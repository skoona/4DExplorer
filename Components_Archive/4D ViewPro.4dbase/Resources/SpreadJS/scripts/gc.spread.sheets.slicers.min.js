/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity/spread-sheets")):t(GC)}(function(i){!function(){"use strict";var n,e,t;function r(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,r)),i.exports}n={"./dist/plugins/slicer/slicer-actions.js":function(t,i,n){var e,o,n,r,s,c,u,a,f,h,l,v,d,m;function b(t){var i,n,n;return!!t.canUndo()&&(i=t.Mf,n=o.Commands.TI(i.name()),n=t.tT[n],t.X5(i,!0),i.Ut.undo(n),t.q5(i,!0),!0)}function g(t,i,n){var e,t,n,r,e=t.parent,t=t.slicers.get(n);e&&i.Z3&&t&&(n=t.startRow(),r=t.startColumn(),e.changeSelectionInCommandExecuting(i,n,r,[],[t]))}function p(t,i){for(var n=0;n<t.length;n++)if(t[n].columnName===i)return t[n]._ps&&t[n]._ps.name}function S(t,i){return l.call(this,t,i)||this}function w(t,i){return v.call(this,t,i)||this}function _(t,i){return d.call(this,t,i)||this}function y(t,i){return m.call(this,t,i)||this}e=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.DeleteSlicerUndoAction=void 0,o=n("Core"),n=o.Commands.ActionBase,e(S,l=n),S.prototype.canExecute=function(){return!!this.tT.slicerData},S.prototype.execute=function(){var t,i,n,e,i,t=this,i=t.tT;return!!t.canExecute()&&(g(n=t.Mf,i,e=p(i.slicerData.aT,i.columnName)),n.Ut.startTransaction(),t.X5(n,!0),i.slicerData.doFilter(i.columnName,{exclusiveRowIndexes:i.newValue}),t.q5(n,!0),i=o.Commands.TI(n.name()),t.tT[i]=n.Ut.endTransaction(),!0)},S.prototype.canUndo=function(){return!!this.tT.slicerData},S.prototype.undo=function(){return b(this)},r=S,e(w,v=n),w.prototype.canExecute=function(){return!!this.tT.slicerData},w.prototype.execute=function(){var t,i,n,e,i,t=this,i=t.tT;return!!t.canExecute()&&(g(n=t.Mf,i,e=p(i.slicerData.aT,i.columnName)),n.Ut.startTransaction(),t.X5(n,!0),i.slicerData.doUnfilter(i.columnName),t.q5(n,!0),i=o.Commands.TI(n.name()),t.tT[i]=n.Ut.endTransaction(),!0)},w.prototype.canUndo=function(){return!!this.tT.slicerData},w.prototype.undo=function(){return b(this)},s=w,e(_,d=n),_.prototype.canExecute=function(){return!!this.tT.slicer},_.prototype.execute=function(){var t,i,n,e,t=this,i=t.tT;return!!t.canExecute()&&(g(n=t.Mf,i,e=p(i.slicerData.aT,i.columnName)),t.X5(n,!0),i.slicer[i.propertyName](i.newValue),t.q5(n,!0),!0)},_.prototype.canUndo=function(){return!!this.tT.slicer},_.prototype.undo=function(){var t,i,n,t=this,i=t.tT;return!!t.canUndo()&&(n=t.Mf,t.X5(n,!0),i.slicer[i.propertyName](i.oldValue),t.q5(n,!0),!0)},c=_,u=o.Commands.zA,o.Commands.filterSlicer={canUndo:!0,execute:function(t,i,n){return u(t,r,i,n)}},o.Commands.unfilterSlicer={canUndo:!0,execute:function(t,i,n){return u(t,s,i,n)}},o.Commands.changeSlicerProperty={canUndo:!0,execute:function(t,i,n){return u(t,c,i,n)}},o.Commands.unfilterSlicerByKey={canUndo:!1,execute:function(t,i){var t,i,i,n,e,t=o.Commands.Tp(t,i),i=t.slicers.t1i();if(1===i.length&&(n=(i=i[0]).i1i()))return e=n.getFilteredIndexes(i.columnName()),t.Qy().execute({cmd:"unfilterSlicer",sheetName:t.name(),slicerData:n,columnName:i.columnName(),value:e})}},a="deleteSlicers",e(y,m=n),y.prototype.canExecute=function(){return!0},y.prototype.execute=function(){var t,i,n,e,r,s,t=this,i=!1,n=t.Mf,e=t.tT,r=e.slicerNames;return t.canExecute()&&o.GC$.isArray(r)&&(n.Ut.startTransaction(),t.X5(n,!0),r.forEach(function(t){n.slicers.DK(t)}),t.q5(n,!0),e[s=o.Commands.TI(n.name())]=n.Ut.endTransaction(),i=0<r.length),i},y.prototype.undo=function(){var t,i,n,e,t=this,i=t.tT,n=t.Mf;return!!t.canUndo()&&(t.X5(n,!0),e=o.Commands.TI(n.name()),n.Ut.undo(i[e]),t.q5(n,!0),!0)},i.DeleteSlicerUndoAction=f=y,o.Commands[a]={canUndo:!0,execute:function(t,i,n){return n||i.cmd||(i.cmd=a),0<i.slicerNames.length&&u(t,f,i,n)}}},"./dist/plugins/slicer/slicer-base/slicer-base.js":function(A,c,t){var i,d,n,u,a,m,e,r,o,s,f,h,l,M,v,b,g,p,S,B,W,w,P,H,_,y,D,C,t,n,j,t,O;function I(t){return t===l||t===h}function U(t){return"number"==typeof t&&0<t}function J(t,i){return i===H?~~t:i===_?!!t:t}function N(t,i,n){var e=this;e[t]&&(I(y[t])||(i=J(i,y[t])),e[t](i),e.refresh()),E.call(e,t,n)}function E(t,i){var n,e,n=this,e=n.sheet();e&&(e.Ut.n1i(n,t,i),n.ki({sheet:e,sheetName:e.name(),slicer:n,propertyName:t}))}function z(n,t,e,i){return W(n,t,function(t,i){e.call(this,n,t,i)},i)}function V(t){var i,n,e,i;return t.dynamicMove()?t.dynamicSize()||(i="oneCell"):i="absolute",n="timeline"===t.ma,e=t.allowResize(),!(i={editAs:i,from:{col:{v_:t.startColumn()},colOff:{v_:f(t.startColumnOffset())},row:{v_:t.startRow()},rowOff:{v_:f(t.startRowOffset())}},to:{col:{v_:t.endColumn()},colOff:{v_:f(t.endColumnOffset())},row:{v_:t.endRow()},rowOff:{v_:f(t.endRowOffset())}},AlternateContent:{r_:[29],Choice:{r_:n?[36,37]:[34,35],graphicFrame:{macro:"",nvGraphicFramePr:{cNvPr:{id:n?"8":"2",name:x(t.name())},cNvGraphicFramePr:Y(t.disableResizingAndMoving(),e)},xfrm:{off:{x:0,y:0},ext:{cx:0,cy:0}},graphic:{graphicData:{uri:n?"http://schemas.microsoft.com/office/drawing/2012/timeslicer":"http://schemas.microsoft.com/office/drawing/2010/slicer"}}}},Fallback:{xmlns:"",sp:{macro:"",textlink:"",nvSpPr:{cNvPr:{id:"0",name:""},cNvSpPr:{spLocks:{noTextEdit:w}}},spPr:{xfrm:{off:{x:5486400,y:942975},ext:{cx:1828800,cy:2524125}},prstGeom:{prst:"rect",avLst:{}},solidFill:{prstClr:{val:"white"}},ln:{w:1,solidFill:{prstClr:{val:"green"}}}},txBody:{bodyPr:{vertOverflow:"clip",horzOverflow:"clip"},lstStyle:{},p:[{n_:"p",c_:[{r:{rPr:{lang:"en-US",sz:"1100"},t:{v_:n?"Timeline: Works in Excel 2013 or higher. Do not move or resize.":"This shape represents a table slicer. Table slicers are supported in Excel or later.    If the shape was modified in an earlier version of Excel, or if the workbook was saved in Excel 2007 or earlier, the slicer can't be used."}}}]}]}}}},clientData:{}})===t.isVisible()&&(i.AlternateContent.Choice.graphicFrame.nvGraphicFramePr.cNvPr.hidden=w),!1===t.isLocked()&&(i.clientData.fLocksWithSheet=P),1!==e&&2!==e||(i.AlternateContent.Choice.graphicFrame.lossless={allowResize:e}),n?(i.AlternateContent.Choice.graphicFrame.nvGraphicFramePr.cNvPr.extLst={ext:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}",creationId:{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{729A7851-DBA1-4F10-BB7B-BEC1E3EEDA64}"}}},i.AlternateContent.Choice.graphicFrame.graphic.graphicData.timeslicer={r_:[36],name:x(t.name())}):i.AlternateContent.Choice.graphicFrame.graphic.graphicData.slicer={r_:[38],name:x(t.name())},i}function Y(t,i){var n={};return t&&(n.noMove=w,n.noResize=w),0===i&&(n.noChangeAspect=w),{graphicFrameLocks:n}}function G(t){return r(s(t,"\n","_x000a_"))}function T(t){return o(s(s(t,"_x000a_","\n"),"&#xA;","\n"))}function x(t){return r(s(t,"\n","&#xA;"))}function L(){var t=null!==O&&O.apply(this,arguments)||this;return t.e1i={},t.rb=!1,t.u=!0,t}function k(t,i,n){this.r1i={},this.UQt=!1,this.Mf=t,this.updateOptionsCallback=i,this.updateValuesCallback=n,this.WQt()}function R(t,i,n){this.Mf=i,this.FQt=n,this.name(t),this.captionName(this.sourceName())}function q(t,i){t.save(),t.strokeStyle="#000000",t.miterLimit=4,t.fillStyle=i?"#FFFFFF":"#DCDCDC",t.font="15px",t.beginPath(),t.moveTo(3,3),t.lineTo(17,3),t.lineTo(17,6),t.lineTo(12,12),t.lineTo(12,17),t.lineTo(8,17),t.lineTo(8,12),t.lineTo(3,6),t.lineTo(3,3),t.stroke(),t.beginPath(),t.moveTo(3,3),t.lineTo(17,3),t.lineTo(17,6),t.lineTo(12,12),t.lineTo(12,17),t.lineTo(8,17),t.lineTo(8,12),t.lineTo(3,6),t.lineTo(3,3),t.fill(),t.restore(),t.save(),t.fillStyle=i?"#E65249":"#C4C4C4",t.font="15px",t.beginPath(),t.moveTo(19,13.75),t.lineTo(18.25,13),t.lineTo(16,15.25),t.lineTo(13.75,13),t.lineTo(13,13.75),t.lineTo(15.25,16),t.lineTo(13,18.25),t.lineTo(13.75,19),t.lineTo(16,16.75),t.lineTo(18.25,19),t.lineTo(19,18.25),t.lineTo(16.75,16),t.lineTo(19,13.75),t.fill(),t.restore()}function F(t){var i=t;if((i=t.AlternateContent?t.AlternateContent.Choice:i).twoCellAnchor?i=i.twoCellAnchor:i.oneCellAnchor?i=i.oneCellAnchor:i.absoluteAnchor&&(i=i.absoluteAnchor),i)return i=i.AlternateContent?i.AlternateContent.Choice:i}function K(t,i){var r,s,r=[],s=i.split(".");return d.GC$.each(t.c_,function(t,i){for(var n,e,n=F(i),e=0;e<s.length;e++)if((n=n[s[e]])===l)return;r.push(o(n))}),r}function Z(t,i,s){var o,c,c=i.split(".");return d.GC$.each(t.c_,function(t,i){for(var n,e,r,n=i,e=F(i),r=0;r<c.length;r++)if((e=e[c[r]])===l)return;if(T(e)===T(s))return o=n,!1}),o}i=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(c,"__esModule",{value:!0}),c.iSi=c.tSi=c.nSi=c.SlicerViewBase=c.SlicerViewModelBase=c.SlicerBase=c.encodeSlicerDrawingName=c.decodeSlicerName=c.encodeSlicerName=c.getSlicerDrawing=c.SlicerUIType=c.defSlicerProperty=c.afterPropertyChanged=c.onPropertyChanged=c.ItemSlicerCacheProperties=c.ItemSlicerProperties=c.SlicerShapeProperties=c.SlicerBaseProperties=c.ht=c.TIMELINE_DRAWING_PATH=c.SLICER_DRAWING_PATH=void 0,d=t("Core"),n=t("Shapes"),u=t("./dist/plugins/slicer/slicer.js"),a=t("./dist/plugins/slicer/slicer-style.js"),m=t("./dist/plugins/slicer/slicer-ui/diagram-util.js"),e=t("./dist/plugins/slicer/slicer-ui/slicer-button.js"),c.SLICER_DRAWING_PATH="graphicFrame.graphic.graphicData.slicer.name",c.TIMELINE_DRAWING_PATH="graphicFrame.graphic.graphicData.timeslicer.name",r=d.util.vo,o=d.util.n1,s=d.Util.gr,f=d.ExcelHelper.pixelToEMU,h=null,l=void 0,M=1,v="name",b="black",g="white",p="normal 11pt calibri",S="bold 11pt calibri",B=d.mt.yt,W=d.mt.p0,w=n&&n.SJS_True,P=n&&n.SJS_False,c.ht=I,c.SlicerBaseProperties=[["name","",function(t,i,n){var e=this;e.Mf&&(e.Mf.slicers.Ydt(n,i),E.call(e,t,n))}],["captionName","",N],["disableResizingAndMoving",!1,function(t,i,n){var e,i,e=this;e.allowMove(!i),e.allowResize(!i),N.call(e,"disableResizingAndMoving",i,n),(i=e.sheet())&&i.zw()}],["showHeader",!0,N]],c.SlicerShapeProperties=["isSelected","isVisible","isLocked","dynamicMove","dynamicSize","x","y","height","width","startRow","startColumn","endRow","endColumn","startRowOffset","startColumnOffset","endRowOffset","endColumnOffset","allowResize","allowMove"],c.ItemSlicerProperties=[["columnCount",1,N,U],["itemHeight",21,N,U],["multiSelect",!1,N]],y={columnCount:H="i",multiSelect:_="b",showHeader:_,showHorizontalScrollbar:_,showSelectionLabel:_,showTimeLevel:_},c.ItemSlicerCacheProperties=["showNoDataItems","showNoDataItemsInLast","visuallyNoDataItems","sortState"],c.onPropertyChanged=N,c.afterPropertyChanged=E,c.defSlicerProperty=z,(t=D=c.SlicerUIType||(c.SlicerUIType={}))[t.header=1]="header",t[t.captionName=2]="captionName",t[t.clearFilter=3]="clearFilter",t[t.multiSelect=4]="multiSelect",t[t.item=5]="item",t[t.scrollBar=6]="scrollBar",t[t.timeLevel=7]="timeLevel",t[t.dragBar=8]="dragBar",c.getSlicerDrawing=V,c.encodeSlicerName=G,c.decodeSlicerName=T,c.encodeSlicerDrawingName=x,n&&(R.prototype.init=function(){var t=this;t.initSlicerUI(),t.paintSlicerUI()},R.prototype.setFilter=function(){this.FQt.setFilter()},R.prototype.wmi=function(){this.GQt&&this.GQt.wmi()},R.prototype.clearFilter=function(){this.FQt.clearFilter()},R.prototype.filterCleared=function(){return this.FQt.filterCleared()},R.prototype.initSlicerUI=function(){},R.prototype.paintSlicerUI=function(){this.GQt&&this.GQt.refresh()},R.prototype.refresh=function(){this.wmi(),this.paintSlicerUI()},R.prototype.L0=function(){var t=this;t.GQt.dispose(),t.GQt=h,t.Mf=h,t.FQt=h,t.RN=h},R.prototype.sheet=function(){return this.Mf},R.prototype.sourceName=function(){return this.FQt.sourceName},R.prototype.nameInFormula=function(t){var i=this;if(0===arguments.length)return i.FQt.name;i.FQt.name=t},R.prototype.position=function(t){var i=this;return 0===arguments.length?new d.Point(i.x(),i.y()):(i.x(t.x||m.DEFAULT_LEFT),i.y(t.y||m.DEFAULT_TOP),i)},R.prototype.style=function(t){var i,n,i=this;if(0===arguments.length)return i.RN;i.RN!==t&&((n=new a.SlicerStyle).fromJSON(i.RN.toJSONInternal()),i.RN.fromJSON(t.toJSONInternal()),i.GQt.setStyle(i.RN),i.refresh(),E.call(i,"style",n))},R.prototype.ki=function(t){var i=this.sheet();i&&i.ki(d.Events.SlicerChanged,t)},R.prototype.s1i=function(t){for(var i,n,e,r,i=1,n,e=t,r=this.sheet().parent;(0,u.o1i)(r,e);)e=t+i,i++;return e},R.prototype.toJSON=function(i){var n,e,t,t,n=this,e={},t=n.FQt;return e.type=n.ma,e.slicerCacheName=t.name,n.style()&&(e.style=n.style().toJSON()),n.ma===u.SlicerType.table&&(t=t._getTable())&&t.Gwt&&(e.newTableName=t.Gwt,e.sourceName=n.sourceName()),c.SlicerBaseProperties.forEach(function(t){var t=t[0];t===v?I(i)?e[v]=n.name():e[v]=n.s1i(n.name()):e[t]=n[t]()}),c.SlicerShapeProperties.forEach(function(t){n[t]&&(e[t]=n[t]())}),e.nameInFormula=n.nameInFormula(),e},R.prototype.fromJSON=function(i){var n=this;c.SlicerBaseProperties.forEach(function(t){var t=t[0];i[t]!==l&&n[t](i[t])}),c.SlicerShapeProperties.forEach(function(t){n[t]&&i[t]!==l&&n[t](i[t])}),n.style().fromJSON(i.style)},R.prototype.getSlicerUIRect=function(t,i){if(this.GQt)return this.GQt.gWt(t,i)},R.prototype.yh=function(t,i,n,e,r){var s,o,i,o,s=this,o=t.name;o!==l&&s.name(T(o)),t.caption!==l&&s.captionName(T(t.caption)),t.showCaption!==l&&s.showHeader("1"===t.showCaption),o!==l&&i!==l&&s.GQt!==l&&s.GQt.yh(i,o,e,r,s.ma===u.SlicerType.pivotTimeline?c.TIMELINE_DRAWING_PATH:c.SLICER_DRAWING_PATH),t.lockedPosition!==l&&s.disableResizingAndMoving("1"===t.lockedPosition),(i=t.style||n.getDefaultStyleName("defaultSlicerStyle"))&&((0,a.isBuildInSlicerStyle)(i)?s.style(a.SlicerStyles[i.substring("SlicerStyle".length).toLowerCase()]()):(o=n.getSlicerStyle(i))&&s.style(o))},C=R,c.SlicerBaseProperties.forEach(function(t){C.prototype[t[0]]=z(t[0],t[1],t[2],t[3])}),c.SlicerShapeProperties.forEach(function(n){C.prototype[n]=function(t){var i=this;return 0===arguments.length?this.GQt&&this.GQt.getProperty(n):(i.GQt.setProperty(n,t),"isLocked"===n&&i.refresh(),this)}}),C.prototype.getShapePoints=function(){return this.GQt&&this.GQt.zQt&&this.GQt.zQt.shape.getShapePoints()},k.prototype.WQt=function(){},k.prototype.wmi=function(){this.zQt&&this.zQt.wmi()},k.prototype.bind=function(t,i){this.r1i||(this.r1i={}),this.r1i[t]||(this.r1i[t]=[]),this.r1i[t].push(i)},k.prototype.ki=function(t,i){var t=this.r1i[t];t&&0<t.length&&t.forEach(function(t){t(i)})},k.prototype.getProperty=function(t){var i=this;if(i.RQt[t])return i.RQt[t]()},k.prototype.setProperty=function(t,i){var n=this;if(n.RQt[t])return n.RQt[t](i)},k.prototype.refreshFormControl=function(){var t,i,t=this,i;t.zQt.options=t.updateOptionsCallback()},k.prototype.setStyle=function(t){this.zQt.setStyle(t)},k.prototype.refresh=function(){var t;this.refreshFormControl()},k.prototype.yh=function(t,n,i,e,r){var s,o,c,t,u,a,u,i,s=this;t&&(d.GC$.each(t,function(t,i){if(o=Z(i,r,n))return!1}),o)&&(a=(u=(t=(c=F(o)).graphicFrame).nvGraphicFramePr).cNvPr,u=u.cNvGraphicFramePr.graphicFrameLocks,o.twoCellAnchor?(o=o.twoCellAnchor).anchorType=0:o.oneCellAnchor?(o=o.oneCellAnchor).anchorType=1:o.absoluteAnchor&&((o=o.absoluteAnchor).anchorType=2),d.Util.Co(i)&&d.Util.To(s.Mf,o,l,e),i={nvSpPr:{cNvPr:a,cNvSpPr:{spLocks:u}},spPr:{prstGeom:{prst:"rect"}},lossless:t.lossless},o.sp=i,s.zQt.yh(i,o),delete o.sp)},k.prototype.dispose=function(){this.zQt&&(this.zQt.dispose(),this.zQt=h),this.UQt||(this.UQt=!0,this.Mf.shapes.remove(this.RQt.name())),this.r1i=h,this.RQt=h},k.prototype.gWt=function(t,i){var n;return n=this.zQt?this.zQt.gWt(t,i):n},t=k,O=n.BaseFormControl,i(L,O),L.prototype.isInternalUseForUIDisplay=function(){return!0},L.prototype.onMouseDown=function(t){if(!this.shouldProcessMouseDownEvt(t))return!1;this.doMouseDown(t.evt)&&(this.rb=!0,t.cancelDefault=!0)},L.prototype.onMouseMove=function(t){this.doMouseMove(t.evt),this.rb&&(t.cancelDefault=!0);var t=this.sheet;I(t)||I(t.MD)||(clearTimeout(t.MD),delete t.MD)},L.prototype.onMouseUp=function(t){this.doMouseUp(t.evt),this.rb&&(t.cancelDefault=!0,this.rb=!1)},L.prototype.c1i=function(){var t,i,t=this.sheet.options,i=this.LEt;return!t.isProtected||!i.isLocked||t.protectionOptions.allowEditObjects},L.prototype.shouldProcessMouseEvt=function(t){var t=t.canvas.getPointer(t.evt);return this.c1i()&&this.hitTest(t)},L.prototype.shouldProcessMouseDownEvt=function(t){return this.shouldProcessMouseEvt(t)&&0===t.evt.button},L.prototype.doMouseDown=function(t){return!1},L.prototype.doMouseMove=function(t){return h},L.prototype.doMouseUp=function(t){this.u1i.onMouseUp(t)},L.prototype.onClearFilterButtonClick=function(){this.triggerEvent("clearFilter"),this.onClearFilter(),this.refresh()},L.prototype.onClearFilter=function(){},L.prototype.addEventListener=function(t,i){var n,e,n=this,e=n.e1i[t]||[];e.push(i),n.e1i[t]=e},L.prototype.removeEventListener=function(t,i){var n,t,i,n,t=this.e1i[t]||[],i=t.indexOf(i);-1!==i&&t.splice(i,1)},L.prototype.fireEvent=function(t,i){var n,e,n=this,e;(n.e1i[t]||[]).forEach(function(t){return t(n.shape,i)})},L.prototype.dispose=function(){this.u1i.dispose(),this.u1i=null,this.e1i=null,O.prototype.dispose.call(this)},L.prototype.wmi=function(){this.u=!0},L.prototype.getButtonBGStyle=function(){var t,i,t,i;return{headerStyle:this.getHeaderStyle(),wholeStyle:this.getWholeStyle()}},L.prototype.initClearFilterButton=function(){var t,i,t=new e.SlicerButton,i=t.props;i.contentType="callback",i.containerSize={w:23,h:23},i.renderCallBack=q,i.onButtonClick=this.onClearFilterButtonClick.bind(this),i.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),i.refresh=this.refresh.bind(this),i.setCursor=this.setCursor.bind(this),i.getBackColor=this.getButtonBGStyle.bind(this),i.getThemeColor=this.getThemeColor.bind(this),t.props=i,this.u1i=t},L.prototype.onWindowMouseMove=function(t){this.u1i.onWindowMouseMove(t)},L.prototype.getWholeStyle=function(){return this.RN.wholeSlicerStyle()},L.prototype.getHeaderStyle=function(){return this.RN.headerStyle()},L.prototype.getThemeColor=function(t){return this.shape.Mf.currentTheme().getColor(t)},L.prototype.triggerEvent=function(t,i){this.fireEvent(t,i)},L.prototype.setCursor=function(t){var i=this.shape.Mf.Dg();i&&(i.style.cursor=t)},L.prototype.setStyle=function(t){this.RN=t},L.prototype.a1i=function(t){if(0===arguments.length)return this.f1i;this.f1i=!!t},L.prototype.gWt=function(t,i){var n,e,r,s,o,n=this,e=n.LEt.showHeader,r=n.width,s=n.height;switch(t){case D.header:o=e?new d.Rect(0,0,r,Math.min(s,25)):h;break;case D.captionName:o=e?new d.Rect(10,10,r-60,Math.min(s,10)):h;break;case D.clearFilter:o=e?new d.Rect(r-30,5,16,16):h;break;case D.multiSelect:o=e?new d.Rect(r-55,5,16,16):h}return(i=i||{}).left=10,i.top=e?30:5,{rect:o,args:i}},L.prototype.render=function(t,i){var n,e,r,s,o,n=this;if(n.RN)return e=-n.width/2,r=-n.height/2,s=n.width-20,o=n.height-40,t.textAlign="left",t.textBaseline="middle",n.paintBody(t,e,r,s,o),n.LEt.showHeader?n.paintHeader(t,e,r,s,o):o+=30,n.a1i()&&n.h1i(t,e,r,s,o),{left:e,top:r,w:s,h:o}},L.prototype.paintBody=function(t,i,n,e,r){var s,o,c,u,a,f,s=this,o=s.getWholeStyle();for(t.save(),c=new d.Rect(i,n,s.width,s.height),u=0;u<4;u++)(f=o[a=m.Border_Names[u]]())&&(0,m.paintBorder)(t,u,c,f,this.getThemeColor.bind(this));(0,m.appendBackColorStyle)(t,i,n,s.width,s.height,o,o,this.getThemeColor.bind(this)),t.fillRect(c.x,c.y,c.width,c.height),t.restore()},L.prototype.paintHeader=function(t,i,n,e,r){var s,o,c,u,a,u,f,h,l,v,u,a,s=this;for(t.save(),o=new d.Rect(i,n,s.width,Math.min(s.height,25)),t.rect(o.x,o.y,o.width,o.height),t.clip(),t.beginPath(),c=s.getHeaderStyle(),u=s.getWholeStyle(),c&&c.backColor()||u&&u.backColor()?(0,m.appendBackColorStyle)(t,i,n,o.width,o.height,c,u,this.getThemeColor.bind(this)):t.fillStyle=g,t.fillRect(o.x,o.y,o.width,o.height),a=s.LEt.captionName||"",t.font=B(s.l1i(c,u)),u=c&&c.foreColor()||u&&u.foreColor()||b,t.fillStyle=s.getThemeColor(u),t.fillText((0,m.getEllipsisText)(t,a,e-50),i+10,n+15),f=!1,!s.v1i(c.borderBottom())&&s.v1i(c.borderRight())&&s.v1i(c.borderLeft())&&s.v1i(c.borderTop())&&(f=!0),h=0;h<4;h++)(v=c[l=m.Border_Names[h]]())&&(2===h&&f&&(o.width-=20,o.x+=10),(0,m.paintBorder)(t,h,o,v,this.getThemeColor.bind(this)),2===h)&&f&&(o.width+=20,o.x-=10);u=s.u1i,a=s.filterCleared(),t.translate(.5*e-20,n+1),u.props.offset=s.bWt(),u.props.enabled=!a,u.render(t),t.restore()},L.prototype.h1i=function(t,i,n,e,r){var s=i,o=n;for(t.save(),t.beginPath(),t.fillStyle="red";s<e+i;)t.fillRect(s,n,1,r),s+=10;for(t.fillStyle="lightblue";o<r+n;)t.fillRect(i,o,e,1),o+=10;t.restore()},L.prototype.filterCleared=function(){return!0},L.prototype.bWt=function(){var t;return{top:-5,left:30-this.width}},L.prototype.v1i=function(t){return!(t&&t.borderColor()&&t.borderStyle()&&t.borderWidth())},L.prototype.l1i=function(t,i){return t&&t.font()?t.font():i&&i.font()&&i.font()!==p?i.font():S},L.prototype.isNeedControlCursorBySelf=function(){return!0},L.prototype.isNeedControlCommandBySelf=function(){return!0},L.prototype.yh=function(t,i){this.shape.yh(t,i),this.shape.anV(!0)},n=L,c.SlicerBase=C,c.SlicerViewModelBase=t,c.SlicerViewBase=n),c.nSi=F,c.tSi=K,c.iSi=Z},"./dist/plugins/slicer/slicer-base/slicer-cache-base.js":function(t,i){var n,e,r;function s(t,i){this.name=t,this.sourceName=i,this.IQt=[],this.Xst=!1}Object.defineProperty(i,"__esModule",{value:!0}),i.SlicerCacheBase=i.SlicerCacheType=void 0,(r=n=i.SlicerCacheType||(i.SlicerCacheType={}))[r.pivotSlicer=1]="pivotSlicer",r[r.pivotTimeline=2]="pivotTimeline",r[r.tableSlicer=3]="tableSlicer",s.prototype.filterCleared=function(){return!0},s.prototype.suspendUpdate=function(){this.Xst=!0},s.prototype.resumeUpdate=function(){this.Xst=!1,this.updateCache()},s.prototype.canUpdate=function(){return!this.Xst},s.prototype.mQt=function(){return null},s.prototype.beforeSetFilter=function(){var t,i,t=this,i=t.mQt();t.suspendUpdate(),i.suspendPaint(),i.suspendCalcService()},s.prototype.afterSetFilter=function(){var t,i,t=this,i=t.mQt();i.resumeCalcService(!1),i.resumePaint(),t.resumeUpdate()},s.prototype.add=function(t,i){return null},s.prototype.get=function(i){var t,n,t;return this.IQt.forEach(function(t){if(t.name()===i)return n=t,!0}),n},s.prototype.remove=function(n){var e=this;e.d1i||e.IQt.forEach(function(t,i){if(t.name()===n)return e.IQt.splice(i,1),t.L0(),!0})},s.prototype.updateCache=function(){},s.prototype.onWorkSheetDisposing=function(t){for(var i,n,e,i=this,n=i.IQt.length-1;-1<n;n--)(e=i.IQt[n]).sheet()&&e.sheet().name()!==t||i.IQt.splice(n,1)},s.prototype.setFilter=function(){},s.prototype.clearFilter=function(){},s.prototype.refreshSlicers=function(){this.IQt.forEach(function(t){t.refresh()})},s.prototype.toJSON=function(){},s.prototype.fromJSON=function(t){var i=this;i.disposeAllSlicers(),i.IQt=[],i.name=t.name},s.prototype.disposeAllSlicers=function(){var t=this;t.d1i=!0,t.IQt.forEach(function(t){t.L0()}),t.d1i=!1},s.prototype.dispose=function(){var t=this;t.disposeAllSlicers(),t.IQt=null},i.SlicerCacheBase=s},"./dist/plugins/slicer/slicer-style.js":function(A,t,i){var o,M,l,B,s,f,c,v,n,W,b,D,e,r,u,a,h,i,P,H,U,J,z,M,V,Y,G,q,K,d,Z,$,Q,X,tt,it,nt,et,rt,st,ot,ct,ut,at,ft,ht,lt,C,vt,m,dt,g,mt,bt,gt,pt,St,wt,_t,yt,Dt,Ct,jt,Ot,It,Nt,Et,Tt,xt,p,S,w,_,Lt,y,kt,Rt,Ft,At,Mt,Bt,j,O,I;function Wt(t,i){return!!(t&&0<t.length&&0<t.filter(function(t){return t.name===i}).length)}function Pt(t,i,n,e){var r,s,o,c,u,r=[],s={n_:"tableStyle",c_:r,name:t};if(!(e?R:F)(t))for(o in n)if(n.hasOwnProperty(o)&&"name"!==o&&!(0,l.ht)(n[o]))switch(o){case"headerStyle":case"wholeSlicerStyle":ri(n[o]),(c=i.getDxfIndex(n[o]))!==v&&r.push(u={n_:"tableStyleElement",type:W[o],dxfId:c})}s.pivot="0",s.count=r.length,0===r.length&&delete s.c_,i.addTableStyle(s)}function Ht(t){var i,n,i,i=(t.kSt?(i=t.kSt,n=o.NodeHelper.sr(i.dxfId,0),i):(n=t.dxfId,t)).type;return{type:i,dxfId:n}}function N(){var t=this;t[D]("",!1),t[d](Jt(),!1)}function E(){var t=this;t[D]("",!1),t[d](Jt(),!1)}function T(t,i,n,e,r,s,o,c){for(var u=0,a=f(T.properties);u<a;u++)this[T.properties[u]](arguments[u])}for(Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineStyles=t.SlicerStyles=t.isBuildInTimelineStyle=t.isBuildInSlicerStyle=t.SlicerBorder=t.SlicerStyleInfo=t.TimelineStyle=t.SlicerStyle=void 0,o=i("Core"),M=i("Common"),l=i("./dist/plugins/slicer/slicer-base/slicer-base.js"),B=o.mt.p0,s=o.mt.T1,f=M.Common.Uf.tR,c=null,v=void 0,n="normal 11pt calibri",W={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow"},D="name",e="light",r="dark",u="white",a="black",i="font",P="setBorders",H="back"+(b={b1i:"Style",m1i:"Color",g1i:"Width",hdt:"border",ght:"top",p1i:"header",S1i:"body",w1i:"periodLabel",_1i:"selectedTimeBlock",y1i:"WithDataStyle",D1i:"WithNoDataStyle",C1i:"electedItem",O1i:"hovered",j1i:"gc-slicer-",I1i:"container",N1i:"clearfilter",E1i:"itemscontainer",T1i:"item"}).m1i,U="fore"+b.m1i,J=b.hdt+"Width",z=b.hdt+b.b1i,M=b.hdt+b.m1i,V=b.hdt+"Left",Y=b.hdt+"Top",G=b.hdt+"Right",q=b.hdt+"Bottom",K="textDecoration",d="wholeSlicer"+b.b1i,Z="header"+b.b1i,$="s"+b.C1i+b.y1i,Q="s"+b.C1i+b.D1i,X="unS"+b.C1i+b.y1i,tt="unS"+b.C1i+b.D1i,it=b.O1i+"S"+b.C1i+b.y1i,nt=b.O1i+"S"+b.C1i+b.D1i,et=b.O1i+"UnS"+b.C1i+b.y1i,rt=b.O1i+"UnS"+b.C1i+b.D1i,st="selectionLabel"+b.b1i,ot="timeLevel"+b.b1i,ct=b.w1i+"1"+b.b1i,ut=b.w1i+"2"+b.b1i,at=b._1i+b.b1i,ft="un"+b._1i+b.b1i,ht=b._1i+"Space"+b.b1i,lt="Accent ",C="Slicer"+b.b1i,vt="Time"+C,m="#999999",dt="#828282",g="#CCCCCC",mt=" 40",bt=" 60",gt=" 80",pt=" -25",St=" -50",wt="bold 11pt calibri",_t="normal 10pt calibri",yt="normal 9pt calibri",Dt="Text 1 50",Ct="Background 1 -15",jt=["empty",h="thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantedDashDot"],Ot={selectedItemWithData:"selectedItemWithDataStyle",selectedItemWithNoData:"selectedItemWithNoDataStyle",unselectedItemWithData:"unSelectedItemWithDataStyle",unselectedItemWithNoData:"unSelectedItemWithNoDataStyle",hoveredSelectedItemWithData:"hoveredSelectedItemWithDataStyle",hoveredSelectedItemWithNoData:"hoveredSelectedItemWithNoDataStyle",hoveredUnselectedItemWithData:"hoveredUnSelectedItemWithDataStyle",hoveredUnselectedItemWithNoData:"hoveredUnSelectedItemWithNoDataStyle",wholeTable:"wholeSlicerStyle",headerRow:"headerStyle"},It={selectionLabel:"selectionLabelStyle",timeLevel:"timeLevelStyle",periodLabel1:"periodLabel1Style",periodLabel2:"periodLabel2Style",selectedTimeBlock:"selectedTimeBlockStyle",unselectedTimeBlock:"unselectedTimeBlockStyle",selectedTimeBlockSpace:"selectedTimeBlockSpaceStyle",wholeTable:"wholeSlicerStyle",headerRow:"headerStyle"},Nt={selectedItemWithDataStyle:"selectedItemWithData",selectedItemWithNoDataStyle:"selectedItemWithNoData",unSelectedItemWithDataStyle:"unselectedItemWithData",unSelectedItemWithNoDataStyle:"unselectedItemWithNoData",hoveredSelectedItemWithDataStyle:"hoveredSelectedItemWithData",hoveredSelectedItemWithNoDataStyle:"hoveredSelectedItemWithNoData",hoveredUnSelectedItemWithDataStyle:"hoveredUnselectedItemWithData",hoveredUnSelectedItemWithNoDataStyle:"hoveredUnselectedItemWithNoData"},Et={selectionLabelStyle:"selectionLabel",timeLevelStyle:"timeLevel",periodLabel1Style:"periodLabel1",periodLabel2Style:"periodLabel2",selectedTimeBlockStyle:"selectedTimeBlock",unselectedTimeBlockStyle:"unselectedTimeBlock",selectedTimeBlockSpaceStyle:"selectedTimeBlockSpace"},Tt={empty:0,thin:1,medium:2,dashed:3,dotted:4,thick:5,double:6,hair:7,mediumDashed:8,dashDot:9,mediumDashDot:10,dashDotDot:11,mediumDashDotDot:12,slantedDashDot:13},xt={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3},N.prototype.fromJSON=function(e){var r,t,t,i;e&&!o.GC$.isEmptyObject(e)&&(r=this,t=e.name,s(t)&&(r.name(t),R(t))?(t=t.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),i=Ut(t),N.properties.forEach(function(t){r[t](i[t](),!1)})):N.properties.forEach(function(t){var i,n,i=e[t];t!==D&&(n=Ut(),s(i)&&n.fromJSON(i),r[t](n,!1))}))},N.prototype.toJSON=function(){var t,i,n,e,t=this,i=R(t.name())?{name:t.name()}:t.toJSONInternal(),n={};for(e in i)i[e]===c||i[e]===v||o.GC$.isEmptyObject(i[e])||(n[e]=i[e]);return n},N.prototype.toJSONInternal=function(){var t,i,n,e,r,s,t=this,i={},n="toJSON";for(i[D]=t.name(),e=1,r=f(N.properties);e<r;e++)i[s=N.properties[e]]=t[s]()?t[s]()[n]():c;return i},N.prototype.wh=function(t,i,n,e){var r,s,o,c,u,a,f,h,r=this,s=r.toJSON();if(t&&Pt(r.name(),n,s,!0),i&&(o=e.dxfsRecords,!Wt(c=e.slicerStyleNodes,r.name()))&&!R(r.name())){for(a in u=[],s)if(s.hasOwnProperty(a)&&"name"!==a&&!(0,l.ht)(s[a]))switch(a){case"selectedItemWithDataStyle":case"selectedItemWithNoDataStyle":case"unSelectedItemWithDataStyle":case"unSelectedItemWithNoDataStyle":case"hoveredSelectedItemWithDataStyle":case"hoveredSelectedItemWithNoDataStyle":case"hoveredUnSelectedItemWithDataStyle":case"hoveredUnSelectedItemWithNoDataStyle":ri(s[a]),s[a]&&(f=o.cv(s[a]))!==v&&u.push(h={n_:"slicerStyleElement",type:Nt[a],dxfId:f})}c.push({name:r.name(),styleElements:u})}},N.prototype.yh=function(t,i,n,e,r){var s,o,c,u,a,f,a,h,f,l,v,d,m,m,s=this;if(s.name(t),e&&0<e.length)for(o=0,c=e;o<c.length;o++)f=(a=Ht(u=c[o])).type,a=a.dxfId,"function"==typeof s[h=Ot[f]]&&(f=new w,ei(l=n.fv(a)),f.fromJSON(l),s[h](f));if(r&&0<r.length)for(v=0,d=r;v<d.length;v++)u=d[v],h=Ot[u.type],(m=i.getTableTheme(t))&&(l=new w,ei(m=m[W[h]+b.b1i]()),l.fromJSON(m),s[h](l));i.addSlicerStyle(s)},N.properties=[D,d,Z,$,Q,X,tt,it,nt,et,rt],p=N,t.SlicerStyle=p,E.prototype.fromJSON=function(e){var r,t,t,i;e&&!o.GC$.isEmptyObject(e)&&(r=this,t=e.name,s(t)&&(r.name(t),F(t))?(t=t.toLocaleLowerCase().replace("timeslicerstyle","").replace(" ",""),i=x(t),E.properties.forEach(function(t){r[t](i[t](),!1)})):E.properties.forEach(function(t){var i,n,i=e[t];t!==D&&(n=x(),s(i)&&n.fromJSON(i),r[t](n,!1))}))},E.prototype.toJSON=function(){var t,i,n,e,t=this,i=F(t.name())?{name:t.name()}:t.toJSONInternal(),n={};for(e in i)i[e]===c||i[e]===v||o.GC$.isEmptyObject(i[e])||(n[e]=i[e]);return n},E.prototype.toJSONInternal=function(){var t,i,n,e,r,s,t=this,i={},n="toJSON";for(i[D]=t.name(),e=1,r=f(E.properties);e<r;e++)i[s=E.properties[e]]=t[s]()?t[s]()[n]():c;return i},E.prototype.wh=function(t,i,n,e){var r,s,o,c,u,a,f,h,r=this,s=r.toJSON();if(t&&Pt(r.name(),n,s,!1),i&&(o=e.x15dxfsRecords,!Wt(c=e.timelineStyleNodes,r.name()))&&!F(r.name())){for(a in u=[],s)if(s.hasOwnProperty(a)&&"name"!==a&&!(0,l.ht)(s[a]))switch(a){case"selectionLabelStyle":case"timeLevelStyle":case"periodLabel1Style":case"periodLabel2Style":case"selectedTimeBlockStyle":case"unselectedTimeBlockStyle":case"selectedTimeBlockSpaceStyle":ri(s[a]),s[a]&&(f=o.cv(s[a]))!==v&&u.push(h={n_:"timelineStyleElement",type:Et[a],dxfId:f})}c.push({name:r.name(),styleElements:u})}},E.prototype.yh=function(t,i,n,e,r){var s,o,c,u,a,f,a,h,f,l,v,d,m,m,s=this;if(s.name(t),e&&0<e.length)for(o=0,c=e;o<c.length;o++)f=(a=Ht(u=c[o])).type,a=a.dxfId,"function"==typeof s[h=It[f]]&&(f=new w,ei(l=n.fv(a)),f.fromJSON(l),s[h](f));if(r&&0<r.length)for(v=0,d=r;v<d.length;v++)u=d[v],h=It[u.type],(m=i.getTableTheme(t))&&(l=new w,ei(m=m[W[h]+b.b1i]()),l.fromJSON(m),s[h](l));i.addTimelineStyle(s)},E.properties=[D,d,Z,st,ot,ct,ut,at,ft,ht],S=E,t.TimelineStyle=S,T.prototype.setBorders=function(t){var i;this[V](t)[Y](t)[G](t)[q](t)},T.prototype.fromJSON=function(e){var r;e&&!o.GC$.isEmptyObject(e)&&(r=this,T.properties.forEach(function(t){var i,n,i=e[t];s(i)&&(0<=t.indexOf(b.hdt)?((n=k()).fromJSON(i),r[t](n,!1)):r[t](i,!1))}))},T.prototype.toJSON=function(){var n,e,n=this,e={};return T.properties.forEach(function(t){var i=n[t]();n[t].isDefault(i)||(e[t]=i&&i.toJSON?i.toJSON():i)}),e},T.properties=[H,U,i,V,Y,G,q,K],w=T,t.SlicerStyleInfo=w,_=0,Lt=f(w.properties);_<Lt;_++)w.prototype[w.properties[_]]=B(w.properties[_]);function Ut(t){var i,n;return t&&0!==f(t)?0===t.indexOf(e)?(n=parseInt(t.replace(e,""),10),i=j[e+n]()):0===t.indexOf(r)?(n=parseInt(t.replace(r,""),10),i=j[r+n]()):j[t]&&(i=j[t]()):i=new w,i}function x(t){var i,n;return t&&0!==f(t)?0===t.indexOf(e)?(n=parseInt(t.replace(e,""),10),i=O[e+n]()):0===t.indexOf(r)?(n=parseInt(t.replace(r,""),10),i=O[r+n]()):O[t]&&(i=O[t]()):i=new w,i}function L(t,i,n){for(var e=0;e<L.properties.length;e++)this[L.properties[e]](arguments[e])}for(L.prototype.fromJSON=function(t){var i,n,e;if(t&&!o.GC$.isEmptyObject(t))for(i=0;i<L.properties.length;i++)e=t[n=L.properties[i]],s(e)&&(n!==z||""===e||zt(e)||(e=h),this[n](e,!1))},L.prototype.toJSON=function(){for(var t,i,n,e,t={},i=0;i<L.properties.length;i++)t[L.properties[i]]=this[L.properties[i]]();for(e in n={},t)t[e]!==v&&t[e]!==c&&(n[e]=t[e]);return n},L.properties=[J,z,M],y=L,t.SlicerBorder=y,kt=function(n,t,i){return B(n,t,i,function(t){var i=typeof t;return n===J?"number"==i&&0<=t:"string"==i})},_=0;_<y.properties.length;_++)y.prototype[y.properties[_]]=kt(y.properties[_],v,v);function k(t,i,n){return new y(t,i,n)}function Jt(){var t,i,t=new y(0,"",""),i=new w(u,a,n);return i.setBorders(t),i}function R(t){var i=0,n=17,e=16,r=17;return-1<t.indexOf(C+"Light")&&17===f(t)&&(i=parseInt(t[16],10)),-1<t.indexOf(C+"Dark")&&16===f(t)&&(i=parseInt(t[15],10)),-1<t.indexOf(C+"Other")&&17===f(t)?1<=(i=parseInt(t[16],10))&&i<=2:1<=i&&i<=6}function F(t){var i=0,n=21,e=20;return-1<t.indexOf(vt+"Light")&&21===f(t)&&(i=parseInt(t[20],10)),1<=(i=-1<t.indexOf(vt+"Dark")&&20===f(t)?parseInt(t[19],10):i)&&i<=6}function zt(t){return-1<jt.indexOf(t)}for(t.isBuildInSlicerStyle=R,t.isBuildInTimelineStyle=F,Rt=function(t,i,n,e){return B(t,i,n,e)},_=1,Ft=f(p.properties);_<Ft;_++)p.prototype[p.properties[_]]=Rt(p.properties[_]);for(_=1,At=f(S.properties);_<At;_++)S.prototype[S.properties[_]]=Rt(S.properties[_]);function Vt(){return new p}function Yt(){return new S}function Gt(t,i){t[it](i)[nt](i)[et](i)[rt](i)}function qt(t,i,n){var e=Ut();return e[U](t)[H](i)[P](n),e}function Kt(t,i){return{degree:90,stops:[{position:0,color:t},{position:1,color:i}]}}function Zt(){return Kt("#F8E162","#FCF7F4")}function $t(){return Kt("#A3BBDF","#CADEF6")}function Qt(){return Kt("#E8EBEE","#F8F8FA")}function Xt(t){var i=lt+t;return Mt("Light",t,n,u,k(1,h,i),k(0,"",""),k(1,h,i),a,i+bt,k(1,h,m),dt,i+gt,k(1,h,g),a,u,k(1,h,g),dt,u,k(1,h,"#E0E0E0"),a,Zt(),k(1,h,m))}function ti(t){var i=lt+t;return Mt("Dark",t,n,u,k(1,h,i),k(0,"",""),k(1,h,i),u,i,k(1,h,i),i+pt,i+bt,k(1,h,i+bt),a,"#C0C0C0",k(1,h,"#C0C0C0"),"#959595","#DFDFDF",k(1,h,"#DFDFDF"),a,Zt(),k(1,h,m))}function ii(t,i){var n,e,n=lt+i,e="Light"===t?Kt(n+bt,n):Kt(n,n+St);return Bt(t,i,k(1,h,n),n+pt,e,n+mt)}function ni(t){return t.color===a&&0===t.style&&t.level===v}function ei(t){var i,n,e,r,s;if(!(0,l.ht)(t))for(i=0,n=Object.keys(t);i<n.length;i++)e=n[i],t.hasOwnProperty(e)&&!(0,l.ht)(t[e])&&-1!==e.indexOf(b.hdt)&&(ni(r=t[e])?t[e]=v:(s=r.style||1,t[e]={borderWidth:xt[s],borderStyle:jt[s],borderColor:r.color}))}function ri(t){var i,n,e,r;if(!(0,l.ht)(t))for(i=0,n=Object.keys(t);i<n.length;i++)e=n[i],t.hasOwnProperty(e)&&!(0,l.ht)(t[e])&&-1!==e.indexOf(b.hdt)&&(r=t[e],t[e]=new o.LineBorder(r.borderColor,Tt[r.borderStyle],v))}function si(){}function oi(){}for(p.prototype.name=Rt(D,""),S.prototype.name=Rt(D,""),Mt=function(t,i,n,e,r,s,o,c,u,a,f,h,l,v,d,m,b,g,p,S,w,_){var y,t,i,t,y=Vt(),t=C+t+i;return y[D](t),(i=Ut()).font(n),i.backColor(e),i.setBorders(r),y.wholeSlicerStyle(i),(t=Ut()).borderLeft(s),t.borderTop(s),t.borderRight(s),t.borderBottom(o),y.headerStyle(t),y[$](qt(c,u,a)),y[Q](qt(f,h,l)),y[X](qt(v,d,m)),y[tt](qt(b,g,p)),Gt(y,qt(S,w,_)),y},Bt=function(t,i,n,e,r,s){var o,t,i,t,n,i,t,e,n,i,t,o=Yt(),t=vt+t+i;return o[D](t),(i=x()).backColor(u),i.setBorders(n),o.wholeSlicerStyle(i),(t=x()).font(wt),o.headerStyle(t),(n=x()).font(_t),n.foreColor(e),o[st](n),(i=x()).foreColor(Dt),i.font(yt),o[ot](i),(t=x()).foreColor(Dt),t.font(yt),o[ct](t),(e=x()).foreColor(Dt),e.font(yt),o[ut](e),(n=x()).backColor(r),o[at](n),(i=x()).backColor(Ct),o[ft](i),(t=x()).backColor(s),o[ht](t),o},j=si,t.SlicerStyles=j,O=oi,t.TimelineStyles=O,I=1;I<=6;I++)j["light"+I]=function(t){return function(){return Xt(t)}}(I),j["dark"+I]=function(t){return function(){return ti(t)}}(I),O["light"+I]=function(t){return function(){return ii("Light",t)}}(I),O["dark"+I]=function(t){return function(){return ii("Dark",t)}}(I);j.other1=function(){return Mt("Other",1,n,u,k(1,h,"#808080"),k(0,"",""),k(1,h,"#A6A6A6"),a,"#BFBFBF",k(1,h,m),a,"#D9D9D9",k(1,h,g),a,u,k(1,h,g),"#959595",u,k(1,h,"#E0E0E0"),a,Zt(),k(1,h,m))},j.other2=function(){return Mt("Other",2,n,u,k(1,h,"#4F81BD"),k(0,"",""),k(1,h,"#4F81BD"),a,$t(),k(1,h,m),dt,$t(),k(1,h,g),a,Qt(),k(1,h,g),dt,Qt(),k(1,h,"#E0E0E0"),a,Zt(),k(1,h,m))},o.GC$.extend(o.StyleManager.prototype,{addSlicerStyle:function(t){var i=this,n,n;(n=(n=i.x1i)||(i.x1i={}))[t.name()]=t},getSlicerStyle:function(t){var i,n,e,r,s,i=this,n=i.x1i;return n=n||(i.x1i={}),R[t.toUpperCase()]?n[e=t.substr(11).toLowerCase()]?n[e]:(r=new p,s=j[e],r.name(s.name()),o.GC$.each(p.properties,function(t,i){r[i](s[i]())}),i.addSlicerStyle(r),r):n[t]},addTimelineStyle:function(t){var i=this,n,n;(n=(n=i.L1i)||(i.L1i={}))[t.name()]=t},getTimelineStyle:function(t){var i,n,e,r,s,i=this,n=i.L1i;return n=n||(i.L1i={}),F[t.toUpperCase()]?n[e=t.substr(13).toLowerCase()]?n[e]:(r=new S,s=n[e],r.name(s.name()),o.GC$.each(S.properties,function(t,i){r[i](s[i]())}),i.addTimelineStyle(r),r):n[t]}})},"./dist/plugins/slicer/slicer-ui/diagram-util.js":function(t,d,i){var n,h,l,v,e;function r(t,i,n,e,r,s,o,c){var s,u,a,f,s=s&&s.backColor()||o&&o.backColor()||"white";if("string"==typeof s)t.fillStyle=c(s);else if("object"==typeof s)if(s=v(s),l(s.stops))l(s.type)||(l(s.backgroundColor)||(s.backgroundColor=c(s.backgroundColor)),l(s.patternColor)||(s.patternColor=c(s.patternColor)),h.W.setFillStylepatternFill(t,s,i,n,e,r,function(){}));else{if((u=s.stops)&&0<u.length)for(a=0;a<u.length;a++)(f=u[a]).color=c(f.color);h.W.setFillStyleGradient(t,s,i,n,e,r,function(){})}}function o(t){return e[t]||e.solid}function s(t,i,n,e,r,s){e&&e.borderColor()&&e.borderWidth()&&e.borderStyle()&&(t.lineWidth=e.borderWidth()||1,t.strokeStyle=r(e.borderColor()),t.setLineDash(o(e.borderStyle())),c(t,i,n,s))}function c(t,i,n,e){var r,s,o,c,u;switch(e=e||0,t.beginPath(),r=[n.x,n.y],s=[n.x,n.y+n.height],o=[n.x+n.width,n.y],c=[n.x+n.width,n.y+n.height],u=Math.PI,i){case 0:t.moveTo(r[0]+e,r[1]),t.lineTo(o[0]-e,o[1]),t.arc(o[0]-e,o[1]+e,e,1.5*u,0);break;case 1:t.moveTo(o[0],o[1]+e),t.lineTo(c[0],c[1]-e),t.arc(c[0]-e,c[1]-e,e,0,.5*u);break;case 2:t.moveTo(c[0]-e,c[1]),t.lineTo(s[0]+e,s[1]),t.arc(s[0]+e,s[1]-e,e,.5*u,u);break;case 3:t.moveTo(s[0],s[1]-e),t.lineTo(r[0],r[1]+e),t.arc(r[0]+e,r[1]+e,e,u,1.5*u);break;default:return}t.stroke()}function u(t,i,n){var e,r,s,o,r=i=l(i)?"":i;if(n<(e=t.measureText(i).width)){for(s="",o=0;o<i.length&&!(t.measureText(s+i[o]+d.ELLIPSIS).width>n);o++)s+=i[o];r=s+d.ELLIPSIS}return r}function a(t,i,n,e,r,s,o){var c=5;t.fillStyle=r,t.fillText(i,5+n,e+s/2,o-5)}function f(t,i){for(var n,e,r,i,s,o,c,u,a,f,h,l,v,n=d.DEFAULT_LEFT,e=d.DEFAULT_TOP,r=i?d.SLICER_WIDTH:d.TIMELINE_WIDTH,i=i?d.SLICER_HEIGHT:d.TIMELINE_HEIGHT,s=t.getRowCount(),o=t.getColumnCount(),c=0,u=0,a=0,f=0,h=0,l=0,v=0;v<s;v++)u+=+t.getRowHeight(v);for(v=0;v<o;v++)c+=+t.getColumnWidth(v);return u<i?l=u:f=u<e+i?u-(l=i):(l=i,e),c<r?h=c:a=c<n+r?c-(h=r):(h=r,n),{left:a,top:f,width:h,height:l}}Object.defineProperty(d,"__esModule",{value:!0}),d.getSlicerSizePosInfo=d.TIMELINE_HEIGHT=d.SLICER_HEIGHT=d.TIMELINE_WIDTH=d.SLICER_WIDTH=d.DEFAULT_TOP=d.DEFAULT_LEFT=d.fillText=d.getEllipsisText=d.paintBorderImp=d.paintBorder=d.appendBackColorStyle=d.ELLIPSIS=d.Border_Names=void 0,n=i("Common"),h=i("Core"),d.Border_Names=["borderTop","borderRight","borderBottom","borderLeft"],d.ELLIPSIS="...",l=n.Common.lt.ht,v=n.Common.lt.tv,d.appendBackColorStyle=r,e={solid:[],dashed:[3,1],dashDot:[8,2,2,2],dotted:[2],dashDotDot:[9,3,3,3,3,3],mediumDashDot:[9,3,3,3],mediumDashDotDot:[9,3,3,3,3,3],mediumDashed:[9,3],hair:[1]},d.paintBorder=s,d.paintBorderImp=c,d.getEllipsisText=u,d.fillText=a,d.DEFAULT_LEFT=50,d.DEFAULT_TOP=250,d.SLICER_WIDTH=186,d.TIMELINE_WIDTH=345,d.SLICER_HEIGHT=258,d.TIMELINE_HEIGHT=145,d.getSlicerSizePosInfo=f},"./dist/plugins/slicer/slicer-ui/item-slicer-view.js":function(t,i,n){var e,r,o,s,a,c,u,f,n,h,u,l,v;function d(){return null!==v&&v.apply(this,arguments)||this}function m(t){t.save(),t.strokeStyle="rgba(0,0,0,0)",t.miterLimit=4,t.font="15px",t.fillStyle="#666666",t.beginPath(),t.moveTo(5.71986,8),t.lineTo(10,3.674096),t.lineTo(9.24114,3),t.lineTo(5.71986,6.55893),t.lineTo(3.758858,4.57697),t.lineTo(3,5.25106),t.lineTo(5.71986,8),t.closePath(),t.moveTo(5.71986,13),t.lineTo(10,8.6741),t.lineTo(9.24114,8),t.lineTo(5.71986,11.55893),t.lineTo(3.758858,9.57697),t.lineTo(3,10.25106),t.lineTo(5.71986,13),t.closePath(),t.moveTo(10,13.6741),t.lineTo(5.71986,18),t.lineTo(3,15.2511),t.lineTo(3.758858,14.577),t.lineTo(5.71986,16.5589),t.lineTo(9.24114,13),t.lineTo(10,13.6741),t.closePath(),t.moveTo(19,6),t.lineTo(11,6),t.lineTo(11,7),t.lineTo(19,7),t.lineTo(19,6),t.closePath(),t.moveTo(11,11),t.lineTo(19,11),t.lineTo(19,12),t.lineTo(11,12),t.lineTo(11,11),t.closePath(),t.moveTo(19,16),t.lineTo(11,16),t.lineTo(11,17),t.lineTo(19,17),t.lineTo(19,16),t.closePath(),t.fill("evenodd"),t.stroke(),t.restore()}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.ItemSlicerView=i.ItemSlicerFormControl=void 0,r=n("Shapes"),o=n("Core"),s=n("./dist/plugins/slicer/slicer-ui/slicer-listbox.js"),a=n("./dist/plugins/slicer/slicer-base/slicer-base.js"),c=n("./dist/plugins/slicer/slicer-ui/slicer-button.js"),u=n("./dist/plugins/slicer/slicer.ns.js"),n=new(f=n("Common")).Common.ResourceManager(u.SR,"Slicer"),h=n.getResource.bind(n),i.ItemSlicerFormControl="itemSlicer",r&&(v=a.SlicerViewBase,e(d,v),d.prototype.init=function(t){v.prototype.init.call(this,t),this.y4={items:[]},this.LEt={},this.initMultiButton(),this.initClearFilterButton(),this.initListBox()},d.prototype.dispose=function(){this.k1i.dispose(),this.UtV.dispose(),this.k1i=null,this.UtV=null,this.RN=null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),v.prototype.dispose.call(this)},d.prototype.initMultiButton=function(){var t,i,t=new c.SlicerButton,i=t.props;i.type="status",i.contentType="callback",i.containerSize={w:23,h:23},i.renderCallBack=m,i.onButtonClick=this.onMultiButtonClick.bind(this),i.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),i.refresh=this.refresh.bind(this),i.setCursor=this.setCursor.bind(this),i.getBackColor=this.getButtonBGStyle.bind(this),i.getThemeColor=this.getThemeColor.bind(this),t.props=i,this.k1i=t},d.prototype.initListBox=function(){this.UtV=new s.ItemSlicerListBox;var t=this.UtV.props;t.selType=s.ItemSlicerSelectionType.single,t.selIndex=[],t.itemHeight=23,t.offset={top:-30,left:-10},this.UtV.props=t,this.UtV.props.onSelIndexChange=this.onSelIndexChange.bind(this),this.UtV.props.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),this.UtV.props.refresh=this.refresh.bind(this),this.UtV.props.getWholeStyle=this.getWholeStyle.bind(this),this.UtV.props.getItemStyle=this.getItemStyle.bind(this),this.UtV.props.getThemeColor=this.getThemeColor.bind(this),this.UtV.props.setCursor=this.setCursor.bind(this),this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},d.prototype.setItems=function(t){this.y4.items=t;var i=this.UtV.props;i.items=t.map(function(t){return t.text}),i.selIndex=this.y4.items.map(function(t,i){if(t.selected)return i}).filter(function(t){return void 0!==t}),this.refresh()},d.prototype.R1i=function(){var t,i,n,e,r,s,e,o,c,u,a,f,h,l,v,t=this,i=t.y4.items,n=[],e=t.LEt,r=e.sortState,s=e.showNoDataItems,e=e.showNoDataItemsInLast,o=t.UtV,c=[];for(o.items.forEach(function(t,i){o.isSelectedItem(i)&&c.push(t)}),u=!1,s?e?(a=[],f=[],i.forEach(function(t){(t.noData?f:a).push(t.text)}),a=t.POn(a,r),f=t.POn(f,r),n=a.concat(f),u=!0):n=i.map(function(t){return t.text}):i.forEach(function(t){t.noData||n.push(t.text)}),u||(n=t.POn(n,r)),h=[],l={},v=0;v<n.length;v++)l[n[v]]=v;return c.forEach(function(t){h.push(l[t])}),o.selIndex.join(" ")!==h.join(" ")&&(o.selIndex=h,o.A1i=void 0),t.u=!1,t._mi=n},d.prototype.POn=function(t,i){var n,e,r,n=h().Blank,e,r=!1;return-1!==t.indexOf(n)&&(r=!0,t=t.filter(function(t){return t!==n})),i===o.SortState.descending&&(t=t.reverse()),r&&t.push(n),t},d.prototype.pWt=function(t,i){var n,e,r,n=this,e=n.u?n.R1i():n._mi,r=n.UtV.props;r.containerSize={w:t,h:i},r.items=e,r.columnCount=~~n.columnCount<1?1:~~n.columnCount,r.itemHeight=~~n.LEt.itemHeight<1?4:~~(n.LEt.itemHeight+3),r.selType=n.LEt.multiSelect?s.ItemSlicerSelectionType.multi:s.ItemSlicerSelectionType.single},d.prototype.gWt=function(t,i){var n,e,r,s,o,c,u,n=this,e=v.prototype.gWt.call(this,t,i);if(e.rect)return e.rect;switch(t){case a.SlicerUIType.scrollBar:r={rect:s=n.UtV.F1i(i)};break;case a.SlicerUIType.item:o=i.index,c=i.displayIndex,u=i.text,(0,a.ht)(o)?(0,a.ht)(c)?(0,a.ht)(u)||(r=n.UtV.M1i(u)):r=n.UtV.B1i(c+n.UtV.scrollRowCount*n.UtV.columnCount):r=n.UtV.B1i(o)}return r&&(r.rect.x+=e.args.left,r.rect.y+=e.args.top),r},d.prototype.render=function(t,i){var i,n,e,r,i,s,i=v.prototype.render.call(this,t,i);if(i)return n=i.left,e=i.top,r=i.w,i=i.h,(s=this).paintListBox(t,n,e,r,i),{left:n,top:e,w:r,h:i}},d.prototype.paintHeader=function(t,i,n,e,r){var r,s,i;v.prototype.paintHeader.call(this,t,i,n,e,r),s=(r=this).k1i,t.save(),i=new o.Rect(i,n,r.width,Math.min(r.height,25)),t.rect(i.x,i.y,i.width,i.height),t.clip(),t.translate(.5*e-45,n+1),s.props.offset={top:-5,left:55-r.width},s.props.selected=!!r.LEt.multiSelect,s.render(t),t.restore()},d.prototype.paintListBox=function(t,i,n,e,r){var s,o,c,s=this;t.save(),o=-e/2,c=-r/2,s.LEt.showHeader?(c+=10,s.UtV.props.offset.top=-30):s.UtV.props.offset.top=-7,t.rect(o,c,e,r),t.clip(),t.beginPath(),t.translate(o,c),s.pWt(e,r),s.UtV.render(t),t.restore()},d.prototype.filterCleared=function(){return this.LEt.filterCleared},d.prototype.q_=function(t){var i,n,e,i,n=this.y4.items;if(this.LEt.sortState===o.SortState.descending){for(e=n.length-1;-1<e;e--)if(n[e].text===t)return n[e]}else for(e=0;e<n.length;e++)if(n[e].text===t)return n[e]},d.prototype.getItemStyle=function(t){var i,n,e,i=this,n=i.q_(t.itemText);return n?(e=t.hover?"hovered":"",t.selected?e+=t.hover?"Selected":"selected":e+=t.hover?"UnSelected":"unSelected",n.noData&&i.LEt.visuallyNoDataItems?e+="ItemWithNoDataStyle":e+="ItemWithDataStyle",i.RN[e]()):null},d.prototype.onMultiButtonClick=function(t){this.UtV.props.selType=t?s.ItemSlicerSelectionType.multi:s.ItemSlicerSelectionType.single,this.triggerEvent("propertyChanged",{propName:"multiSelect",value:!!t})},d.prototype.onClearFilter=function(){this.UtV.onClearFilter()},d.prototype.onSelIndexChange=function(t){this.triggerEvent("valueChanged",t)},d.prototype.onWindowMouseMove=function(t){v.prototype.onWindowMouseMove.call(this,t),this.UtV.onWindowMouseMove(t),this.k1i.onWindowMouseMove(t)},d.prototype.onWindowMouseUp=function(t){this.UtV.onWindowMouseUp(t)},d.prototype.onWindowKeyUp=function(t){this.UtV.onWindowKeyUp(t)},d.prototype.doMouseDown=function(t){return this.UtV.onMouseDown(t)},d.prototype.doMouseMove=function(t){this.UtV.onMouseMove(t),v.prototype.doMouseMove.call(this,t)},d.prototype.doMouseUp=function(t){this.UtV.onMouseUp(t),this.k1i.onMouseUp(t),v.prototype.doMouseUp.call(this,t)},d.prototype.onWindowMouseWheel=function(t){this.UtV.onWindowMouseWheel(t)},Object.defineProperty(d.prototype,"columnCount",{get:function(){return this.LEt.columnCount||1},enumerable:!1,configurable:!0}),r.registerCustomFormControl(i.ItemSlicerFormControl,u=d),i.ItemSlicerView=u)},"./dist/plugins/slicer/slicer-ui/slicer-button.js":function(t,i,n){var e,u,r,s;function o(){var t=this;this.MC=new r.Wh(function(){}),this.tWt={type:"click",enabled:!0,containerSize:{w:30,h:30},offset:{top:0,left:0},content:"",contentType:"text",selected:!1,onButtonClick:function(t){},getBackColor:function(){},getThemeColor:function(t){return""},refresh:function(){},setCursor:function(){},onWindowMouseMove:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}},renderCallBack:function(t,i){}},this.MC.Zh=function(){t.GAt=t.MC.Ot(t.tWt.content)}}Object.defineProperty(i,"__esModule",{value:!0}),i.SlicerButton=void 0,e=n("Shapes"),u=n("./dist/plugins/slicer/slicer-ui/diagram-util.js"),r=n("Core"),e&&(o.prototype.setBackGroundImage=function(){var t,i,t=this.MC,i=this.tWt.content;t.Rt(i)},Object.defineProperty(o.prototype,"props",{get:function(){return this.tWt},set:function(t){"image"===(this.tWt=t).contentType&&this.setBackGroundImage()},enumerable:!1,configurable:!0}),o.prototype.dispose=function(){this.tWt=null,this.GAt=null,this.MC.L0()},o.prototype.render=function(t){var i,n,e,r,s,o,c,e,e,i=this,n=i.tWt;switch(t.save(),r=(e=n.containerSize).w,s=e.h,(e=n.getBackColor())&&(o=e.headerStyle,c=e.wholeStyle),(0,u.appendBackColorStyle)(t,0,0,r,s,o,c,n.getThemeColor),t.fillRect(0,0,r,s),n.enabled&&i.W1i&&n.setCursor("pointer"),(i.W1i||n.selected)&&((e=t.createLinearGradient(0,0,0,s)).addColorStop(0,"rgb(248, 226, 102)"),e.addColorStop(1,"rgb(255, 255, 255)"),t.fillStyle=e),n.contentType){case"image":i.GAt&&t.drawImage(i.GAt,0,0);break;case"text":t.fillRect(0,0,r,s),t.textAlign="center",t.font="16px Calibri",t.fillStyle="black",t.fillText(n.content,r/2,s/2,r);break;case"callback":t.fillRect(0,0,r,s),n.renderCallBack(t,n.enabled),(i.W1i||n.selected)&&i.renderBorder(t,r,s)}t.restore()},o.prototype.renderBorder=function(t,i,n){t.save(),t.strokeStyle="#999999",t.lineWidth=1;var i=new r.Rect(-.5,-.5,i,n);(0,u.paintBorderImp)(t,0,i,3),(0,u.paintBorderImp)(t,1,i,3),(0,u.paintBorderImp)(t,2,i,3),(0,u.paintBorderImp)(t,3,i,3),t.restore()},o.prototype.onMouseUp=function(t){var t=this.getPointerRelativeControl(t);this.hitTest(t.x,t.y)&&("click"===this.tWt.type?this.tWt.onButtonClick():(this.tWt.selected=!this.tWt.selected,this.props.onButtonClick(this.tWt.selected)))},o.prototype.onWindowMouseMove=function(t){var t=this.getPointerRelativeControl(t);this.W1i=this.hitTest(t.x,t.y)},o.prototype.refresh=function(){this.tWt.refresh()},o.prototype.hitTest=function(t,i){var n,e,r,s;return!!this.tWt.enabled&&(n=this.props.containerSize,e=n.w,r=n.h,!!(s=function(){return 0<=t&&t<=e&&0<=i&&i<r})())},o.prototype.getPointerRelativeControl=function(t){var t=this.props.getPointerRelativeControl(t);return t.x+=this.props.offset.left,t.y+=this.props.offset.top,t},i.SlicerButton=o)},"./dist/plugins/slicer/slicer-ui/slicer-listbox.js":function(t,i,n){var d,m,b,e,r,g,s,o,c,u,p,S,a,n;function f(){var n,t,n=this;this.qQt=!1,this.KQt=-1,this.ywt=-1,this.lit=-1,this.XQt=!1,this.$Qt=!1,this.P1i=!1,this.H1i=!1,this.A1i="",this.HtV="",this.tWt={containerSize:{w:300,h:100},selIndex:[],items:[],scrollCount:0,itemHeight:19,columnCount:1,offset:{top:0,left:0},selType:o.single,onSelIndexChange:function(){},onItemClick:function(){},getItemStyle:function(){return null},getWholeStyle:function(){return null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}}},(t=new e.SlicerScrollBar).props.syncSliderHeightWithPageStep=!0,t.refresh=this.refresh.bind(this),t.getPointerRelativeControl=function(t){var t=n.getPointerRelativeControl(t),i=t.x,t=t.y;return{x:i-n.scrollBarLeftOffset,y:t}},t.setCursor=this.setCursor.bind(this),t.props.onScroll=this.onScrollBarChange.bind(this),this.iWt=t}Object.defineProperty(i,"__esModule",{value:!0}),i.ItemSlicerListBox=i.ItemSlicerSelectionType=void 0,d=n("Core"),m=n("Shapes"),b=n("./dist/plugins/slicer/slicer-ui/diagram-util.js"),e=n("./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js"),r=d.mt.Qf,g=d.mt.yt,s=3,(n=o=i.ItemSlicerSelectionType||(i.ItemSlicerSelectionType={})).single="single",n.multi="multi",c=18,u=4,p="black",S="normal 11pt calibri",m&&(Object.defineProperty(f.prototype,"props",{get:function(){return this.tWt},set:function(t){this.tWt=t},enumerable:!1,configurable:!0}),f.prototype.dispose=function(){this.iWt.dispose(),this.A1i=null,this.selIndex=null,this.tWt=null},f.prototype.hitTest=function(t,i){var n,e,r,s,o,c,u,n=this,e=this.height,r,s=function(){return t>=n.scrollBarLeftOffset&&t<=n.width&&0<=i&&i<e};return function(){return 0<=t&&t<=(n.needHiddenScrollBar?n.itemsAreaWidth:n.scrollBarLeftOffset)&&0<=i&&i<e}()?-1!==(u=this.getClickItemIndex(t,i))&&(o="item",c=u):s()&&(o="scrollBar"),{target:o,data:c}},f.prototype.onMouseDown=function(t){var i,n,n,e,n,i=this,n=i.getPointerRelativeControl(t),n=i.hitTest(n.x,n.y),e=n.target,n=n.data;return"item"===e?(t.shiftKey||(i.lit=n),(r()?t.metaKey:t.ctrlKey)&&(i.HtV="ctrl",i.P1i||(i.P1i=!0)),t.shiftKey&&(i.HtV="shift",i.H1i||(i.P1i=!1,i.H1i=!0)),i.ywt=n,i.$Qt=!0,i.qQt=!0,i.changeSelIndex(),!0):"scrollBar"===e?(i.iWt.onMouseDown(t),i.qQt=!0):void 0},f.prototype.onClearFilter=function(){this.A1i=null},f.prototype.onMouseMove=function(t){var i,t,t,n,t,i=this;return i.iWt.onMouseMove(t),t=i.getPointerRelativeControl(t),n=(t=i.hitTest(t.x,t.y)).target,t=t.data,"item"===n?(i.$Qt?i.ywt!==t&&(i.XQt=!0,i.ywt=t,i.changeSelIndex()):i.KQt=t,i.setCursor("default")):i.KQt=-1,i.refresh(),!0},f.prototype.onWindowMouseMove=function(t){var t,i;if(this.scrollRowCount>this.maxScrollCount&&(this.scrollRowCount=this.maxScrollCount,this.refresh()),t=this.getPointerRelativeControl(t),i=this.hitTest(t.x,t.y).target,this.mouseDownItemIndexIsValid){if("item"===i)this.stopScrollInterval();else{if(void 0!==this.vWt)return;t.y<0?this.startScrollInterval(-1):t.y>this.height&&this.startScrollInterval(1)}this.refresh()}void 0===i&&-1!==this.KQt&&(this.KQt=-1,this.refresh())},f.prototype.onMouseUp=function(t){var i,t,n,i=this;return i.iWt.onMouseUp(t),t=i.getPointerRelativeControl(t),"item"!==(n=i.hitTest(t.x,t.y).target)&&(this.KQt=-1,this.refresh()),!!i.qQt&&!(i.qQt=!1)},f.prototype.onWindowMouseUp=function(t){var i,t,t,n,t,i=this;i.iWt.onWindowMouseUp(t),i.mouseDownItemIndexIsValid&&(t=i.getPointerRelativeControl(t),n=(t=i.hitTest(t.x,t.y)).target,t=t.data,"item"===n&&i.XQt&&(i.XQt=!1,i.ywt=t),0===i.selIndex.length&&i.setSelIndexRange(0,i.items.length-1),i.H1i||i.P1i||i.endSelectOperation()),this.clearState()},f.prototype.endSelectOperation=function(){var i,t,n,i=this;i.selIndex.sort(function(t,i){return t-i}),t=i.selIndex.join(" "),i.A1i!==t&&(n=i.selIndex.map(function(t){return i.items[Number(t)]}),i.props.onSelIndexChange(n),i.A1i=t)},f.prototype.onWindowKeyUp=function(t){var i,t,i=this,t=t.keyCode;i.H1i&&16===t?(i.endSelectOperation(),i.P1i=!1,i.H1i=!1):i.P1i&&(r()?91===t:17===t)&&(i.endSelectOperation(),i.P1i=!1)},f.prototype.onWindowMouseWheel=function(t){this.iWt.onWindowMouseWheel(t)},f.prototype.onScrollBarChange=function(){this.scrollRowCount=this.iWt.props.value},f.prototype.changeSelIndex=function(){var t,i,n,e,r,s,t=this,i=t.lit,n=t.ywt,e=t.XQt,r="ctrl"===t.HtV,s="shift"===t.HtV;t.isSingleSelType?r?e&&n===i||t.setCounterSelIndex(n):(t.selIndex=[],t.setSelIndexRange(i,n)):t.isMultiSelType&&(s?t.setSelIndexRange(i,n,!0):t.setCounterSelIndex(n))},f.prototype.clearState=function(){var t=!1;this.qQt&&(t=!(this.qQt=!1)),this.mouseDownItemIndexIsValid&&(this.KQt=-1,this.$Qt=!1,this.HtV="",this.ywt=-1,t=!0),this.stopScrollInterval(),t&&this.refresh()},f.prototype.F1i=function(t){var i,n,e,r,s,o,c,u,i=this;if(i.needHiddenScrollBar)return null;switch(e=(n=i.iWt).scrollBtnLen,r=i.scrollBarLeftOffset,s=i.scrollBarWidth,o=n.height,c=n.scrollSliderOffset,u=n.scrollSliderLen,t.type){case 1:return new d.Rect(r,0,s,o);case 2:return new d.Rect(r,0,s,e);case 3:return new d.Rect(r,o-e,s,e);case 4:return new d.Rect(r,o-e,s,n.scrollTrackViewLen);case 5:return new d.Rect(r,c,s,u);case 6:return new d.Rect(r,e,s,c-e);case 7:return new d.Rect(r,c+u,s,o-u-2*e)}},f.prototype.render=function(t){t.save(),this.renderItems(t),this.renderScrollBar(t),t.restore()},f.prototype.renderItems=function(t){var i,n,e,r,s,o,c,u,i=this.items,n=this.currentPageDisplayRowCount,e=this.columnCount;for(t.textBaseline="middle",r=this.scrollRowCount*this.columnCount,s=0;s<n;s++)for(o=0;o<e;o++,r++){if(r>=i.length)return;c=o,u=i[r],t.beginPath(),this.paintItem(t,u,s,c,r)}},f.prototype.renderScrollBar=function(t){var i,n,e;this.needHiddenScrollBar||(i=this.height,n=this.scrollBarLeftOffset,e=this.scrollBarWidth,t.save(),t.translate(n,0),this.iWt.props.containerSize={w:e,h:i},this.iWt.props.max=this.maxScrollCount,this.iWt.props.value=this.scrollRowCount,this.iWt.props.pageStep=this.onePageCanDisplayRowCount,this.iWt.render(t),t.restore())},Object.defineProperty(f.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"selIndex",{get:function(){return this.props.selIndex},set:function(t){this.props.selIndex=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"selType",{get:function(){return this.props.selType},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"items",{get:function(){return this.props.items},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isSingleSelType",{get:function(){return this.selType===o.single},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isMultiSelType",{get:function(){return this.selType===o.multi},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"itemsAreaWidth",{get:function(){var t=this.width;return this.needHiddenScrollBar||(t-=this.scrollBarWidth),t-.5},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"needHiddenScrollBar",{get:function(){return(this.onePageCanCompletelyDisplayRowCount>=this.rowCount||this.height<=this.itemHeight)&&(this.onePageCanCompletelyDisplayRowCount>=this.rowCount&&(this.scrollRowCount=0),!0)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"scrollBarWidth",{get:function(){return Math.min(18,this.width)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"scrollBarLeftOffset",{get:function(){return this.width-this.scrollBarWidth},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"itemsCount",{get:function(){return this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"columnCount",{get:function(){return this.props.columnCount},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"rowCount",{get:function(){return Math.ceil(this.items.length/this.columnCount)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"itemWidth",{get:function(){return this.itemsAreaWidth/this.columnCount},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"itemHeight",{get:function(){return this.props.itemHeight},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"scrollRowCount",{get:function(){return this.props.scrollCount},set:function(t){this.props.scrollCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.rowCount-this.onePageCanCompletelyDisplayRowCount)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onePageCanDisplayRowCount",{get:function(){return Math.ceil(this.height/(this.itemHeight+4))},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onePageCanCompletelyDisplayRowCount",{get:function(){return Math.floor((this.height+4)/(this.itemHeight+4))},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"currentPageDisplayRowCount",{get:function(){var t,i,t=this.onePageCanDisplayRowCount,i=this.rowCount-this.scrollRowCount;return Math.min(t,i)},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"mouseDownItemIndexIsValid",{get:function(){return-1!==this.ywt},enumerable:!1,configurable:!0}),f.prototype.scroll=function(t){this.scrollTo(this.scrollRowCount+t)},f.prototype.scrollTo=function(t){var i,n,i=0,n=this.maxScrollCount;t=Math.min(t,n),t=Math.max(t,0),this.scrollRowCount=t},f.prototype.setIndexSelected=function(t){-1===this.selIndex.indexOf(t)&&this.selIndex.push(t)},f.prototype.setCounterSelIndex=function(t){var i,n,i=this.selIndex,n=i.indexOf(t);-1!==n?i.splice(n,1):i.push(t)},f.prototype.setSelIndexRange=function(t,i,n){var e,r,s;for(i<t&&(t=(e=[i,t])[0],i=e[1]),r=n?this.selIndex:[],s=t;s<=i;s++)r.push(s);this.selIndex=r},f.prototype.setCounterSelIndexRange=function(t,i){var n,e,r,s;for(i<t&&(t=(n=[i,t])[0],i=n[1]),e=this.selIndex,r=t;r<=i;r++)-1===(s=e.indexOf(r))?e.push(r):e.splice(s,1)},f.prototype.getClickItemIndex=function(t,i){var n,e,i,e,t,n=this.itemWidth,e=this.itemHeight+4,i=Math.floor(i/e)+this.scrollRowCount,e=Math.floor(t/n);return i>=this.rowCount||(t=i*this.columnCount+e)>=this.items.length?-1:t},f.prototype.B1i=function(t){var i,n,e,r,s,i=this,n=~~(t/i.columnCount)-i.scrollRowCount,e=t%i.columnCount,r=i.itemWidth,s=i.itemHeight+4;return{rect:new d.Rect(e*r,n*s,r,i.itemHeight),text:i.items[t],index:t,displayIndex:t-i.scrollRowCount*i.columnCount}},f.prototype.M1i=function(t){var t=this.items.indexOf(t);return-1===t?null:this.B1i(t)},f.prototype.startScrollInterval=function(t){var i,n,e,i=this,n=80,e=function(){i.scroll(t),i.KQt=t<0?i.scrollRowCount+1:i.scrollRowCount+i.currentPageDisplayRowCount,i.refresh(),i.vWt=window.setTimeout(e,80)};this.vWt=window.setTimeout(e,0)},f.prototype.stopScrollInterval=function(){void 0!==this.vWt&&(window.clearTimeout(this.vWt),this.vWt=void 0)},f.prototype.isSelectedItem=function(t){return-1!==this.selIndex.indexOf(t)},f.prototype.paintItem=function(t,i,n,e,r){var s,o,c,u,e,n,a,f,h,r,s,l,v,v,s=this,o=s.itemWidth-4,c=s.itemHeight,u=s.props,e=e*(4+o),n=n*(c+4),a=s.getItemStyle({hover:s.KQt===r,selected:s.isSelectedItem(r),itemText:s.items[r]});if(!(o<=0||c<=0))for(f=s.getWholeStyle(),h=new d.Rect(e,n,o,c),(0,b.appendBackColorStyle)(t,e,n,o,c,a,f,u.getThemeColor),m.drawRoundedRect(new d.Rect(e,n,o,c),3,t),r=a&&a.foreColor()||f&&f.foreColor()||p,s=g(a&&a.font()||f&&f.font()||S),t.fillStyle=u.getThemeColor(r),t.font=s,(0,b.fillText)(t,(0,b.getEllipsisText)(t,i,o),e,n,r,c,o),0===h.x&&(h.x+=.5,h.width-=.1),0===h.y&&(h.y+=.5,h.height-=.1),l=0;l<4;l++)v=b.Border_Names[l],(v=a&&a[v]()||f&&f[v]())&&(0,b.paintBorder)(t,l,h,v,u.getThemeColor,3)},f.prototype.setCursor=function(t){this.props.setCursor(t)},f.prototype.getItemStyle=function(t){return this.props.getItemStyle(t)},f.prototype.getWholeStyle=function(){return this.props.getWholeStyle()},f.prototype.getPointerRelativeControl=function(t){var t=this.props.getPointerRelativeControl(t);return t.x+=this.props.offset.left,t.y+=this.props.offset.top,t},f.prototype.refresh=function(){this.props.refresh()},i.ItemSlicerListBox=f)},"./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js":function(t,i,n){var e,r,s;function o(){this.qQt=!1,this.KtV=!1,this.U1i=!1,this.$tV=0,this.tVV="",this.tWt={containerSize:{w:0,h:0},value:0,min:0,max:100,step:1,pageStep:10,sliderHeight:10,syncSliderHeightWithPageStep:!1,direction:"vertical",showButton:!0,renderTrack:!0,sliderColor:null,onScroll:function(){},finishScroll:function(){},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}}}}e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},Object.defineProperty(i,"__esModule",{value:!0}),i.SlicerScrollBar=void 0,(r=n("Shapes"))&&(Object.defineProperty(o.prototype,"props",{get:function(){return this.tWt},set:function(t){this.tWt=t},enumerable:!1,configurable:!0}),o.prototype.dispose=function(){this.tWt=null},o.prototype.hitTest=function(t,i){var n,e,r,s,o,c,u,a,f,h,l,v,r="horizontal"===this.direction,s=r?t:i;return this.isInBounding(t,i)?(o=r?this.width:this.height,c=this.scrollBtnLen,u=this.scrollSliderOffset,a=this.scrollSliderLen,(f=this.showScrollButton)&&(s<=c||o-c<=s)?s<=c?n="scroll_up_btn":o-c<=s&&(n="scroll_down_btn"):u<=s&&s<=u+a?n="scroll_slider":(n="scroll_track",e=s<u?"up":"down"),{target:n,data:e,offsetWithSlider:h=s-u,offsetWithTrack:v=s-(f?c:0),actualPos:s}):this.KtV?{actualPos:r?t:i}:{target:void 0}},o.prototype.onMouseDown=function(t){var t,t,i,n,t,e,r,t=this.getPointerRelativeControl(t),t=this.hitTest(t.x,t.y),i=t.target,n=t.data,t=t.actualPos,e=this.step,r=this.pageStep;return"scroll_up_btn"===i?(this.scroll(-e),this.startScrollInterval(-e),this.tVV="scroll_up_btn"):"scroll_down_btn"===i?(this.scroll(e),this.startScrollInterval(e),this.tVV="scroll_down_btn"):"scroll_slider"===i?(this.KtV=!0,this.$tV=t):"scroll_track"===i&&(this.U1i=!0,this.scroll("up"===n?-r:r)),this.qQt=!0,this.refresh(),!0},o.prototype.onMouseMove=function(t){var t,t,i,t,i,n,e,r,t=this.getPointerRelativeControl(t),t=this.hitTest(t.x,t.y),i=t.target,t=t.actualPos;return(i||this.KtV)&&this.setCursor("default"),this.KtV&&(i=this.scrollTrackLen/this.max,n=0,e=t>this.$tV,(r=t<this.$tV)?n=Math.ceil((t-this.$tV)/i):e&&(n=Math.floor((t-this.$tV)/i)),n&&(this.scroll(n),this.$tV=r?Math.max(0,t):Math.min(this.isHorizontalDirection?this.width:this.height,t)),this.refresh()),!0},o.prototype.onMouseUp=function(t){return!!this.qQt&&!(this.qQt=!1)},o.prototype.onWindowMouseWheel=function(t){},o.prototype.onWindowMouseUp=function(t){var i=!1;this.qQt&&(i=!(this.qQt=!1)),this.KtV&&(this.KtV=!1,i=!(this.$tV=0)),this.tVV&&(i=!(this.tVV="")),this.U1i&&(i=!(this.U1i=!1)),this.stopScrollInterval(),i&&(this.refresh(),this.tWt.finishScroll())},o.prototype.render=function(s){var t,i,n,o,c,u,e,a,r,f,h,l,v,t=this,i=this.width,n=this.height,o=this.isHorizontalDirection,c=this.scrollUpBtnRect,u=this.scrollDownBtnRect,e=this.scrollSliderRect,a=this.scrollArrowLen,r=this.tVV,f=this.showScrollButton,h=function(t,i,n,e){n&&(s.beginPath(),s.rect(t.x,t.y,t.w,t.h),e&&(s.lineWidth=e),s.strokeStyle=n,s.stroke()),i&&(s.beginPath(),s.rect(t.x,t.y,t.w,t.h),s.fillStyle=i,s.fill())},l=function(t,i){var n,e,r,t,n=i?c:u,e=t?"rgb(96, 96, 96)":"rgb(240, 240, 240)",r=t?"white":"rgb(96, 96, 96)",t=function(){s.save(),s.translate(n.x,n.y),s.translate((n.w-2*a)/2,(n.h-a)/2),s.beginPath();var t=0,t;(t=i?o?-90:0:o?90:180)&&(s.translate(a,a/2),s.rotate(t/180*Math.PI),s.translate(-a,-a/2)),s.moveTo(0,a),s.lineTo(a,0),s.lineTo(2*a,a),s.strokeStyle=r,s.lineWidth=2,s.stroke(),s.restore()};s.beginPath(),h(n,e),t()},v=function(){s.beginPath(),h(e,t.tWt.sliderColor||"rgb(205,205,205)","rgb(135, 135, 135)")};s.save(),s.beginPath(),this.tWt.renderTrack&&h({x:0,y:0,w:i,h:n},"rgb(240, 240, 240)"),f&&l("scroll_up_btn"===r,!0),v(),f&&l("scroll_down_btn"===r,!1),s.restore()},Object.defineProperty(o.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this.isHorizontalDirection?this.width:this.height},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"showScrollButton",{get:function(){return this.tWt.showButton},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollBtnLen",{get:function(){var t=this.isHorizontalDirection?this.height:this.width;return Math.min(this.length/2,t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollSliderLen",{get:function(){var t,i,t=this.props.sliderHeight;return this.syncSliderHeightWithPageStep&&(i=this.pageStep/(this.max-this.min+this.pageStep),t=Math.max(t,this.scrollTrackViewLen*i)),Math.min(t,this.scrollTrackViewLen)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollSliderOffset",{get:function(){return(this.showScrollButton?this.scrollBtnLen:0)+this.scrollSliderOffsetWithTrack},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollSliderOffsetWithTrack",{get:function(){var t=0;return this.max!==this.min&&(t=(this.value-this.min)/(this.max-this.min)),this.scrollTrackLen*t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollTrackLen",{get:function(){return this.scrollTrackViewLen-this.scrollSliderLen},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollTrackViewLen",{get:function(){return Math.max(this.length-2*(this.showScrollButton?this.scrollBtnLen:0),0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){return this.tWt.value},set:function(t){this.tWt.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"min",{get:function(){return this.tWt.min},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"max",{get:function(){return this.tWt.max},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"step",{get:function(){return this.tWt.step},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"pageStep",{get:function(){return this.tWt.pageStep},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"syncSliderHeightWithPageStep",{get:function(){return this.tWt.syncSliderHeightWithPageStep},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"direction",{get:function(){return this.tWt.direction},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isHorizontalDirection",{get:function(){return"horizontal"===this.direction},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollArrowLen",{get:function(){var t,i,t,t=this.scrollBtnSize.w,i=this.scrollBtnSize.h,t=Math.min(.25*t,.5*i);return Math.min(t,5)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollBtnSize",{get:function(){return this.isHorizontalDirection?{w:this.scrollBtnLen,h:this.height}:{w:this.width,h:this.scrollBtnLen}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollUpBtnRect",{get:function(){var t=this.scrollBtnSize;return e({x:0,y:0},t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollDownBtnRect",{get:function(){var t,i,t=this.scrollBtnSize,i=this.length-this.scrollBtnLen;return this.isHorizontalDirection?e({x:i,y:0},t):e({x:0,y:i},t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"scrollSliderRect",{get:function(){var t=this.scrollSliderOffset;return this.isHorizontalDirection?{x:t,y:0,w:this.scrollSliderLen,h:this.height-1}:{x:0,y:t,w:this.width-1,h:this.scrollSliderLen}},enumerable:!1,configurable:!0}),o.prototype.scroll=function(t){this.scrollTo(this.value+t)},o.prototype.scrollTo=function(t){var i,n,i=this.min,n=this.max;t=Math.min(t,n),t=Math.max(t,i),this.value!==t&&(this.value=t,this.props.onScroll())},o.prototype.isInBounding=function(t,i){var n,e,n=this.width,e=this.height;return 0<=t&&t<=n&&0<=i&&i<=e},o.prototype.startScrollInterval=function(t){var i,n,e,r,i=this,n=80,e,r=function(){i.scroll(t),i.refresh(),i.vWt=window.setTimeout(r,80)};this.vWt=window.setTimeout(r,260)},o.prototype.stopScrollInterval=function(){void 0!==this.vWt&&(window.clearTimeout(this.vWt),this.vWt=void 0)},o.prototype.setCursor=function(t){this.props.setCursor(t)},o.prototype.getPointerRelativeControl=function(t){return this.props.getPointerRelativeControl(t)},o.prototype.refresh=function(){this.props.refresh()},i.SlicerScrollBar=o)},"./dist/plugins/slicer/slicer.entry.js":function(t,i,n){var e,r,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),r(n("./dist/plugins/slicer/slicer.ns.js"),i),n("./dist/plugins/slicer/slicer-actions.js"),r(n("./dist/plugins/slicer/slicer.js"),i),r(n("./dist/plugins/slicer/table-slicer.js"),i),r(n("./dist/plugins/slicer/slicer-style.js"),i),r(n("./dist/plugins/slicer/slicer-base/slicer-cache-base.js"),i),r(n("./dist/plugins/slicer/slicer-base/slicer-base.js"),i),r(n("./dist/plugins/slicer/table-item-slicer/table-slicer-cache.js"),i),r(n("./dist/plugins/slicer/table-item-slicer/table-item-slicer.js"),i),r(n("./dist/plugins/slicer/slicer-ui/diagram-util.js"),i),r(n("./dist/plugins/slicer/slicer-ui/slicer-button.js"),i),r(n("./dist/plugins/slicer/slicer-ui/slicer-listbox.js"),i),r(n("./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js"),i),r(n("./dist/plugins/slicer/slicer-ui/item-slicer-view.js"),i)},"./dist/plugins/slicer/slicer.js":function(t,l,i){var v,n,i,i,r,a,i,u,i,f,h,e,d,s,o,c,m,b,g,n,i;function p(t){var i=t;return u(t)||0===t?i=s.table:1===t&&(i=s.pivotTable),i}function S(t){var i=this;i.Mf=t,i.J1i=[],i.z1i={}}function w(t){var t,i,n,e,r,s,o,c,u,t=t.Mf,i=[],n=t&&t.parent&&t.parent.sheets,e=t&&t.shapes;if(n)for(r=0;r<f(n);r++){for(o in s=n[r].slicers.V1i())a(s,o)&&i.push(o);if(e)for(u in c=n[r].shapes.tin)a(c,u)&&-1===i.indexOf(u)&&i.push(u)}return i}function _(t,i,n){var e;return i?-1!==w(t).indexOf(i)&&(e=r().Exp_SlicerNameExist):e=r().Exp_SlicerNameInvalid,e&&n&&(n.error=new Error(e)),!e}function y(t){var i,n,i,n,i;if(!t)return!1;if(n=(i=this).LSt,t===i.name())return!1;if(n&&(n=(i=n.tCt())&&i.slicers)&&!_(n,t,i={}))throw i.error;return!0}function D(t,i){for(var n,e,r,s,o,c,u,a,n,r=0,s=t.sheets;r<s.length;r++)for(c=0,u=e=(o=s[r]).slicers.all();c<u.length;c++)if((a=u[c]).name().toLowerCase()===i.toLowerCase())return!0;return!1}function C(t){for(var i,n,e,r,i,n=0,e=t.tables.all();n<e.length;n++)(r=e[n]).Gwt=h}function j(t){var i,n,e,r;if(t.pivotTables)for(n=0,e=i=t.pivotTables.all();n<e.length;n++)(r=e[n]).Eqt=h}function O(t,i){var n,e;return"Object"===i.constructor.name?(n=i.name||i._ps.name,(e=t.slicers.get(n))||(e=t.slicers.add(n,i.tableName,i.columnName)).fromJSON(i),e):i}Object.defineProperty(l,"__esModule",{value:!0}),l.o1i=l.checkSlicerName=l.SlicerCollection=l.TimelineLevel=l.SlicerType=l.UNDO_UPDATE_TABLE_SLICER=l.UNDOFILTER=l.UNDOREMOVE=l.UNDOADD=void 0,v=i("Core"),n=i("Common"),i=i("./dist/plugins/slicer/slicer.ns.js"),i=new n.Common.ResourceManager(i.SR,"Slicer"),r=i.getResource.bind(i),a=n.Common.kh,i=n.Common.lt,u=i.ht,i=n.Common.Uf,f=i.tR,h=null,e=void 0,l.UNDOADD="undoAdd",l.UNDOREMOVE="undoRemove",l.UNDOFILTER="undoFilter",l.UNDO_UPDATE_TABLE_SLICER="undoUpdateTableSlicer",d=v.UsedRangeUtil.vh,(n=s=l.SlicerType||(l.SlicerType={})).table="table",n.pivotTable="pivot",n.pivotTimeline="timeline",(i=o=l.TimelineLevel||(l.TimelineLevel={}))[i.years=1]="years",i[i.quarters=2]="quarters",i[i.months=3]="months",i[i.days=4]="days",S.prototype.getUsedRange=function(){var t,i,n,e,r,s,o,c,u,a,t,i=this.all(),n={};if(i)for(o=s=r=e=void 0,c=0,u=i;c<u.length;c++)e=(a=u[c]).startRow(),r=a.startColumn(),s=a.endRow(),o=a.endColumn(),d(n,{minRow:e,minCol:r,maxRow:s,maxCol:o});return n},S.prototype.L0=function(){var t=this;t.z1i&&(v.GC$.each(t.z1i,function(t,i){i.L0()}),t.z1i=h),t.J1i=[],t.Mf=h},S.prototype.add=function(t,i,n,e,r){var s,o,c,c,t,u,s=this,o=s.Mf,c={};if(!_(s,t,c))throw c.error;if(o.suspendPaint(),r=p(r),v.Worksheet.et(o,"slicerAdding",c={slicer:h,slicerName:t,targetName:i,itemName:n,sheet:o,type:r}),t=c.slicer)return e&&t.style(e),s.WB(t),v.Worksheet.et(o,"slicerAdded",u={slicer:t}),o.resumePaint(),t;o.resumePaint()},S.prototype.WB=function(t){var i=this,n=i.Mf;t&&(i.z1i[t.name()]=t,n.Ut.n1i(i,l.UNDOADD,t.name(),t))},S.prototype.get=function(t){return t===h||t===e?h:this.z1i[t]},S.prototype.remove=function(t){var i;this.DK(t)},S.prototype.DK=function(t,i){var n,e,r,s,o,n=this,e=n.Mf,r=n.z1i,s=n.get(t);s&&a(r,t)&&(v.Worksheet.et(e,"slicerRemoved",o={slicer:s,ignoreModel:i}),delete n.z1i[t])},S.prototype.Ydt=function(t,i){var n,e,r,r,s,n=this,e=n.Mf,r={};if(!_(n,i,r))throw r.error;(r=n.z1i[t])&&(delete n.z1i[t],n.z1i[i]=r,v.Worksheet.et(e,"slicerRenamed",s={oldName:t,newName:i,slicer:r}))},S.prototype.clear=function(){var n=this,t=n.Mf;t.suspendPaint(),v.GC$.each(this.z1i,function(t,i){n.remove(i.name())}),t.resumePaint()},S.prototype.all=function(t,i){var t={targetName:t,itemName:i,slicers:[]};return v.Worksheet.et(this.Mf,"getAllSlicers",t),t.slicers},S.prototype.V1i=function(){return this.z1i},S.prototype.G1i=function(t){var i,n,e,r,i=w(this);if(-1===i.indexOf(t))return t;for(n=1,r=t.split(e=" ")[0];-1!==i.indexOf(r+e+n);)n++;return r+e+n},S.prototype.t1i=function(){var t,i,n,e,r,t,i=this.z1i;if(!i||v.GC$.isEmptyObject(i))return[];for(e in n=[],i)a(i,e)&&(r=i[e])&&r.isSelected()&&n.push(r);return n},S.prototype.Y1i=function(t){var i,n,e,r,i,n=this.t1i();if(1===f(n)&&0<f(e=n)){for(r=0;r<f(e);r++)e[r].Mg&&e[r].Mg(t);return!0}return!1},S.prototype.toJSON=function(t){var i,n,e,r,i,n=[],e=this.z1i;if(e&&!v.GC$.isEmptyObject(e))for(r in e)a(e,r)&&n.push(e[r].toJSON(t));return n},S.prototype.fromJSON=function(t){var i,n,e,r;if(t&&0!==f(t))for(n=(i=this).Mf,i.z1i={},e=0;e<f(t);e++)(r=t[e]).type=p(r.type),v.Worksheet.et(n,"slicerFromJson",{slicerJSON:r,sheetName:n.name()})},c=S,l.SlicerCollection=c,l.checkSlicerName=y,l.o1i=D,v.Worksheet.ch("slicer",m={priority:900,init:function(){var t=this;t.slicers=new c(t)},dispose:function(t){!1!==t.clearCache&&(this.slicers&&(this.slicers.L0(),this.slicers=h),this.unbind("tableRemoved"))},getUsedRange:function(t){var i,n,e;t.type&v.UsedRangeType.slicer&&(e=(n=(i=this).slicers).getUsedRange(),d(t.range,e))},toJson:function(t,i){var n,i,n,n=i&&i.ignoreStyle,i=i&&i.newWorkSheetName;n||0<(n=this.slicers.toJSON(i)).length&&(t.slicers=n),C(this),j(this)},fromJson:function(t,i,n,e,r){var s,n,o,r,c,s;n&&n.ignoreStyle||(o=(n=this).parent,u(o))||r||(r=t&&t.slicers)&&0<r.length&&(D(o,c=r[0].name)||n.slicers.fromJSON(r))},preProcessMouseWheel:function(t){var i=this.slicers;i&&i.Y1i(t.e)&&(t.r=!0)}}),b=function(t){var i="unfilterSlicerByKey",n="filterSlicer",e="unfilterSlicer",r="changeSlicerProperty",s="deleteSlicers";t.register(i,v.Commands[i],67,!1,!1,!0,!1),t.register(n,v.Commands[n]),t.register(e,v.Commands[e]),t.register(r,v.Commands[r]),t.register(s,v.Commands[s])},v.Workbook.ch("slicer",g={init:function(){b(this.commandManager()),this.nameInFormulas={}},fromJson:function(t,i,n){var n,e,r,s,o,c,c,n=n&&n.ignoreStyle;if(!n)for(r=0,s=(e=this).getSheetCount();r<s;r++)o=e.getSheet(r),(c=(c=t.sheets&&t.sheets[o.name()])&&c.slicers)&&o.slicers.fromJSON(c)},onCommandExecuting:function(t){var i;t.slicers.all().forEach(function(t){t.isSelected(!1)})},dispose:function(){this.nameInFormulas=h}}),v.GC$.extend(v.Workbook.prototype,{q1i:function(t,i){var n="".concat(r().SlicerNameInFormula,"_").concat(t);return this.nameInFormulas[n]&&this.nameInFormulas[n]!==i?this.q1i(t+"1",i):(this.nameInFormulas[n]=i,n)},K1i:function(t,i){return this.nameInFormulas[t]&&this.nameInFormulas[t]!==i}}),v.GC$.extend(v.Y8.prototype,{n1i:function(t,i,n,e){var r,s,r=this.G8;r&&(s=(s=r.slicerChanges)||(r.slicerChanges=[])).push({slicerItem:t,name:i,value:n,newValue:e})},Z1i:function(t,i){var n,e,r,s,o,c,u,c,u,a,f,h;if(t)for(n=t.length-1;0<=n;n--)if(r=(e=t[n]).slicerItem,s=e.name,o=e.value,s===l.UNDOFILTER)c=o.columnName,u=o.oldValue,r.doFilter(c,{exclusiveRowIndexes:u});else if(s===l.UNDOADD)r.DK(o);else if(s===l.UNDOREMOVE){if(!o)return;o.iht?(r.WB(o),(c=o.LSt.$1i)&&0<=(u=c.indexOf(o))&&c.splice(u,1)):(a=this.Mf,f=o.slicerJSON,h=o.cacheJSON,f.type=p(f.type),v.Worksheet.et(a,"slicerFromJson",{slicerJSON:f,cacheJSON:h,sheetName:a.name()}))}else if(s===l.UNDO_UPDATE_TABLE_SLICER){if(!o)return;this.Mf.Q1i(o.row,o.col,o.rowCount,o.colCount,o.sheetArea)}else r[s](o);else for(n=t.length-1;0<=n;n--)e=t[n],this.X1i(e)},X1i:function(t,i){var n,e,t,r,s,o,r,s,i,r,s,s,c,n=t.slicerItem,e=t.name,t=i?t.newValue:t.value;e===l.UNDOFILTER&&n?(r=t.columnName,s=t.oldValue,("Object"===n.constructor.name?o=this.Mf.tables.findByName(n.nM.name).getSlicerData():n).doFilter(r,{exclusiveRowIndexes:s})):e===l.UNDOADD?(n=O(this.Mf,t),i||this.Mf.slicers.DK(n)):e===l.UNDOREMOVE?t&&(t.iht?(n=O(this.Mf,t),i?this.Mf.slicers.DK(n.name()):(r=t.LSt.$1i)&&0<=(s=r.indexOf(t))&&r.splice(s,1)):(i=this.Mf,r=t.slicerJSON,s=t.cacheJSON,s={slicer:h,slicerName:r.name,sheet:i,type:r.type,cacheJSON:s},v.Worksheet.et(i,"slicerAdding",s),(c=s.slicer)&&(r.type=p(r.type),v.Worksheet.et(i,"slicerFromJson",{data:r,sheetName:i.name()})))):e===l.UNDO_UPDATE_TABLE_SLICER?t&&this.Mf.Q1i(t.row,t.col,t.rowCount,t.colCount,t.sheetArea):(n=n&&"Object"===n.constructor.name?this.Mf.slicers.get(n.name||n._ps&&n._ps.name):n)&&n[e](t)}}),v.Y8.ch("SLICER_PROPERTYCHANGE",{priority:5500,applyChanges:function(t){var i,t,i,i=t.changes,t=t.isUndo,i=i&&i.slicerChanges;i&&this.Z1i(i,!t)},undo:function(t){var t=t.slicerChanges;t&&this.Z1i(t)}})},"./dist/plugins/slicer/slicer.ns.js":function(t,i,n){Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/slicer/slicer.res.en.js");i.SR={en:n}},"./dist/plugins/slicer/slicer.res.en.js":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.SlicerNameInFormula=i.Exp_SlicerNameExist=i.Exp_SlicerNameInvalid=i.Blank=void 0,i.Blank="(blank)",i.Exp_SlicerNameInvalid="The slicer name is not valid.",i.Exp_SlicerNameExist="The slicer name is already in use; please enter a unique name.",i.SlicerNameInFormula="Slicer"},"./dist/plugins/slicer/table-item-slicer/table-item-slicer-view-model.js":function(t,i,n){var e,r,s,u,a,o,c,f;function h(t,i,n){return f.call(this,t,i,n)||this}e=this&&this.__extends||(c=function(t,i){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}c(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.TableItemSlicerViewModel=void 0,r=n("Shapes"),s=n("./dist/plugins/slicer/slicer-base/slicer-base.js"),u=n("./dist/plugins/slicer/slicer-ui/diagram-util.js"),a=n("./dist/plugins/slicer/slicer-ui/item-slicer-view.js"),r&&(f=s.SlicerViewModelBase,e(h,f),h.prototype.WQt=function(){var e,t,i,n,r,s,o,c,r,i,e=this,t=this,i=t.Mf;i.shapes&&(n=t.updateOptionsCallback(),s=(r=(0,u.getSlicerSizePosInfo)(i,!0)).left,o=r.top,c=r.width,r=r.height,(i=i.shapes.addFormControl(n.name,a.ItemSlicerFormControl,s,o,c,r)).allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!1),i.drawingType="Slicer",t.zQt=i.GtV,t.RQt=i,t.refreshFormControl(),t.zQt.addEventListener("valueChanged",function(t,i){var n=e.updateValuesCallback();n.forEach(function(t){return t.selected=-1!==i.indexOf(t.text)}),e.ki("valueChanged",n)}),t.zQt.addEventListener("clearFilter",function(t,i){e.ki("clearFilter",{})}),t.zQt.addEventListener("propertyChanged",function(t,i){e.ki("propertyChanged",i)}))},h.prototype.refreshFormControl=function(){var t,i;f.prototype.refreshFormControl.call(this),(i=(t=this).zQt).setItems(t.updateValuesCallback())},i.TableItemSlicerViewModel=h)},"./dist/plugins/slicer/table-item-slicer/table-item-slicer.js":function(t,i,n){var e,c,s,d,v,r,o,f,u,a,h,l,m;function b(t,i,n){var t,e,t=m.call(this,t,i,n)||this;return t.ma=d.SlicerType.table,t.RN=r.SlicerStyles.light1(),t}function g(t,i){return t.odi.getSlicer(i)}function p(t){return t&&t.ma===d.SlicerType.table}function S(t){return t.FQt._getTable()}function w(t,i){for(var n,e,r,s,o,n=t.sheets,e=0;e<n.length;e++)if(r=n[e].slicers&&n[e].slicers.all())for(s=0;s<r.length;s++)if(p(o=r[s])&&o.GQt.RQt===i)return{sheetIndex:e,slicer:o};return null}function _(t,i,n,e){var r,i,s,o,r=t.rels;c.util.xr(t,c.XFileConstants.vu)||(i=i.parent,D(t,s=n?y(i,r,t):s,o=e?y(i,r,t):o,n,e))}function y(t,i,n){var e,e,t,e=c.Util.wr(i),e=c.XFileConstants.Rr+e;return t.Cp.slicer+=1,t=c.XFileConstants.vu+t.Cp.slicer,i.c_.push({n_:c.XFileConstants.Lr,Id:e,Type:c.RelationshipConstants.yc,Target:"../slicers/"+t+"."+c.XFileConstants.Cr}),n.c_||(n.c_=[]),n.c_.push({n_:c.XFileConstants.vu,"r:id":e}),e}function D(t,i,n,e,r){var s,t,s=c.util.xr(t,c.XFileConstants.Au);(0,v.ht)(s)&&(s={n_:c.XFileConstants.Au,c_:[]},t.c_.push(s)),t=s.c_,e&&t.push({n_:"ext",r_:[48,44],c_:[{n_:"slicerList",r_:[1],c_:[{n_:"slicer","r:id":i}]}]}),r&&t.push({n_:"ext",r_:[61,55],c_:[{n_:"slicerList",c_:[{n_:"slicer","r:id":n}]}]})}function C(t,i){var n,e,e,i,n=t.rels;c.util.xr(t,c.XFileConstants.gu)||(e=c.Util.wr(n),e=c.XFileConstants.Rr+e,i.parent.Cp.timeline+=1,i=c.XFileConstants.gu+i.parent.Cp.timeline,n.c_.push({n_:c.XFileConstants.Lr,Id:e,Type:c.RelationshipConstants.Nc,Target:"../timelines/"+i+"."+c.XFileConstants.Cr}),t.c_||(t.c_=[]),t.c_.push({n_:c.XFileConstants.vu,"r:id":e}),j(t,e))}function j(t,i){var n,e,n=c.util.xr(t,c.XFileConstants.Au);(0,v.ht)(n)&&(n={n_:c.XFileConstants.Au,c_:[]},t.c_.push(n)),(e=n.c_).push({n_:"ext",r_:[62,44],c_:[{n_:"timelineRefs",c_:[{n_:"timelineRef","r:id":i}]}]})}e=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.Slicer=i.TableItemSlicer=void 0,c=n("Core"),s=n("Shapes"),d=n("./dist/plugins/slicer/slicer.js"),v=n("./dist/plugins/slicer/slicer-base/slicer-base.js"),r=n("./dist/plugins/slicer/slicer-style.js"),o=n("./dist/plugins/slicer/table-item-slicer/table-item-slicer-view-model.js"),f=c.Util.jr,u=c.util.vo,a=c.Util.gr,s&&(m=v.SlicerBase,e(b,m),b.prototype.getItems=function(){return this.FQt.items},b.prototype.getOptionsSet=function(){var t=this;return{nameInFormula:t.nameInFormula(),sourceName:t.sourceName(),name:t.name(),captionName:t.captionName(),showNoDataItems:t.showNoDataItems(),showNoDataItemsInLast:t.showNoDataItemsInLast(),visuallyNoDataItems:t.visuallyNoDataItems(),showHeader:t.showHeader(),sortState:t.sortState(),columnCount:t.columnCount(),multiSelect:t.multiSelect(),itemHeight:t.itemHeight(),filterCleared:t.filterCleared(),isLocked:t.isLocked()}},b.prototype.columnName=function(){return this.sourceName()},b.prototype.sortState=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.sortState();t!==(n=i.FQt.sortState())&&(i.FQt.sortState(t),v.afterPropertyChanged.call(i,"sortState",n))},b.prototype.showNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItems();(t=!!t)!==(n=i.FQt.showNoDataItems())&&(i.FQt.showNoDataItems(t),v.afterPropertyChanged.call(i,"showNoDataItems",n))},b.prototype.showNoDataItemsInLast=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItemsInLast();(t=!!t)!==(n=i.FQt.showNoDataItemsInLast())&&(i.FQt.showNoDataItemsInLast(t),v.afterPropertyChanged.call(i,"showNoDataItemsInLast",n))},b.prototype.visuallyNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.visuallyNoDataItems();(t=!!t)!==(n=i.FQt.visuallyNoDataItems())&&(i.FQt.visuallyNoDataItems(t),v.afterPropertyChanged.call(i,"visuallyNoDataItems",n))},b.prototype.QQt=function(){var t;this.FQt.buildItems()},b.prototype.i1i=function(){return this.FQt.LSt},b.prototype.setFilterWithItems=function(t){var i;this.FQt.setFilter(t)},b.prototype.initSlicerUI=function(){var n=this;n.GQt=new o.TableItemSlicerViewModel(n.Mf,n.getOptionsSet.bind(n),n.getItems.bind(n)),n.GQt.setStyle(n.RN),n.GQt.bind("valueChanged",function(t){n.setFilterWithItems(t)}),n.GQt.bind("clearFilter",function(){n.clearFilter()}),n.GQt.bind("propertyChanged",function(t){var i=t.propName,t=t.value;n[i]&&n[i](t)})},b.prototype.fromJSON=function(i){var n;i&&(m.prototype.fromJSON.call(this,i),n=this,v.ItemSlicerProperties.forEach(function(t){var t=t[0];void 0!==i[t]&&n[t](i[t])}))},b.prototype.yh=function(t,i,n,e){var i;t&&(m.prototype.yh.call(this,t,i,n,e),i=this,void 0!==t.rowHeight&&i.itemHeight(c.ExcelHelper.emuToPixles(+t.rowHeight)-4),t.lossless&&void 0!==t.lossless.multiSelect&&i.multiSelect(t.lossless.multiSelect),void 0!==t.columnCount)&&i.columnCount(+t.columnCount)},b.prototype.toJSON=function(t){var i,n,i=this,n=m.prototype.toJSON.call(this,t);return v.ItemSlicerProperties.forEach(function(t){var t=t[0];n[t]=i[t]()}),n},b.prototype.wh=function(t,i,n){var e,r,t,e=this,r={name:(0,v.encodeSlicerName)(e.name()),cache:u(e.FQt.name),caption:u(e.captionName()),columnCount:e.columnCount(),style:u(e.RN.name()),rowHeight:c.ExcelHelper.pixelToEMU(e.itemHeight()+4),lossless:{multiSelect:e.multiSelect()}};e.showHeader()||(r.showCaption=s.SJS_False),e.disableResizingAndMoving()&&(r.lockedPosition=s.SJS_True),t.push(r),t={twoCellAnchor:(0,v.getSlicerDrawing)(e)},i.push(t)},h=b,v.ItemSlicerProperties.forEach(function(t){h.prototype[t[0]]=(0,v.defSlicerProperty)(t[0],t[1],t[2],t[3])}),c.Worksheet.ch("ItemSlicer",{slicerAdding:function(t){var i,n,e,r,s,o,c,u,c,i,i=this;t.type===d.SlicerType.table&&(n=i.parent&&i.parent.odi)&&(e=t.slicerName,r=t.targetName,s=t.itemName,o=t.sheet,(i=(u=(c=t.slicerCacheName)?n.get(c):(c=i.parent.r5t(r),n.add(c,s,d.SlicerType.table))).add(o,e)).init(),t.slicer=i)},slicerRemoved:function(t){var i,t,n,i,i=this.parent,t=t.slicer.name(),n=g(i,t);if(n){if(n.isSelected(!1),i=i.odi.removeSlicer(t),n.GQt){if(n.GQt.UQt)return;n.GQt.UQt=!0}this.Ut.n1i(self,"undoRemove",i)}},slicerRenamed:function(t){var i=t.newName,t=t.slicer;p(t)&&t.name(i)},getAllSlicers:function(t){var i,n,e,r,i,n=t.slicers,e=t.targetName,r=t.itemName;c.GC$.each(this.slicers.z1i,function(t,i){!p(i)||e&&(S(i).name()!==e||r&&i.sourceName()!==r)||n.push(i)})},slicerFromJson:function(t){var i,n,e,r,s,t,o,c,t,u,o,n,i=t.slicerJSON,n=t.cacheJSON;if(i.type!==d.SlicerType.pivotTable&&i.type!==d.SlicerType.pivotTimeline&&this.parent&&(e=i.tableName,r=i.sourceName,s=i.slicerCacheName,t=t.sheetName,o=this.parent)&&(c=o.getSheetFromName(t))){if(t=o.odi,(0,v.ht)(e)){if(!s)return;i.newTableName?u=t._Qt(i.newTableName,i.sourceName):n?(u=t._Qt(n.tableName,n.sourceName)).fromJSON(n):u=t.get(s)}else{if(!(o=this.parent.r5t(e)))return;if(-1===o.getSlicerData().columnNames.indexOf(r))return;u=t.add(o,r),v.ItemSlicerCacheProperties.forEach(function(t){(0,v.ht)(i[t])||(u["_"+t]=i[t])})}u&&((n=(n=u.get(i.name))||u.add(c,i.name)).init(),n.fromJSON(i),this.slicers.WB(n))}},wh:function(t,i,n){var e,r,s,o,c,u,a,e=this,r=e.slicers.all();if(!(r.length<=0||n&&!1===n.includeStyles)){for(c=o=s=!1,u=0;u<r.length&&((a=r[u]).ma===d.SlicerType.pivotTimeline?c=!0:a.ma===d.SlicerType.table?s=!0:o=!0,!(c&&o&&s));u++);f(t,e.parent.Cp),(s||o)&&_(t,e,s,o),c&&C(t,e)}}}),c.GC$.extend(c.Worksheet.prototype,{pmi:function(){var t;this.tables.all().map(function(t){t.LSt&&t.LSt.gue()})},Smi:function(){var t;this.tables.all().map(function(t){t.LSt&&t.LSt.pue()})},Q1i:function(t,i,n,e,r){var s,o,c,u,a,f,h,l,v;if(void 0===r&&(r=3),o=(s=this).tables){for(c=0;c<n;c++)for(u=0;u<e;u++)h=o.find(a=c+t,f=u+i),3===r&&h&&h.N5t()&&(l=h.dataRange()).contains(a,f)&&(v=h.getSlicerData())&&v.onDataChanged([{columnName:h.getColumnName(f-l.col),row:a-l.row,data:{value:s.getValue(a,f),text:s.getText(a,f)}}]);s.Ut.n1i(null,d.UNDO_UPDATE_TABLE_SLICER,{row:t,col:i,rowCount:n,colCount:e,sheetArea:r})}}}),s.ShapeBase.ch("TableSlicer",{fireEvents:function(t){for(var i,n,e,r,s,o,c,u,i=t.sheet,n=t.sheetName,e=t.propertyName,r=t.shape,s=i.slicers.all(),o=0;o<s.length;o++)if(p(c=s[o])&&(u=c.GQt)&&u.RQt===r&&u.RQt[e]){t.stopThisFire=!0,c.ki({sheet:i,sheetName:n,slicer:c,propertyName:e});break}},ShapeCopingOrCutting:function(t){var i,n,e,i,i,n,i=t.sheet,n=t.shape,e,i=w(i&&i.parent,n);i&&(n={slicerJSON:(i=i.slicer).toJSON(),slicerName:i.name(),sourceName:i.sourceName(),slicerCacheName:i.FQt.name,shapeName:n.name(),cacheJSON:null},t.isCutting&&(n.cacheJSON=i.FQt.toJSON()),t.drawingData=n)},FormControlShapePasting:function(t){var i,n,e,r,s,o,c,u,a,f,h,s,o,u,l,r,c,i=t.sheet,n=t.fromSheetName,e=t.toSheetName,r=t.name,s=t.drawingData,o=t.isCutting,c=i.parent,u=c.getSheetFromName(n);s&&u&&u.slicers&&(a=s.slicerJSON,f=s.slicerName,h=s.slicerCacheName,s=s.cacheJSON,a.type===d.SlicerType.table)&&(o||(f=u.slicers.G1i(r)),!(u=(o=c.odi).get(h))&&s&&(u=o._Qt(s.tableName,s.sourceName)).fromJSON(s),l=u.add(i,f),i.slicers.WB(l),v.SlicerBaseProperties.forEach(function(t){var t=t[0];"name"!==t&&void 0!==a[t]&&l[t](a[t])}),p(l)&&v.ItemSlicerProperties.forEach(function(t){var t=t[0];void 0!==a[t]&&l[t](a[t])}),l.style().fromJSON(a.style),l.init(),r=l.GQt.RQt,n!==e&&(r.Mf=i,c=r.name(),i.eeV(c)||r.name(c&&i.eeV(c)||i.eeV("FormControl ",!0))),t.shape=r)},ShapeRemoving:function(t){var i,n,e,r,e,i,n,i,e,i=t.sheet,n=t.shape,e=t.isGroup,r=t.ignoreModel;e||(i=w(e=i.parent,n))&&(n=i.slicer,i=i.sheetIndex,e=e.sheets[i],n.GQt.UQt=!0,e.slicers.DK(n.name(),r),t.cancelEvent=!0)}}),i.TableItemSlicer=h),i.Slicer=i.TableItemSlicer},"./dist/plugins/slicer/table-item-slicer/table-slicer-cache.js":function(A,t,i){var n,m,S,e,d,l,r,s,w,v,b,o,g,p,_,y,c,a,i,D,u,f,h,C;function j(t){return t.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function O(t){return(0,d.ht)(t)||""===t}function I(t){return O(t)?D().Blank:t+""}function N(t,i,n,e){var i=C.call(this,i,e)||this;return i.slicerCacheType=l.SlicerCacheType.tableSlicer,i.fQt=S.SortState.ascending,i.hQt=!0,i.vQt=!0,i.dQt=!0,i.Ti=t,i.tableName=n,i.Hc(n),i}function E(t){this.vpt=t,this.cQt=[]}function M(t,i){var n;return t.odi.getSlicerCachesByTableName(i)}function B(t,i){var n=null;return t.BSt.forEach(function(t){t.name()===i&&(n=t.id())}),n}function W(t,i){var n,e;return!i||0===Object.keys(i).length||(S.GC$.each(i,function(t,i){var n;if(Array.isArray(i)?0<(n=i.filter(function(t){return!(0,d.ht)(t.tableSlicerCache)})).length&&(n=n[0].tableSlicerCache):n=i.tableSlicerCache,n)return e=n.tableId,!1}),(0,d.ht)(e))?null:(S.GC$.each(t,function(t,i){if(i.id===e)return n=i.name,!1}),n)}function P(t,i,n){var e,r,i,e,s,o,e=i.slicers,r=i.slicerCaches,i=i.tables;if(e&&0!==e.length&&(e=t&&H(t[n],e)))return z(t,n,o=J(i,s=U(r,e)))}function H(t,n){var e=[];return t&&0<t.length&&S.GC$.each(t,function(t,i){var i,i;i.Type===S.RelationshipConstants.yc&&(i=S.Util.vr(i.Target),i=n[i])&&S.GC$.each(i.c_,function(t,i){-1===e.indexOf(i.cache)&&e.push(i.cache)})}),e}function U(t,e){var r=[];return S.GC$.each(t,function(t,i){var i,n,i,i=i.slicerCacheDefinition,n=i.name,i=S.NodeHelper.lr(i,"extLst.ext.tableSlicerCache.tableId");i!==b&&-1===r.indexOf(i)&&-1!==e.indexOf(n)&&r.push(i)}),r}function J(t,n){var e=[];return S.GC$.each(t,function(t,i){-1===e.indexOf(t)&&-1!==n.indexOf(i.id)&&e.push(t)}),e}function z(t,r,s){var o=[];return S.GC$.each(t,function(t,i){var n,e;if(t!==r&&i&&0!==i.length)for(n=0;n<i.length;n++)if((e=i[n]).Type===S.RelationshipConstants.lc&&-1!==s.indexOf(S.Util.vr(e.Target)))return void o.push(t)}),o}function T(t,i,n){var e,r,s,o,c,u,a,f,h,h,e=t.slicerCaches,r=0;for(e?r=Object.keys(e).length:e=t.slicerCaches={},s=[],o=t.workbook.rels,c=0,u=i;c<u.length;c++)(a=u[c]).slicerCacheType!==l.SlicerCacheType.pivotTimeline&&(f=r+=1,h=g(o),o.c_.push({n_:"Relationship",Id:h="rId"+h,Type:S.RelationshipConstants.wc,Target:p("slicerCaches/slicerCache"+f)}),e[S.XFileConstants.mu+f]={slicerCacheDefinition:a.wh()},s.push(h));n(t,s)}function x(t,i,n){var e,r,s,o,c,e=S.util.xr(t.workbook,"definedNames");for((0,d.ht)(e)&&t.workbook.c_.push(e={n_:"definedNames",c_:[]}),r=e.c_,s=0,o=i;s<o.length;s++)(c=o[s]).slicerCacheType===n&&r.push({n_:"definedName",name:c.name,c_:["#N/A"]})}function V(t,i){var n,e,r,s,o,t,i,n,n=S.util.xr(t.workbook,S.XFileConstants.Au);for((0,d.ht)(n)&&(n={n_:S.XFileConstants.Au,c_:[]},t.workbook.c_.push(n)),e=[],r=0,s=i;r<s.length;r++)o=s[r],e.push({n_:"x14:slicerCache","r:id":o});(t=n.c_).push({n_:"ext",r_:[45,44],c_:[{n_:"x15:slicerCaches",r_:[1],c_:e}]}),t.push({n_:"ext",r_:[46,47],c_:[{n_:"xcalcf:calcFeatures",c_:[{n_:i="xcalcf:feature",name:(n="microsoft.com:")+"RD"},{n_:i,name:n+"Single"},{n_:i,name:n+"FV"},{n_:i,name:n+"CNMTM"},{n_:i,name:n+"LET_WF"}]}]})}function Y(t,i,n){var i,e,r,s,o,c,u,a,f,h,l,v,d,i=i.styles,e=i.extLst,r=e&&e.slicerStyleNodes||[],s=new S.SimpleSharedStrings,o=new S.SimpleSharedStrings,c=new S.SharedDxfs(s,o);for(e&&e.dxfsRecords&&(c.rv(e.dxfsRecords),s.yh(e.slicerSharedColors),o.yh(e.slicerCommonSharedStrings)),u=0,a=t;u<a.length;u++)for(l=0,v=h=(f=a[u]).slicers.all().filter(function(t){return t.ma===n});l<v.length;l++)(d=v[l]).style().wh(!1,!0,b,{dxfsRecords:c,slicerStyleNodes:r});e=e||(i.extLst={}),S.GC$.extend(e,{dxfsRecords:c.iv(),slicerSharedColors:s.wh(),slicerCommonSharedStrings:o.wh(),slicerStyleNodes:r})}function L(t,i,n,e,r,s){for(var o,c,u,a,f,h,l,v,d,m,b,g,o=t.slicers,c=Object.keys(o).length,u=0,a=n;u<a.length;u++)if(0<(h=(f=a[u]).slicers.all().filter(function(t){return t.ma===r})).length)for(l=o[S.XFileConstants.vu+(c+=1)]={slicers:{r_:[42,14,30,43],slicer:[]}},t.drawings||(t.drawings={}),v=0,d=h;v<d.length;v++)m=d[v],g=(b=y(t,_(t,f.name()))).c_,m.wh(l.slicers.slicer,g,e),m.style().wh(!0,!1,e);x(t,i,s),Y(n,t,r)}function k(t,i,n,e,r,s,o){var e,s,e=(0,d.tSi)(e,s);e&&(i[o=o||(o=(s=S.Util.so(n,r))&&S.Util.co(s,t.workbook))&&a(o)]||(i[o]=[]),i[o]=i[o].concat(e))}function G(t,i,n,e,r,s,o){var c,t,c,u,c=a(e.cache),t=t.get(c);t&&(c=(0,d.decodeSlicerName)(e.name),(u=(u=t.get(c))||t.add(i,c)).init(),u.yh(e,n,s,o,r),i.slicers.WB(u))}function R(n,e,t,r,i){var s,o,o,s={};if(i){if(!(o=(o=n.rels.c_.find(function(t){return t.Type===S.RelationshipConstants.Fr}))&&o.Target.slice(S.XFileConstants.za.length,-1*".xml".length)))return;k(n,s,e,t[o],o,r,i.name())}else S.GC$.each(t,function(t,i){k(n,s,e,i,t,r)});return s}function F(t,i,n,e,r,s,o,c,u){var i,a,f,h,l,v,i=i&&i[e];if(i)for(a=t.mQt().getSheetFromName(e),f={},S.GC$.each(n,function(t,i){var n,n,i,e,r,s,i=i.c_||(u?null==(n=i.timelines)?void 0:n.timeline:null==(n=i.slicers)?void 0:n.slicer);if(i)for(e=0,r=i;e<r.length;e++)s=r[e],f[(0,d.decodeSlicerName)(s.name)]=s}),h=0,l=i;h<l.length;h++)v=l[h],G(t,a,r,f[(0,d.decodeSlicerName)(v)],s,o,c)}n=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.loadSheetSlicers=t.appendNameMapWithMode=t.cdi=t.adi=t.fdi=t.TableSlicerCacheManager=t.TableItemSlicerCache=void 0,m=i("Common"),S=i("Core"),e=i("Tables"),d=i("./dist/plugins/slicer/slicer-base/slicer-base.js"),l=i("./dist/plugins/slicer/slicer-base/slicer-cache-base.js"),r=i("./dist/plugins/slicer/slicer.ns.js"),s=i("./dist/plugins/slicer/table-item-slicer/table-item-slicer.js"),w=i("./dist/plugins/slicer/slicer-style.js"),v=null,b=void 0,o="TableSlicer_",g=S.Util.wr,p=S.Util.Mr,_=S.Util.ho,y=S.Util.Er,c=S.util.vo,a=S.util.n1,i=new m.Common.ResourceManager(r.SR,"Slicer"),D=i.getResource.bind(i),C=l.SlicerCacheBase,n(N,C),N.prototype.Hc=function(t){var t=this.Ti.mQt().r5t(t);t&&(this.LSt=t.getSlicerData(),this.attachSlicerData(),this.items=this.initItems())},N.prototype.mQt=function(){return this.Ti.mQt()},N.prototype.attachSlicerData=function(){var t=this,i;t.LSt.attachListener(t)},N.prototype.detachSlicerData=function(){var t=this,i=t.LSt;i&&i.detachListener(t)},N.prototype.filterCleared=function(){for(var t,i,t=this,i=0;i<t.items.length;i++)if(!1===t.items[i].selected)return!1;return!0},N.prototype._getTable=function(){var t=this;return t.LSt||t.Hc(t.tableName),t.LSt.getTable()},N.prototype.add=function(t,i){var n,e,i,n=this,e;if(n._getTable())return i=new s.TableItemSlicer(i,t,n),n.IQt.push(i),i},N.prototype.sortState=function(t){var i=this;if(0===arguments.length)return i.fQt;(0,d.ht)(t)||t===i.fQt||(i.fQt=t,i.refreshSlicers())},N.prototype.showNoDataItems=function(t){var i=this;if(0===arguments.length)return i.hQt;(t=!!t)!==i.hQt&&(i.hQt=t,i.refreshSlicers())},N.prototype.showNoDataItemsInLast=function(t){var i=this;if(0===arguments.length)return i.vQt;(t=!!t)!==i.vQt&&(i.vQt=t,i.refreshSlicers())},N.prototype.visuallyNoDataItems=function(t){var i=this;if(0===arguments.length)return i.dQt;(t=!!t)!==i.dQt&&(i.dQt=t,i.refreshSlicers())},N.prototype.initItems=function(){for(var t,i,n,e,r,s,o,c,t=this,i=t.LSt,n=t.sourceName,e=i.getExclusiveData(n),r=i.getFilteredOutIndexes(n,1),s=i.getFilteredOutIndexes(n,2),o=[],c=0;c<e.length;c++)o.push({text:I(e[c]),selected:-1===r.indexOf(c),noData:-1!==s.indexOf(c)});return t.Ydi(o,t.fQt)},N.prototype.Ydi=function(t,i){var n,e,r,s,o,c,u,a,f,h,l,l,v,d,n=this,e=n.LSt,r=e.getColumnIndex(n.sourceName),s,o=e.getTable().dataRange(),c=[],u=D().Blank;if(0!==i){for(a=[],f=e.tCt(),h=0;h<t.length;h++)l=e.getRowIndexes(n.sourceName,h),O(l=f.getValue(o.row+l[0],o.col+r))&&(l=u),a.push(l);for(v=m.Slicers.xzt.quickSort(a),d=0;d<v.length;d++)c[d]=t[v[d].index]}else c=t;return c},N.prototype.buildItems=function(){return this.initItems()},N.prototype.clearSelfFilter=function(){},N.prototype.clearFilter=function(t,i){var n,i,i,e,e,n=this;!n.canUpdate()||!i&&n.filterCleared()||(n.clearSelfFilter(),n.beforeSetFilter(),t=t||n.mQt().getActiveSheet(),i=n.LSt.getFilteredIndexes(n.sourceName),t.Qy().execute({cmd:"unfilterSlicer",sheetName:t.name(),slicerData:n.LSt,columnName:n.sourceName,value:i}),(e=(i=n.LSt).getTable())&&(e={sheet:t,sheetName:t.name(),table:e,tableCol:i.getColumnIndex(n.sourceName)},t.ki(S.Events.TableFilterCleared,e)),n.afterSetFilter())},N.prototype.setFilter=function(t){var i,n,e,r,s,o,c,u,a,f,h,l,l,i=this,n=i.LSt;if(i.canUpdate()&&(t||!i.filterCleared())&&(t=t||i.items)&&0!==t.length){for(e=D().Blank,r=[],s=t.filter(function(t){return t.selected}),o=n.getExclusiveData(i.sourceName),c=0;c<o.length;c++)for(u=o[c],a=0;a<s.length;a++)if((f=s[a].text===e?"":s[a].text)===u){r.push(c);break}r.length===t.length?i.clearFilter(v,!0):(i.beforeSetFilter(),(h=i.mQt().getActiveSheet()).Qy().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:n,columnName:i.sourceName,oldValue:n.getFilteredIndexes(i.sourceName),newValue:r}),(l=n.getTable())&&(l={sheet:h,sheetName:h.name(),table:l,tableCol:n.getColumnIndex(i.sourceName),filterValues:t.map(function(t){return{text:t,value:t,type:"string"}})},h.ki(S.Events.TableFiltered,l)),i.afterSetFilter())}},N.prototype.onFiltered=function(){this.updateCache()},N.prototype.onSlicerDataChanged=function(){this.Ti.ldi||this.Ti.vdi||this.updateCache()},N.prototype.onDataChanged=function(){this.onSlicerDataChanged()},N.prototype.onRowsChanged=function(){this.onSlicerDataChanged()},N.prototype.onColumnNameChanged=function(i,n){this.sourceName===i&&(this.sourceName=n,this.IQt.forEach(function(t){t.captionName()===i&&t.captionName(n)}))},N.prototype.onColumnRemoved=function(t){var i,n,e,r;if(t===this.sourceName)for(n=(i=this.IQt).length-1;-1<n;n--)(r=(e=i[n]).sheet()).slicers.remove(e.name())},N.prototype.ddi=function(t){var i,n,e,r;if(void 0===t&&(t=!1),n=(i=this).mdi){if(!(r=(e=i.mQt()).r5t(n)))return!1;t=!0,i.Hc(n)}return i.mdi=v,t&&i.updateCache(),!0},N.prototype.updateItems=function(){this.items=this.buildItems()},N.prototype.updateCache=function(){this.canUpdate()&&(this.updateItems(),this.refreshSlicers())},N.prototype.toJSON=function(){var t,i,t,i,t=this,i=t._getTable(),t={name:t.name,sourceName:t.sourceName,tableName:t._getTable().name(),columnName:t.sourceName,sortOrder:t.fQt===S.SortState.descending?S.SortState.descending:S.SortState.ascending,showNoDataItems:t.hQt,showNoDataItemsInLast:t.vQt,visuallyNoDataItems:t.dQt},i=(0,d.ht)(i.Gwt)?i.tableName():i.Gwt;return i&&(t.tableName=i),t},N.prototype.wh=function(){var t,i,i,t=this,i=t._getTable(),i={r_:[42,14,30,43],name:c(t.name),sourceName:c(t.sourceName),extLst:{ext:[{r_:[31,44],tableSlicerCache:{tableId:i._id+"",column:B(i,t.sourceName)+""}}]}};return t.fQt===S.SortState.descending&&(i.extLst.ext[0].tableSlicerCache.sortOrder="descending"),!1===t.dQt?i.extLst.ext[0].tableSlicerCache.crossFilter="none":!1===t.vQt&&(i.extLst.ext[0].tableSlicerCache.crossFilter="showItemsWithNoData"),!1===t.hQt&&i.extLst.ext.push({r_:[33,32],slicerCacheHideItemsWithNoData:{}}),i},N.prototype.fromJSON=function(t){var i,n,e,i=this;C.prototype.fromJSON.call(this,t),i.detachSlicerData(),i.sourceName=t.columnName,n=t.tableName,(e=this.Ti.mQt().r5t(n))?i.Hc(n):i.mdi=n,(0,d.ht)(t.sortOrder)||(i.fQt=t.sortOrder),(0,d.ht)(t.showNoDataItems)||(i.hQt=t.showNoDataItems),(0,d.ht)(t.showNoDataItemsInLast)||(i.vQt=t.showNoDataItemsInLast),(0,d.ht)(t.visuallyNoDataItems)||(i.dQt=t.visuallyNoDataItems)},N.prototype.preFromSJSFormat=function(t,i){var n,i,e,i,r,t,i,n=this;n.disposeAllSlicers(),n.IQt=[],n.name=(0,d.decodeSlicerName)(t.name),n.detachSlicerData(),n.sourceName=(0,d.decodeSlicerName)(t.sourceName),i=(0,d.decodeSlicerName)(i),(e=this.Ti.mQt().r5t(i))?n.Hc(i):n.mdi=i,i=t.extLst.ext,t=Array.isArray(i)?(r=i.filter(function(t){return t.tableSlicerCache})[0].tableSlicerCache,0<i.filter(function(t){return t.slicerCacheHideItemsWithNoData}).length):(r=i.tableSlicerCache,!1),(0,d.ht)(r.sortOrder)||(n.fQt="descending"===r.sortOrder?S.SortState.descending:S.SortState.ascending),t&&(n.hQt=!1),"none"===(i=r.crossFilter)?n.dQt=!1:"showItemsWithNoData"===i&&(n.vQt=!1)},N.prototype.yh=function(t){},N.prototype.dispose=function(){var t=this;C.prototype.dispose.call(this),t.detachSlicerData(),t.LSt=v,t.Ti=v,t.items=v},u=N,t.TableItemSlicerCache=u,E.prototype.bdi=function(t){var i,n,e,r,s,i=this,n=i.vpt;if(i.get(t)||n.getCustomName(t))return!1;for(e=n.sheets,r=0;r<e.length;r++)if((s=e[r]).getCustomName(t))return!1;return!0},E.prototype.OQt=function(t,i){var n,e,r,n=this,e=t+j(i);if(n.bdi(e))return e;for(r=1;!n.bdi(e+r);)r+=1;return e+r},E.prototype.mQt=function(){return this.vpt},E.prototype.getSlicerCachesByTableName=function(t){for(var i,n,e,r,i=this,n=[],e=0;e<i.cQt.length;e++)(r=i.cQt[e])._getTable().name()===t&&n.push(r);return n},E.prototype.getExistedSlicerCache=function(t,i){for(var n,e,r,n=this,e=0;e<n.cQt.length;e++)if((r=n.cQt[e]).sourceName===i&&r._getTable().name()===t)return r},E.prototype.get=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t)return e;return b},E.prototype.add=function(t,i){var n=this;return n.getExistedSlicerCache(t.name(),i)||n._Qt(t.name(),i)},E.prototype._Qt=function(t,i){var n,t,n=this,t=new u(n,n.OQt(o,i),t,i);return n.cQt.push(t),t},E.prototype.remove=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t){e.dispose(),i.cQt.splice(n,1);break}},E.prototype.getSlicer=function(t){for(var i,n,e,r,i=this,n=0;n<i.cQt.length;n++)if(r=(e=i.cQt[n]).get(t))return r},E.prototype.getAllSlicers=function(i){var t,n,t,n=[];return this.cQt.forEach(function(t){t.IQt.forEach(function(t){(i!==v&&i!==b||t.sheet().name()===i)&&n.push(t)})}),n},E.prototype.removeSlicer=function(t){for(var i,n,e,r,s,i=this,e=0;e<i.cQt.length;e++)if(s=(r=i.cQt[e]).get(t)){(n={}).slicerJSON=s.toJSON(),r.remove(t),0===r.IQt.length&&(n.cacheJSON=r.toJSON(),i.remove(r.name));break}return n},E.prototype.onWorksheetDisposing=function(t){for(var i,n,e,r,i=this,n=i.cQt,e=n.length-1;-1<e;e--)(r=n[e]).onWorkSheetDisposing(t),0===r.IQt.length&&i.remove(r.name)},E.prototype.updateSlicerCaches=function(t){for(var i,n,e,r,i,n=this.cQt,e=0;e<n.length;e++)r=n[e],t&&r._getTable()!==t||r.updateCache()},E.prototype.updateSlicerCacheAfterLazyLoad=function(t){for(var i,n,e,r,s,o,s,c,u,a,u,i=this,n=i.cQt,e=[],r=0;r<n.length;r++)if(o=(s=n[r])._getTable(),s=s.LSt,o&&s&&-1===e.indexOf(o.name())){if(c=o.Mf.name(),!(u=i.vpt.v2).sheetsState[c]&&!u.refSheetsState[c])return void(a=(t=t||i.vpt.getActiveSheet()).Uw()).addReferenceSheetName(c);s.refresh(),e.push(o.name()),(u=o.IB)&&(s.suspendFilteredEvents(),u.reFilter(),s.resumeFilteredEvents())}},E.prototype.gdi=function(i){var n,e;void 0===i&&(i=!1),e=[],(n=this).cQt.forEach(function(t){t.ddi(i)||e.push(t.name)}),e.forEach(function(t){n.remove(t)})},E.prototype.toJSON=function(){var t,i,t,i=[];return this.cQt.forEach(function(t){i.push(t.toJSON())}),i},E.prototype.fromJSON=function(t){var n=this;0<t.length&&(n.cQt.forEach(function(t){t.dispose()}),n.cQt=[],t.forEach(function(t){var i;n._Qt(t.tableName,t.sourceName).fromJSON(t)}))},E.prototype.preFromSJSFormat=function(t,i,n){var r,e,s,o,e,n,c,u,a,f,h,l,v,d,t,m,b,g,p,r=this;if(r.cQt.forEach(function(t){t.dispose()}),r.cQt=[],e=t.slicerCaches,s=i.tables,S.GC$.each(e,function(t,i){var i,n,e,i=i.slicerCacheDefinition;i.pivotTables||(n=W(s,i.extLst),(e=r._Qt(n,i.sourceName)).preFromSJSFormat(i,n))}),!(o=n&&!1===n.includeStyles)&&(n=(e=t.styles).extLst,c=S.NodeHelper.cr(e.tableStyles&&e.tableStyles.c_),n)&&(u=n.dxfsRecords,a=n.slicerStylesNode,f=n.slicerStyleNodes,h=n.slicerSharedColors,l=n.slicerCommonSharedStrings,a||f))for(t=d=v=void 0,a?(v=!0,d=S.NodeHelper.cr(a.slicerStyle),t=a.kSt&&a.kSt.defaultSlicerStyle||"SlicerStyleLight1"):(v=!1,d=f,t="SlicerStyleLight1",h=new S.SimpleSharedStrings(h,!0),l=new S.SimpleSharedStrings(l)),m=i.styleManager,(b=new S.SharedDxfs(h,l)).rv(u),m.addDefaultStyleName("defaultSlicerStyle",t),g=function(t){var t,i,t,n,e,r,t=d[t];if(!t)return"continue";i=v?t.kSt&&t.kSt.name:t.name,t=v?S.NodeHelper.lr(t,"slicerStyleElements.slicerStyleElement"):t.styleElements,n=void 0,c&&(n=(e=c.filter(function(t){return t.name===i})[0])&&S.NodeHelper.lr(e,"c_")),(r=new w.SlicerStyle).yh(i,m,b,t,n)},p=0;p<d.length;p++)g(p)},E.prototype.yh=function(t,i,n,e){var r,s,o,c,u,a,f,h,l,v,r=this,s=!!e,o=n&&n.sheets,c=t.slicers,u=t.drawings,a=t.styleManager,f=R(n,o,u,d.SLICER_DRAWING_PATH,e);if(s)F(r,f,c,e.name(),u,t,a,i);else for(h=0,l=Object.keys(f);h<l.length;h++)F(r,f,c,v=l[h],u,t,a,i)},E.prototype.dispose=function(){this.cQt.forEach(function(t){t.dispose()}),this.cQt=v,this.vpt=v},f=E,t.TableSlicerCacheManager=f,S.Workbook.ch("TableSlicerCaches",{init:function(){var t;this.odi=new f(this)},dispose:function(){var t=this;t.odi&&(t.odi.dispose(),t.odi=b)},preFromJson:function(t,i,n){var e=this;e.odi&&e.odi.dispose(),e.odi=new f(e),t.tableSlicerCaches&&0!==t.tableSlicerCaches.length&&(e.odi.ldi=!0,e.odi.fromJSON(t.tableSlicerCaches))},fromJson:function(t,i,n){var e=this;t.tableSlicerCaches&&0!==t.tableSlicerCaches.length&&(e.odi.gdi(!1),e.odi.updateSlicerCaches())},preFromSJSFormat:function(t,i,n){var e=this;e.odi.dispose(),e.odi=new f(e),t.slicerCaches&&0!==Object.keys(t.slicerCaches).length&&(e.odi.vdi=!0,e.odi.preFromSJSFormat(t,i,n))},yh:function(t,i,n){var e,r,s,o,c,r,s,e=this;t.slicerCaches&&0!==Object.keys(t.slicerCaches).length&&(S.Util.wo(n,e.v2)?(s=(r=e.getActiveSheet()).name(),o=r.Uw(),r=P(c=i.sheetRelsMap,i,s),S.GC$.each(r,function(t,i){o.addReferenceSheetName(i)})):((s=e.odi).gdi(!1),s.yh(i,n,t),s.updateSlicerCaches()))},toJson:function(t,i){var n,e,n,e=this.odi.toJSON();e&&0<e.length&&(t.tableSlicerCaches=e)},wh:function(t,i,n){var e,i,r,s,n,e=this,i=i.styleManager,r=e.odi;r&&!(s=n&&!1===n.includeStyles)&&(n=r.cQt)&&0!==n.length&&(T(t,n,V),t.slicers||(t.slicers={}),L(t,n,e.sheets,i,"table",l.SlicerCacheType.tableSlicer))}}),S.Worksheet.ch("TableSlicerCaches",{priority:1800,dispose:function(t){!1!==t.clearCache&&this.parent&&this.parent.odi.onWorksheetDisposing(this.name())},yh:function(t,i,n){var e,e,e=this.parent;n&&S.Util.wo(n,e.v2)&&((e=e.odi).gdi(!1),e.yh(i,n,t,this),0<this.tables.all().length||0<this.slicers.all().length)&&this.parent.odi.updateSlicerCacheAfterLazyLoad(this)},fromJsonAfterSJSFormula:function(t,i,n){var e,r,e=this.parent;e&&!S.Util.wo(n,e.v2)&&(r=e.getSheetCount()-1)===e.getSheetIndex(this.name())&&(e.odi.vdi=!1,e.odi.updateSlicerCaches())},fromJsonAfterFormula:function(t){var i,n,i=this.parent;i&&(n=i.getSheetCount()-1)===i.getSheetIndex(this.name())&&(i.odi.ldi=!1,i.odi.updateSlicerCaches())},afterRefSheetLazyLoaded:function(t){(0<this.tables.all().length||0<this.slicers.all().length)&&(this.parent.odi.vdi=!1,this.parent.odi.updateSlicerCacheAfterLazyLoad())}}),e.Table.ch("TableSlicer",{tableNameChanged:function(t){var i,n,t,e,i=t.oldName,n=t.newName,t=this.Mf;t&&(e=M(t.parent,i)).forEach(function(t){t.tableName=n})}}),t.fdi=T,t.adi=x,t.cdi=L,t.appendNameMapWithMode=R,t.loadSheetSlicers=F},"./dist/plugins/slicer/table-slicer.js":function(A,M,t){var B,_,d,W,P,H,U,J,z,t,V,Y,U,c,p,f,G,j,q,K,Z,$,O,y,a,Q,e,r,X,tt,it,nt,et,rt,D,st,l,h,ot,ct,ut,at,v,m,ft,ht,lt,vt,dt,mt,b,g,S,w,bt,C,gt,pt,St,wt,_t,yt,Dt,Ct,jt,Ot,It,I,Nt,Et,Tt,xt,Lt,kt,Rt,Ft,At,Mt,Bt,Wt,Pt,Ht,Ut,Jt,zt,Vt,Yt,Gt,qt,N,E,Kt,Zt,T,x,$t,Qt,Xt,ti,ii,ni,ei,ri,si,oi,ci,ui,ai,fi,hi,i,li,vi,di,mi,bi,gi,t,pi,U,H,Si,wi,_i,yi,Di,Ci,ji,Oi,Ii,Ni,Ei,Ti,xi,Li,ki,Ri,Fi,Ai,Mi,Bi,Wi,Pi,Hi,Ui;function Ji(t,i){var n,e,r,s,o,c,u,a,f,h,n=t.yZt,e=t._caption,r=Yi(t.slicerData),s=t.zoomFactor();if(i)for(f in i[C]&&(Ki(t.Wc,i[C],r,e,s),wn(t,D.I1i)),o=t.pdi,c=zi(i[C],i[gt]),Zi(i)?(a=(u=c[w])&&u[vt]||0,o[l][m]=(t.Sdi-a)*k(i)*s+I,qi(o,u,r,w),c[b]=c[g]=c[S]=c[w]=y):(o[l][w+v]=0+I,o[l][m]=n[l][m]),Ki(n,c,r,e,s),wn(t,D.p1i),t.wdi)Y(t.wdi,f)&&gn(t,h=parseInt(f,10))}function L(t,i,n){var e,r,s,e={};if(i&&n&&j(i)===j(n)){for(r=0,s=j(i);r<s;r++)e[i[r]]=n[r];(0,_.GC$)(t).css(e)}}function zi(t,i){var n={},e;if(i)for(e in i)Y(i,e)&&(n[e]=i[e]);if(t)for(e in t)n[e]===O&&t[e]!==O&&(n[e]=t[e]);return n}function Vi(t,i){var n;if("string"==typeof t){if(!i)return t;t&&i.getColor&&(n=i.getColor(t))}else"object"==typeof t&&(n=i.getColor(t.stops[0].color));return n}function Yi(t){var t=t&&t.tCt&&t.tCt();return t&&t.currentTheme()}function Gi(t){switch(t){case"double":return"double";case"dashDot":case"dashDotDot":case"dotted":case"slantedDashDot":case"mediumDashDot":case"mediumDashDotDot":return"dotted";case"medium":case"dashed":case"mediumDashed":return"dashed";default:return"solid"}}function qi(t,i,n,e){var r,s,i;t&&(r=i&&i[vt]||0,s=i&&i[dt]||"",i=i&&i[mt]||"",t[l][e+D._di]=r+I,t[l][e+D.ydi]=Gi(s),t[l][e+D.Ddi]=Vi(i,n))}function Ki(t,i,n,e,r){var s,o,c,o;t&&i&&(s=i[lt]||ot,o=i[ht]||h,c=i[ft]||a,t[l][at]=Vi(o,n),t[l][ut]=Vi(s,n),t[l][ft]=q(_.W.V(c,r)[ft]),qi(t,i[b],n,b),qi(t,i[g],n,g),qi(t,i[S],n,S),qi(t,i[w],n,w),o=_.W.A5(i[bt]),d.Common.zf.OS(t.className,Qt)?e[l][bt]=o:d.Common.zf.OS(t.className,ui)&&(t[l][bt]=o))}function Zi(t){var i,t,i=t[gt];return!i||!(i[b]||i[g]||i[S]||i[S])||!(!((t=zi(t[C],i))[w]&&0<t[w][vt])||t[b]&&0!==t[b][vt]||t[g]&&0!==t[g][vt]||t[S]&&0!==t[S][vt])}function k(t){var t,t,i,n,e,r,n,e,t;return(t=t&&zi(t[C],t[gt]))&&t[ft]?(t=t[ft],i=1,r=(n=_.W.Ne)((e=_.W.b5)(a)).fontSize,n=n(e(t)).fontSize,r&&n&&(e=Q(r),t=Q(n),isNaN(t)||(i=t/e)),i):1}function $i(t){var i,n,t,e,r,s,t,i=0,n=0;return t&&(e=(t=t[l])[b+D._di],r=t[g+D._di],s=t[S+D._di],t=t[w+D._di],e&&(i+=Q(e)),r&&(n+=Q(r)),s&&(i+=Q(s)),t)&&(n+=Q(t)),{widthOffset:i,heightOffset:n}}function Qi(t){var i,n,e,i=[];if(t)for(e=0;e<j(t);e++)n=t[e]===O||t[e]===y||""===t[e]?V().Blank:String(t[e]),i.push(n);return i}function Xi(t){var i=f(It);return L(i,[Tt,Lt,N,Mt],[xt,6*t.zoomFactor(),E,Bt]),(0,_.GC$)(i).addClass($t),wn(t,D.I1i),(0,_.GC$)(i).append(tn(t)).append(nn(t)),i}function tn(t){var i,n,e,r,s,o,c,c,u,c,u,o,a,s,i=f(It),n=f(It),e=f("span"),r=f(It),s=t.zoomFactor(),o=t.style();return L(i,[v,Tt,D.ght,Rt,Ft,N,Mt],[Wt,xt,0,0,0,E,Bt]),(0,_.GC$)(i).addClass(Qt),t.yZt=i,c=t.Cdi*s,L(n,[v,Tt,Rt,Ft,N,Mt],[Wt,xt,c,c,E,Bt]),(0,_.GC$)(n).addClass(Xt),t.pdi=n,(0,_.GC$)(i).append(n),c=t.Odi*k(o)*s,u=sn(t)*s,L(e,[N,Tt,D.ght,Mt,v,Pt,Ut],[E,xt,c,Bt,u,Ht,Jt]),(0,_.GC$)(e).text(t.captionName()).attr(zt,Vt).addClass(ti+" "+ai),t._caption=e,c=t.jdi*s,u=t.Idi*s,o=t.Ndi*k(o)*s,a=t.Edi*s,s=t.lre*s+I,L(r,[v,m,Et,Tt,D.ght,Ft,At,N,Yt,qt,Mt,Gt],[c,u,Nt,xt,o,a,"center",E,"normal",2,Bt,s]),(0,_.GC$)(r).attr("title","Clear Filter (Alt+C)").attr(zt,Vt).text(Zt).addClass(ii+" "+ai),t.Wrt=r,wn(t,D.p1i),(0,_.GC$)(n).append(e).append(r),i}function nn(t){var i,n,e,r,s,o,o,i=f(It),n=f("table"),e=f("tr"),r=f("td"),s=f("td"),o=(t.Sdi-t.Cdi+t.Tdi)*k(t.style())*t.zoomFactor();return L(i,[v,Mt,kt,N],[Wt,Bt,o,E]),(0,_.GC$)(i).attr(zt,Vt).addClass(ni+" "+ai),t.xdi=i,L(n,[N,"border-spacing"],[E,0+I]),(0,_.GC$)(n).attr(zt,Vt).addClass(ei+" "+ai),t.Ldi=n,(0,_.GC$)(e).css(N,E).addClass(ri),t.kdi=e,L(r,[Lt,N],[0,E]),(0,_.GC$)(r).addClass(si),t.Rdi=r,L(s,[Lt,N,Et],[0,E,Nt]),(0,_.GC$)(s).addClass(oi),t.Adi=s,(0,_.GC$)(r).append(en(t)),o=hn(t),(0,_.GC$)(s).append(o),t.Fdi=o,(0,_.GC$)(e).append(r).append(s),(0,_.GC$)(n).append(e),(0,_.GC$)(i).append(n),i}function en(t){var i,n,e,r,s,o,c,u,a,i=f(It),n=t.zoomFactor();for(t.Mdi=i,r=on(t),t.Bdi=r,e=cn(t),t.Wdi=e,L(i,[v,m,Gt],[e*n,r*n,t.lre*n+I]),(0,_.GC$)(i).attr(zt,Vt).addClass(ci+" "+ai),s=fn(t),t.Pdi=s,o=Math.min(an(t),j(s)),c=0;c<o;c++)a=rn(t,u=s[c],c),(0,_.GC$)(i).append(a),t._items.push(a),t.wdi[t.Hdi.indexOf(u)]=a;return i}function rn(t,i,n){var i,e,r,s,s,o,i=i,e=f(Kt),r=t.zoomFactor(),s=t.Udi*r+I;return L(e,[At,Ut,kt,Et,N,qt,Lt,Mt,Pt,at],[Rt,Jt,s,Nt,E,5,"1px 6px",Bt,Ht,h]),(0,_.GC$)(e).attr("type",Kt).attr(zt,Vt).text(i).addClass(ui+" "+ai),(o=(s=t.slicerData.Mf)?s.parent:o)&&o.options.enableAccessibility&&(0,_.GC$)(e).attr("tabindex",-1),(n+1)%t.columnCount()!=0&&(0,_.GC$)(e).css("margin-right",t.Udi*r+I),wn(t,D.T1i,e),e}function sn(t){var i,n,e,r,s,o,c,i,i,u,a,i=t.Wc,n=t.yZt,e=1,r=1,s=0,o=0,c=function(t){return t?Q(t):0},u=D.hdt+"Left"+D._di,a=D.hdt+"Right"+D._di;return i&&(e=c((i=i.style)[u]),r=c(i[a])),n&&(s=c((i=n.style)[u]),o=c(i[a])),t.width()-(e+r)-2*t.Cdi-(s+o)-t.jdi}function on(t){var i,i,i=$i(t.Wc),i=t.height()-2*t.Cdi-i.heightOffset;return t.showHeader()?i-t.Sdi*k(t.style())-t.Tdi:i}function cn(t){var i,i,i=$i(t.Wc),i=t.width()-2*t.Cdi-i.widthOffset-1;return t.Jdi()?i-t.zdi:i}function un(t,i){var n=t.columnCount();return(i-(n-1)*t.Udi)/n}function an(t){return Math.ceil(t.Bdi/(t.itemHeight()+2*(t.Vdi+t.Gdi)+t.Udi))*t.columnCount()}function fn(t){var i,n,e,r,s,o,c,u,t,i=t.Hdi,n=t.Ydi(i.slice(0),t.sortState()),e=t.slicerData.getFilteredOutIndexes(t.columnName,2);if(t.showNoDataItems()){if(t.visuallyNoDataItems()&&t.showNoDataItemsInLast()){for(r=[],o=j(n),u=c=void 0,c=0;c<o;c++)u=n[c],p.OS(e,i.indexOf(u))||r.push(u);for(c=0;c<o;c++)u=n[c],p.OS(e,i.indexOf(u))&&r.push(u);n=r}}else for(r=n.concat(),s=0;s<j(r);s++)p.OS(e,i.indexOf(r[s]))&&p.VP(n,r[s]);return t=V().Blank,p.OS(n,t)&&(p.VP(n,t),n.push(t)),n}function hn(s){var t,t,t=new _.YM(!1),t=(s.qdi=t).oy();return(0,_.GC$)(t).bind("scroll.gcScrollbar",function(t,i){var n,e,r,n=i.scrollEventType,e=i.scrollOrientation;t.data=s,1===e&&0<=(r=[0,1,2,3,5]).indexOf(n)&&s.ay(t,i)}),t}function ln(t){var i=t.slicerData;t.data=i.getData(t.columnName),t.exclusiveDatas=i.getExclusiveData(t.columnName),t.Kdi=Qi(t.data),t.Hdi=Qi(t.exclusiveDatas),t.Pdi=fn(t),Sn(t),bn(t)}function vn(t,i){var n,e,e,n=t.style(),e=t.Wc;e&&(i!==O&&i!==t.zoomFactor()&&(t.zoomFactor(i),Ji(t,n)),(0,_.GC$)(e).css(Lt,6*i),wn(t,D.I1i),dn(t),e=t.showHeader()?(t.Sdi+t.Tdi-t.Cdi)*k(n)*i:0,(0,_.GC$)(t.xdi).css(kt,e),mn(t),Sn(t))}function dn(t){var i,n,e,r,s,o,e,e,c,r,u,e,c,r,o,i,i=t.zoomFactor(),n=t.yZt,e=t.xdi,r=t._caption,s=t.Wrt,o=t.style();t.showHeader()?(t.Wc.firstChild!==n&&((0,_.GC$)(n).insertBefore(e),(0,_.GC$)(e).css(kt,(t.Sdi+t.Tdi)*k(o)*i)),(0,_.GC$)(n).css(m,t.Sdi*k(o)*i),e=t.Cdi*i,L(t.pdi,[Rt,Ft],[e,e]),r.innerHTML!==t.captionName()&&(0,_.GC$)(r).text(t.captionName()),e=t.Odi*k(o)*i,c=sn(t)*i,L(r,[D.ght,v,Yt],[e,c,"bold"]),Nn(t,u=(r=t.Zdi)&&0<j(r)?1:0),c=e=t.jdi*i,r=t.Ndi*k(o)*i,o=t.Edi*i,i=t.lre*i+I,L(s,[v,m,D.ght,Ft,Gt],[e,c,r,o,i]),wn(t,D.p1i)):(0,_.GC$)(n).remove()}function mn(t){var i,n,e,i=t.zoomFactor(),n=on(t);t.Bdi=n,e=cn(t),t.Wdi=e,L(t.Mdi,[v,m,Gt],[e*i,n*i,t.lre*i]),bn(t)}function bn(t){var i,n,e,r,s,o,c,u,a,i=t.Pdi;if(i){for((n=t._items)&&0<j(n)&&(0,_.GC$)(n).remove(),t._items=[],n=t._items,t.wdi={},e=Math.min(an(t),j(i)),r=t.Jdi()?t.qdi.value()*t.columnCount():0,s=Math.min(r+e,j(i)),o=r;o<s;o++)u=rn(t,c=i[o],o),(0,_.GC$)(t.Mdi).append(u),n.push(u),t.wdi[t.Hdi.indexOf(c)]=u;if(0!==j(n))for(a in t.wdi)Y(t.wdi,a)&&gn(t,parseInt(a,10))}}function gn(t,i){var n,n,e,r,s,o,n=t.$di,n=n?t.Hdi.indexOf(n[x]):-1,e=t.Zdi,r=t.Qdi,s=t.wdi[i],o=0;i===n&&(o|=1),p.OS(e,i)?o|=4:o|=2,p.OS(r,i)&&t.visuallyNoDataItems()?o|=16:o|=8,pn(t,s,o)}function pn(t,i,n){var e=t.style(),r;if(i&&e){switch(n){case 10:r=pt;break;case 18:r=St;break;case 12:r=wt;break;case 20:r=_t;break;case 11:r=yt;break;case 19:r=Dt;break;case 13:r=Ct;break;case 21:r=jt}Ki(i,zi(e[C],e[r]),Yi(t.slicerData),t._caption,t.zoomFactor()),wn(t,D.T1i,i)}}function Sn(t){var i,n,e,r,s,o,r,i=t.Fdi,n=t.Adi;t.Jdi()?(i=i||hn(t),n.firstChild!==i&&((0,_.GC$)(n).append(i),mn(t)),e=t.zoomFactor(),r=t.Bdi,s=Math.floor(r/(t.itemHeight()+2*t.Vdi+t.Udi)),(o=t.qdi).value(t.Xdi),o.YC(t.zdi*e,!1),o.ZC(r*e,!1),o.m4(0),o.v4(Math.ceil(j(t.Hdi)/t.columnCount())-s),o.d4(s),o.iS(1),o.cS(s-1),o.w4()):(n.firstChild===i&&((r=i.parentElement)&&r.removeChild(i),mn(t)),t.Xdi=0)}function wn(t,i,n){var e,r,s,o,c,u,a,a,u,c,u,e=t.zoomFactor();switch(i){case D.I1i:u=$i(c=t.Wc),a=t.Cdi,r=(t.width()-2*a)*e-u.widthOffset,s=(t.height()-2*a)*e-u.heightOffset,o=c;break;case D.p1i:u=$i(a=t.yZt),c=t.Sdi*k(t.style())*e-u.heightOffset,(0,_.GC$)(a).css(m,c),r=t.jdi*e,s=t.Idi*e,o=t.Wrt;break;case D.T1i:u=$i(n),r=un(t,t.Wdi)*e-2*t.tmi-u.widthOffset,s=t.itemHeight()*e-u.heightOffset,o=n}L(o,[v,m],[r,s])}function _n(t,i){var n,e,i,r,s,o,c,u,n=t.exclusiveDatas,e=t.Zdi,i=jn(t,i[x]),r=t.imi,s=t.nmi;for(p.OS(r,i)?p.VP(r,i):r.push(i),o=0;o<j(n);o++)p.OS(e,o)||s.push(o);for(c=0;c<j(r);c++)p.OS(s,r[c])?p.VP(s,r[c]):s.push(r[c]);if(0===j(s))for(u=0;u<j(t.Hdi);u++)s.push(u);t.emi=i}function yn(t,i){var n,e,r,r,i,s,o,c,u,a,f,n=t.Pdi,e=t.Hdi,r=e[t.emi];for(Cn(t),r=n.indexOf(r),i=n.indexOf(i[x]),s=Math.min(r,i),o=Math.max(r,i),c=s;c<=o;c++)u=e.indexOf(n[c]),a=t.imi,f=t.nmi,-1===a.indexOf(u)&&a.push(u),-1===f.indexOf(u)&&f.push(u)}function Dn(t,i){Cn(t);var i=jn(t,i[x]);gn(t,i),t.imi.push(i),t.nmi.push(i),t.emi=i}function Cn(t){var i,n,e,r,s,o,c,i=t._items;if(i&&0!==j(i))for(n=t.Qdi,e=0,r=j(i);e<r;e++)s=i[e],o=t.Hdi.indexOf(i[e].innerHTML),pn(t,s,c=p.OS(n,o)?20:12)}function jn(t,i){var n,e,r,n=t.Hdi;if(n)for(e=0,r=j(n);e<r;e++)if(n[e]===i)return e;return-1}function On(t,i){for(var n,e,r,s,n=t.Zdi,e=t.Qdi,r=0;r<j(i);r++)s=0,!t.rmi||p.OS(n,i[r])?s|=2:s|=4,p.OS(e,i[r])&&t.visuallyNoDataItems()?s|=16:s|=8,pn(t,t.wdi[i[r]],s)}function In(t,i){var n=t.$di;t.bg(i),n=n?new vi(n[T],n[x]):y,t.$di=y,En(t,n)}function Nn(t,i){var n,e,e,r,n=t.Wrt;if(n)switch(r=(r=(e=zi((e=t.style())[C],e[gt]))&&e[ht])||h,t.smi=r,i){case 0:t.Dit=!1,L(n,[ut,at],[t.omi,r]);break;case 1:t.Dit=!0,L(n,[ut,at],[t.cmi,r]);break;case 2:(0,_.GC$)(n).css(at,t.umi)}}function En(t,i){var n,e;if(i)switch(n=t.imi,i[T]){case 4:t.Wrt&&(t.Dit?Nn(t,1):Nn(t,0));break;case 5:e=t.Hdi.indexOf(i[x]),n&&p.OS(n,e)?On(t,n):gn(t,e)}}function Tn(t,i){if(i)switch(i[T]){case 4:t.Wrt&&t.Dit&&Nn(t,2);break;case 5:var n=t.Hdi.indexOf(i[x]);gn(t,n);break;case 6:t.Mdi.style.cursor=Nt}}function xn(t,i){var n,e,r,n=t._items;if(n&&i!==y)for(e=0;e<j(n);e++)if((r=n[e]).innerHTML.toLowerCase()===i.toLowerCase())return r;return y}function Ln(t,i){var n,e,r,s,o,n,i,c,u,a,f,h,l,n,n=R(t,D.I1i),e=y,r=y;if(!n)return y;if(s=i.pageX,o=i.pageY,n=R(t,D.p1i),i=R(t,D.N1i),c=R(t,D.S1i),u=R(t,D.E1i),n&&n.contains(s,o))e=i&&i.contains(s,o)?4:1;else if(c&&c.contains(s,o))if(a=t._items,u&&u.contains(s,o)&&a){for(f=void 0,f=0;f<j(a);f++)if((h=R(t,D.T1i,f))&&h.contains(s,o)){for(l in e=5,t.wdi)if(t.wdi[l]===a[f]){r=t.Hdi[l];break}break}f>=j(a)&&(e=(n=R(t,D.T1i,j(a)-1))&&o<n.y+t.itemHeight()*t.zoomFactor()?6:7)}else e=8;else e=0;return new vi(e,r)}function R(t,i,n){var e,r,s,o,c,u,a,f,h,l,v,d,m,b,g,p,S,g,S,g,w,e=i===D.I1i?O:R(t,D.I1i),r=t.Wc,s=t.ami,o=t.Cdi,c=t.zoomFactor(),u=t.style(),a=t.showHeader(),f=t.Sdi,h=t.jdi,l=t.Hdi;switch(i){case D.I1i:for(d=v=0,m=r.offsetWidth,b=r.offsetHeight;v+=r.offsetLeft,d+=r.offsetTop,r=r.offsetParent;);break;case D.p1i:if(!e||!a)return y;v=e.x+s*c,d=e.y+s*c,m=t.width()*c,b=f*k(u)*c;break;case D.N1i:if(!e||!a)return y;v=e.x+e.width-(s+o+h)*c,d=e.y+s+t.Odi*k(u)*c,m=h*c,b=t.Idi*c;break;case D.S1i:if(!e)return y;g=s+o,p=0,S=f*k(u)+t.Tdi,v=e.x+g*c,d=e.y+0*c+(a?S*c:0),m=(t.width()-2*g)*c,b=e.height-0*c-(a?S*c:0);break;case D.E1i:if(!(g=R(t,D.S1i)))return y;if(!t.Jdi())return g;v=g.x,d=g.y,m=g.width-t.zdi*t.zoomFactor(),b=g.height;break;case D.T1i:if(!e||0===j(l)||n>=j(l))return y;if(!(S=R(t,D.E1i)))return y;g=t.columnCount(),w=t.Udi,m=(S.width-(g-2)*w*c)/g,b=t.itemHeight()*c+2*t.Gdi,v=S.x+n%g*(m+w*c),d=S.y+Math.floor(n/g)*(b+w*c)}return new _.Rect(v,d,m,b)}function kn(t){return 0<t}function n(t,i,n){var e=this;e.name(t,!1),e.Wc=y,e.Cdi=6,e.ami=1,e.lre=14,e.yZt=y,e.Sdi=27,e.Tdi=5,e._caption=y,e.Wrt=y,e.jdi=28,e.Idi=25,e.Ndi=3,e.Edi=0,e.Dit=!1,e.Odi=3,e.xdi=y,e.Ldi=y,e.kdi=y,e.Rdi=y,e.Adi=y,e.Mdi=y,e.Wdi=0,e.Bdi=0,e.Fdi=y,e.fmi=2,e._items=[],e.wdi={},e.Gdi=1,e.Vdi=1,e.tmi=6,e.Udi=2,e.zdi=17,e.Xdi=0,e.smi=h,e.umi="#F9E578",e.cmi="red",e.omi="#B0ADB0",e.hmi=!1,e.lmi=!1,e.imi=[],e.nmi=[],e.emi=0,e.Pdi=[],e.Zdi=[],e.Qdi=[],e.Hdi=[],e.Kdi=[],e.slicerData=i,e.columnName=n,e.data=i.getData(n),e.exclusiveDatas=i.getExclusiveData(n),e.slicerData.attachListener(e),e.vmi()}function Rn(n){return function(t,i){vn(this),this.onPropertyChanged(n,t,i)}}function Fn(e){return function(t,i){var n=this;n.Pdi=fn(n),vn(n),n.onPropertyChanged(e,t,i)}}function An(t,i,n,e){return n=n||Rn(t),_.mt.p0(t,i,n,e)}for(B=this&&this.__extends||(Ai=function(t,i){return(Ai=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Ai(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(M,"__esModule",{value:!0}),M.DOMTableSlicer=M.TableSlicerData=M.ItemSlicer=void 0,_=t("Core"),d=t("Common"),W=t("FloatingObject"),P=t("ConditionalFormatting"),H=t("Tables"),U=t("./dist/plugins/slicer/slicer.ns.js"),J=t("./dist/plugins/slicer/slicer.js"),z=t("./dist/plugins/slicer/slicer-style.js"),t=new d.Common.ResourceManager(U.SR,"Slicer"),V=t.getResource.bind(t),Y=d.Common.kh,U=d.Common.lt,c=U.ht,p=d.Common.Uf,f=_.mt.En,G=_.mt.p0,j=p.tR,q=_.mt.yt,K=_.GC$.isArray,Z=_.GC$.extend,$=document,O=void 0,y=null,a="normal 11pt calibri",Q=parseFloat,e=".slicer",r="mouse",X="wheel",tt="DOMMouseScroll",it=d.Slicers.GeneralSlicerData,Mi=nt={CONTAINER:0,0:"CONTAINER",H_SPACE:1,1:"H_SPACE",H_CAPTION:2,2:"H_CAPTION",H_SPLITLINE:3,3:"H_SPLITLINE",H_CLEARFILTER:4,4:"H_CLEARFILTER",B_ITEM:5,5:"B_ITEM",B_ITEMSPACER:6,6:"B_ITEMSPACER",B_TAIL:7,7:"B_TAIL",B_SCROLLBAR:8,8:"B_SCROLLBAR"},Bi=et={HOVERED:1,1:"HOVERED",SELECTED:2,2:"SELECTED",UNSELECTED:4,4:"UNSELECTED",HASDATA:8,8:"HASDATA",NODATA:16,16:"NODATA"},Wi=rt={NORMAL:0,0:"NORMAL",ACTIVE:1,1:"ACTIVE",HOVERED:2,2:"HOVERED"},st="name",l="style",h="white",ot="black",ct="solid",ut="color",at="background-color",v="width",m="height",ft="font",ht="back"+(D={ydi:"Style",Ddi:"Color",_di:"Width",hdt:"border",y1i:"WithDataStyle",D1i:"WithNoDataStyle",C1i:"electedItem",O1i:"hovered",ght:"top",j1i:"gc-slicer-",I1i:"container",p1i:"header",N1i:"clearfilter",S1i:"body",E1i:"itemscontainer",T1i:"item"}).Ddi,lt="fore"+D.Ddi,vt=D.hdt+"Width",dt=D.hdt+D.ydi,mt=D.hdt+D.Ddi,b=D.hdt+"Left",g=D.hdt+"Top",S=D.hdt+"Right",w=D.hdt+"Bottom",bt="textDecoration",C="wholeSlicer"+D.ydi,gt="header"+D.ydi,pt="s"+D.C1i+D.y1i,St="s"+D.C1i+D.D1i,wt="unS"+D.C1i+D.y1i,_t="unS"+D.C1i+D.D1i,yt=D.O1i+"S"+D.C1i+D.y1i,Dt=D.O1i+"S"+D.C1i+D.D1i,Ct=D.O1i+"UnS"+D.C1i+D.y1i,jt=D.O1i+"UnS"+D.C1i+D.D1i,Ot="undoFilter",It="div",I="px",Nt="default",Et="cursor",Tt="position",xt="absolute",Lt="padding",kt="margin-"+D.ght,Rt="left",Ft="right",At="text-align",Mt="overflow",Bt="hidden",Wt="auto",Pt="text-overflow",Ht="ellipsis",Ut="white-space",Jt="nowrap",zt="unselectable",Vt="on",Yt="font-weight",Gt="font-size",qt="border-radius",N="box-sizing",E="content-box",Kt="button",Zt="\u2717",T="mark",x="itemValue",$t=D.j1i+D.I1i,Qt=D.j1i+D.p1i,Xt=D.j1i+"header-borderDiv",ti=D.j1i+"caption",ii=D.j1i+D.N1i,ni=D.j1i+D.S1i,ei=D.j1i+"table",ri=D.j1i+"tr",si=D.j1i+"td1",oi=D.j1i+"td2",ci=D.j1i+D.E1i,ui=D.j1i+D.T1i,ai="gc-no-user-select",n.getDefaultStyle=function(){var t,i,n,e,r,s,o,c,u,t=function(t,i,n,e,r,s,o,c){var u={};return u[ht]=t,u[lt]=i,u[ft]=n,u[b]=e,u[g]=r,u[S]=s,u[w]=o,u[bt]=c,u},i=function(t,i,n){var e={};return e[vt]=t,e[dt]=i,e[mt]=n,e},n=i(1,ct,"#808080"),e=i(0,"",""),r=i(1,ct,"#999999"),s=i(1,ct,"#CCCCCC"),o=i(1,ct,"#E0E0E0"),c=t("#F9E36F",ot,a,r,r,r,r),u={};return u[C]=t(h,ot,a,n,n,n,n),u[gt]=t(h,ot,"bold 11pt calibri",e,e,e,i(1,ct,"#A6A6A6")),u[pt]=t("#BFBFBF",ot,a,r,r,r,r),u[St]=t("#D9D9D9",ot,a,s,s,s,s),u[wt]=t(h,ot,a,s,s,s,s),u[_t]=t(h,"#959595",a,o,o,o,o),u[yt]=c,u[Dt]=c,u[Ct]=c,u[jt]=c,u},n.prototype.vmi=function(){var t=this;t.Kdi=Qi(t.data),t.Hdi=Qi(t.exclusiveDatas),t.Wc=Xi(t),t.captionName(t.columnName,!1),t.attachEvents(),t.onFiltered(),Ji(t,t.style()),vn(t)},n.prototype.attachEvents=function(){var i,t,n,i=this,t=i.Wc;t&&((0,_.GC$)(t).bind(r+"down"+e,function(t){i.gg(t)}).bind(r+"move"+e,function(t){i.pg(t)}).bind(r+"out"+e,function(t){i.dmi()}),(0,_.GC$)($).bind(r+"up"+e,function(t){In(i,t)}).bind("keydown"+e,function(t){i.pf(t)}).bind("keyup"+e,function(t){i.bf(t)}),i.Mg=i.Mg.bind(i),t.addEventListener(r+X,i.Mg,n={capture:!1,passive:!1}),t.addEventListener(tt,i.Mg,n),$.addEventListener(r+X,i.Mg,n),$.addEventListener(tt,i.Mg,n))},n.prototype.detachEvents=function(){var t,i,t=this,i=t.Wc;i&&((0,_.GC$)(i).unbind(e),(0,_.GC$)($).unbind(e),i.removeEventListener(r+X,t.Mg),i.removeEventListener(tt,t.Mg),$.removeEventListener(r+X,t.Mg),$.removeEventListener(tt,t.Mg))},n.prototype.L0=function(){var t=this;t.detachEvents(),(0,_.GC$)(t.Wc).remove(),t.Wc=y},n.prototype.getDOMElement=function(){return this.Wc},n.prototype.Ydi=function(t,i){var n,e,r,n=[];if(0!==i){for(e=d.Slicers.xzt.quickSort(t),r=0;r<j(e);r++)n[r]=e[r].value;return 2===i&&n.reverse(),n}},n.prototype.Jdi=function(){var t,i,i,n,t=this,i=t.Hdi,i=t.showNoDataItems()?j(i):j(i)-j(t.Qdi),n;return Math.ceil(i/t.columnCount())*(t.itemHeight()+2*(t.Gdi+t.Vdi)+t.Udi)>t.Bdi},n.prototype.ay=function(t,i){this.w0n(t,i)},n.prototype.w0n=function(t,i){var n=this,i=i.newValue;i!==n.Xdi&&i<=n.qdi.v4()&&(n.Xdi=i,Sn(n),bn(n))},n.prototype.onDataChanged=function(){ln(this)},n.prototype.onRowsChanged=function(){ln(this)},n.prototype.onColumnNameChanged=function(t,i){var n=this;n.columnName===t&&n._caption&&(n.columnName=i,n.captionName(i,!1),(0,_.GC$)(n._caption).text(i))},n.prototype.onColumnRemoved=function(t){var i=this;t===i.columnName&&(i.slicerData.doUnfilter(t),i.detachEvents(),(0,_.GC$)(i.Wc).remove(),i.Wc=y)},n.prototype.onFiltered=function(){var t=this,i=t.slicerData,n=t.columnName;t.Pdi=fn(t),t.Qdi=i.getFilteredOutIndexes(n,2),t.Zdi=i.getFilteredOutIndexes(n,1),vn(t)},n.prototype.mmi=function(t){var t,t,t=Ln(this,t);return!!t&&(5===(t=t.mark)||6===t||8===t||4===t)},n.prototype.gg=function(t){var i=this,n=Ln(i,t);n&&(8===n[T]&&(i.lmi=!0),5===n[T]&&(i.nmi=[],i.hmi=!0,(t.ctrlKey?_n:t.shiftKey?yn:Dn)(i,n)),On(i,i.imi),5===n[T]||6===n[T]||8===n[T]||4===n[T]&&i.Dit)&&t.stopPropagation()},n.prototype.bg=function(t){var i,t,n,e,r,i=this,t=Ln(i,t);t&&(n=i.slicerData,e=i.imi,r=!1,4===t[T]?i.Dit&&(n.doUnfilter(i.columnName),Nn(i,0),r=!0):e&&0<j(e)&&!i.rmi&&!i.bmi&&(n.doFilter(i.columnName,{exclusiveRowIndexes:i.nmi}),r=!0),i.hmi=!1,i.lmi=!1,r)&&(i.imi=[],i.nmi=[])},n.prototype.pg=function(t){var i,n,n,t,e,r,s,o,c,u,a,f,h,l,v,d,m,b,g,i=this,n=i.$di,n=n?new vi(n[T],n[x]):y,t=Ln(i,t),e=i.Hdi,r=i.nmi;if(t&&(!n||n[T]!==t[T]||5===n[T]&&n[x]!==t[x]))if(i.hmi){if(5===t[T])if(s=e.indexOf(t[x]),o=i.Qdi,a=u=c=void 0,p.OS(r,s)){for(h=(f=i.Pdi).indexOf(e[i.emi]),l=f.indexOf(t[x]),v=Math.min(h,l),d=Math.max(h,l),m=[],b=j(r),c=0;c<b;c++)g=r[c],(d<(u=f.indexOf(e[g]))||u<v)&&m.push(g);for(b=j(m),c=0;c<b;c++)a=xn(i,e[u=m[c]]),p.OS(o,u)?pn(i,a,20):pn(i,a,12),p.VP(r,u)}else a=xn(i,e[s]),p.OS(o,s)?pn(i,a,18):pn(i,a,10),p.ZP(r,s);i.$di=t}else i.$di=t,En(i,n),Tn(i,t)},n.prototype.dmi=function(){var t,i,i,t=this,i=t.$di,i=i?new vi(i[T],i[x]):y;t.$di=y,En(t,i)},n.prototype.Mg=function(t){var i;return 8===Ln(this,t)[T]&&(t.stopPropagation(),!0)},n.prototype.pf=function(t){var i=this;17!==t.keyCode||i.rmi||(i.rmi=!0),16!==t.keyCode||i.bmi||(i.bmi=!0)},n.prototype.bf=function(t){var i=this,n=i.slicerData;17===t.keyCode&&i.rmi&&(i.rmi=!1),16===t.keyCode&&i.bmi&&(i.bmi=!1),!i.rmi&&!i.bmi&&0<j(i.imi)&&(n.doFilter(i.columnName,{exclusiveRowIndexes:i.nmi}),i.imi=[],i.nmi=[])},n.prototype.onPropertyChanged=function(t,i,n){var e,r,e=this;e.slicerData.tCt&&(r=e.slicerData.tCt()).Ut.n1i(e,t,n,i)},fi=n,M.ItemSlicer=fi,hi=[[st],[v,180],[m,210],["captionName",""],["columnCount",1,y,kn],["itemHeight",21,y,kn],["showHeader",!0],["sortState",1,Fn("sortState")],["showNoDataItems",!0,Fn("showNoDataItems")],["showNoDataItemsInLast",!0,Fn("showNoDataItemsInLast")],["visuallyNoDataItems",!0,Fn("visuallyNoDataItems")],[l,fi.getDefaultStyle(),function(t,i){Ji(this,t),vn(this),this.onPropertyChanged("visuallyNoDataItems",t,i)}],["zoomFactor",1,y,kn],["isLocked"],["disableResizingAndMoving"]],i=0,li=j(hi);i<li;i++)fi.prototype[hi[i][0]]=An(hi[i][0],hi[i][1],hi[i][2],hi[i][3]);function Mn(t,i){var n=this;n[T]=t===O?y:t,n[x]=i===O?y:i}function Bn(t,i,n){for(var e,r,s,o,c,u,a,f,e=t.Mf,r=t.dataRange(),s=r.row+r.rowCount-1,o=r.col+r.colCount-1,c=r.row;c<=s;c++)for(i.push(u=[]),a=r.col;a<=o;a++)u.push({value:e.getValue(c,a),text:e.getText(c,a)});for(a=0;a<r.colCount;a++)f=t.getColumnName(a)||"",n.push(f)}function Wn(t,i){var n,e,r,s,n=t.Mf,e=t.nM.rowFilter();for(n.suspendPaint(),r=e&&e.Mct||[],s=0;s<j(r);s++)Pn(t,i,[r[s]]);n.resumePaint()}function Pn(t,i,n){for(var e,r,s,o,c,u,a,f,h,l,v,d,m,m,b,g,e=0;e<n.length;e++){if(r=t.nM,s=t.IB,u=(o=n[e]-r.range().col)+(c=r.dataRange()).col,a=t.columnNames[o],f=[],h={},p.OS(s.Mct,u)){for(l=[],v=c.row;v<c.row+c.rowCount;v++)s.Lct(v,u)||l.push(v);for(d=0;d<j(l);d++)m=l[d]-c.row,h[m=t.getExclusiveRowIndex(a,m)]||(h[m]=!0,f.push(m))}else for(b=j(t.getExclusiveData(a)),g=0;g<b;g++)f.push(g);Hn(Un(t,a),f)||(i.prototype.doFilter.call(t,a,{exclusiveRowIndexes:f}),t.onFiltered(),t.Mf.zw())}}function Hn(t,i){if(c(t)&&c(i))return 1;if(!(c(t)&&!c(i)||!c(t)&&c(i))&&(c(t)||c(i)||K(t)&&K(i))&&t.length===i.length){for(var n=0;n<t.length;n++)if(t[n]!==i[n])return;return 1}}function Un(t,i){for(var n,e,r,s,o,n=t.getExclusiveData(i),e=t.getFilteredOutIndexes(i,1),r=[],s={},o=0;o<j(e);o++)s[e[o]]=!0;for(o=0;o<j(n);o++)s[o]&&r.push(o);return r}function s(t){var i,n,e,r,s,i=this,n=[],e=[],r=t.rowFilter();return Bn(t,n,e),i=Pi.call(this,n,e)||this,(s=i).nM=t,s.Mf=t.Mf,s.IB=r,s.$1i=y,Wn(s,it),r&&(r.filterHandler=function(t){Pn(s,it,t.columns)}),i}function Jn(t){var t=t.nM,i,n;return t&&(i=t.Mf,n=t.rowFilter()),i&&(!i.options.isProtected||n&&n.Hct(i))}function o(t,i,n){var t=Hi.call(this,t,i,n)||this;return t.isSelected(!1),t}function zn(t,i){var n,e,r,n=t.J1i;if(i){for(e=i.getTable(),r=0;r<j(n);r++)if(n[r].getTable()===e)return;n.push(i)}}function Vn(t,i){p.VP(t.J1i,i)}function Yn(t,i){for(var n,e,r,s,n=t.J1i,e=0;e<j(n);e++)if(s=(r=n[e]).getTable(),r&&s&&s.tableName()===i)return r;return y}function Gn(i,n,e){var t,t,r,t=i.LSt;t&&(t=t.tCt(),(r=t.slicers).all().forEach(function(t){t===i&&(r.Ydt(n,e),i.onPropertyChanged(st,e,n))}))}function u(t,i,n){var t,e,r,r,i,t=Ui.call(this,t,Ei,Ti,xi,Li)||this;return t.ma=J.SlicerType.table,(e=t).typeName=Ni,e.iht=Ni,i&&(r=i.Mf,e.sheet(r),i.DSt&&(i.V5t(),i.DSt=!1),r=Yn(r.slicers,i.tableName())),r=r||i.getSlicerData(),e.LSt=r,e[pi](n),e.gmi=[],e.IKt=n,i=Ni+"_"+n,e.sheet()&&e.sheet().parent&&(i=e.sheet().parent.q1i(n,e.ma)),e[bi](i),e[gi](n),e[Oi](!1),e[ji](!1),t}for(vi=Mn,B(s,Pi=it),s.prototype.L0=function(){var t=this;t.$1i=y,t.nM=y,t.IB&&(t.IB.filterHandler=y,t.IB=y),t.Mf=y},s.prototype.tCt=function(){return this.Mf},s.prototype.getTable=function(){return this.nM},s.prototype.doFilter=function(t,i,n){var e,r,s,o,c,u,a,f,h,l,v,n,d,m,b,g,p,S,a,w,_,y,D,C,e=this,r=e.Mf,s=e.nM,o=e.IB,c=i.ranges,u=i.exclusiveRowIndexes,a=!!u,f={columnName:t,oldValue:e.getFilteredIndexes(t)},h=e.getColumnIndex(t);if(!(h<0||!a&&!c)){if(n)Pi.prototype.doFilter.call(this,t,i,n);else{if(l=a?e.getExclusiveData(t):e.getData(t),v=[],a)v=u;else for(n=e.Dzt(),d=e._zt(),n[h]||e.Czt(h),m=n[h],b=0;b<j(c);b++)for(g=c[b],S=(p=e.Tzt(m,g)).start;S<=p.end;S++)v.push(d[h][S]);if(r.suspendPaint(),a=s.startColumn()+h,o&&o.removeFilterItems(a,!0),r.kct(),P.aJ){for(w=[],_=0;_<j(v);_++)(y=(0,P.aJ)(2,0,l[v[_]])).useWildCards(!1),w.push(y);o&&o.addFilterItem(a,w)}Pi.prototype.Ozt.call(this,t,i),e.jzt(t,D=[],C={}),o&&(o.filter(a,!0),o.onFilter(o.Dct(0,[a])),r.Ut.cct(o,7,O,!0)),e.onFiltered(),r.resumePaint()}r.Ut.n1i(e,Ot,f,{columnName:t,oldValue:e.getFilteredIndexes(t)})}},s.prototype.doUnfilter=function(t){var i,n,e,r,s,o,e,i=this,n=i.Mf,e=i.nM,r=i.getColumnIndex(t),s=i.IB;-1!==r&&(o={columnName:t,oldValue:i.getFilteredIndexes(t)},e=e.startColumn()+r,s.removeFilterItems(e),Pi.prototype.Rzt.call(this,t),s.unfilter(e,!0),s.onFilter(s.Dct(0,[e])),i.onFiltered(),i.Mf.zw(),n.Ut.n1i(i,Ot,o,{columnName:t,oldValue:i.getFilteredIndexes(t)}))},s.prototype.refresh=function(){var t=this,i=[],n=[];Bn(t.nM,i,n),t.Izt(i,n)},s.prototype.onColumnNameChanged=function(i,n){var e,t,r,e=this;Pi.prototype.onColumnNameChanged.call(this,i,n),(r=(t=e.Mf.parent)&&t.sheets||[e.Mf]).forEach(function(t){t.slicers.all().forEach(function(t){t.LSt===e&&t.columnName()===i&&t.columnName(n)})})},s.prototype.onRowsAdded=function(t,i){var n,e,r,s,o,c,n=this,e=n.Mf,r,s=n.nM.dataRange();for(Pi.prototype.onRowsAdded.call(this,t,i,!0),o=t;o<t+i;o++)for(c=0;c<j(n.columnNames);c++)n.data[o][c]={value:e.getValue(s.row+o,s.col+c),text:e.getText(s.row+o,s.col+c)};n.Izt(n.data,n.columnNames),n.Nzt("onRowsChanged",t,i,!0)},s.prototype.onRowsRemoved=function(t,i){Pi.prototype.kzt.call(this,t,i,!1)},s.prototype.onColumnsAdded=function(t,i){for(var n,e,r,s,o,c,u,a,f,h,n=this,e=n.Mf,r=n.nM,s=r.dataRange(),o=n.data,c=n.columnNames,u=0;u<j(o);u++)for(a=t;a<t+i;a++)o[u].splice(a,0,{value:e.getValue(s.row+u,s.col+a),text:e.getText(s.row+u,s.col+a)});for(f=t;f<t+i;f++)h=r.getColumnName(f)||"",c.splice(f,0,h);n.Izt(o,c)},s.prototype.onColumnsRemoved=function(t,i){for(var n,e,r,s,o,c,u,n=this,e=n.Mf,r=n.nM.name(),s=n.columnNames,o=[],c=t;c<t+i;c++)s[c]&&o.push(s[c]);Pi.prototype.onColumnsRemoved.call(this,t,i),u=e&&e.slicers,o.forEach(function(t){u.all(r,t).forEach(function(t){u.remove(t.name())})})},s.prototype.onTableRemoved=function(t){var i,n,e,n,i=this;t&&t===i.nM&&(i.$1i=[],n=i.Mf,e=n.slicers,n=t.name(),e.all(n).forEach(function(t){i.$1i.push(t),e.remove(t.name())}),e&&Vn(e,i),i.aT=[])},s.prototype.onTableAdded=function(t){var i,n,r,e,i=this,n,r=i.Mf.slicers;r&&t&&t.N5t()&&zn(r,t.getSlicerData()),(e=i.$1i||[]).forEach(function(t){var i=t.name(),n=t.LSt.nM.name(),e=t.columnName(),t=t.style();r.add(i,n,e,t)})},di=s,M.TableSlicerData=di,H.Table&&_.GC$.extend(H.Table.prototype,{getSlicerData:function(){var t=this;return t.LSt||(t.LSt=new di(t)),t.LSt}}),B(o,Hi=fi),o.prototype.L0=function(){var t=this;t.nM=y,t.slicer(y),t.sheet(y),Hi.prototype.L0.call(this)},o.prototype.vmi=function(){var t=this,i=t.slicerData;i&&i instanceof di&&(t.sheet(i.tCt()),t.nM=i.getTable()),Hi.prototype.vmi.call(this)},o.prototype.onColumnRemoved=function(t){var i,n,e,r,s,i=this,n=i.sheet(),e=i.nM,r=i.slicerData;t===i.columnName&&(s=r.getFilteredOutIndexes(t,1),0!==j(s)&&r.doUnfilter(t),n)&&e&&n.WL.VP(i.name())},o.prototype.Ydi=function(t,i){var n,e,r,s,o,c,u,a,f,h,l,v,n=this,e=n.slicerData,r=e.getColumnIndex(n.columnName),s,o=n.nM.dataRange(),c=[];if(0===i)return t;for(u=[],a=e.tCt(),f=0;f<j(t);f++)h=e.getRowIndexes(n.columnName,f),u.push(a.getValue(o.row+h[0],o.col+r));for(l=d.Slicers.xzt.quickSort(u),v=0;v<j(l);v++)c[v]=t[l[v].index];return 2===i&&c.reverse(),c},o.prototype.ay=function(t,i){var n,e,n,r,s,n=this,e=n.sheet(),n=n.slicer();for(n&&e._lt(n)||(i.newValue=i.oldValue),r=Zn(n),s=0;s<j(r);s++)Hi.prototype.w0n.call(this,t,i)},o.prototype.gg=function(t){var i,n,e,n,r,s,i=this,n=i.sheet(),e=i.slicer();if(e&&n._lt(e))if(n=Ln(i,t),Jn(i)||5!==n[T]&&6!==n[T]&&8!==n[T])for(r=Zn(e),s=0;s<j(r);s++)Hi.prototype.gg.call(this,t);else t.stopPropagation()},o.prototype.bg=function(t){var i,n,e,t,r,s,o,c,u,a,t,c,t,f,h,l,v,i=this,n=i.sheet(),e=i.slicer();if(e&&n._lt(e)&&Jn(i)&&(t=Ln(i,t))){for(r=i.slicerData,s=i.imi,o=i.nmi,c=r.getExclusiveData(i.columnName),u=!1,a=y,4===t[T]||5===t[T]&&j(o)===j(c)&&!i.rmi&&!i.bmi?(t=r.getFilteredIndexes(i.columnName),a=n.Qy().execute({cmd:"unfilterSlicer",sheetName:n.name(),slicerData:r,columnName:i.columnName,value:t}),u=!0):s&&0<j(s)&&!i.rmi&&!i.bmi&&(c=r.getFilteredIndexes(i.columnName),t=o.concat(),a=n.Qy().execute({cmd:"filterSlicer",sheetName:n.name(),slicerData:r,columnName:i.columnName,oldValue:c,newValue:t}),u=!0),f=Zn(e),h=0,l=j(f);h<l;h++)(v=f[h]).hmi=!1,v.lmi=!1,u&&(v.imi=[],v.nmi=[]);return!!a}},o.prototype.pg=function(t){var i,n,e,r,s,i=this,n=i.sheet(),e=i.slicer();if(e&&!i.lmi&&n._lt(e))for(r=Zn(e),s=0;s<j(r);s++)Hi.prototype.pg.call(this,t)},o.prototype.dmi=function(){var t,i,t,n,e,t=this,i=t.sheet(),t=t.slicer();if(t&&i._lt(t))for(n=Zn(t),e=0;e<j(n);e++)Hi.prototype.dmi.call(this)},o.prototype.Mg=function(t){var i,n,n,n,e,i=this;return!(!Hi.prototype.Mg.call(this,t)&&(n=i.sheet())&&(n=(n=n.slicers)&&n.t1i(),e=i.qdi,!(n&&1===j(n)&&i.isSelected()&&i.Jdi()&&e)||(e.eS(t),t.stopPropagation(),0)))},o.prototype.bf=function(t){var i,n,e,r,t,t,t,r,i=this,n=i.slicerData,e=i.sheet(),r=i.nmi;17===t.keyCode&&i.rmi&&(i.rmi=!1),16===t.keyCode&&i.bmi&&(i.bmi=!1),!i.rmi&&!i.bmi&&0<j(i.imi)&&(t=j(n.getExclusiveData(i.columnName)),j(r)===t?(t=n.getFilteredIndexes(i.columnName),e.Qy().execute({cmd:"unfilterSlicer",sheetName:e.name(),slicerData:n,columnName:i.columnName,value:t})):(t=n.getFilteredIndexes(i.columnName),r=r.concat(),e.Qy().execute({cmd:"filterSlicer",sheetName:e.name(),slicerData:n,columnName:i.columnName,oldValue:t,newValue:r})),i.imi=[],i.nmi=[])},o.prototype.toJSON=function(){return{slicerName:this.name(),columnName:this.columnName}},(mi=o).prototype.isSelected=G("isSelected",!1),mi.prototype.sheet=G("sheet"),mi.prototype.slicer=G("slicer"),bi="nameInFormula",gi="captionName",t="columnCount",pi="columnName",U="itemHeight",H="showHeader",Si="sortState",wi="disableResizingAndMoving",_i="showNoDataItems",yi="showNoDataItemsInLast",Di="visuallyNoDataItems",Ci="isSelected",ji="dynamicMove",Oi="dynamicSize",Ii="tableName",Ni="Slicer",Ti=Ei=100,xi=192,Li=250,ki=[],Ui=W.FloatingObject,B(u,Ui),u.prototype.L0=function(t){var t;!1!==t&&((t=this).gmi&&(t.gmi.forEach(function(t){t.L0()}),t.gmi=y),t.LSt&&(t.LSt.L0(),t.LSt=y),t.sheet(y))},u.prototype.sourceName=function(){return this.IKt},u.prototype.cloneContent=function(){var t,i,n,n,t=this,i=t.sheet(),n=t.LSt,n=new mi(t.name(),n,t.columnName());return n.width(t.width(),!1),n.height(t.height(),!1),n.captionName(t.captionName()),n.columnCount(t.columnCount()),n.itemHeight(t.itemHeight()),n.showHeader(t.showHeader()),n.sortState(t.sortState()),n.isLocked(t.isLocked()),n.disableResizingAndMoving(t.disableResizingAndMoving()),n.showNoDataItems(t.showNoDataItems()),n.showNoDataItemsInLast(t.showNoDataItemsInLast()),n.visuallyNoDataItems(t.visuallyNoDataItems()),n.style(t.style().toJSONInternal()),n.zoomFactor(i.zoom()),n.isSelected(t.isSelected()),n.slicer(t),n.sheet()!==i&&n.sheet(i),t.gmi.push(n),n.getDOMElement()},u.prototype.i1i=function(){return this.LSt},u.prototype.Zdt=function(){return!1},u.prototype.s1i=function(t){for(var i,n,e,r,i=1,n,e=t,r=this.sheet().parent;(0,J.o1i)(r,e);)e=t+i,i++;return e},u.prototype.refresh=function(t){for(var i,n,i=this.gmi,n=0;n<j(i);n++)vn(i[n],t)},u.prototype.refreshContent=function(t){var i=this,n=i.sheet().zoom();n!==i.cNt&&(i.cNt=n,i.refresh(n))},u.prototype.clone=function(t){var i,t,i=this;return!i.sheet()&&t&&i.sheet(t,!1),(t=new u(i.name(),Kn(i),i.columnName())).sheet(i.sheet(),!1),t.fromJSON(i.toJSON(),!1,i.LSt),t},u.prototype.fromJSON=function(n,t,i){var e,r,s,o,c,o,i,u,c,o,r;n&&(e=this,r=n.tableName,s=n[pi],r)&&s&&(Ui.prototype.fromJSON.call(this,n),c=(o=e.sheet()).slicers,o=o.parent,(i=i||Yn(c,r))||zn(c,i=(u=o.r5t(r)).getSlicerData()),e.LSt=i,e[pi](s),c=n.x!==O?n.x:Ei,o=n.y!==O?n.y:Ti,e.position(new _.Point(c,o)),e[v](n[v]!==O?n[v]:xi,!1),e[m](n[m]!==O?n[m]:Li,!1),n.sourceName!==O&&(e.IKt=n.sourceName),ki.forEach(function(t){var i,i,i=n[t];i!==O&&(e[t](i,!1),t===wi)&&(i=e[t](),e.allowMove(!i,!1),e.allowResize(!i,!1))}),n.style!==O)&&((r=new z.SlicerStyle).fromJSON(n.style),e.style(r,!1))},u.prototype.toJSON=function(t){var n,e,i,r,s,r,o,n=this,e={};return e.type=n.ma,(i=["x","y",v,m,ji,Oi,"isLocked","fixedPosition"]).forEach(function(t){var i=n[t]();n[t].isDefault(i)&&t!==ji&&t!==Oi||(e[t]=i)}),(r=n.IKt)&&(e.sourceName=r),n[l]()&&(e[l]=n[l]().toJSON()),r=(s=n.LSt).getTable(),o=c(r.Gwt)?r[Ii]():r.Gwt,c(t)?e[st]=n.name():e[st]=n.s1i(n.name()),r[Ii]&&(e[Ii]=o),ki.forEach(function(t){var i=n[t]();t===l||n[t].isDefault(i)||t!==st&&(e[t]=i)}),e},u.prototype.ki=function(t){var i=this.sheet();i&&i.ki(_.Events.SlicerChanged,t)},M.DOMTableSlicer=Ri=u,Fi=[["name","",function(t,i,n){Gn(this,n,i)},J.checkSlicerName],[gi,"",F],[t,1,F,kn],[U,21,F,kn],[H,!0,F],[Si,1,F],[wi,!1,function(t,i,n){var e,i,e=this;e.allowMove(!i,!1),e.allowResize(!i,!1),F.call(e,wi,i,n),(i=e.sheet())&&i.zw()}],[_i,!0,F],[yi,!0,F],[Di,!0,F],[l,z.SlicerStyles.light1(),F],[pi,"",function(t,i,n){var e,r,e=this;e.IKt=i,e.captionName(i,!1),(r=e.sheet()).Ut.n1i(e,t,n,i)}]],i=0,li=j(Fi);i<li;i++)Ri.prototype[Fi[i][0]]=qn(Fi[i][0],Fi[i][1],Fi[i][2],Fi[i][3]);function qn(n,t,e,i){return ki.push(n),G(n,t,function(t,i){e.call(this,n,t,i)},i)}function F(t,i,n){for(var e,r,s,o,e=this,r=e.gmi||[],s=0;s<j(r);s++)r[s][t]&&("style"===t?r[s][t](i.toJSONInternal()):r[s][t](i));(o=e.sheet())&&(o.Ut.n1i(e,t,n,i),e.ki({sheet:o,sheetName:o.name(),slicer:e,propertyName:t}))}function Kn(t){return t.LSt.getTable()}function Zn(t){return t.gmi}Ri.prototype.nameInFormula=qn(bi,"",F,function(t){var i,n,i=this,n=i.sheet()&&i.sheet().parent;return!n||!n.K1i(t,i.ma)}),Ri.prototype.onPropertyChanged=F},Common:function(t){t.exports=i.Spread},Core:function(t){t.exports=i.Spread.Sheets},ConditionalFormatting:function(t){t.exports=i.Spread.Sheets.ConditionalFormatting},FloatingObject:function(t){t.exports=i.Spread.Sheets.FloatingObjects},Shapes:function(t){t.exports=i.Spread.Sheets.Shapes},Tables:function(t){t.exports=i.Spread.Sheets.Tables}},e={},t=r("./dist/plugins/slicer/slicer.entry.js"),(((i=void 0===i?{}:i).Spread=i.Spread||{}).Sheets=i.Spread.Sheets||{}).Slicers=t}()});