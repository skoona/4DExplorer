/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity/spread-sheets")):t(GC)}(function(n){!function(){"use strict";var i,e,t;function r(t){var n,n,n=e[t];return void 0!==n||(n=e[t]={exports:{}},i[t].call(n.exports,n,n.exports,r)),n.exports}i={"./dist/plugins/formulaPanel/editor/codemirror/index.js":function(T,L){var k,B,_,N,U,H,W,V,$,q,G,f,J,K,Q,X,O,Z,y,Y,tt,w,nt,it,et,rt,ot,ut,st,at,ht,ft,ct,lt,vt,dt,yt,mt,pt,kt,gt,wt,bt,v,Mt,xt,c,St,Ct,C,t,jt,Pt,j,Ot,Et,At,Dt,Rt,It,Tt,Lt,Bt,_t,Ft,Nt,Ut,Ht,zt,n,Wt,Vt,$t,qt,Gt,Jt,Kt,Qt,Xt,l,Zt,n,zt,i,e,r,Yt,o,tn,nn,en,rn,g,on,un,sn,an,hn,fn,Yt,P,m,cn,ln,vn,dn,yn,mn,pn,kn,gn,wn,bn,Mn,xn,Sn,Cn,jn,Pn,On,En,An,Dn,u,Rn,In,Tn,Ln,Bn,_n,Fn,Nn,Un,E,Hn,zn,Wn,Vn,$n,qn,Gn,Jn,Kn,Qn,Kn,Xn,Zn,z,Yn,ti,ni,ii,ei,ri,oi,ui,si,ai,hi,fi,ci,li,s,vi,di,yi,mi,pi,ki,gi,wi,bi,Mi,xi,Si,Ci,ji,d,Pi,Oi,Ei,Ai,Di,Ri,Ii,Ti,Li,Bi,_i,Fi,Ni,Ui,Hi,zi,Wi,Vi,$i,qi,Gi,Ji,Ki,Qi,Xi,Zi,p,Yi,te,ne,ie,o,ee,re,oe,ue,se,ae,he,fe,ce,le,ve,tn,de,ye,me,pe,ke,ge,we,be,Me,xe,Se,Ce,je,Pe,Oe,Ee,Ae,De,Re,Ie,Te,Le,Be,_e,Fe,Ne,rn,Ue,He,ze,We,Ve,$e,qe,n,Ge,Je,Ke,Qe,en,Xe,Ze,Ye,tr,nr,ir,er,rr,or,ur,sr,ar,hr,fr,cr,lr,vr,nn,dr,yr,mr,pr,M,kr,gr,zt,wr,br,Mr,b,xr,Sr,Cr,jr,Pr,Or,Er,Ar,Dr,Rr,Ir,Tr,Lr,Br,_r,Fr,Nr,r,i,o,tn,rn,nn,n,e,a,Ur,Hr,zr,Wr,Vr,$r,h,tn,qr,Gr,Jr,i,Kr,Qr,Xr,Zr,Yr,to,no,io,rn,o,eo,ro,oo,uo,so,n,ao,ho,fo,co,lo,vo,nn,Hr,zr,Wr,e,Vr,yo,mo,po,ko,go,wo,bo,Mo,xo,So,Co,Ur,a,jo,Po,Oo,Eo,Ao,r,Do,Ro,Io,To,$r,Lo,Bo,_o,Fo,No,Uo,Ho,zo,Wo,Vo,Wo,$o,qo,Go,Jo,Ko,Qo,Xo,Zo,Yo,tu,nu,tn,r,a,iu,eu,ru,ou,uu,su,au,hu,fu,cu,lu,vu,du,yu,mu,pu,ku,gu,wu,bu,Mu,xu,Su,Cu,ju,o,zt,i,Pu,Ou,Eu,Au,Du,rn,Ru,Iu,Tu,Lu,Bu,_u,Fu,$r,n,Nu,Uu,Hu,zu,zr,Wu,nn,e,Wr,Hr,t,Vu,$u,qu,Gu,Ju,Ku,Qu,tn,Xu,Zu,o,a,rn,$r,Yu,ts,ns,is,es,zt,rs,os,i,r,us,ss,as,hs,fs,cs,ls,vs,ds,ys,ms,ps,ks,gs,ws,bs,Ms,xs,Ss,Cs,js,Ps,Os,Es,As,Ds,Rs,Is,Ts,Ls,Bs,_s,Fs,Ns,Us,Hs,zs,Ws,Vs,$s,qs,Gs,Js,Ks,Qs,Xs,Zs,Ys,ta,na,ia,ea,ra,oa,ua,sa,aa,ha,fa,ca,la,va,da,ya,ma,pa,ka,ga,wa,ba,Ma,xa,Sa,Ca,ja,Pa,Oa,Ea,Aa,Da,Ra,Ia,Ta,La,Ba,Hr,_a,t,ma,Fa,Na,Ua,Ha,za,ya,Wa,Va,$a,qa,Ga,Ja,Ka,Qa,Xa,Za,Ya,th,nh,ih,eh,rh,oh,uh,sh,r,ah,hh,fh,ch,lh,vh,dh,yh,i,mh,ph,rs,kh,gh,wh,bh,Mh,xh,Sh,Ch,os,jh,Ph,Oh,Ks,Eh,Ah,Dh,Rh,Js,Ih,Th,Lh,hs,Bh,_h,Fh,Nh,Uh,Hh,zh,t,Wh,Vh,t,$h,qh,Gh,Jh,Kh,Qh,Xh,Zh,Yh,tf,e,nf,ef,rf,of,uf,sf,af,hf,ff,cf,lf,vf,df,yf,r,mf,pf,kf,gf,wf,bf,i,Mf,xf,Sf,Cf,jf,Pf,Of,Ef,Af,Df,Rf,If,Tf,Lf,Bf,_f,Ff,Nf,Uf,Hf,zf,Wf,e,Vf,$f,qf,Gf,Jf,Kf,Qf,Xf,Zf,Yf,tc,nc,ic,ec,rc,oc,uc,sc,ac,hc,fc,cc,lc,vc;function dc(t,n,i){return(n=Tc(n))in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function yc(t){return kc(t)||pc(t)||xc(t)||mc()}function mc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pc(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function kc(t){if(Array.isArray(t))return Sc(t)}function gc(t,n){return Mc(t)||bc(t,n)||xc(t,n)||wc()}function wc(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bc(t,n){var i,e,r,o,u,s,a,h,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){s=[],h=!(a=!0);try{if(o=(i=i.call(t)).next,0===n){if(Object(i)!==i)return;a=!1}else for(;!(a=(e=o.call(i)).done)&&(s.push(e.value),s.length!==n);a=!0);}catch(t){h=!0,r=t}finally{try{if(!a&&null!=i.return&&(u=i.return(),Object(u)!==u))return}finally{if(h)throw r}}return s}}function Mc(t){if(Array.isArray(t))return t}function F(n,t){var i,e,t,r,o,u,i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(i)return o=!(r=!0),{s:function t(){i=i.call(n)},n:function t(){var n=i.next();return r=n.done,n},e:function t(n){o=!0,u=n},f:function t(){try{r||null==i.return||i.return()}finally{if(o)throw u}}};if(Array.isArray(n)||(i=xc(n))||t&&n&&"number"==typeof n.length)return i&&(n=i),e=0,{s:t=function t(){},n:function t(){return e>=n.length?{done:!0}:{done:!1,value:n[e++]}},e:function t(n){throw n},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xc(t,n){var i;if(t)return"string"==typeof t?Sc(t,n):"Map"===(i="Object"===(i=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Sc(t,n):void 0}function Sc(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}function Cc(){return(Cc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function t(n,i,e){var r,r,r=jc(n,i);if(r)return(r=Object.getOwnPropertyDescriptor(r,i)).get?r.get.call(arguments.length<3?n:e):r.value}).apply(this,arguments)}function jc(t,n){for(;!Object.prototype.hasOwnProperty.call(t,n)&&null!==(t=Dc(t)););return t}function x(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&Pc(t,n)}function Pc(t,n){return(Pc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(n,i){return n.__proto__=i,n})(t,n)}function S(e){var r=Ac();return function t(){var n,i,i,n=Dc(e),i=r?(i=Dc(this).constructor,Reflect.construct(n,arguments,i)):n.apply(this,arguments);return Oc(this,i)}}function Oc(t,n){if(n&&("object"===Rc(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Ec(t)}function Ec(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ac(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function Dc(t){return(Dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(n){return n.__proto__||Object.getPrototypeOf(n)})(t)}function Rc(t){return(Rc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function Ic(t,n){for(var i,e,i=0;i<n.length;i++)(e=n[i]).enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,Tc(e.key),e)}function D(t,n,i){return n&&Ic(t.prototype,n),i&&Ic(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tc(t){var t=Lc(t,"string");return"symbol"===Rc(t)?t:String(t)}function Lc(t,n){var i,i;if("object"!==Rc(t)||null===t)return t;if(void 0===(i=t[Symbol.toPrimitive]))return("string"===n?String:Number)(t);if("object"!==Rc(i=i.call(t,n||"default")))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}function Bc(){A(this,Bc)}function _c(t){var n,i,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Nc(t);return A(this,_c),(n=Uh.call(this)).text=t,n.length=i,n}function Fc(t,n){var i,e,r,o;A(this,Fc),(i=zh.call(this)).children=t,i.length=n,i.lines=0,e=F(t);try{for(e.s();!(r=e.n()).done;)o=r.value,i.lines+=o.lines}catch(t){e.e(t)}finally{e.f()}return i}function Nc(t){var n,i,e,r,n=-1,i=F(t);try{for(i.s();!(e=i.n()).done;)n+=(r=e.value).length+1}catch(t){i.e(t)}finally{i.f()}return n}function Uc(t,n,i,e){for(var r,o,u,s,a,h,f,r=2<arguments.length&&void 0!==i?i:0,o=3<arguments.length&&void 0!==e?e:1e9,u=0,s=0,a=!0;s<t.length&&u<=o;s++)r<=(f=u+(h=t[s]).length)&&(o<f&&(h=h.slice(0,o-u)),u<r&&(h=h.slice(r-u)),a?(n[n.length-1]+=h,a=!1):n.push(h)),u=f+1;return n}function Hc(t,n,i){return Uc(t,[""],n,i)}function zc(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;A(this,zc),this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[0<n?1:(t instanceof B?t.text:t.children).length<<1]}function Wc(t,n,i){A(this,Wc),this.value="",this.done=!1,this.cursor=new N(t,i<n?-1:1),this.pos=i<n?t.length:0,this.from=Math.min(n,i),this.to=Math.max(n,i)}function Vc(t){A(this,Vc),this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}function $c(t,n,i,e){A(this,$c),this.from=t,this.to=n,this.number=i,this.text=e}for(Object.defineProperty(L,"__esModule",{value:!0}),L.basicSetup=L.View=L.State=L.Search=L.Lint=L.Language=L.Commands=L.Autocomplete=void 0,D(Bc,[{key:"lineAt",value:function t(n){if(n<0||n>this.length)throw new RangeError("Invalid position ".concat(n," in document of length ").concat(this.length));return this.lineInner(n,!1,1,0)}},{key:"line",value:function t(n){if(n<1||n>this.lines)throw new RangeError("Invalid line number ".concat(n," in ").concat(this.lines,"-line document"));return this.lineInner(n,!0,1,0)}},{key:"replace",value:function t(n,i,e){var r=[];return this.decompose(0,n,r,2),e.length&&e.decompose(0,e.length,r,3),this.decompose(i,this.length,r,1),_.from(r,this.length-(i-n)+e.length)}},{key:"append",value:function t(n){return this.replace(this.length,this.length,n)}},{key:"slice",value:function t(n){var i,e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length,e=[];return this.decompose(n,i,e,0),_.from(e,i-n)}},{key:"eq",value:function t(n){var i,e,r,o,u,s;if(n==this)return!0;if(n.length!=this.length||n.lines!=this.lines)return!1;for(i=this.scanIdentical(n,1),e=this.length-this.scanIdentical(n,-1),r=new N(this),o=new N(n),s=u=i;;){if(r.next(u),o.next(u),u=0,r.lineBreak!=o.lineBreak||r.done!=o.done||r.value!=o.value)return!1;if(s+=r.value.length,r.done||e<=s)return!0}}},{key:"iter",value:function t(){var n;return new N(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:1)}},{key:"iterRange",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length;return new U(this,n,i)}},{key:"iterLines",value:function t(n,i){var n,n,n=null==n?this.iter():(null==i&&(i=this.lines+1),n=this.line(n).from,this.iterRange(n,Math.max(n,i==this.lines+1?this.length:i<=1?0:this.line(i-1).to)));return new H(n)}},{key:"toString",value:function t(){return this.sliceString(0)}},{key:"toJSON",value:function t(){var n=[];return this.flatten(n),n}}],[{key:"of",value:function t(n){if(0==n.length)throw new RangeError("A document must have at least one line");return 1!=n.length||n[0]?n.length<=32?new B(n):_.from(B.split(n,[])):Bc.empty}}]),x(_c,k=Bc),Uh=S(_c),D(_c,[{key:"lines",get:function t(){return this.text.length}},{key:"children",get:function t(){return null}},{key:"lineInner",value:function t(n,i,e,r){for(var o,u,s,o=0;;o++){if(s=r+(u=this.text[o]).length,n<=(i?e:s))return new W(r,s,e,u);r=s+1,e++}}},{key:"decompose",value:function t(n,i,e,r){var i,n,r,n,i=n<=0&&i>=this.length?this:new _c(Hc(this.text,n,i),Math.min(i,this.length)-Math.max(0,n));1&r?(n=e.pop(),(r=Uc(i.text,n.text.slice(),0,i.length)).length<=32?e.push(new _c(r,n.length+i.length)):(n=r.length>>1,e.push(new _c(r.slice(0,n)),new _c(r.slice(n))))):e.push(i)}},{key:"replace",value:function t(n,i,e){var r,o;return e instanceof _c?(r=Uc(this.text,Uc(e.text,Hc(this.text,0,n)),i),o=this.length+e.length-(i-n),r.length<=32?new _c(r,o):_.from(_c.split(r,[]),o)):Cc(Dc(_c.prototype),"replace",this).call(this,n,i,e)}},{key:"sliceString",value:function t(n){for(var i,e,r,o,u,s,a,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"\n",r="",o=0,u=0;o<=i&&u<this.text.length;u++)n<o&&u&&(r+=e),n<(a=o+(s=this.text[u]).length)&&o<i&&(r+=s.slice(Math.max(0,n-o),i-o)),o=a+1;return r}},{key:"flatten",value:function t(n){var i,e,r,i=F(this.text);try{for(i.s();!(e=i.n()).done;)r=e.value,n.push(r)}catch(t){i.e(t)}finally{i.f()}}},{key:"scanIdentical",value:function t(){return 0}}],[{key:"split",value:function t(n,i){var e,r,o,u,s,e=[],r=-1,o=F(n);try{for(o.s();!(u=o.n()).done;)s=u.value,e.push(s),r+=s.length+1,32==e.length&&(i.push(new _c(e,r)),e=[],r=-1)}catch(t){o.e(t)}finally{o.f()}return-1<r&&i.push(new _c(e,r)),i}}]),B=_c,x(Fc,k),zh=S(Fc),D(Fc,[{key:"lineInner",value:function t(n,i,e,r){for(var o,u,s,a,o=0;;o++){if(s=r+(u=this.children[o]).length,a=e+u.lines-1,n<=(i?a:s))return u.lineInner(n,i,e,r);r=s+1,e=1+a}}},{key:"decompose",value:function t(n,i,e,r){for(var o,u,s,a,h,o=0,u=0;u<=i&&o<this.children.length;o++)n<=(a=u+(s=this.children[o]).length)&&u<=i&&(h=r&((u<=n?1:0)|(i<=a?2:0)),n<=u&&a<=i&&!h?e.push(s):s.decompose(n-u,i-u,e,h)),u=a+1}},{key:"replace",value:function t(n,i,e){var r,o,u,s,a,u,u;if(e.lines<this.lines)for(o=r=0;r<this.children.length;r++){if(s=o+(u=this.children[r]).length,o<=n&&i<=s)return a=u.replace(n-o,i-o,e),u=this.lines-u.lines+a.lines,a.lines<u>>4&&a.lines>u>>6?((u=this.children.slice())[r]=a,new Fc(u,this.length-(i-n)+e.length)):Cc(Dc(Fc.prototype),"replace",this).call(this,o,s,a);o=s+1}return Cc(Dc(Fc.prototype),"replace",this).call(this,n,i,e)}},{key:"sliceString",value:function t(n){for(var i,e,r,o,u,s,a,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.length,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"\n",r="",o=0,u=0;o<this.children.length&&u<=i;o++)n<u&&o&&(r+=e),n<(a=u+(s=this.children[o]).length)&&u<i&&(r+=s.sliceString(n-u,i-u,e)),u=a+1;return r}},{key:"flatten",value:function t(n){var i,e,r,i=F(this.children);try{for(i.s();!(e=i.n()).done;)(r=e.value).flatten(n)}catch(t){i.e(t)}finally{i.f()}}},{key:"scanIdentical",value:function t(n,i){var e,r,o,u,s,a,h,f,c;if(!(n instanceof Fc))return 0;for(u=(o=gc(r=(e=0)<i?[0,0,this.children.length,n.children.length]:[this.children.length-1,n.children.length-1,-1,-1],4))[0],s=o[1],a=o[2],h=o[3];;u+=i,s+=i){if(u==a||s==h)return e;if((f=this.children[u])!=(c=n.children[s]))return e+f.scanIdentical(c,i);e+=f.length+1}}}],[{key:"from",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.reduce(function(t,n){return t+n.length+1},-1),e=0,r=F(n);try{for(r.s();!(o=r.n()).done;)e+=(u=o.value).lines}catch(t){r.e(t)}finally{r.f()}if(e<32){s=[],a=F(n);try{for(a.s();!(h=a.n()).done;)(f=h.value).flatten(s)}catch(t){a.e(t)}finally{a.f()}return new B(s,i)}function b(t){var n,i,e,r;if(t.lines>l&&t instanceof Fc){i=F(t.children);try{for(i.s();!(e=i.n()).done;)b(r=e.value)}catch(t){i.e(t)}finally{i.f()}}else t.lines>v&&(v<y||!y)?(M(),d.push(t)):t instanceof B&&y&&(n=p[p.length-1])instanceof B&&t.lines+n.lines<=32?(y+=t.lines,m+=t.length+1,p[p.length-1]=new B(n.text.concat(t.text),n.length+1+t.length)):(y+t.lines>c&&M(),y+=t.lines,m+=t.length+1,p.push(t))}function M(){0!=y&&(d.push(1==p.length?p[0]:Fc.from(p,m)),m=-1,y=p.length=0)}c=Math.max(32,e>>5),l=c<<1,v=c>>1,d=[],y=0,m=-1,p=[],k=F(n);try{for(k.s();!(g=k.n()).done;)b(w=g.value)}catch(t){k.e(t)}finally{k.f()}return M(),1==d.length?d[0]:new Fc(d,i)}}]),_=Fc,k.empty=new B([""],0),D(zc,[{key:"nextInner",value:function t(n,i){var e,r,o,u,s,s,o;for(this.done=this.lineBreak=!1;;)if(e=this.nodes.length-1,r=this.nodes[e],u=(o=this.offsets[e])>>1,s=(r instanceof B?r.text:r.children).length,u==(0<i?s:0)){if(0==e)return this.done=!0,this.value="",this;0<i&&this.offsets[e-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&o)==(0<i?0:1)){if(this.offsets[e]+=i,0==n)return this.lineBreak=!0,this.value="\n",this;n--}else if(r instanceof B){if(s=r.text[u+(i<0?-1:0)],this.offsets[e]+=i,s.length>Math.max(0,n))return this.value=0==n?s:0<i?s.slice(n):s.slice(0,s.length-n),this;n-=s.length}else n>(o=r.children[u+(i<0?-1:0)]).length?(n-=o.length,this.offsets[e]+=i):(i<0&&this.offsets[e]--,this.nodes.push(o),this.offsets.push(0<i?1:(o instanceof B?o.text:o.children).length<<1))}},{key:"next",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return n<0&&(this.nextInner(-n,-this.dir),n=this.value.length),this.nextInner(n,this.dir)}}]),N=zc,D(Wc,[{key:"nextInner",value:function t(n,i){var e,r,o;return(i<0?this.pos<=this.from:this.pos>=this.to)?(this.value="",this.done=!0):(n+=Math.max(0,i<0?this.pos-this.to:this.from-this.pos),e=i<0?this.pos-this.from:this.to-this.pos,e-=n=e<n?e:n,o=(r=this.cursor.next(n)).value,this.pos+=(o.length+n)*i,this.value=o.length<=e?o:i<0?o.slice(o.length-e):o.slice(0,e),this.done=!this.value),this}},{key:"next",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return n<0?n=Math.max(n,this.from-this.pos):0<n&&(n=Math.min(n,this.to-this.pos)),this.nextInner(n,this.cursor.dir)}},{key:"lineBreak",get:function t(){return this.cursor.lineBreak&&""!=this.value}}]),U=Wc,D(Vc,[{key:"next",value:function t(){var n,i,e,r,i,n,i=this.inner.next(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0),e=i.done,r=i.lineBreak,i=i.value;return e?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}},{key:"lineBreak",get:function t(){return!1}}]),H=Vc,"undefined"!=typeof Symbol&&(k.prototype[Symbol.iterator]=function(){return this.iter()},N.prototype[Symbol.iterator]=U.prototype[Symbol.iterator]=H.prototype[Symbol.iterator]=function(){return this}),D($c,[{key:"length",get:function t(){return this.to-this.from}}]),W=$c,V="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(function(t){return t?parseInt(t,36):1}),$=1;$<V.length;$++)V[$]+=V[$-1];function qc(t){for(var n=1;n<V.length;n+=2)if(V[n]>t)return V[n-1]<=t}function Gc(t){return 127462<=t&&t<=127487}function Jc(t,n){var i,e,i,e;return(!(2<arguments.length&&void 0!==arguments[2])||arguments[2]?Kc:Qc)(t,n,!(3<arguments.length&&void 0!==arguments[3])||arguments[3])}function Kc(t,n,i){var e,r,o,u;if(n!=t.length)for(n&&Xc(t.charCodeAt(n))&&Zc(t.charCodeAt(n-1))&&n--,n+=nl(e=Yc(t,n));n<t.length;)if(r=Yc(t,n),e==q||r==q||i&&qc(r))n+=nl(r),e=r;else{if(!Gc(r))break;for(o=0,u=n-2;0<=u&&Gc(Yc(t,u));)o++,u-=2;if(o%2==0)break;n+=2}return n}function Qc(t,n,i){for(;0<n;){var e=Kc(t,n-2,i);if(e<n)return e;n--}return 0}function Xc(t){return 56320<=t&&t<57344}function Zc(t){return 55296<=t&&t<56320}function Yc(t,n){var i,t,i=t.charCodeAt(n);return Zc(i)&&n+1!=t.length&&Xc(t=t.charCodeAt(n+1))?t-56320+(i-55296<<10)+65536:i}function tl(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function nl(t){return t<65536?1:2}function il(t){A(this,il),this.sections=t}function el(t,n){var t;return A(this,el),(t=Vh.call(this,t)).inserted=n,t}function rl(t,n,i,e){var e,r,e=3<arguments.length&&void 0!==e&&e;0==n&&i<=0||(0<=(r=t.length-2)&&i<=0&&i==t[1+r]?t[r]+=n:0==n&&0==t[r]?t[1+r]+=i:e?(t[r]+=n,t[1+r]+=i):t.push(n,i))}function ol(t,n,i){if(0!=i.length){var e=n.length-2>>1;if(e<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<e;)t.push(k.empty);t.push(i)}}}function ul(t,n,i){for(var e,r,o,u,s,a,h,f,c,e=t.inserted,r=0,o=0,u=0;u<t.sections.length;)if(s=t.sections[u++],(a=t.sections[u++])<0)r+=s,o+=s;else{for(h=r,f=o,c=k.empty;h+=s,f+=a,a&&e&&(c=c.append(e[u-2>>1])),!(i||u==t.sections.length||t.sections[u+1]<0);)s=t.sections[u++],a=t.sections[u++];n(r,h,o,f,c),r=h,o=f}}function sl(t,n,i,e){for(var r,o,u,s,a,h,f,c,l,v,d,y,r,o=[],u=3<arguments.length&&void 0!==e&&e?[]:null,s=new Q(t),a=new Q(n),h=-1;;)if(-1==s.ins&&-1==a.ins)rl(o,f=Math.min(s.len,a.len),-1),s.forward(f),a.forward(f);else if(0<=a.ins&&(s.ins<0||h==s.i||0==s.off&&(a.len<s.len||a.len==s.len&&!i))){for(c=a.len,rl(o,a.ins,-1);c;)l=Math.min(s.len,c),0<=s.ins&&h<s.i&&s.len<=l&&(rl(o,0,s.ins),u&&ol(u,o,s.text),h=s.i),s.forward(l),c-=l;a.next()}else{if(!(0<=s.ins)){if(s.done&&a.done)return u?K.createSet(o,u):J.create(o);throw new Error("Mismatched change set lengths")}for(v=0,d=s.len;d;)if(-1==a.ins)v+=y=Math.min(d,a.len),d-=y,a.forward(y);else{if(!(0==a.ins&&a.len<d))break;d-=a.len,a.next()}rl(o,v,h<s.i?s.ins:0),u&&h<s.i&&ol(u,o,s.text),h=s.i,s.forward(s.len-d)}}function al(t,n,i){for(var e,r,o,u,s,a,h,f,c,e,r=[],o=2<arguments.length&&void 0!==i&&i?[]:null,u=new Q(t),s=new Q(n),a=!1;;){if(u.done&&s.done)return o?K.createSet(r,o):J.create(r);if(0==u.ins)rl(r,u.len,0,a),u.next();else if(0!=s.len||s.done){if(u.done||s.done)throw new Error("Mismatched change set lengths");h=Math.min(u.len2,s.len),f=r.length,-1==u.ins?(rl(r,h,c=-1==s.ins?-1:s.off?0:s.ins,a),o&&c&&ol(o,r,s.text)):-1==s.ins?(rl(r,u.off?0:u.len,h,a),o&&ol(o,r,u.textBit(h))):(rl(r,u.off?0:u.len,s.off?0:s.ins,a),o&&!s.off&&ol(o,r,s.text)),a=(u.ins>h||0<=s.ins&&s.len>h)&&(a||f<r.length),u.forward2(h),s.forward(h)}else rl(r,0,s.ins,a),o&&ol(o,r,s.text),s.next()}}function hl(t){A(this,hl),this.set=t,this.i=0,this.next()}function fl(t,n,i){A(this,fl),this.from=t,this.to=n,this.flags=i}function cl(t,n){A(this,cl),this.ranges=t,this.mainIndex=n}function ll(t,n){var i,e,r,i=F(t.ranges);try{for(i.s();!(e=i.n()).done;)if((r=e.value).to>n)throw new RangeError("Selection points outside of document")}catch(t){i.e(t)}finally{i.f()}}function vl(t,n,i,e,r){A(this,vl),this.combine=t,this.compareInput=n,this.compare=i,this.isStatic=e,this.id=Z++,this.default=t([]),this.extensions="function"==typeof r?r(this):r}function dl(t,i){return t==i||t.length==i.length&&t.every(function(t,n){return t===i[n]})}function yl(t,n,i,e){A(this,yl),this.dependencies=t,this.facet=n,this.type=i,this.value=e,this.id=Z++}function ml(t,n,i){if(t.length==n.length){for(var e=0;e<t.length;e++)if(!i(t[e],n[e]))return;return 1}}function pl(t,n){var i,e,r,o,i=!1,e=F(n);try{for(e.s();!(r=e.n()).done;)1&Sl(t,o=r.value)&&(i=!0)}catch(t){e.e(t)}finally{e.f()}return i}function kl(n,s,o){var a,h,r,u;function f(t){for(var n,i,e,r,o,u,n=[],i=0;i<a.length;i++)if(e=Cl(t,a[i]),2==h[i]){r=F(e);try{for(r.s();!(o=r.n()).done;)u=o.value,n.push(u)}catch(t){r.e(t)}finally{r.f()}}else n.push(e);return s.combine(n)}return a=o.map(function(t){return n[t.id]}),h=o.map(function(t){return t.type}),r=a.filter(function(t){return!(1&t)}),u=n[s.id]>>1,{create:function t(n){var i,e,r,i=F(a);try{for(i.s();!(e=i.n()).done;)Sl(n,r=e.value)}catch(t){i.e(t)}finally{i.f()}return n.values[u]=f(n),1},update:function t(n,i){var e;return!pl(n,r)||(e=f(n),s.compare(e,n.values[u]))?0:(n.values[u]=e,1)},reconfigure:function t(n,i){var e,r,i,e,e=pl(n,a),r=i.config.facets[s.id],i=i.facet(s);return r&&!e&&dl(o,r)||(e=f(n),s.compare(e,i))?(n.values[u]=i,0):(n.values[u]=e,1)}}}function gl(t,n,i,e,r){A(this,gl),this.id=t,this.createF=n,this.updateF=i,this.compareF=e,this.spec=r,this.provides=void 0}function wl(n){return function(t){return new at(t,n)}}function bl(){A(this,bl)}function Ml(t,n,i,e,r,o){for(A(this,Ml),this.base=t,this.compartments=n,this.dynamicSlots=i,this.address=e,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}function xl(t,s,a){var h,f;function c(t,n){var i,e,r,o,u,i,e,i=f.get(t);if(null!=i){if(i<=n)return;-1<(e=h[i].indexOf(t))&&h[i].splice(e,1),t instanceof ft&&a.delete(t.compartment)}if(f.set(t,n),Array.isArray(t)){r=F(t);try{for(r.s();!(o=r.n()).done;)c(u=o.value,n)}catch(t){r.e(t)}finally{r.f()}}else if(t instanceof ft){if(a.has(t.compartment))throw new RangeError("Duplicate use of compartment in extensions");i=s.get(t.compartment)||t.inner,a.set(t.compartment,i),c(i,n)}else if(t instanceof at)c(t.inner,t.prec);else if(t instanceof w)h[n].push(t),t.provides&&c(t.provides,n);else if(t instanceof Y)h[n].push(t),t.facet.extensions&&c(t.facet.extensions,rt);else{if(!(e=t.extension))throw new Error("Unrecognized extension value in extension set (".concat(t,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));c(e,n)}}return h=[[],[],[],[],[]],f=new Map,c(t,rt),h.reduce(function(t,n){return t.concat(n)})}function Sl(t,n){var n,i,i;if(1&n)return 2;if(4==(i=t.status[n=n>>1]))throw new Error("Cyclic dependency between fields and/or facets");return 2&i?i:(t.status[n]=4,i=t.computeSlot(t,t.config.dynamicSlots[n]),t.status[n]=2|i)}function Cl(t,n){return(1&n?t.config.staticValues:t.values)[n>>1]}function jl(t,n){A(this,jl),this.type=t,this.value=n}function Pl(){A(this,Pl)}function Ol(t){A(this,Ol),this.map=t}function El(t,n){A(this,El),this.type=t,this.value=n}function Al(t,n,i,e,r,o){A(this,Al),this.startState=t,this.changes=n,this.selection=i,this.effects=e,this.annotations=r,this.scrollIntoView=o,this.Qae=null,this.Kh=null,i&&ll(i,n.newLength),r.some(function(t){return t.type==Al.time})||(this.annotations=r.concat(Al.time.of(Date.now())))}function Dl(t,n){for(var i,e,r,o,u,i=[],e=0,r=0;;){if(u=o=void 0,e<t.length&&(r==n.length||n[r]>=t[e]))o=t[e++],u=t[e++];else{if(!(r<n.length))return i;o=n[r++],u=n[r++]}!i.length||i[i.length-1]<o?i.push(o,u):i[i.length-1]<u&&(i[i.length-1]=u)}}function Rl(t,n,i){var i,e,r,i,i=i?(e=n.changes,r=K.empty(n.changes.length),t.changes.compose(n.changes)):(e=n.changes.map(t.changes),r=t.changes.mapDesc(n.changes,!0),t.changes.compose(e));return{changes:i,selection:n.selection?n.selection.map(r):null==(i=t.selection)?void 0:i.map(e),effects:v.mapEffects(t.effects,e).concat(v.mapEffects(n.effects,r)),annotations:t.annotations.length?t.annotations.concat(n.annotations):n.annotations,scrollIntoView:t.scrollIntoView||n.scrollIntoView}}function Il(t,n,i){var e=n.selection,r=_l(n.annotations);return n.userEvent&&(r=r.concat(Mt.userEvent.of(n.userEvent))),{changes:n.changes instanceof K?n.changes:K.of(n.changes||[],i,t.facet(dt)),selection:e&&(e instanceof O?e:O.single(e.anchor,e.head)),effects:_l(n.effects),annotations:r,scrollIntoView:!!n.scrollIntoView}}function Tl(t,n,i){var e,r,o,u,e=Il(t,n.length?n[0]:{},t.doc.length);for(n.length&&!1===n[0].filter&&(i=!1),r=1;r<n.length;r++)!1===n[r].filter&&(i=!1),o=!!n[r].sequential,e=Rl(e,Il(t,n[r],o?e.changes.newLength:t.doc.length),o);return u=Mt.create(t,e.changes,e.selection,e.effects,e.annotations,e.scrollIntoView),Bl(i?Ll(u):u)}function Ll(t){var n,i,e,r,o,u,s,a,h,f,c,l,n=t.startState,i=!0,e=F(n.facet(yt));try{for(e.s();!(r=e.n()).done;){if(!1===(u=(o=r.value)(t))){i=!1;break}Array.isArray(u)&&(i=!0===i?u:Dl(i,u))}}catch(t){e.e(t)}finally{e.f()}for(!0!==i&&(!1===i?(a=t.changes.invertedDesc,s=K.empty(n.doc.length)):(s=(h=t.changes.filter(i)).changes,a=h.filtered.mapDesc(h.changes).invertedDesc),t=Mt.create(n,s,t.selection&&t.selection.map(a),v.mapEffects(t.effects,a),t.annotations,t.scrollIntoView)),c=(f=n.facet(mt)).length-1;0<=c;c--)t=(l=f[c](t))instanceof Mt?l:Array.isArray(l)&&1==l.length&&l[0]instanceof Mt?l[0]:Tl(n,_l(l),!1);return t}function Bl(t){for(var n,i,e,r,o,n=t.startState,i=n.facet(pt),e=t,r=i.length-1;0<=r;r--)(o=i[r](t))&&Object.keys(o).length&&(e=Rl(e,Il(n,o,t.changes.newLength),!0));return e==t?t:Mt.create(n,t.changes,t.selection,e.effects,e.annotations,e.scrollIntoView)}function _l(t){return null==t?xt:Array.isArray(t)?t:[t]}q=8205,G=/\r\n?|\n/,(t=f=f||{})[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",f=t,D(il,[{key:"length",get:function t(){for(var n,i,n=0,i=0;i<this.sections.length;i+=2)n+=this.sections[i];return n}},{key:"newLength",get:function t(){for(var n,i,e,n=0,i=0;i<this.sections.length;i+=2)n+=(e=this.sections[i+1])<0?this.sections[i]:e;return n}},{key:"empty",get:function t(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}},{key:"iterGaps",value:function t(n){for(var i,e,r,o,u,i=0,e=0,r=0;i<this.sections.length;)o=this.sections[i++],(u=this.sections[i++])<0?(n(e,r,o),r+=o):r+=u,e+=o}},{key:"iterChangedRanges",value:function t(n){var i;ul(this,n,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}},{key:"invertedDesc",get:function t(){for(var n,i,e,r,n=[],i=0;i<this.sections.length;)e=this.sections[i++],(r=this.sections[i++])<0?n.push(e,r):n.push(r,e);return new il(n)}},{key:"composeDesc",value:function t(n){return this.empty?n:n.empty?this:al(this,n)}},{key:"mapDesc",value:function t(n){var i;return n.empty?this:sl(this,n,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}},{key:"mapPos",value:function t(n){for(var i,e,r,o,u,s,a,h,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:f.Simple,r=0,o=0,u=0;u<this.sections.length;){if(h=r+(s=this.sections[u++]),(a=this.sections[u++])<0){if(n<h)return o+(n-r);o+=s}else{if(e!=f.Simple&&n<=h&&(e==f.TrackDel&&r<n&&n<h||e==f.TrackBefore&&r<n||e==f.TrackAfter&&n<h))return null;if(n<h||h==n&&i<0&&!s)return n==r||i<0?o:o+a;o+=a}r=h}if(r<n)throw new RangeError("Position ".concat(n," is out of range for changeset of length ").concat(r));return o}},{key:"touchesRange",value:function t(n){for(var i,e,r,o,u,s,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n,e=0,r=0;e<this.sections.length&&r<=i;){if(s=r+(o=this.sections[e++]),0<=(u=this.sections[e++])&&r<=i&&n<=s)return!(r<n&&i<s)||"cover";r=s}return!1}},{key:"toString",value:function t(){for(var n,i,e,r,n="",i=0;i<this.sections.length;)n+=(n?" ":"")+(e=this.sections[i++])+(0<=(r=this.sections[i++])?":"+r:"");return n}},{key:"toJSON",value:function t(){return this.sections}}],[{key:"fromJSON",value:function t(n){if(!Array.isArray(n)||n.length%2||n.some(function(t){return"number"!=typeof t}))throw new RangeError("Invalid JSON representation of ChangeDesc");return new il(n)}},{key:"create",value:function t(n){return new il(n)}}]),x(el,J=il),Vh=S(el),D(el,[{key:"apply",value:function t(o){if(this.length!=o.length)throw new RangeError("Applying change set to a document with the wrong length");return ul(this,function(t,n,i,e,r){o=o.replace(i,i+(n-t),r)},!1),o}},{key:"mapDesc",value:function t(n){var i;return sl(this,n,1<arguments.length&&void 0!==arguments[1]&&arguments[1],!0)}},{key:"invert",value:function t(n){for(var i,e,r,o,u,s,a,i=this.sections.slice(),e=[],r=0,o=0;r<i.length;r+=2){if(u=i[r],0<=(s=i[r+1])){for(i[r]=s,i[r+1]=u,a=r>>1;e.length<a;)e.push(k.empty);e.push(u?n.slice(o,o+u):k.empty)}o+=u}return new el(i,e)}},{key:"compose",value:function t(n){return this.empty?n:n.empty?this:al(this,n,!0)}},{key:"map",value:function t(n){var i;return n.empty?this:sl(this,n,1<arguments.length&&void 0!==arguments[1]&&arguments[1],!0)}},{key:"iterChanges",value:function t(n){var i;ul(this,n,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}},{key:"desc",get:function t(){return J.create(this.sections)}},{key:"filter",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,i=[],e=[],r=[],o=new Q(this);t:for(u=0,s=0;;){for(a=u==n.length?1e9:n[u++];s<a||s==a&&0==o.len;){if(o.done)break t;rl(r,h=Math.min(o.len,a-s),-1),rl(i,h,f=-1==o.ins?-1:0==o.off?o.ins:0),0<f&&ol(e,i,o.text),o.forward(h),s+=h}for(c=n[u++];s<c;){if(o.done)break t;rl(i,l=Math.min(o.len,c-s),-1),rl(r,l,-1==o.ins?-1:0==o.off?o.ins:0),o.forward(l),s+=l}}return{changes:new el(i,e),filtered:J.create(r)}}},{key:"toJSON",value:function t(){for(var n,i,e,r,n=[],i=0;i<this.sections.length;i+=2)e=this.sections[i],r=this.sections[i+1],n.push(r<0?e:0==r?[e]:[e].concat(this.inserted[i>>1].toJSON()));return n}}],[{key:"of",value:function t(n,s,a){var h,f,c,l;function v(t){var n,t,n;(0<arguments.length&&void 0!==t&&t||h.length)&&(c<s&&rl(h,s-c,-1),t=new el(h,f),l=l?l.compose(t.map(l)):t,h=[],f=[],c=0)}function d(t){var n,i,e,r,o,o,t,t,u;if(Array.isArray(t)){n=F(t);try{for(n.s();!(i=n.n()).done;)d(e=i.value)}catch(t){n.e(t)}finally{n.f()}}else if(t instanceof el){if(t.length!=s)throw new RangeError("Mismatched change set length (got ".concat(t.length,", expected ").concat(s,")"));v(),l=l?l.compose(t.map(l)):t}else{if(r=t.from,o=t.to,t=t.insert,(o=void 0===o?r:o)<r||r<0||s<o)throw new RangeError("Invalid change range ".concat(r," to ").concat(o," (in doc of length ").concat(s,")"));u=(t=t?"string"==typeof t?k.of(t.split(a||G)):t:k.empty).length,r==o&&0==u||(r<c&&v(),c<r&&rl(h,r-c,-1),rl(h,o-r,u),ol(f,h,t),c=o)}}return h=[],f=[],c=0,l=null,d(n),v(!l),l}},{key:"empty",value:function t(n){return new el(n?[n,-1]:[],[])}},{key:"fromJSON",value:function t(n){var i,e,r,o;if(!Array.isArray(n))throw new RangeError("Invalid JSON representation of ChangeSet");for(i=[],e=[],r=0;r<n.length;r++)if("number"==typeof(o=n[r]))i.push(o,-1);else{if(!Array.isArray(o)||"number"!=typeof o[0]||o.some(function(t,n){return n&&"string"!=typeof t}))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==o.length)i.push(o[0],0);else{for(;e.length<r;)e.push(k.empty);e[r]=k.of(o.slice(1)),i.push(o[0],e[r].length)}}return new el(i,e)}},{key:"createSet",value:function t(n,i){return new el(n,i)}}]),K=el,D(hl,[{key:"next",value:function t(){var n=this.set.sections;this.i<n.length?(this.len=n[this.i++],this.ins=n[this.i++]):(this.len=0,this.ins=-2),this.off=0}},{key:"done",get:function t(){return-2==this.ins}},{key:"len2",get:function t(){return this.ins<0?this.len:this.ins}},{key:"text",get:function t(){var n=this.set.inserted,i=this.i-2>>1;return i>=n.length?k.empty:n[i]}},{key:"textBit",value:function t(n){var i=this.set.inserted,e=this.i-2>>1;return e>=i.length&&!n?k.empty:i[e].slice(this.off,null==n?void 0:this.off+n)}},{key:"forward",value:function t(n){n==this.len?this.next():(this.len-=n,this.off+=n)}},{key:"forward2",value:function t(n){-1==this.ins?this.forward(n):n==this.ins?this.next():(this.ins-=n,this.off+=n)}}]),Q=hl,D(fl,[{key:"anchor",get:function t(){return 16&this.flags?this.to:this.from}},{key:"head",get:function t(){return 16&this.flags?this.from:this.to}},{key:"empty",get:function t(){return this.from==this.to}},{key:"assoc",get:function t(){return 4&this.flags?-1:8&this.flags?1:0}},{key:"bidiLevel",get:function t(){var n=3&this.flags;return 3==n?null:n}},{key:"goalColumn",get:function t(){var n=this.flags>>5;return 33554431==n?void 0:n}},{key:"map",value:function t(n){var i,e,r,i;return this.empty?e=r=n.mapPos(this.from,1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1):(e=n.mapPos(this.from,1),r=n.mapPos(this.to,-1)),e==this.from&&r==this.to?this:new fl(e,r,this.flags)}},{key:"extend",value:function t(n){var i,n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n;return n<=this.anchor&&i>=this.anchor?O.range(n,i):(n=Math.abs(n-this.anchor)>Math.abs(i-this.anchor)?n:i,O.range(this.anchor,n))}},{key:"eq",value:function t(n){return this.anchor==n.anchor&&this.head==n.head}},{key:"toJSON",value:function t(){return{anchor:this.anchor,head:this.head}}}],[{key:"fromJSON",value:function t(n){if(n&&"number"==typeof n.anchor&&"number"==typeof n.head)return O.range(n.anchor,n.head);throw new RangeError("Invalid JSON representation for SelectionRange")}},{key:"create",value:function t(n,i,e){return new fl(n,i,e)}}]),X=fl,D(cl,[{key:"map",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;return n.empty?this:cl.create(this.ranges.map(function(t){return t.map(n,i)}),this.mainIndex)}},{key:"eq",value:function t(n){if(this.ranges.length!=n.ranges.length||this.mainIndex!=n.mainIndex)return!1;for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(n.ranges[i]))return!1;return!0}},{key:"main",get:function t(){return this.ranges[this.mainIndex]}},{key:"asSingle",value:function t(){return 1==this.ranges.length?this:new cl([this.main],0)}},{key:"addRange",value:function t(n){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return cl.create([n].concat(this.ranges),i?0:this.mainIndex+1)}},{key:"replaceRange",value:function t(n){var i,e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.mainIndex,e=this.ranges.slice();return e[i]=n,cl.create(e,this.mainIndex)}},{key:"toJSON",value:function t(){return{ranges:this.ranges.map(function(t){return t.toJSON()}),main:this.mainIndex}}}],[{key:"fromJSON",value:function t(n){if(!n||!Array.isArray(n.ranges)||"number"!=typeof n.main||n.main>=n.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new cl(n.ranges.map(function(t){return X.fromJSON(t)}),n.main)}},{key:"single",value:function t(n){var i;return new cl([cl.range(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:n)],0)}},{key:"create",value:function t(n){var i,e,r,o,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(0==n.length)throw new RangeError("A selection needs at least one range");for(r=e=0;r<n.length;r++){if((o=n[r]).empty?o.from<=e:o.from<e)return cl.normalized(n.slice(),i);e=o.to}return new cl(n,i)}},{key:"cursor",value:function t(n){var i,e,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0;return X.create(n,n,(0==i?0:i<0?4:8)|(null==e?3:Math.min(2,e))|(null!=r?r:33554431)<<5)}},{key:"range",value:function t(n,i,e,r){var e=(null!=e?e:33554431)<<5|(null==r?3:Math.min(2,r));return i<n?X.create(i,n,24|e):X.create(n,i,(n<i?4:0)|e)}},{key:"normalized",value:function t(n){var i,e,r,o,u,s,u,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=n[i];for(n.sort(function(t,n){return t.from-n.from}),i=n.indexOf(e),r=1;r<n.length;r++)o=n[r],u=n[r-1],(o.empty?o.from<=u.to:o.from<u.to)&&(s=u.from,u=Math.max(o.to,u.to),r<=i&&i--,n.splice(--r,2,o.anchor>o.head?cl.range(u,s):cl.range(s,u)));return new cl(n,i)}}]),O=cl,Z=0,D(vl,[{key:"of",value:function t(n){return new Y([],this,0,n)}},{key:"compute",value:function t(n,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new Y(n,this,1,i)}},{key:"computeN",value:function t(n,i){if(this.isStatic)throw new Error("Can't compute a static facet");return new Y(n,this,2,i)}},{key:"from",value:function t(n,i){return i=i||function t(n){return n},this.compute([n],function(t){return i(t.field(n))})}}],[{key:"define",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new vl(n.combine||function(t){return t},n.compareInput||function(t,n){return t===n},n.compare||(n.combine?function(t,n){return t===n}:dl),!!n.static,n.enables)}}]),y=vl,D(yl,[{key:"dynamicSlot",value:function t(n){var o,i,u,s,a,h,f,e,r,c,l,v,d,o=this,u=this.value,s=this.facet.compareInput,a=this.id,h=n[a]>>1,f=2==this.type,e=!1,r=!1,c=[],l=F(this.dependencies);try{for(l.s();!(v=l.n()).done;)"doc"==(d=v.value)?e=!0:"selection"==d?r=!0:0==(1&(null!=(i=n[d.id])?i:1))&&c.push(n[d.id])}catch(t){l.e(t)}finally{l.f()}return{create:function t(n){return n.values[h]=u(n),1},update:function t(n,i){if(e&&i.docChanged||r&&(i.docChanged||i.selection)||pl(n,c)){var i=u(n);if(f?!ml(i,n.values[h],s):!s(i,n.values[h]))return n.values[h]=i,1}return 0},reconfigure:function t(n,i){var e,r,r,r=i.config.address[a];if(null!=r){if(r=Cl(i,r),o.dependencies.every(function(t){return t instanceof y?i.facet(t)===n.facet(t):!(t instanceof w)||i.field(t,!1)==n.field(t,!1)})||(f?ml(e=u(n),r,s):s(e=u(n),r)))return n.values[h]=r,0}else e=u(n);return n.values[h]=e,1}}}}]),Y=yl,tt=y.define({static:!0}),D(gl,[{key:"create",value:function t(n){var i,e,i=this,e=n.facet(tt).find(function(t){return t.field==i});return((null==e?void 0:e.create)||this.createF)(n)}},{key:"slot",value:function t(n){var r,o,r=this,o=n[this.id]>>1;return{create:function t(n){return n.values[o]=r.create(n),1},update:function t(n,i){var e,i,e=n.values[o],i=r.updateF(e,i);return r.compareF(e,i)?0:(n.values[o]=i,1)},reconfigure:function t(n,i){return null!=i.config.address[r.id]?(n.values[o]=i.field(r),0):(n.values[o]=r.create(n),1)}}}},{key:"init",value:function t(n){return[this,tt.of({field:this,create:n})]}},{key:"extension",get:function t(){return this}}],[{key:"define",value:function t(n){var i=new gl(Z++,n.create,n.update,n.compare||function(t,n){return t===n},n);return n.provide&&(i.provides=n.provide(i)),i}}]),w=gl,st={highest:wl(ut=0),high:wl(ot=1),default:wl(rt=2),low:wl(et=3),lowest:wl(it=4)},at=D(function t(n,i){A(this,t),this.inner=n,this.prec=i}),D(bl,[{key:"of",value:function t(n){return new ft(this,n)}},{key:"reconfigure",value:function t(n){return bl.reconfigure.of({compartment:this,extension:n})}},{key:"get",value:function t(n){return n.config.compartments.get(this)}}]),ht=bl,ft=D(function t(n,i){A(this,t),this.compartment=n,this.inner=i}),D(Ml,[{key:"staticFacet",value:function t(n){var i=this.address[n.id];return null==i?n.default:this.staticValues[i>>1]}}],[{key:"resolve",value:function t(n,i,s){var e,a,r,o,u,h,f,c,l,v,d,y,m,p,k,g,e=[],a=Object.create(null),r=new Map,o=F(xl(n,i,r));try{for(o.s();!(u=o.n()).done;)((h=u.value)instanceof w?e:a[h.facet.id]||(a[h.facet.id]=[])).push(h)}catch(t){o.e(t)}finally{o.f()}for(f=Object.create(null),c=[],l=[],v=function t(){var n=y[d];f[n.id]=l.length<<1,l.push(function(t){return n.slot(t)})},d=0,y=e;d<y.length;d++)v();for(k in m=null==s?void 0:s.config.facets,p=function t(){var n,i,e,e,r,o,u,n=a[k],i=n[0].facet,e=m&&m[k]||[];if(n.every(function(t){return 0==t.type}))f[i.id]=c.length<<1|1,dl(e,n)?c.push(s.facet(i)):(e=i.combine(n.map(function(t){return t.value})),c.push(s&&i.compare(e,s.facet(i))?s.facet(i):e));else{r=F(n);try{for(u=function t(){var n=o.value;0==n.type?(f[n.id]=c.length<<1|1,c.push(n.value)):(f[n.id]=l.length<<1,l.push(function(t){return n.dynamicSlot(t)}))},r.s();!(o=r.n()).done;)u()}catch(t){r.e(t)}finally{r.f()}f[i.id]=l.length<<1,l.push(function(t){return kl(t,i,n)})}},a)p();return new Ml(n,r,g=l.map(function(t){return t(f)}),f,c,a)}}]),ct=Ml,lt=y.define(),vt=y.define({combine:function t(n){return n.some(function(t){return t})},static:!0}),dt=y.define({combine:function t(n){return n.length?n[0]:void 0},static:!0}),yt=y.define(),mt=y.define(),pt=y.define(),kt=y.define({combine:function t(n){return!!n.length&&n[0]}}),D(jl,null,[{key:"define",value:function t(){return new wt}}]),gt=jl,D(Pl,[{key:"of",value:function t(n){return new gt(this,n)}}]),wt=Pl,D(Ol,[{key:"of",value:function t(n){return new v(this,n)}}]),bt=Ol,D(El,[{key:"map",value:function t(n){var n=this.type.map(this.value,n);return void 0===n?void 0:n==this.value?this:new El(this.type,n)}},{key:"is",value:function t(n){return this.type==n}}],[{key:"define",value:function t(){var n;return new bt((0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).map||function(t){return t})}},{key:"mapEffects",value:function t(n,i){var e,r,o,u,s;if(!n.length)return n;e=[],r=F(n);try{for(r.s();!(o=r.n()).done;)(s=(u=o.value).map(i))&&e.push(s)}catch(t){r.e(t)}finally{r.f()}return e}}]),(v=El).reconfigure=v.define(),v.appendConfig=v.define(),D(Al,[{key:"newDoc",get:function t(){return this.Qae||(this.Qae=this.changes.apply(this.startState.doc))}},{key:"newSelection",get:function t(){return this.selection||this.startState.selection.map(this.changes)}},{key:"state",get:function t(){return this.Kh||this.startState.applyTransaction(this),this.Kh}},{key:"annotation",value:function t(n){var i,e,r,i=F(this.annotations);try{for(i.s();!(e=i.n()).done;)if((r=e.value).type==n)return r.value}catch(t){i.e(t)}finally{i.f()}}},{key:"docChanged",get:function t(){return!this.changes.empty}},{key:"reconfigured",get:function t(){return this.startState.config!=this.state.config}},{key:"isUserEvent",value:function t(n){var i=this.annotation(Al.userEvent);return!(!i||!(i==n||i.length>n.length&&i.slice(0,n.length)==n&&"."==i[n.length]))}}],[{key:"create",value:function t(n,i,e,r,o,u){return new Al(n,i,e,r,o,u)}}]),(Mt=Al).time=gt.define(),Mt.userEvent=gt.define(),Mt.addToHistory=gt.define(),Mt.remote=gt.define(),xt=[],(t=c=c||{})[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",c=t,St=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{Ct=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}function Fl(t){var n,i;if(Ct)return Ct.test(t);for(n=0;n<t.length;n++)if(i=t[n],/\w/.test(i)||"\x80"<i&&(i.toUpperCase()!=i.toLowerCase()||St.test(i)))return 1}function Nl(i){return function(t){if(!/\S/.test(t))return c.Space;if(Fl(t))return c.Word;for(var n=0;n<i.length;n++)if(-1<t.indexOf(i[n]))return c.Word;return c.Other}}function Ul(t,n,i,e,r,o){A(this,Ul),this.config=t,this.doc=n,this.selection=i,this.values=e,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o.Kh=this);for(var u=0;u<this.config.dynamicSlots.length;u++)Sl(this,u<<1);this.computeSlot=null}function Hl(t,n){var i,e,r,o,u,s,a,h,f,c,l,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e={},r=F(t);try{for(r.s();!(o=r.n()).done;)for(u=o.value,s=0,a=Object.keys(u);s<a.length;s++)if(f=u[h=a[s]],void 0===(c=e[h]))e[h]=f;else if(c!==f&&void 0!==f){if(!Object.hasOwnProperty.call(i,h))throw new Error("Config merge conflict for field "+h);e[h]=i[h](c,f)}}catch(t){r.e(t)}finally{r.f()}for(l in n)void 0===e[l]&&(e[l]=n[l]);return e}function zl(){A(this,zl)}function Wl(t,n,i){A(this,Wl),this.from=t,this.to=n,this.value=i}function Vl(t,n){return t.from-n.from||t.value.startSide-n.value.startSide}function $l(t,n,i,e){A(this,$l),this.from=t,this.to=n,this.value=i,this.maxPoint=e}function ql(t,n,i,e){A(this,ql),this.chunkPos=t,this.chunk=n,this.nextLayer=i,this.maxPoint=e}function Gl(t){var n,i,e;if(1<t.length)for(n=t[0],i=1;i<t.length;i++){if(0<Vl(n,e=t[i]))return t.slice().sort(Vl);n=e}return t}function Jl(){A(this,Jl),this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}function Kl(t,n,i){var e,r,o,u,s,a,h,f,c,l,v,e=new Map,r=F(t);try{for(r.s();!(o=r.n()).done;)for(u=o.value,s=0;s<u.chunk.length;s++)u.chunk[s].maxPoint<=0&&e.set(u.chunk[s],u.chunkPos[s])}catch(t){r.e(t)}finally{r.f()}a=new Set,h=F(n);try{for(h.s();!(f=h.n()).done;)for(c=f.value,l=0;l<c.chunk.length;l++)null==(v=e.get(c.chunk[l]))||(i?i.mapPos(v):v)!=c.chunkPos[l]||null!=i&&i.touchesRange(v,v+c.chunk[l].length)||a.add(c.chunk[l])}catch(t){h.e(t)}finally{h.f()}return a}function Ql(t,n,i){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;A(this,Ql),this.layer=t,this.skip=n,this.minPoint=i,this.rank=e}function Xl(t){A(this,Xl),this.heap=t}function Zl(t,n){for(var i,e,r,i=t[n];!((e=1+(n<<1))>=t.length||(r=t[e],e+1<t.length&&0<=r.compare(t[e+1])&&(r=t[e+1],e++),i.compare(r)<0));)t[e]=i,t[n]=r,n=e}function Yl(t,n,i){A(this,Yl),this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=At.from(t,n,i)}function t0(t,n,i,e,r,o){var u,s,a,h,f,c;for(t.goto(n),i.goto(e),u=e+r,a=(s=e)-n;f=(h=t.to+a-i.to||t.endSide-i.endSide)<0?t.to+a:i.to,c=Math.min(f,u),t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&n0(t.activeForPoint(t.to),i.activeForPoint(i.to))||o.comparePoint(s,c,t.point,i.point):s<c&&!n0(t.active,i.active)&&o.compareRange(s,c,t.active,i.active),!(u<f);)s=f,h<=0&&t.next(),0<=h&&i.next()}function n0(t,n){if(t.length==n.length){for(var i=0;i<t.length;i++)if(t[i]!=n[i]&&!t[i].eq(n[i]))return;return 1}}function i0(t,n){for(var i=n,e=t.length-1;i<e;i++)t[i]=t[i+1];t.pop()}function e0(t,n,i){for(var e=t.length-1;n<=e;e--)t[e+1]=t[e];t[n]=i}function r0(t,n){for(var i,e,r,i=-1,e=1e9,r=0;r<n.length;r++)(n[r]-e||t[r].endSide-t[i].endSide)<0&&(e=n[i=r]);return i}function o0(t,n){for(var i,e,r,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:t.length,e=0,r=0;r<i;)9==t.charCodeAt(r)?(e+=n-e%n,r++):(e++,r=Jc(t,r));return e}function u0(t,n,i,e){for(var r=0,o=0;;){if(n<=o)return r;if(r==t.length)break;o+=9==t.charCodeAt(r)?i-o%i:1,r=Jc(t,r)}return!0===e?-1:t.length}function s0(t,n){var i,h,e;function f(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function c(t,n,i,e){var r,o,u,s,a,r=[],o=/^@(\w+)\b/.exec(t[0]),u=o&&"keyframes"==o[1];if(o&&null==n)return i.push(t[0]+";");for(s in n)if(a=n[s],/&/.test(s))c(s.split(/,\s*/).map(function(n){return t.map(function(t){return n.replace(/&/,t)})}).reduce(function(t,n){return t.concat(n)}),a,i);else if(a&&"object"==Rc(a)){if(!o)throw new RangeError("The value of a property ("+s+") should be a primitive value.");c(f(s),a,r,u)}else null!=a&&r.push(s.replace(/_.*/,"").replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})+": "+a+";");(r.length||u)&&i.push((!h||o||e?t:t.map(h)).join(", ")+" {"+r.join(" ")+"}")}for(e in A(this,s0),this.rules=[],h=(i=n||{}).finish,t)c(f(e),t[e],this.rules)}function a0(t){var n,i,e,e;if(A(this,a0),i=(n=t.ownerDocument||t).defaultView,!t.head&&t.adoptedStyleSheets&&i.CSSStyleSheet){if(e=Ft.get(n))return t.adoptedStyleSheets=[e.sheet].concat(yc(t.adoptedStyleSheets)),t[Lt]=e;this.sheet=new i.CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(yc(t.adoptedStyleSheets)),Ft.set(n,this)}else this.styleTag=n.createElement("style"),(e=t.head||t).insertBefore(this.styleTag,e.firstChild);this.modules=[],t[Lt]=this}for(D(Ul,[{key:"field",value:function t(n){var i,n,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.config.address[n.id];if(null!=n)return Sl(this,n),Cl(this,n);if(i)throw new RangeError("Field is not present in this state")}},{key:"update",value:function t(){for(var n=arguments.length,i=new Array(n),e=0;e<n;e++)i[e]=arguments[e];return Tl(this,i,!0)}},{key:"applyTransaction",value:function t(i){var e,n,r,o,u,s,a,h,r,f,e=this,n=this.config,r=n,o=r.base,u=r.compartments,s=F(i.effects);try{for(s.s();!(a=s.n()).done;)(h=a.value).is(ht.reconfigure)?(n&&(u=new Map,n.compartments.forEach(function(t,n){return u.set(n,t)}),n=null),u.set(h.value.compartment,h.value.extension)):h.is(v.reconfigure)?(n=null,o=h.value):h.is(v.appendConfig)&&(n=null,o=_l(o).concat(h.value))}catch(t){s.e(t)}finally{s.f()}r=n?i.startState.values.slice():(f=new Ul(n=ct.resolve(o,u,this),this.doc,this.selection,n.dynamicSlots.map(function(){return null}),function(t,n){return n.reconfigure(t,e)},null)).values,new Ul(n,i.newDoc,i.newSelection,r,function(t,n){return n.update(t,i)},i)}},{key:"replaceSelection",value:function t(n){return"string"==typeof n&&(n=this.toText(n)),this.changeByRange(function(t){return{changes:{from:t.from,to:t.to,insert:n},range:O.cursor(t.from+n.length)}})}},{key:"changeByRange",value:function t(n){for(var i,e,r,o,u,s,a,h,f,c,h,i=this.selection,e=n(i.ranges[0]),r=this.changes(e.changes),o=[e.range],u=_l(e.effects),s=1;s<i.ranges.length;s++){for(a=n(i.ranges[s]),f=(h=this.changes(a.changes)).map(r),c=0;c<s;c++)o[c]=o[c].map(f);h=r.mapDesc(h,!0),o.push(a.range.map(h)),r=r.compose(f),u=v.mapEffects(u,f).concat(v.mapEffects(_l(a.effects),h))}return{changes:r,selection:O.create(o,i.mainIndex),effects:u}}},{key:"changes",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return n instanceof K?n:K.of(n,this.doc.length,this.facet(Ul.lineSeparator))}},{key:"toText",value:function t(n){return k.of(n.split(this.facet(Ul.lineSeparator)||G))}},{key:"sliceDoc",value:function t(){var n,i,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.doc.length;return this.doc.sliceString(n,i,this.lineBreak)}},{key:"facet",value:function t(n){var i=this.config.address[n.id];return null==i?n.default:(Sl(this,i),Cl(this,i))}},{key:"toJSON",value:function t(n){var i,e,r,i={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(n)for(e in n)(r=n[e])instanceof w&&null!=this.config.address[r.id]&&(i[e]=r.spec.toJSON(this.field(n[e]),this));return i}},{key:"tabSize",get:function t(){return this.facet(Ul.tabSize)}},{key:"lineBreak",get:function t(){return this.facet(Ul.lineSeparator)||"\n"}},{key:"readOnly",get:function t(){return this.facet(kt)}},{key:"phrase",value:function t(n){for(var i,e,r,o,u,s,i=arguments.length,e=new Array(1<i?i-1:0),r=1;r<i;r++)e[r-1]=arguments[r];o=F(this.facet(Ul.phrases));try{for(o.s();!(u=o.n()).done;)if(s=u.value,Object.prototype.hasOwnProperty.call(s,n)){n=s[n];break}}catch(t){o.e(t)}finally{o.f()}return n=e.length?n.replace(/\$(\$|\d*)/g,function(t,n){var n;return"$"==n?"$":!(n=+(n||1))||n>e.length?t:e[n-1]}):n}},{key:"languageDataAt",value:function t(n,i){var e,r,o,u,s,a,h,f,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,r=[],o=F(this.facet(lt));try{for(o.s();!(u=o.n()).done;){a=F((s=u.value)(this,i,e));try{for(a.s();!(h=a.n()).done;)f=h.value,Object.prototype.hasOwnProperty.call(f,n)&&r.push(f[n])}catch(t){a.e(t)}finally{a.f()}}}catch(t){o.e(t)}finally{o.f()}return r}},{key:"charCategorizer",value:function t(n){return Nl(this.languageDataAt("wordChars",n).join(""))}},{key:"wordAt",value:function t(n){for(var i,e,r,o,u,s,a,h,f,i=this.doc.lineAt(n),e=i.text,r=i.from,o=i.length,u=this.charCategorizer(n),s=n-r,a=n-r;0<s&&(h=Jc(e,s,!1),u(e.slice(h,s))==c.Word);)s=h;for(;a<o&&(f=Jc(e,a),u(e.slice(a,f))==c.Word);)a=f;return s==a?null:O.range(s+r,a+r)}}],[{key:"fromJSON",value:function t(e){var n,r,o,i,u,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");if(o=[],r)for(u in i=function t(){var n,i;Object.prototype.hasOwnProperty.call(e,u)&&(n=r[u],i=e[u],o.push(n.init(function(t){return n.spec.fromJSON(i,t)})))},r)i();return Ul.create({doc:e.doc,selection:O.fromJSON(e.selection),extensions:n.extensions?o.concat([n.extensions]):o})}},{key:"create",value:function t(){var n,i,e,n,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=ct.resolve(n.extensions||[],new Map),e=n.doc instanceof k?n.doc:k.of((n.doc||"").split(i.staticFacet(Ul.lineSeparator)||G)),n=n.selection?n.selection instanceof O?n.selection:O.single(n.selection.anchor,n.selection.head):O.single(0);return ll(n,e.length),i.staticFacet(vt)||(n=n.asSingle()),new Ul(i,e,n,i.dynamicSlots.map(function(){return null}),function(t,n){return n.create(t)},null)}}]),(C=Ul).allowMultipleSelections=vt,C.tabSize=y.define({combine:function t(n){return n.length?n[0]:4}}),C.lineSeparator=dt,C.readOnly=kt,C.phrases=y.define({compare:function t(n,i){var e=Object.keys(n),r=Object.keys(i);return e.length==r.length&&e.every(function(t){return n[t]==i[t]})}}),C.languageData=lt,C.changeFilter=yt,C.transactionFilter=mt,C.transactionExtender=pt,ht.reconfigure=v.define(),D(zl,[{key:"eq",value:function t(n){return this==n}},{key:"range",value:function t(n){var i;return jt.create(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:n,this)}}]),(t=zl).prototype.startSide=t.prototype.endSide=0,t.prototype.point=!1,t.prototype.mapMode=f.TrackDel,D(Wl,null,[{key:"create",value:function t(n,i,e){return new Wl(n,i,e)}}]),jt=Wl,D($l,[{key:"length",get:function t(){return this.to[this.to.length-1]}},{key:"findIndex",value:function t(n,i,e){for(var r,o,u,s,a,h,r,o=e?this.to:this.from,u=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,s=o.length;;){if(u==s)return u;if(h=o[a=u+s>>1]-n||(e?this.value[a].endSide:this.value[a].startSide)-i,a==u)return 0<=h?u:s;0<=h?s=a:u=1+a}}},{key:"between",value:function t(n,i,e,r){for(var o=this.findIndex(i,-1e9,!0),u=this.findIndex(e,1e9,!1,o);o<u;o++)if(!1===r(this.from[o]+n,this.to[o]+n,this.value[o]))return!1}},{key:"map",value:function t(n,i){for(var e,r,o,u,s,a,h,f,c,l,v,d,e=[],r=[],o=[],u=-1,s=-1,a=0;a<this.value.length;a++){if(h=this.value[a],v=l=void 0,(f=this.from[a]+n)==(c=this.to[a]+n)){if(null==(d=i.mapPos(f,h.startSide,h.mapMode)))continue;if(l=v=d,h.startSide!=h.endSide&&(v=i.mapPos(f,h.endSide))<l)continue}else if(l=i.mapPos(f,h.startSide),(v=i.mapPos(c,h.endSide))<l||l==v&&0<h.startSide&&h.endSide<=0)continue;(v-l||h.endSide-h.startSide)<0||(u<0&&(u=l),h.point&&(s=Math.max(s,v-l)),e.push(h),r.push(l-u),o.push(v-u))}return{mapped:e.length?new $l(r,o,e,s):null,pos:u}}}]),Pt=$l,D(ql,[{key:"length",get:function t(){var n=this.chunk.length-1;return n<0?0:Math.max(this.chunkEnd(n),this.nextLayer.length)}},{key:"size",get:function t(){var n,i,e,r;if(this.isEmpty)return 0;n=this.nextLayer.size,i=F(this.chunk);try{for(i.s();!(e=i.n()).done;)n+=(r=e.value).value.length}catch(t){i.e(t)}finally{i.f()}return n}},{key:"chunkEnd",value:function t(n){return this.chunkPos[n]+this.chunk[n].length}},{key:"update",value:function t(n){var i,e,i,r,o,u,o,s,a,h,f,c,l,v,i=n.add,e=void 0===i?[]:i,i=n.sort,r,o=n.filterFrom,u=void 0===o?0:o,o=n.filterTo,s=void 0===o?this.length:o,a=n.filter;if(0==e.length&&!a)return this;if(void 0!==i&&i&&(e=e.slice().sort(Vl)),this.isEmpty)return e.length?ql.of(e):this;for(h=new Et(this,null,-1).goto(0),f=0,c=[],l=new Ot;h.value||f<e.length;)f<e.length&&0<=(h.from-e[f].from||h.startSide-e[f].value.startSide)?(v=e[f++],l.addInner(v.from,v.to,v.value)||c.push(v)):1==h.rangeIndex&&h.chunkIndex<this.chunk.length&&(f==e.length||this.chunkEnd(h.chunkIndex)<e[f].from)&&(!a||u>this.chunkEnd(h.chunkIndex)||s<this.chunkPos[h.chunkIndex])&&l.addChunk(this.chunkPos[h.chunkIndex],this.chunk[h.chunkIndex])?h.nextChunk():((!a||u>h.to||s<h.from||a(h.from,h.to,h.value))&&!l.addInner(h.from,h.to,h.value)&&c.push(jt.create(h.from,h.to,h.value)),h.next());return l.finishInner(this.nextLayer.isEmpty&&!c.length?ql.empty:this.nextLayer.update({add:c,filter:a,filterFrom:u,filterTo:s}))}},{key:"map",value:function t(n){var i,e,r,o,u,s,a,a,s,u,h;if(n.empty||this.isEmpty)return this;for(i=[],e=[],r=-1,o=0;o<this.chunk.length;o++)u=this.chunkPos[o],s=this.chunk[o],!1===(a=n.touchesRange(u,u+s.length))?(r=Math.max(r,s.maxPoint),i.push(s),e.push(n.mapPos(u))):!0===a&&(s=(a=s.map(u,n)).mapped,u=a.pos,s)&&(r=Math.max(r,s.maxPoint),i.push(s),e.push(u));return h=this.nextLayer.map(n),0==i.length?h:new ql(e,i,h||ql.empty,r)}},{key:"between",value:function t(n,i,e){var r,o,u;if(!this.isEmpty){for(r=0;r<this.chunk.length;r++)if(o=this.chunkPos[r],u=this.chunk[r],o<=i&&n<=o+u.length&&!1===u.between(o,n-o,i-o,e))return;this.nextLayer.between(n,i,e)}}},{key:"iter",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return At.from([this]).goto(n)}},{key:"isEmpty",get:function t(){return this.nextLayer==this}}],[{key:"create",value:function t(n,i,e,r){return new ql(n,i,e,r)}},{key:"iter",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return At.from(n).goto(i)}},{key:"compare",value:function t(n,i,e,r){var o,n,i,u,s,a,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:-1,n=n.filter(function(t){return 0<t.maxPoint||!t.isEmpty&&t.maxPoint>=o}),i=i.filter(function(t){return 0<t.maxPoint||!t.isEmpty&&t.maxPoint>=o}),u=Kl(n,i,e),s=new Dt(n,u,o),a=new Dt(i,u,o);e.iterGaps(function(t,n,i){return t0(s,t,a,n,i,r)}),e.empty&&0==e.length&&t0(s,0,a,0,0,r)}},{key:"eq",value:function t(n,i){var e,r,o,u,s,a,h,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length?arguments[3]:void 0;if(null==r&&(r=1e9-1),o=n.filter(function(t){return!t.isEmpty&&i.indexOf(t)<0}),u=i.filter(function(t){return!t.isEmpty&&n.indexOf(t)<0}),o.length!=u.length)return!1;if(!o.length)return!0;for(s=Kl(o,u),a=new Dt(o,s,0).goto(e),h=new Dt(u,s,0).goto(e);;){if(a.to!=h.to||!n0(a.active,h.active)||a.point&&(!h.point||!a.point.eq(h.point)))return!1;if(a.to>r)return!0;a.next(),h.next()}}},{key:"spans",value:function t(n,i,e,r){for(var o,u,s,a,h,f,c,o,u=new Dt(n,null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:-1).goto(i),s=i,a=u.openStart;;){if(h=Math.min(u.to,e),u.point?(f=u.activeForPoint(u.to),c=u.pointFrom<i?f.length+1:Math.min(f.length,a),r.point(s,h,u.point,f,c,u.pointRank),a=Math.min(u.openEnd(h),f.length)):s<h&&(r.span(s,h,u.active,a),a=u.openEnd(h)),u.to>e)return a+(u.point&&u.to>e?1:0);s=u.to,u.next()}}},{key:"of",value:function t(n){var i,e,r,o,u,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=new Ot,r=F(n instanceof jt?[n]:i?Gl(n):n);try{for(r.s();!(o=r.n()).done;)u=o.value,e.add(u.from,u.to,u.value)}catch(t){r.e(t)}finally{r.f()}return e.finish()}}]),(j=ql).empty=new j([],[],null,-1),j.empty.nextLayer=j.empty,D(Jl,[{key:"finishChunk",value:function t(n){this.chunks.push(new Pt(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,n&&(this.from=[],this.to=[],this.value=[])}},{key:"add",value:function t(n,i,e){this.addInner(n,i,e)||(this.nextLayer||(this.nextLayer=new Jl)).add(n,i,e)}},{key:"addInner",value:function t(n,i,e){var r=n-this.lastTo||e.startSide-this.last.endSide;if(r<=0&&(n-this.lastFrom||e.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(r<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=n),this.from.push(n-this.chunkStart),this.to.push(i-this.chunkStart),this.last=e,this.lastFrom=n,this.lastTo=i,this.value.push(e),e.point&&(this.maxPoint=Math.max(this.maxPoint,i-n)),0))}},{key:"addChunk",value:function t(n,i){if((n-this.lastTo||i.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,i.maxPoint),this.chunks.push(i),this.chunkPos.push(n);var e=i.value.length-1;return this.last=i.value[e],this.lastFrom=i.from[e]+n,this.lastTo=i.to[e]+n,!0}},{key:"finish",value:function t(){return this.finishInner(j.empty)}},{key:"finishInner",value:function t(n){var n;return this.from.length&&this.finishChunk(!1),0==this.chunks.length||(n=j.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(n):n,this.setMaxPoint),this.from=null),n}}]),Ot=Jl,D(Ql,[{key:"startSide",get:function t(){return this.value?this.value.startSide:0}},{key:"endSide",get:function t(){return this.value?this.value.endSide:0}},{key:"goto",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1e9;return this.chunkIndex=this.rangeIndex=0,this.gotoInner(n,i,!1),this}},{key:"gotoInner",value:function t(n,i,e){for(var r,i;this.chunkIndex<this.layer.chunk.length&&(r=this.layer.chunk[this.chunkIndex],this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<n||r.maxPoint<this.minPoint);)this.chunkIndex++,e=!1;this.chunkIndex<this.layer.chunk.length&&(i=this.layer.chunk[this.chunkIndex].findIndex(n-this.layer.chunkPos[this.chunkIndex],i,!0),!e||this.rangeIndex<i)&&this.setRangeIndex(i),this.next()}},{key:"forward",value:function t(n,i){(this.to-n||this.endSide-i)<0&&this.gotoInner(n,i,!0)}},{key:"next",value:function t(){for(var n,i,e;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}if(e=(n=this.layer.chunkPos[this.chunkIndex])+(i=this.layer.chunk[this.chunkIndex]).from[this.rangeIndex],this.from=e,this.to=n+i.to[this.rangeIndex],this.value=i.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}},{key:"setRangeIndex",value:function t(n){if(n==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=n}},{key:"nextChunk",value:function t(){this.chunkIndex++,this.rangeIndex=0,this.next()}},{key:"compare",value:function t(n){return this.from-n.from||this.startSide-n.startSide||this.rank-n.rank||this.to-n.to||this.endSide-n.endSide}}]),Et=Ql,D(Xl,[{key:"startSide",get:function t(){return this.value?this.value.startSide:0}},{key:"goto",value:function t(n){var i,e,r,o,u,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1e9,e=F(this.heap);try{for(e.s();!(r=e.n()).done;)(o=r.value).goto(n,i)}catch(t){e.e(t)}finally{e.f()}for(u=this.heap.length>>1;0<=u;u--)Zl(this.heap,u);return this.next(),this}},{key:"forward",value:function t(n,i){var e,r,o,u,e=F(this.heap);try{for(e.s();!(r=e.n()).done;)(o=r.value).forward(n,i)}catch(t){e.e(t)}finally{e.f()}for(u=this.heap.length>>1;0<=u;u--)Zl(this.heap,u);(this.to-n||this.value.endSide-i)<0&&this.next()}},{key:"next",value:function t(){var n;0==this.heap.length?(this.from=this.to=1e9,this.value=null,this.rank=-1):(n=this.heap[0],this.from=n.from,this.to=n.to,this.value=n.value,this.rank=n.rank,n.value&&n.next(),Zl(this.heap,0))}}],[{key:"from",value:function t(n){for(var i,e,r,o,u,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,r=[],o=0;o<n.length;o++)for(u=n[o];!u.isEmpty;u=u.nextLayer)u.maxPoint>=e&&r.push(new Et(u,i,e,o));return 1==r.length?r[0]:new Xl(r)}}]),At=Xl,D(Yl,[{key:"goto",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1e9;return this.cursor.goto(n,i),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=n,this.endSide=i,this.openStart=-1,this.next(),this}},{key:"forward",value:function t(n,i){for(;-1<this.minActive&&(this.activeTo[this.minActive]-n||this.active[this.minActive].endSide-i)<0;)this.removeActive(this.minActive);this.cursor.forward(n,i)}},{key:"removeActive",value:function t(n){i0(this.active,n),i0(this.activeTo,n),i0(this.activeRank,n),this.minActive=r0(this.active,this.activeTo)}},{key:"addActive",value:function t(n){for(var i=0,e=this.cursor,r=e.value,o=e.to,u=e.rank;i<this.activeRank.length&&this.activeRank[i]<=u;)i++;e0(this.active,i,r),e0(this.activeTo,i,o),e0(this.activeRank,i,u),n&&e0(n,i,this.cursor.from),this.minActive=r0(this.active,this.activeTo)}},{key:"next",value:function t(){var n,i,e,r,r,o,n=this.to,i=this.point;for(this.point=null,e=this.openStart<0?[]:null;;)if(-1<(r=this.minActive)&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>n){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),e&&i0(e,r)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>n){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}if((r=this.cursor.value).point){if(!(i&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else this.addActive(e);this.cursor.next()}if(e)for(this.openStart=0,o=e.length-1;0<=o&&e[o]<n;o--)this.openStart++}},{key:"activeForPoint",value:function t(n){var i,e;if(!this.active.length)return this.active;for(i=[],e=this.active.length-1;0<=e&&!(this.activeRank[e]<this.pointRank);e--)(this.activeTo[e]>n||this.activeTo[e]==n&&this.active[e].endSide>=this.point.endSide)&&i.push(this.active[e]);return i.reverse()}},{key:"openEnd",value:function t(n){for(var i,e,i=0,e=this.activeTo.length-1;0<=e&&this.activeTo[e]>n;e--)i++;return i}}]),Dt=Yl,Rt=L.State=Object.freeze({__proto__:null,Annotation:gt,AnnotationType:wt,ChangeDesc:J,ChangeSet:K,get CharCategory(){return c},Compartment:ht,EditorSelection:O,EditorState:C,Facet:y,Line:W,get MapMode(){return f},Prec:st,Range:jt,RangeSet:j,RangeSetBuilder:Ot,RangeValue:t,SelectionRange:X,StateEffect:v,StateEffectType:bt,StateField:w,Text:k,Transaction:Mt,codePointAt:Yc,codePointSize:nl,combineConfig:Hl,countColumn:o0,findClusterBreak:Jc,findColumn:u0,fromCodePoint:tl}),It="\u037c",Tt="undefined"==typeof Symbol?"__\u037c":Symbol.for(It),Lt="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),Bt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{},D(s0,[{key:"getRules",value:function t(){return this.rules.join("\n")}}],[{key:"newName",value:function t(){var n=Bt[Tt]||1;return Bt[Tt]=n+1,It+n.toString(36)}},{key:"mount",value:function t(n,i){(n[Lt]||new Nt(n)).mount(Array.isArray(i)?i:[i])}}]),_t=s0,Ft=new Map,D(a0,[{key:"mount",value:function t(n){for(var i,e,r,o,u,s,a,h,f,i=this.sheet,e=0,r=0,o=0;o<n.length;o++)if(u=n[o],(s=this.modules.indexOf(u))<r&&-1<s&&(this.modules.splice(s,1),r--,s=-1),-1==s){if(this.modules.splice(r++,0,u),i)for(a=0;a<u.rules.length;a++)i.insertRule(u.rules[a],e++)}else{for(;r<s;)e+=this.modules[r++].rules.length;e+=u.rules.length,r++}if(!i){for(h="",f=0;f<this.modules.length;f++)h+=this.modules[f].getRules()+"\n";this.styleTag.textContent=h}}}]),Nt=a0,Ut={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ht={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},zt="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),n="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Wt="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Vt=n||zt&&+zt[1]<57,$t=0;$t<10;$t++)Ut[48+$t]=Ut[96+$t]=String($t);for($t=1;$t<=24;$t++)Ut[$t+111]="F"+$t;for($t=65;$t<=90;$t++)Ut[$t]=String.fromCharCode($t+32),Ht[$t]=String.fromCharCode($t);for(qt in Ut)Ht.hasOwnProperty(qt)||(Ht[qt]=Ut[qt]);function h0(t){var n,t,n,t=!(Vt&&(t.ctrlKey||t.altKey||t.metaKey)||Wt&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Ht:Ut)[t.keyCode]||t.key||"Unidentified";return t="Down"==(t="Right"==(t="Up"==(t="Left"==(t="Del"==(t="Esc"==t?"Escape":t)?"Delete":t)?"ArrowLeft":t)?"ArrowUp":t)?"ArrowRight":t)?"ArrowDown":t}function f0(t){var t,t=11!=t.nodeType||t.getSelection?t:t.ownerDocument;return t.getSelection()}function c0(t,n){return!!n&&(t==n||t.contains(1!=n.nodeType?n.parentNode:n))}function l0(t){for(var n=t.activeElement;n&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function v0(t,n){if(!n.anchorNode)return!1;try{return c0(t,n.anchorNode)}catch(t){return!1}}function d0(t){return 3==t.nodeType?C0(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function y0(t,n,i,e){return i&&(p0(t,n,i,e,-1)||p0(t,n,i,e,1))}function m0(t){for(var n=0;;n++)if(!(t=t.previousSibling))return n}function p0(t,n,i,e,r){for(;;){if(t==i&&n==e)return!0;if(n==(r<0?0:k0(t))){if("DIV"==t.nodeName)return!1;var o=t.parentNode;if(!o||1!=o.nodeType)return!1;n=m0(t)+(r<0?0:1),t=o}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[n+(r<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;n=r<0?k0(t):0}}}function k0(t){return(3==t.nodeType?t.nodeValue:t.childNodes).length}function g0(t,n){var n=n?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function w0(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function b0(t,n,i,e,r,o,u,s){for(var a,h,f,c,l,v,v,d,y,m,p,k,y,m,c,c,a=t.ownerDocument,h=a.defaultView||window,f=t;f;)if(1==f.nodeType){if(c=void 0,l=f==a.body)c=w0(h);else{if(f.scrollHeight<=f.clientHeight&&f.scrollWidth<=f.clientWidth){f=f.assignedSlot||f.parentNode;continue}c={left:(v=f.getBoundingClientRect()).left,right:v.left+f.clientWidth,top:v.top,bottom:v.top+f.clientHeight}}if(d=v=0,"nearest"==r?n.top<c.top?(d=-(c.top-n.top+u),0<i&&n.bottom>c.bottom+d&&(d=n.bottom-c.bottom+d+u)):n.bottom>c.bottom&&(d=n.bottom-c.bottom+u,i<0)&&n.top-d<c.top&&(d=-(c.top+d-n.top+u)):(y=n.bottom-n.top,m=c.bottom-c.top,d=(p="center"==r&&y<=m?n.top+y/2-m/2:"start"==r||"center"==r&&i<0?n.top-u:n.bottom-m+u)-c.top),"nearest"==e?n.left<c.left?(v=-(c.left-n.left+o),0<i&&n.right>c.right+v&&(v=n.right-c.right+v+o)):n.right>c.right&&(v=n.right-c.right+o,i<0)&&n.left<c.left+v&&(v=-(c.left+v-n.left+o)):v=(k="center"==e?n.left+(n.right-n.left)/2-(c.right-c.left)/2:"start"==e==s?n.left-o:n.right-(c.right-c.left)+o)-c.left,(v||d)&&(l?h.scrollBy(v,d):(m=y=0,d&&(c=f.scrollTop,f.scrollTop+=d,m=f.scrollTop-c),v&&(c=f.scrollLeft,f.scrollLeft+=v,y=f.scrollLeft-c),n={left:n.left-y,top:n.top-m,right:n.right-y,bottom:n.bottom-m},y&&Math.abs(y-v)<1&&(e="nearest"),m&&Math.abs(m-d)<1&&(r="nearest"))),l)break;f=f.assignedSlot||f.parentNode}else{if(11!=f.nodeType)break;f=f.host}}function M0(t){for(var n,i,n=t.ownerDocument,i=t.parentNode;i&&i!=n.body;)if(1==i.nodeType){if(i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)return i;i=i.assignedSlot||i.parentNode}else{if(11!=i.nodeType)break;i=i.host}return null}function x0(){A(this,x0),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}function S0(t){var n,i,e,r,o,u;if(t.setActive)return t.setActive();if(Jt)return t.focus(Jt);for(n=[],i=t;i&&(n.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Jt?{get preventScroll(){return Jt={preventScroll:!0},!0}}:void 0),!Jt)for(Jt=!1,e=0;e<n.length;)r=n[e++],o=n[e++],u=n[e++],r.scrollTop!=o&&(r.scrollTop=o),r.scrollLeft!=u&&(r.scrollLeft=u)}function C0(t,n,i){var i,e,i=2<arguments.length&&void 0!==i?i:n,e=Kt=Kt||document.createRange();return e.setEnd(t,i),e.setStart(t,n),e}function j0(t,n,i){var n,i,n,n={key:n,code:n,keyCode:i,which:i,cancelable:!0},i=new KeyboardEvent("keydown",n);return i.synthetic=!0,t.dispatchEvent(i),(n=new KeyboardEvent("keyup",n)).synthetic=!0,t.dispatchEvent(n),i.defaultPrevented||n.defaultPrevented}function P0(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function O0(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function E0(t,n){var i,e,r,i=n.focusNode,e=n.focusOffset;if(i&&n.anchorNode==i&&n.anchorOffset==e)for(e=Math.min(e,k0(i));;)if(e){if(1!=i.nodeType)return;"false"==(r=i.childNodes[e-1]).contentEditable?e--:e=k0(i=r)}else{if(i==t)return 1;e=m0(i),i=i.parentNode}}function A0(t,n){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];A(this,A0),this.node=t,this.offset=n,this.precise=i}function D0(){A(this,D0),this.parent=null,this.dom=null,this.dirty=2}function R0(t){var n=t.nextSibling;return t.parentNode.removeChild(t),n}function I0(t,n,i){A(this,I0),this.children=t,this.pos=n,this.i=i,this.off=0}function T0(t,n,i,e,r,o,u,s,a){var h,f,c,l,v,h=t.children,f=h.length?h[n]:null,c=o.length?o[o.length-1]:null,l=c?c.breakAfter:u;if(!(n==e&&f&&!u&&!l&&o.length<2&&f.merge(i,r,o.length?c:null,0==i,s,a))){for(e<h.length&&((v=h[e])&&r<v.length?(n==e&&(v=v.split(r),r=0),!l&&c&&v.merge(0,r,c,!0,0,a)?o[o.length-1]=v:(r&&v.merge(0,r,null,!1,0,a),o.push(v))):null!=v&&v.breakAfter&&(c?c.breakAfter=1:u=1),e++),f&&(f.breakAfter=u,0<i)&&(!u&&o.length&&f.merge(i,f.length,o[0],!1,s,0)?f.breakAfter=o.shift().breakAfter:(i<f.length||f.children.length&&0==f.children[f.children.length-1].length)&&f.merge(i,f.length,null,!1,s,0),n++);n<e&&o.length;)if(h[e-1].become(o[o.length-1]))e--,o.pop(),a=o.length?0:s;else{if(!h[n].become(o[0]))break;n++,o.shift(),s=o.length?0:a}!o.length&&n&&e<h.length&&!h[n-1].breakAfter&&h[e].merge(0,0,h[n-1],!1,s,a)&&n--,(n<e||o.length)&&t.replaceChildren(n,e,o)}}function L0(t,n,i,e,r,o){var u,s,a,s,u,h,u,f,c,l,v,u=t.childCursor(),s=u.findPos(i,1),a=s.i,s=s.off,u=u.findPos(n,-1),h=u.i,u=u.off,f=n-i,c=F(e);try{for(c.s();!(l=c.n()).done;)f+=(v=l.value).length}catch(t){c.e(t)}finally{c.f()}t.length+=f,T0(t,h,u,a,s,e,0,r,o)}function B0(t){var n;return A(this,B0),(n=qh.call(this)).text=t,n}function _0(t){var n,i,e,r,o,u,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;A(this,_0),(n=Jh.call(this)).mark=t,n.children=i,n.length=e,r=F(i);try{for(r.s();!(o=r.n()).done;)(u=o.value).setParent(Ec(n))}catch(t){r.e(t)}finally{r.f()}return n}function F0(t,n,i){var e,r,o,u,n,e,e=t.nodeValue.length;return(u=0)==(o=r=n=e<n?e:n)&&i<0||n==e&&0<=i?g.chrome||g.gecko||(n?(r--,u=1):o<e&&(o++,u=-1)):i<0?r--:o<e&&o++,(n=C0(t,r,o).getClientRects()).length?(e=n[(u?u<0:0<=i)?0:n.length-1],g.safari&&!u&&0==e.width&&(e=Array.prototype.find.call(n,function(t){return t.width})||e),u?g0(e,u<0):e||null):null}function N0(t,n,i){var e;return A(this,N0),(e=Qh.call(this)).widget=t,e.length=n,e.side=i,e.prevWidget=null,e}function U0(){return A(this,U0),Zh.apply(this,arguments)}function H0(t,n,i,e,r,o,u){var s,a,h,h,f;if(i instanceof sn){for(s=i.dom.firstChild;s;s=s.nextSibling)if(a=l.get(s)){if(h=c0(s,e),t<(f=a.length+(h?r:0))||t==f&&a.getSide()<=0)return h?H0(t,n,a,e,r,o,u):o(a,t,n);t-=f}else{if("number"!=typeof(h=z0(t,n,s,u)))return h;t=h}return o(i,i.length,-1)}return i.dom==e?u(e,t,n):o(i,t,n)}function z0(t,n,i,e){var r,o,u;if(3==i.nodeType){if(t<=(r=i.nodeValue.length))return e(i,t,n);t-=r}else if(1==i.nodeType&&"false"!=i.contentEditable)for(o=i.firstChild;o;o=o.nextSibling){if("number"!=typeof(u=z0(t,n,o,e)))return u;t=u}return t}function W0(t,n,i,e,r){var o,u,s,a,s;if(i instanceof sn)for(o=0,u=i.dom.firstChild;u;u=u.nextSibling)if(s=l.get(u)){if(a=c0(u,e),c0(u,t))return o+(a?W0(t,n,s,e,r):s.localPosFromDOM(t,n));o+=s.length+(a?r:0)}else{if(null!=(s=V0(t,n,u)).result)return o+s.result;o+=s.size}else if(i.dom==e)return Math.min(n,e.nodeValue.length);return i.localPosFromDOM(t,n)}function V0(t,n,i){var e,r,o,u;if(3==i.nodeType)return t==i?{result:n}:{size:i.nodeValue.length};if(1!=i.nodeType||"false"==i.contentEditable)return i.contains(t)?{result:0}:{size:0};for(r=i.firstChild,o=e=0;;r=r.nextSibling,o++){if(t==i&&o==n)return{result:e};if(!r)return{size:e};if(null!=(u=V0(t,n,r)).result)return{result:n+u.result};e+=u.size}}function $0(t){var n;return A(this,$0),(n=tf.call(this)).side=t,n}function q0(t,n){for(var i,e,r,o,u,s,a,h,f,c,i=t.dom,e=t.children,r=0,o=0;r<e.length;r++)if(!((s=o+(u=e[r]).length)==o&&u.getSide()<=0)){if(o<n&&n<s&&u.dom.parentNode==i)return u.domAtPos(n-o);if(n<=o)break;o=s}for(a=r;0<a;a--)if((h=e[a-1]).dom.parentNode==i)return h.domAtPos(h.length);for(f=r;f<e.length;f++)if((c=e[f]).dom.parentNode==i)return c.domAtPos(0);return new Qt(i,0)}function G0(t,n,i){var e,r=t.children;0<i&&n instanceof sn&&r.length&&(e=r[r.length-1])instanceof sn&&e.mark.eq(n.mark)?G0(e,n.children[0],i-1):(r.push(n),n.setParent(t)),t.length+=n.length}function J0(t,n,u){var s,a,h,f,n;function c(t,n){for(var i,e,r,o,i=0,e=0;i<t.children.length&&e<=n;i++)n<=(o=e+(r=t.children[i]).length)&&(r.children.length?c(r,n-e):(!h||h.isHidden&&0<u)&&(n<o||e==o&&0<r.getSide())?(h=r,f=n-e):(e<n||e==o&&r.getSide()<0&&!r.isHidden)&&(s=r,a=n-e)),e=o}return h=s=null,f=a=-1,c(t,n),(n=(u<0?s:h)||s||h)?n.coordsAt(Math.max(0,n==s?a:f),u):K0(t)}function K0(t){var n,n,n=t.dom.lastChild;return n?(n=d0(n))[n.length-1]||null:t.dom.getBoundingClientRect()}function Q0(t,n){for(var i in t)"class"==i&&n.class?n.class+=" "+t.class:"style"==i&&n.style?n.style+=";"+t.style:n[i]=t[i];return n}function X0(t,n){var i,e,r,o,u;if(t!=n){if(!t||!n)return!1;if(i=Object.keys(t),e=Object.keys(n),i.length!=e.length)return!1;for(r=0,o=i;r<o.length;r++)if(u=o[r],-1==e.indexOf(u)||t[u]!==n[u])return!1}return!0}function Z0(t,n,i){var e,r,o,e=null;if(n)for(r in n)i&&r in i||t.removeAttribute(e=r);if(i)for(o in i)n&&n[o]==i[o]||t.setAttribute(e=o,i[o]);return!!e}function Y0(){A(this,Y0)}function tv(t,n,i,e){var r;return A(this,tv),(r=ef.call(this)).startSide=t,r.endSide=n,r.widget=i,r.spec=e,r}function nv(t){var n,i,n,i;return A(this,nv),n=(i=rv(t)).start,i=i.end,(n=of.call(this,n?-1:5e8,i?1:-6e8,null,t)).tagName=t.tagName||"span",n.class=t.class||"",n.attrs=t.attributes||null,n}function iv(t){return A(this,iv),sf.call(this,-2e8,-2e8,null,t)}function ev(t,n,i,e,r,o){var i;return A(this,ev),(i=hf.call(this,n,i,r,t)).block=e,i.isReplace=o,i.mapMode=e?n<=0?f.TrackBefore:f.TrackAfter:f.TrackDel,i}function rv(t,n){var n,i,e,n=1<arguments.length&&void 0!==n&&n,i=t.inclusiveStart,e=t.inclusiveEnd;return{start:null!=(i=null==i?t.inclusive:i)?i:n,end:null!=(e=null==e?t.inclusive:e)?e:n}}function ov(t,n){return t==n||!!(t&&n&&t.compare(n))}function uv(t,n,i,e){var r,o,r,o=i.length-1;0<=o&&i[o]+(3<arguments.length&&void 0!==e?e:0)>=t?i[o]=Math.max(i[o],n):i.push(t,n)}function sv(){var t;return A(this,sv),(t=cf.apply(this,arguments)).children=[],t.length=0,t.prevAttrs=void 0,t.attrs=null,t.breakAfter=0,t}function av(t,n,i){var e;return A(this,av),(e=vf.call(this)).widget=t,e.length=n,e.type=i,e.breakAfter=0,e.prevWidget=null,e}function hv(t,n,i,e){A(this,hv),this.doc=t,this.pos=n,this.end=i,this.disallowBlockEffectsFor=e,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=n}function fv(t,n){var i,e,r,i=F(n);try{for(i.s();!(e=i.n()).done;)r=e.value,t=new sn(r,[t],t.length)}catch(t){i.e(t)}finally{i.f()}return t}function cv(t){var n;return A(this,cv),(n=yf.call(this)).tag=t,n}function lv(t){var n,i,e,r,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"nearest",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"nearest",e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:5,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:5;A(this,lv),this.range=t,this.y=n,this.x=i,this.yMargin=e,this.xMargin=r}function vv(t,n,i){var t=t.facet(bn);t.length?t[0](n):window.onerror?window.onerror(String(n),i,void 0,void 0,n):i?console.error(i+":",n):console.error(n)}function dv(t,n,i,e){A(this,dv),this.id=t,this.create=n,this.domEventHandlers=i,this.extension=e(this)}function yv(t){A(this,yv),this.spec=t,this.mustUpdate=null,this.value=null}function mv(t){var n,i,e,r,o,u,s,a,n=0,i=0,e=0,r=0,o=F(t.state.facet(_n));try{for(o.s();!(u=o.n()).done;)(a=(s=u.value)(t))&&(null!=a.left&&(n=Math.max(n,a.left)),null!=a.right&&(i=Math.max(i,a.right)),null!=a.top&&(e=Math.max(e,a.top)),null!=a.bottom)&&(r=Math.max(r,a.bottom))}catch(t){o.e(t)}finally{o.f()}return{left:n,right:i,top:e,bottom:r}}function pv(t,n,i,e){A(this,pv),this.fromA=t,this.toA=n,this.fromB=i,this.toB=e}function kv(t,n,i){var e,r,o,u;A(this,kv),this.view=t,this.state=n,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=K.empty(this.startState.doc.length),e=F(i);try{for(e.s();!(r=e.n()).done;)o=r.value,this.changes=this.changes.compose(o.changes)}catch(t){e.e(t)}finally{e.f()}u=[],this.changes.iterChangedRanges(function(t,n,i,e){return u.push(new Nn(t,n,i,e))}),this.changedRanges=u}function gv(t){for(var n,i,n=[],i=0;i<t.length;i++)n.push(1<<+t[i]);return n}D(x0,[{key:"eq",value:function t(n){return this.anchorNode==n.anchorNode&&this.anchorOffset==n.anchorOffset&&this.focusNode==n.focusNode&&this.focusOffset==n.focusOffset}},{key:"setRange",value:function t(n){var i=n.anchorNode,e=n.focusNode;this.set(i,Math.min(n.anchorOffset,i?k0(i):0),e,Math.min(n.focusOffset,e?k0(e):0))}},{key:"set",value:function t(n,i,e,r){this.anchorNode=n,this.anchorOffset=i,this.focusNode=e,this.focusOffset=r}}]),Gt=x0,D(A0,Jt=null,[{key:"before",value:function t(n,i){return new A0(n.parentNode,m0(n),i)}},{key:"after",value:function t(n,i){return new A0(n.parentNode,m0(n)+1,i)}}]),Qt=A0,Xt=[],D(D0,[{key:"overrideDOMText",get:function t(){return null}},{key:"posAtStart",get:function t(){return this.parent?this.parent.posBefore(this):0}},{key:"posAtEnd",get:function t(){return this.posAtStart+this.length}},{key:"posBefore",value:function t(n){var i,e,r,o,i=this.posAtStart,e=F(this.children);try{for(e.s();!(r=e.n()).done;){if((o=r.value)==n)return i;i+=o.length+o.breakAfter}}catch(t){e.e(t)}finally{e.f()}throw new RangeError("Invalid child in posBefore")}},{key:"posAfter",value:function t(n){return this.posBefore(n)+n.length}},{key:"sync",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l;if(2&this.dirty){e=this.dom,r=null,u=F(this.children);try{for(u.s();!(s=u.n()).done;){if((a=s.value).dirty&&(a.dom||!(o=r?r.nextSibling:e.firstChild)||(h=D0.get(o))&&(h.parent||!h.canReuseDOM(a))||a.reuseDOM(o),a.sync(n,i),a.dirty=0),o=r?r.nextSibling:e.firstChild,i&&!i.written&&i.node==e&&o!=a.dom&&(i.written=!0),a.dom.parentNode==e)for(;o&&o!=a.dom;)o=R0(o);else e.insertBefore(a.dom,o);r=a.dom}}catch(t){u.e(t)}finally{u.f()}for((o=r?r.nextSibling:e.firstChild)&&i&&i.node==e&&(i.written=!0);o;)o=R0(o)}else if(1&this.dirty){f=F(this.children);try{for(f.s();!(c=f.n()).done;)(l=c.value).dirty&&(l.sync(n,i),l.dirty=0)}catch(t){f.e(t)}finally{f.f()}}}},{key:"reuseDOM",value:function t(n){}},{key:"localPosFromDOM",value:function t(n,i){var e,r,o,u,s,a;if(n==this.dom)e=this.dom.childNodes[i];else{for(r=0==k0(n)?0:0==i?-1:1;(o=n.parentNode)!=this.dom;)0==r&&o.firstChild!=o.lastChild&&(r=n==o.firstChild?-1:1),n=o;e=r<0?n:n.nextSibling}if(e==this.dom.firstChild)return 0;for(;e&&!D0.get(e);)e=e.nextSibling;if(!e)return this.length;for(s=u=0;;u++){if((a=this.children[u]).dom==e)return s;s+=a.length+a.breakAfter}}},{key:"domBoundsAround",value:function t(n,i){for(var e,r,o,u,s,a,h,f,c,l,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=-1,o=-1,u=-1,s=-1,a=0,h=e,f=e;a<this.children.length;a++){if(l=h+(c=this.children[a]).length,h<n&&i<l)return c.domBoundsAround(n,i,h);if(n<=l&&-1==r&&(r=a,o=h),i<h&&c.dom.parentNode==this.dom){u=a,s=f;break}h=(f=l)+c.breakAfter}return{from:o,to:s<0?e+this.length:s,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&0<=u?this.children[u].dom:null}}},{key:"markDirty",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.dirty|=2,this.markParentsDirty(n)}},{key:"markParentsDirty",value:function t(n){for(var i=this.parent;i;i=i.parent){if(n&&(i.dirty|=2),1&i.dirty)return;i.dirty|=1,n=!1}}},{key:"setParent",value:function t(n){this.parent!=n&&(this.parent=n,this.dirty)&&this.markParentsDirty(!0)}},{key:"setDOM",value:function t(n){this.dom&&(this.dom.cmView=null),(this.dom=n).cmView=this}},{key:"rootView",get:function t(){for(var n,i,n=this;;){if(!(i=n.parent))return n;n=i}}},{key:"replaceChildren",value:function t(n,i){var e,r,o,u,s,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Xt;for(this.markDirty(),o=n;o<i;o++)(u=this.children[o]).parent==this&&u.destroy();for((e=this.children).splice.apply(e,[n,i-n].concat(yc(r))),s=0;s<r.length;s++)r[s].setParent(this)}},{key:"ignoreMutation",value:function t(n){return!1}},{key:"ignoreEvent",value:function t(n){return!1}},{key:"childCursor",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.length;return new Zt(this.children,n,this.children.length)}},{key:"childPos",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.childCursor().findPos(n,i)}},{key:"toString",value:function t(){var n=this.constructor.name.replace("View","");return n+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==n?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}},{key:"isEditable",get:function t(){return!0}},{key:"isWidget",get:function t(){return!1}},{key:"isHidden",get:function t(){return!1}},{key:"merge",value:function t(n,i,e,r,o,u){return!1}},{key:"become",value:function t(n){return!1}},{key:"canReuseDOM",value:function t(n){return n.constructor==this.constructor}},{key:"getSide",value:function t(){return 0}},{key:"destroy",value:function t(){this.parent=null}}],[{key:"get",value:function t(n){return n.cmView}}]),(l=D0).prototype.breakAfter=0,D(I0,[{key:"findPos",value:function t(n){for(var i,e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;;){if(n>this.pos||n==this.pos&&(0<i||0==this.i||this.children[this.i-1].breakAfter))return this.off=n-this.pos,this;e=this.children[--this.i],this.pos-=e.length+e.breakAfter}}}]),Zt=I0,n="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},zt="undefined"!=typeof document?document:{documentElement:{style:{}}},i=/Edge\/(\d+)/.exec(n.userAgent),e=/MSIE \d/.test(n.userAgent),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(n.userAgent),o=!(Yt=!!(e||r||i))&&/gecko\/(\d+)/i.test(n.userAgent),tn=!Yt&&/Chrome\/(\d+)/.exec(n.userAgent),nn="webkitFontSmoothing"in zt.documentElement.style,rn=(en=!Yt&&/Apple Computer/.test(n.vendor))&&(/Mobile\/\w+/.test(n.userAgent)||2<n.maxTouchPoints),g={mac:rn||/Mac/.test(n.platform),windows:/Win/.test(n.platform),linux:/Linux|X11/.test(n.platform),ie:Yt,ie_version:e?zt.documentMode||6:r?+r[1]:i?+i[1]:0,gecko:o,gecko_version:o?+(/Firefox\/(\d+)/.exec(n.userAgent)||[0,0])[1]:0,chrome:!!tn,chrome_version:tn?+tn[1]:0,ios:rn,android:/Android\b/.test(n.userAgent),webkit:nn,safari:en,webkit_version:nn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=zt.documentElement.style.tabSize?"tab-size":"-moz-tab-size"},on=256,x(B0,l),qh=S(B0),D(B0,[{key:"length",get:function t(){return this.text.length}},{key:"createDOM",value:function t(n){this.setDOM(n||document.createTextNode(this.text))}},{key:"sync",value:function t(n,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}},{key:"reuseDOM",value:function t(n){3==n.nodeType&&this.createDOM(n)}},{key:"merge",value:function t(n,i,e){return(!e||e instanceof B0&&!(this.length-(i-n)+e.length>on))&&(this.text=this.text.slice(0,n)+(e?e.text:"")+this.text.slice(i),this.markDirty(),!0)}},{key:"split",value:function t(n){var i=new B0(this.text.slice(n));return this.text=this.text.slice(0,n),this.markDirty(),i}},{key:"localPosFromDOM",value:function t(n,i){return n==this.dom?i:i?this.text.length:0}},{key:"domAtPos",value:function t(n){return new Qt(this.dom,n)}},{key:"domBoundsAround",value:function t(n,i,e){return{from:e,to:e+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}},{key:"coordsAt",value:function t(n,i){return F0(this.dom,n,i)}}]),un=B0,x(_0,l),Jh=S(_0),D(_0,[{key:"setAttrs",value:function t(n){if(O0(n),this.mark.class&&(n.className=this.mark.class),this.mark.attrs)for(var i in this.mark.attrs)n.setAttribute(i,this.mark.attrs[i]);return n}},{key:"reuseDOM",value:function t(n){n.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(n),this.dirty|=6)}},{key:"sync",value:function t(n,i){this.dom?4&this.dirty&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),Cc(Dc(_0.prototype),"sync",this).call(this,n,i)}},{key:"merge",value:function t(n,i,e,r,o,u){return!(e&&(!(e instanceof _0&&e.mark.eq(this.mark))||n&&o<=0||i<this.length&&u<=0)||(L0(this,n,i,e?e.children:[],o-1,u-1),this.markDirty(),0))}},{key:"split",value:function t(n){var i,e,r,o,u,s,a,h,f,i=[],e=0,r=-1,o=0,u=F(this.children);try{for(u.s();!(s=u.n()).done;)n<(h=e+(a=s.value).length)&&i.push(e<n?a.split(n-e):a),r<0&&n<=e&&(r=o),e=h,o++}catch(t){u.e(t)}finally{u.f()}return f=this.length-n,this.length=n,-1<r&&(this.children.length=r,this.markDirty()),new _0(this.mark,i,f)}},{key:"domAtPos",value:function t(n){return q0(this,n)}},{key:"coordsAt",value:function t(n,i){return J0(this,n,i)}}]),sn=_0,x(N0,l),Qh=S(N0),D(N0,[{key:"split",value:function t(n){var i=N0.create(this.widget,this.length-n,this.side);return this.length-=n,i}},{key:"sync",value:function t(n){this.dom&&this.widget.updateDOM(this.dom,n)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(n)),this.dom.contentEditable="false")}},{key:"getSide",value:function t(){return this.side}},{key:"merge",value:function t(n,i,e,r,o,u){return!(e&&(!(e instanceof N0&&this.widget.compare(e.widget))||0<n&&o<=0||i<this.length&&u<=0)||(this.length=n+(e?e.length:0)+(this.length-i),0))}},{key:"become",value:function t(n){return n instanceof N0&&n.side==this.side&&this.widget.constructor==n.widget.constructor&&(this.widget.compare(n.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=n.widget,this.length=n.length,!0)}},{key:"ignoreMutation",value:function t(){return!0}},{key:"ignoreEvent",value:function t(n){return this.widget.ignoreEvent(n)}},{key:"overrideDOMText",get:function t(){var n,i,e,e,r;if(0==this.length)return k.empty;for(n=this;n.parent;)n=n.parent;return e=(e=n.view)&&e.state.doc,r=this.posAtStart,e?e.slice(r,r+this.length):k.empty}},{key:"domAtPos",value:function t(n){return(this.length?0==n:0<this.side)?Qt.before(this.dom):Qt.after(this.dom,n==this.length)}},{key:"domBoundsAround",value:function t(){return null}},{key:"coordsAt",value:function t(n,i){var i,e,r,o,i=this.widget.coordsAt(this.dom,n,i);if(i)return i;if(r=null,!(e=this.dom.getClientRects()).length)return null;for(o=0<n?e.length-1:0;r=e[o],!(0<n?0==o:o==e.length-1||r.top<r.bottom);o+=0<n?-1:1);return this.length?r:g0(r,0<this.side)}},{key:"isEditable",get:function t(){return!1}},{key:"isWidget",get:function t(){return!0}},{key:"isHidden",get:function t(){return this.widget.isHidden}},{key:"destroy",value:function t(){Cc(Dc(N0.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom)}}],[{key:"create",value:function t(n,i,e){return new(n.customView||N0)(n,i,e)}}]),x(U0,an=N0),Zh=S(U0),D(U0,[{key:"domAtPos",value:function t(n){var i=this.widget,e=i.topView,i=i.text;return e?H0(n,0,e,i,this.length-e.length,function(t,n){return t.domAtPos(n)},function(t,n){return new Qt(t,Math.min(n,t.nodeValue.length))}):new Qt(i,Math.min(n,i.nodeValue.length))}},{key:"sync",value:function t(){this.setDOM(this.widget.toDOM())}},{key:"localPosFromDOM",value:function t(n,i){var e=this.widget,r=e.topView,e=e.text;return r?W0(n,i,r,e,this.length-r.length):Math.min(i,this.length)}},{key:"ignoreMutation",value:function t(){return!1}},{key:"overrideDOMText",get:function t(){return null}},{key:"coordsAt",value:function t(n,i){var e=this.widget,r=e.topView,e=e.text;return r?H0(n,i,r,e,this.length-r.length,function(t,n,i){return t.coordsAt(n,i)},F0):F0(e,n,i)}},{key:"destroy",value:function t(){var n;Cc(Dc(U0.prototype),"destroy",this).call(this),null!=(n=this.widget.topView)&&n.destroy()}},{key:"isEditable",get:function t(){return!0}},{key:"canReuseDOM",value:function t(){return!0}}]),hn=U0,x($0,l),tf=S($0),D($0,[{key:"length",get:function t(){return 0}},{key:"merge",value:function t(){return!1}},{key:"become",value:function t(n){return n instanceof $0&&n.side==this.side}},{key:"split",value:function t(){return new $0(this.side)}},{key:"sync",value:function t(){var n;this.dom||((n=document.createElement("img")).className="cm-widgetBuffer",n.setAttribute("aria-hidden","true"),this.setDOM(n))}},{key:"getSide",value:function t(){return this.side}},{key:"domAtPos",value:function t(n){return 0<this.side?Qt.before(this.dom):Qt.after(this.dom)}},{key:"localPosFromDOM",value:function t(){return 0}},{key:"domBoundsAround",value:function t(){return null}},{key:"coordsAt",value:function t(n){return this.dom.getBoundingClientRect()}},{key:"overrideDOMText",get:function t(){return k.empty}},{key:"isHidden",get:function t(){return!0}}]),fn=$0,un.prototype.children=an.prototype.children=fn.prototype.children=Xt,D(Y0,[{key:"eq",value:function t(n){return!1}},{key:"updateDOM",value:function t(n,i){return!1}},{key:"compare",value:function t(n){return this==n||this.constructor==n.constructor&&this.eq(n)}},{key:"estimatedHeight",get:function t(){return-1}},{key:"ignoreEvent",value:function t(n){return!0}},{key:"coordsAt",value:function t(n,i,e){return null}},{key:"customView",get:function t(){return null}},{key:"isHidden",get:function t(){return!1}},{key:"destroy",value:function t(n){}}]),Yt=Y0,(e=P=P||{})[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",P=e,x(tv,t),ef=S(tv),D(tv,[{key:"heightRelevant",get:function t(){return!1}},{key:"hasHeight",value:function t(){return!!this.widget&&-1<this.widget.estimatedHeight}}],[{key:"mark",value:function t(n){return new cn(n)}},{key:"widget",value:function t(n){var i=n.side||0,e=!!n.block;return new vn(n,i+=e?0<i?3e8:-4e8:0<i?1e8:-1e8,i,e,n.widget||null,!1)}},{key:"replace",value:function t(n){var i,e,r,r,o,u,i=!!n.block,r=n.isBlockGap?(e=-5e8,4e8):(e=((o=(r=rv(n,i)).start)?i?-3e8:-1:5e8)-1,1+((u=r.end)?i?2e8:1:-6e8));return new vn(n,e,r,i,n.widget||null,!0)}},{key:"line",value:function t(n){return new ln(n)}},{key:"set",value:function t(n){var i;return j.of(n,1<arguments.length&&void 0!==arguments[1]&&arguments[1])}}]),(m=tv).none=j.empty,x(nv,m),of=S(nv),D(nv,[{key:"eq",value:function t(n){return this==n||n instanceof nv&&this.tagName==n.tagName&&this.class==n.class&&X0(this.attrs,n.attrs)}},{key:"range",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n;if(i<=n)throw new RangeError("Mark decorations may not be empty");return Cc(Dc(nv.prototype),"range",this).call(this,n,i)}}]),(cn=nv).prototype.point=!1,x(iv,m),sf=S(iv),D(iv,[{key:"eq",value:function t(n){return n instanceof iv&&this.spec.class==n.spec.class&&X0(this.spec.attributes,n.spec.attributes)}},{key:"range",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n;if(i!=n)throw new RangeError("Line decoration ranges must be zero-length");return Cc(Dc(iv.prototype),"range",this).call(this,n,i)}}]),(ln=iv).prototype.mapMode=f.TrackBefore,ln.prototype.point=!0,x(ev,m),hf=S(ev),D(ev,[{key:"type",get:function t(){return this.startSide<this.endSide?P.WidgetRange:this.startSide<=0?P.WidgetBefore:P.WidgetAfter}},{key:"heightRelevant",get:function t(){return this.block||!!this.widget&&5<=this.widget.estimatedHeight}},{key:"eq",value:function t(n){return n instanceof ev&&ov(this.widget,n.widget)&&this.block==n.block&&this.startSide==n.startSide&&this.endSide==n.endSide}},{key:"range",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n;if(this.isReplace&&(i<n||n==i&&0<this.startSide&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(this.isReplace||i==n)return Cc(Dc(ev.prototype),"range",this).call(this,n,i);throw new RangeError("Widget decorations can only have zero-length ranges")}}]),(vn=ev).prototype.point=!0,x(sv,l),cf=S(sv),D(sv,[{key:"merge",value:function t(n,i,e,r,o,u){if(e){if(!(e instanceof sv))return!1;this.dom||e.transferDOM(this)}return r&&this.setDeco(e?e.attrs:null),L0(this,n,i,e?e.children:[],o,u),!0}},{key:"split",value:function t(n){var i,e,r,e,o,i=new sv;if(i.breakAfter=this.breakAfter,0!=this.length){for(r=(e=this.childPos(n)).i,(e=e.off)&&(i.append(this.children[r].split(e),0),this.children[r].merge(e,this.children[r].length,null,!1,0,0),r++),o=r;o<this.children.length;o++)i.append(this.children[o],0);for(;0<r&&0==this.children[r-1].length;)this.children[--r].destroy();this.children.length=r,this.markDirty(),this.length=n}return i}},{key:"transferDOM",value:function t(n){this.dom&&(this.markDirty(),n.setDOM(this.dom),n.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}},{key:"setDeco",value:function t(n){X0(this.attrs,n)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=n)}},{key:"append",value:function t(n,i){G0(this,n,i)}},{key:"addLineDeco",value:function t(n){var i=n.spec.attributes,n=n.spec.class;i&&(this.attrs=Q0(i,this.attrs||{})),n&&(this.attrs=Q0({class:n},this.attrs||{}))}},{key:"domAtPos",value:function t(n){return q0(this,n)}},{key:"reuseDOM",value:function t(n){"DIV"==n.nodeName&&(this.setDOM(n),this.dirty|=6)}},{key:"sync",value:function t(n,i){var n,e,i;for(this.dom?4&this.dirty&&(O0(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Z0(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),Cc(Dc(sv.prototype),"sync",this).call(this,n,i),e=this.dom.lastChild;e&&l.get(e)instanceof sn;)e=e.lastChild;e&&this.length&&("BR"==e.nodeName||0!=(null==(n=l.get(e))?void 0:n.isEditable)||g.ios&&this.children.some(function(t){return t instanceof un}))||((i=document.createElement("BR")).cmIgnore=!0,this.dom.appendChild(i))}},{key:"measureTextSize",value:function t(){var n,i,e,r,o,u;if(0==this.children.length||20<this.length)return null;n=0,e=F(this.children);try{for(e.s();!(r=e.n()).done;){if(!((o=r.value)instanceof un)||/[^ -~]/.test(o.text))return null;if(1!=(u=d0(o.dom)).length)return null;n+=u[0].width,i=u[0].height}}catch(t){e.e(t)}finally{e.f()}return n?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:n/this.length,textHeight:i}:null}},{key:"coordsAt",value:function t(n,i){var n,i,e,e,n=J0(this,n,i);return!this.children.length&&n&&this.parent&&(i=this.parent.view.viewState.heightOracle,e=n.bottom-n.top,Math.abs(e-i.lineHeight)<2)&&i.textHeight<e?(e=(e-i.textHeight)/2,{top:n.top+e,bottom:n.bottom-e,left:n.left,right:n.left}):n}},{key:"become",value:function t(n){return!1}},{key:"type",get:function t(){return P.Text}}],[{key:"find",value:function t(n,i){for(var e,r,o,u,e=0,r=0;e<n.children.length;e++){if(i<=(u=r+(o=n.children[e]).length)){if(o instanceof sv)return o;if(i<u)break}r=u+o.breakAfter}return null}}]),dn=sv,x(av,l),vf=S(av),D(av,[{key:"merge",value:function t(n,i,e,r,o,u){return!(e&&(!(e instanceof av&&this.widget.compare(e.widget))||0<n&&o<=0||i<this.length&&u<=0)||(this.length=n+(e?e.length:0)+(this.length-i),0))}},{key:"domAtPos",value:function t(n){return 0==n?Qt.before(this.dom):Qt.after(this.dom,n==this.length)}},{key:"split",value:function t(n){var i,n,i=this.length-n;return this.length=n,(n=new av(this.widget,i,this.type)).breakAfter=this.breakAfter,n}},{key:"children",get:function t(){return Xt}},{key:"sync",value:function t(n){this.dom&&this.widget.updateDOM(this.dom,n)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(n)),this.dom.contentEditable="false")}},{key:"overrideDOMText",get:function t(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):k.empty}},{key:"domBoundsAround",value:function t(){return null}},{key:"become",value:function t(n){return n instanceof av&&n.widget.constructor==this.widget.constructor&&(n.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=n.widget,this.length=n.length,this.type=n.type,this.breakAfter=n.breakAfter,!0)}},{key:"ignoreMutation",value:function t(){return!0}},{key:"ignoreEvent",value:function t(n){return this.widget.ignoreEvent(n)}},{key:"isEditable",get:function t(){return!1}},{key:"isWidget",get:function t(){return!0}},{key:"coordsAt",value:function t(n,i){return this.widget.coordsAt(this.dom,n,i)}},{key:"destroy",value:function t(){Cc(Dc(av.prototype),"destroy",this).call(this),this.dom&&this.widget.destroy(this.dom)}}]),yn=av,D(hv,[{key:"posCovered",value:function t(){var n;return 0==this.content.length?!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos:!((n=this.content[this.content.length-1]).breakAfter||n instanceof yn&&n.type==P.WidgetBefore)}},{key:"getLine",value:function t(){return this.curLine||(this.content.push(this.curLine=new dn),this.atCursorPos=!0),this.curLine}},{key:"flushBuffer",value:function t(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.bufferMarks;this.pendingBuffer&&(this.curLine.append(fv(new fn(-1),n),n.length),this.pendingBuffer=0)}},{key:"addBlockWidget",value:function t(n){this.flushBuffer(),this.curLine=null,this.content.push(n)}},{key:"finish",value:function t(n){this.pendingBuffer&&n<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}},{key:"buildText",value:function t(n,i,e){for(var r,o,u,r,r;0<n;){if(this.textOff==this.text.length){if(o=(r=this.cursor.next(this.skip)).value,u=r.lineBreak,r=r.done,this.skip=0,r)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,n--;continue}this.text=o,this.textOff=0}r=Math.min(this.text.length-this.textOff,n,512),this.flushBuffer(i.slice(i.length-e)),this.getLine().append(fv(new un(this.text.slice(this.textOff,this.textOff+r)),i),e),this.atCursorPos=!0,this.textOff+=r,n-=r,e=0}}},{key:"span",value:function t(n,i,e,r){this.buildText(i-n,e,r),this.pos=i,this.openStart<0&&(this.openStart=r)}},{key:"point",value:function t(n,i,e,r,o,u){var u,s,s,a,h,f;if(this.disallowBlockEffectsFor[u]&&e instanceof vn){if(e.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}u=i-n,e instanceof vn?e.block?((s=e.type)!=P.WidgetAfter||this.posCovered()||this.getLine(),this.addBlockWidget(new yn(e.widget||new pn("div"),u,s))):(s=an.create(e.widget||new pn("span"),u,u?0:e.startSide),a=this.atCursorPos&&!s.isEditable&&o<=r.length&&(n<i||0<e.startSide),h=!s.isEditable&&(n<i||o>r.length||e.startSide<=0),f=this.getLine(),2!=this.pendingBuffer||a||s.isEditable||(this.pendingBuffer=0),this.flushBuffer(r),a&&(f.append(fv(new fn(1),r),o),o=r.length+Math.max(0,o-r.length)),f.append(fv(s,r),o),this.atCursorPos=h,this.pendingBuffer=h?n<i||o>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())):this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(e),u&&(this.textOff+u<=this.text.length?this.textOff+=u:(this.skip+=u-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=o)}}],[{key:"build",value:function t(n,i,e,r,o){var n=new hv(n,i,e,o);return n.openEnd=j.spans(r,i,e,n),n.openStart<0&&(n.openStart=n.openEnd),n.finish(n.openEnd),n}}]),mn=hv,x(cv,Yt),yf=S(cv),D(cv,[{key:"eq",value:function t(n){return n.tag==this.tag}},{key:"toDOM",value:function t(){return document.createElement(this.tag)}},{key:"updateDOM",value:function t(n){return n.nodeName.toLowerCase()==this.tag}},{key:"isHidden",get:function t(){return!0}}]),pn=cv,kn=y.define(),gn=y.define(),wn=y.define(),bn=y.define(),Mn=y.define(),xn=y.define(),Sn=y.define(),Cn=y.define({combine:function t(n){return n.some(function(t){return t})}}),jn=y.define({combine:function t(n){return n.some(function(t){return t})}}),D(lv,[{key:"map",value:function t(n){return n.empty?this:new lv(this.range.map(n),this.y,this.x,this.yMargin,this.xMargin)}}]),Pn=lv,On=v.define({map:function t(n,i){return n.map(i)}}),En=y.define({combine:function t(n){return!n.length||n[0]}}),An=0,Dn=y.define(),D(dv,null,[{key:"define",value:function t(n,i){var i=i||{},e=i.eventHandlers,r=i.provide,o=i.decorations;return new dv(An++,n,e,function(n){var t=[Dn.of(n)];return o&&t.push(Ln.of(function(t){var t=t.plugin(n);return t?o(t):m.none})),r&&t.push(r(n)),t})}},{key:"fromClass",value:function t(n,i){return dv.define(function(t){return new n(t)},i)}}]),u=dv,D(yv,[{key:"update",value:function n(i){if(this.value){if(this.mustUpdate){var n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(t){if(vv(n.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(i)}catch(t){vv(i.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}},{key:"destroy",value:function t(n){var i;if(null!=(i=this.value)&&i.destroy)try{this.value.destroy()}catch(t){vv(n.state,t,"CodeMirror plugin crashed")}}},{key:"deactivate",value:function t(){this.spec=this.value=null}}]),Rn=yv,In=y.define(),Tn=y.define(),Ln=y.define(),Bn=y.define(),_n=y.define(),Fn=y.define(),D(pv,[{key:"join",value:function t(n){return new pv(Math.min(this.fromA,n.fromA),Math.max(this.toA,n.toA),Math.min(this.fromB,n.fromB),Math.max(this.toB,n.toB))}},{key:"addToSet",value:function t(n){for(var i,e,r,i=n.length,e=this;0<i;i--)if(!((r=n[i-1]).fromA>e.toA)){if(r.toA<e.fromA)break;e=e.join(r),n.splice(i-1,1)}return n.splice(i,0,e),n}}],[{key:"extendWithRanges",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,c,v;if(0==i.length)return n;for(e=[],s=u=o=r=0;;r++){for(h=u-s,f=(a=r==n.length?null:n[r])?a.fromB:1e9;o<i.length&&i[o]<f&&(c=i[o],l=i[o+1],(c=Math.max(s,c))<=(v=Math.min(f,l))&&new pv(c+h,v+h,c,v).addToSet(e),!(f<l));)o+=2;if(!a)return e;new pv(a.fromA,a.toA,a.fromB,a.toB).addToSet(e),u=a.toA,s=a.toB}}}]),Nn=pv,D(kv,[{key:"viewportChanged",get:function t(){return 0<(4&this.flags)}},{key:"heightChanged",get:function t(){return 0<(2&this.flags)}},{key:"geometryChanged",get:function t(){return this.docChanged||0<(10&this.flags)}},{key:"focusChanged",get:function t(){return 0<(1&this.flags)}},{key:"docChanged",get:function t(){return!this.changes.empty}},{key:"selectionSet",get:function t(){return this.transactions.some(function(t){return t.selection})}},{key:"empty",get:function t(){return 0==this.flags&&0==this.transactions.length}}],[{key:"create",value:function t(n,i,e){return new kv(n,i,e)}}]),Un=kv,(r=E=E||{})[r.LTR=0]="LTR",r[r.RTL=1]="RTL",Hn=(E=r).LTR,zn=E.RTL,Wn=gv("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Vn=gv("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),$n=Object.create(null),qn=[];for(Gn=0,Jn=["()","[]","{}"];Gn<Jn.length;Gn++)Qn=(Kn=Jn[Gn]).charCodeAt(0),Kn=Kn.charCodeAt(1),$n[Qn]=Kn,$n[Kn]=-Qn;function wv(t){return t<=247?Wn[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Vn[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8203?256:64336<=t&&t<=65023?4:8204==t?256:1}function bv(t,n,i){A(this,bv),this.from=t,this.to=n,this.level=i}function Mv(t,n){var i,e,B,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,k,w,b,b,M,x,S,C,j,_,F,N,P,O,E,A,D,R,U,I,T,H,L,i=t.length,e=n==Hn?1:2,B=n==Hn?2:1;if(!t||1==e&&!Xn.test(t))return xv(i);for(r=0,u=o=e;r<i;r++)512==(s=wv(t.charCodeAt(r)))?s=o:8==s&&4==u&&(s=16),z[r]=4==s?2:s,7&s&&(u=s),o=s;for(a=0,f=h=e;a<i;a++){if(128==(c=z[a]))a<i-1&&h==z[a+1]&&24&h?c=z[a]=h:z[a]=256;else if(64==c){for(l=a+1;l<i&&64==z[l];)l++;for(v=a&&8==h||l<i&&8==z[l]?1==f?1:8:256,d=a;d<l;d++)z[d]=v;a=l-1}else 8==c&&1==f&&(z[a]=1);7&(h=c)&&(f=c)}for(p=m=y=0;y<i;y++)if(g=$n[k=t.charCodeAt(y)])if(g<0){for(w=m-3;0<=w;w-=3)if(qn[w+1]==-g){(b=2&(b=qn[w+2])?e:4&b?1&b?B:e:0)&&(z[y]=z[qn[w]]=b),m=w;break}}else{if(189==qn.length)break;qn[m++]=y,qn[m++]=k,qn[m++]=p}else if(2==(k=z[y])||1==k)for(p=(M=k==e)?0:1,x=m-3;0<=x&&!(2&(S=qn[x+2]));x-=3)if(M)qn[x+2]|=2;else{if(4&S)break;qn[x+2]|=4}for(C=0;C<i;C++)if(256==z[C]){for(j=C+1;j<i&&256==z[j];)j++;for(N=(_=1==(C?z[C-1]:e))==(F=1==(j<i?z[j]:e))?_?1:2:e,P=C;P<j;P++)z[P]=N;C=j-1}if(O=[],1==e)for(E=0;E<i;){for(A=E,D=1!=z[E++];E<i&&D==(1!=z[E]);)E++;if(D)for(R=E;A<R;){for(U=R,I=2!=z[--R];A<R&&I==(2!=z[R-1]);)R--;O.push(new Zn(R,U,I?2:1))}else O.push(new Zn(A,E,0))}else for(T=0;T<i;){for(H=T,L=2==z[T++];T<i&&L==(2==z[T]);)T++;O.push(new Zn(H,T,L?1:2))}return O}function xv(t){return[new Zn(0,t,0)]}function Sv(t,n,i,e,r){var o,u,s,o,o,e,a,u,u=e.head-t.from,s=-1;if(0==u){if(!r||!t.length)return null;n[0].level!=i&&(u=n[0].side(!1,i),s=0)}else if(u==t.length){if(r)return null;(o=n[n.length-1]).level!=i&&(u=o.side(!0,i),s=n.length-1)}return u==(o=n[s=s<0?Zn.find(n,u,null!=(o=e.bidiLevel)?o:-1,e.assoc):s]).side(r,i)&&(u=(o=n[s+=r?1:-1]).side(!r,i)),e=r==(o.dir==i),a=Jc(t.text,u,e),Yn=t.text.slice(Math.min(u,a),Math.max(u,a)),a!=o.side(r,i)?O.cursor(a+t.from,e?-1:1,o.level):(u=s==(r?n.length-1:0)?null:n[s+(r?1:-1)])||o.level==i?u&&u.level<o.level?O.cursor(u.side(!r,i)+t.from,r?1:-1,u.level):O.cursor(a+t.from,r?-1:1,o.level):O.cursor(r?t.to:t.from,r?-1:1,i)}function Cv(t,n){A(this,Cv),this.points=t,this.text="",this.lineSeparator=n.facet(C.lineSeparator)}function jv(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function Pv(t){var n;return A(this,Pv),(n=pf.call(this)).view=t,n.compositionDeco=m.none,n.decorations=[],n.dynamicDecorationMap=[],n.minWidth=0,n.minWidthFrom=0,n.minWidthTo=0,n.impreciseAnchor=null,n.impreciseHead=null,n.forceSelection=!1,n.lastUpdate=Date.now(),n.setDOM(t.contentDOM),n.children=[new dn],n.children[0].setParent(Ec(n)),n.updateDeco(),n.updateInner([new Nn(0,0,0,t.state.doc.length)],0),n}function Ov(t){return 1==t.node.nodeType&&t.node.firstChild&&(0==t.offset||"false"==t.node.childNodes[t.offset-1].contentEditable)&&(t.offset==t.node.childNodes.length||"false"==t.node.childNodes[t.offset].contentEditable)}function Ev(t){var n;return A(this,Ev),(n=gf.call(this)).height=t,n}function Av(t){var n,n,i,e,r,t,o,u,t,n=t.observer.selectionRange,n=n.focusNode&&Iv(n.focusNode,n.focusOffset,0);if(!n)return null;if(!(i=t.docView.nearest(n)))return null;if(i instanceof dn){for(e=n;e.parentNode!=i.dom;)e=e.parentNode;for(r=e.previousSibling;r&&!l.get(r);)r=r.previousSibling;return{from:t=r?l.get(r).posAtEnd:i.posAtStart,to:t,node:e,text:n}}for(;;){if(!(u=i.parent))return null;if(u instanceof dn)break;i=u}return{from:t=i.posAtStart,to:t+i.length,node:i.dom,text:n}}function Dv(t,n){var i,e,r,o,i,e,n,r,t,r,i=Av(t);if(!i)return m.none;if(e=i.from,r=i.to,o=i.node,i=i.text,e=n.mapPos(e,1),n=Math.max(e,n.mapPos(r,-1)),r=t.state,-1<(t=3==o.nodeType?o.nodeValue:new ni([],r).readRange(o.firstChild,null).text).indexOf(ti))return m.none;if(n-e<t.length)if(r.doc.sliceString(e,Math.min(r.doc.length,e+t.length))==t)n=e+t.length;else{if(r.doc.sliceString(Math.max(0,n-t.length),n)!=t)return m.none;e=n-t.length}else if(r.doc.sliceString(e,n)!=t)return m.none;return(r=l.get(o))instanceof hn?r=r.widget.topView:r&&(r.parent=null),m.set(m.replace({widget:new oi(o,i,r),inclusive:!0}).range(e,n))}function Rv(t,n,i){var e;return A(this,Rv),(e=bf.call(this)).top=t,e.text=n,e.topView=i,e}function Iv(t,n,i){var e,r,o,u;if(i<=0)for(e=t,r=n;;){if(3==e.nodeType)return e;if(!(1==e.nodeType&&0<r))break;r=k0(e=e.childNodes[r-1])}if(0<=i)for(o=t,u=n;;){if(3==o.nodeType)return o;if(!(1==o.nodeType&&u<o.childNodes.length&&0<=i))break;o=o.childNodes[u],u=0}return null}function Tv(t,n){return 1!=t.nodeType?0:(n&&"false"==t.childNodes[n-1].contentEditable?1:0)|(n<t.childNodes.length&&"false"==t.childNodes[n].contentEditable?2:0)}function Lv(){A(this,Lv),this.changes=[]}function Bv(t,n,i){var e=new ui;return j.compare(t,n,i,e),e.changes}function _v(t,n){for(var i=t;i&&i!=n;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return 1}function Fv(t,n,i){var i,e,r,t,o,u,s,a,h,i=2<arguments.length&&void 0!==i?i:1,e=t.charCategorizer(n),r=t.doc.lineAt(n),t=n-r.from;if(0==r.length)return O.cursor(n);for(0==t?i=1:t==r.length&&(i=-1),u=o=t,i<0?o=Jc(r.text,t,!1):u=Jc(r.text,t),s=e(r.text.slice(o,u));0<o&&(a=Jc(r.text,o,!1),e(r.text.slice(a,o))==s);)o=a;for(;u<r.length&&(h=Jc(r.text,u),e(r.text.slice(u,h))==s);)u=h;return O.range(o+r.from,u+r.from)}function Nv(t,n){return n.left>t?n.left-t:Math.max(0,t-n.right)}function Uv(t,n){return n.top>t?n.top-t:Math.max(0,t-n.bottom)}function Hv(t,n){return t.top<n.bottom-1&&t.bottom>n.top+1}function zv(t,n){return n<t.top?{top:n,left:t.left,right:t.right,bottom:t.bottom}:t}function Wv(t,n){return n>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:n}:t}function Vv(t,n,i){for(var e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,p,k,g,s=!1,l=t.firstChild;l;l=l.nextSibling)for(v=d0(l),d=0;d<v.length;d++){if(y=v[d],m=Nv(n,y=r&&Hv(r,y)?zv(Wv(y,r.bottom),r.top):y),p=Uv(i,y),0==m&&0==p)return(3==l.nodeType?$v:Vv)(l,n,i);(!e||p<u||u==p&&m<o)&&(e=l,r=y,o=m,s=!(p=(u=p)?i<y.top?-1:1:m?n<y.left?-1:1:0)||(0<p?d<v.length-1:0<d)),0==m?i>y.bottom&&(!f||f.bottom<y.bottom)?(a=l,f=y):i<y.top&&(!c||c.top>y.top)&&(h=l,c=y):f&&Hv(f,y)?f=Wv(f,y.bottom):c&&Hv(c,y)&&(c=zv(c,y.top))}return f&&f.bottom>=i?(e=a,r=f):c&&c.top<=i&&(e=h,r=c),e?(k=Math.max(r.left,Math.min(r.right,n)),3==e.nodeType?$v(e,k,i):s&&"false"!=e.contentEditable?Vv(e,k,i):{node:t,offset:g=Array.prototype.indexOf.call(t.childNodes,e)+(n>=(r.left+r.right)/2?1:0)}):{node:t,offset:0}}function $v(t,n,i){for(var e,r,o,u,s,a,h,f,c,l,v,d,e=t.nodeValue.length,r=-1,o=1e9,u=0,s=0;s<e;s++)for(a=C0(t,s,s+1).getClientRects(),h=0;h<a.length;h++)if((f=a[h]).top!=f.bottom&&(u=u||n-f.left,c=(f.top>i?f.top-i:i-f.bottom)-1,f.left-1<=n)&&f.right+1>=n&&c<o){if(v=l=n>=(f.left+f.right)/2,(g.chrome||g.gecko)&&(d=C0(t,s).getBoundingClientRect()).left==f.right&&(v=!l),c<=0)return{node:t,offset:s+(v?1:0)};r=s+(v?1:0),o=c}return{node:t,offset:-1<r?r:0<u?t.nodeValue.length:0}}function qv(t,n,i,e){var r,o,u,e,u,s,a,h,f,c,l,v,u,d,o,y,m,e,y,o,y,d,o,y,r=3<arguments.length&&void 0!==e?e:-1,e=t.contentDOM.getBoundingClientRect(),u=e.top+t.viewState.paddingTop,a=t.viewState.docHeight,h=n.x,f=n.y,c=f-u;if(c<0)return 0;if(a<c)return t.state.doc.length;for(l=t.defaultLineHeight/2,v=!1;(s=t.elementAtHeight(c)).type!=P.Text;)for(;!(0<=(c=0<r?s.bottom+l:s.top-l)&&c<=a);){if(v)return i?null:0;v=!0,r=-r}if(f=u+c,(u=s.from)<t.viewport.from)return 0==t.viewport.from?0:i?null:Gv(t,e,s,h,f);if(u>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:Gv(t,e,s,h,f);if(d=t.dom.ownerDocument,(y=(y=(o=t.root.elementFromPoint?t.root:d).elementFromPoint(h,f))&&!t.contentDOM.contains(y)?null:y)||(h=Math.max(e.left+1,Math.min(e.right-1,h)),(y=o.elementFromPoint(h,f))&&!t.contentDOM.contains(y)&&(y=null)),e=-1,y&&0!=(null==(o=t.docView.nearest(y))?void 0:o.isEditable)&&(d.caretPositionFromPoint?(y=d.caretPositionFromPoint(h,f))&&(m=y.offsetNode,e=y.offset):d.caretRangeFromPoint&&(o=d.caretRangeFromPoint(h,f))&&(m=o.startContainer,e=o.startOffset,!t.contentDOM.contains(m)||g.safari&&Jv(m,e,h)||g.chrome&&Kv(m,e,h))&&(m=void 0)),!m||!t.docView.dom.contains(m)){if(!(y=dn.find(t.docView,u)))return c>s.top+s.height/2?s.to:s.from;m=(d=Vv(y.dom,h,f)).node,e=d.offset}return(o=t.docView.nearest(m))?o.isWidget&&1==(null==(u=o.dom)?void 0:u.nodeType)?(y=o.dom.getBoundingClientRect(),n.y<y.top||n.y<=y.bottom&&n.x<=(y.left+y.right)/2?o.posAtStart:o.posAtEnd):o.localPosFromDOM(m,e)+o.posAtStart:null}function Gv(t,n,i,e,r){var e,o,n,e=Math.round((e-n.left)*t.defaultCharacterWidth);return t.lineWrapping&&i.height>1.5*t.defaultLineHeight&&(e+=(o=Math.floor((r-i.top)/t.defaultLineHeight))*t.viewState.heightOracle.lineLength),n=t.state.sliceDoc(i.from,i.to),i.from+u0(n,e,t.state.tabSize)}function Jv(t,n,i){var n,e;if(3==t.nodeType&&n==(n=t.nodeValue.length)){for(e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return;return C0(t,n-1,n).getBoundingClientRect().left>i}}function Kv(t,n,i){var e,r,o;if(0==n){for(e=t;;){if(!(r=e.parentNode)||1!=r.nodeType||r.firstChild!=e)return;if(r.classList.contains("cm-line"))break;e=r}return 5<i-(o=(1==t.nodeType?t:C0(t,0,Math.max(t.nodeValue.length,1))).getBoundingClientRect()).left}}function Qv(t,n,i,e){var r,e,o,u,u,o,e,r=t.state.doc.lineAt(n.head),e=e&&t.lineWrapping?t.coordsAtPos(n.assoc<0&&n.head>r.from?n.head-1:n.head):null;return e&&(o=t.dom.getBoundingClientRect(),u=t.textDirectionAt(r.from),null!=(u=t.posAtCoords({x:i==(u==E.LTR)?o.right-1:o.left+1,y:(e.top+e.bottom)/2})))?O.cursor(u,i?-1:1):(e=(o=dn.find(t.docView,n.head))?i?o.posAtEnd:o.posAtStart:i?r.to:r.from,O.cursor(e,i?-1:1))}function Xv(t,n,i,e){for(var r,o,u,s,a,h,f,r=t.state.doc.lineAt(n.head),o=t.bidiSpans(r),u=t.textDirectionAt(r.from),s=n,a=null;;){if(h=Sv(r,o,u,s,i),f=Yn,!h){if(r.number==(i?t.state.doc.lines:1))return s;f="\n",r=t.state.doc.line(r.number+(i?1:-1)),o=t.bidiSpans(r),h=O.cursor(i?r.from:r.to)}if(a){if(!a(f))return s}else{if(!e)return h;a=e(f)}s=h}}function Zv(t,n,i){var e,r,e=t.state.charCategorizer(n),r=e(i);return function(t){var t=e(t);return(r=r==c.Space?t:r)==t}}function Yv(t,n,i,e){var r,o,u,s,a,i,h,i,f,c,l,v,d,r=n.head,o=i?1:-1;if(r==(i?t.state.doc.length:0))return O.cursor(r,n.assoc);for(u=n.goalColumn,a=t.contentDOM.getBoundingClientRect(),i=t.coordsAtPos(r),h=t.documentTop,s=i?(null==u&&(u=i.left-a.left),o<0?i.top:i.bottom):(i=t.viewState.lineBlockAt(r),null==u&&(u=Math.min(a.right-a.left,t.defaultCharacterWidth*(r-i.from))),(o<0?i.top:i.bottom)+h),f=a.left+u,c=null!=e?e:t.defaultLineHeight>>1,l=0;;l+=10)if(d=qv(t,{x:f,y:v=s+(c+l)*o},!1,o),v<a.top||v>a.bottom||(o<0?d<r:r<d))return O.cursor(d,n.assoc,void 0,u)}function td(o,u,s){for(var t=function t(){var r,n,i,e,r=0,n=F(o);try{for(n.s();!(i=n.n()).done;)(e=i.value).between(u-1,u+1,function(t,n,i){var e;t<u&&u<n&&(u=(e=r||s||(u-t<n-u?-1:1))<0?t:n,r=e)})}catch(t){n.e(t)}finally{n.f()}if(!r)return{v:u}},n;;)if(n=t())return n.v}function nd(n,t,i){var t=td(n.state.facet(Bn).map(function(t){return t(n)}),i.from,t.head>i.from?-1:1);return t==i.from?i:O.cursor(t,t<i.from?1:-1)}function id(e){var r,i,t,o,r=this;for(o in A(this,id),this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,i=function t(n,i){r.ignoreDuringComposition(i)||"keydown"==i.type&&r.keydown(e,i)||(r.mustFlushObserver(i)&&e.observer.forceFlush(),r.runCustomHandlers(i.type,e,i)?i.preventDefault():n(e,i))},t=function t(){var n=s[o];e.contentDOM.addEventListener(o,function(t){ad(e,t)&&i(n,t)},vi[o]),r.registeredEvents.push(o)},s)t();e.scrollDOM.addEventListener("mousedown",function(t){var n;t.target==e.scrollDOM&&t.clientY>e.contentDOM.getBoundingClientRect().bottom&&(i(s.mousedown,t),t.defaultPrevented||2!=t.button||(n=e.contentDOM.style.minHeight,e.contentDOM.style.minHeight="100%",setTimeout(function(){return e.contentDOM.style.minHeight=n},200)))}),e.scrollDOM.addEventListener("drop",function(t){t.target==e.scrollDOM&&t.clientY>e.contentDOM.getBoundingClientRect().bottom&&i(s.drop,t)}),g.chrome&&102==g.chrome_version&&e.scrollDOM.addEventListener("wheel",function(){r.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(r.chromeScrollHack),r.chromeScrollHack=setTimeout(function(){r.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,g.safari&&e.contentDOM.addEventListener("input",function(){return null})}function ed(t){return.7*Math.max(0,t)+8}function rd(n,t,i,e){A(this,rd),this.view=n,this.style=i,this.mustSelect=e,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=M0(n.contentDOM),this.atoms=n.state.facet(Bn).map(function(t){return t(n)});var i=n.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=n.state.facet(C.allowMultipleSelections)&&od(n,t),this.dragMove=ud(n,t),this.dragging=!(!sd(n,t)||1!=dd(t))&&null}function od(t,n){var t=t.state.facet(kn);return t.length?t[0](n):g.mac?n.metaKey:n.ctrlKey}function ud(t,n){var t=t.state.facet(gn);return t.length?t[0](n):g.mac?!n.altKey:!n.ctrlKey}function sd(t,n){var i,i,e,r,o,i=t.state.selection.main;if(!i.empty){if(!(i=f0(t.root))||0==i.rangeCount)return 1;for(e=i.getRangeAt(0).getClientRects(),r=0;r<e.length;r++)if((o=e[r]).left<=n.clientX&&o.right>=n.clientX&&o.top<=n.clientY&&o.bottom>=n.clientY)return 1}}function ad(t,n){if(!n.bubbles)return 1;if(!n.defaultPrevented){for(var i=n.target,e;i!=t.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(e=l.get(i))&&e.ignoreEvent(n))return;return 1}}function hd(t){var n,i,n=t.dom.parentNode;n&&((i=n.appendChild(document.createElement("textarea"))).style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(function(){t.focus(),i.remove(),fd(t,i.value)},50))}function fd(t,e){var r,n,o,u,s,i,a,r=t.state,o=1,u=r.toText(e),s=u.lines==r.selection.ranges.length,i,n=null!=bi&&r.selection.ranges.every(function(t){return t.empty})&&bi==u.toString()?(a=-1,r.changeByRange(function(t){var n,i,n=r.doc.lineAt(t.from);return n.from==a?{range:t}:(a=n.from,i=r.toText((s?u.line(o++).text:e)+r.lineBreak),{changes:{from:n.from,insert:i},range:O.cursor(t.from+i.length)})})):s?r.changeByRange(function(t){var n=u.line(o++);return{changes:{from:t.from,to:t.to,insert:n.text},range:O.cursor(t.from+n.length)}}):r.replaceSelection(u);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function cd(t,n,i,e){var e,i,n,e;return 1==e?O.cursor(n,i):2==e?Fv(t.state,n,i):(e=dn.find(t.docView,n),i=t.state.doc.lineAt(e?e.posAtEnd:n),n=e?e.posAtStart:i.from,(e=e?e.posAtEnd:i.to)<t.state.doc.length&&e==i.to&&e++,O.range(n,e))}function ld(t,n,i,e){var t,n,r,t,t=dn.find(t.docView,n);return t&&0!=(n=n-t.posAtStart)&&(n==t.length||(r=t.coordsAt(n,-1))&&mi(i,e,r)||(!(t=t.coordsAt(n,1))||!mi(i,e,t))&&r&&yi(e,r))?-1:1}function vd(t,n){var i=t.posAtCoords({x:n.clientX,y:n.clientY},!1);return{pos:i,bias:ld(t,i,n.clientX,n.clientY)}}function dd(t){var n,i;return pi?(n=ki,i=wi,ki=t,wi=Date.now(),gi=!n||i>Date.now()-400&&Math.abs(n.clientX-t.clientX)<2&&Math.abs(n.clientY-t.clientY)<2?(gi+1)%3:1):t.detail}function yd(s,t){var a,h,f,a=vd(s,t),h=dd(t),f=s.state.selection;return{update:function t(n){n.docChanged&&(a.pos=n.changes.mapPos(a.pos),f=f.map(n.changes))},get:function t(n,i,e){var n,r,o,r,u,r,n=vd(s,n),o=cd(s,n.pos,n.bias,h);return a.pos==n.pos||i||(r=cd(s,a.pos,a.bias,h),u=Math.min(r.from,o.from),r=Math.max(r.to,o.to),o=u<o.from?O.range(u,r):O.range(r,u)),i?f.replaceRange(f.main.extend(o.from,o.to)):e&&1==h&&1<f.ranges.length&&(r=md(f,n.pos))?r:e?f.addRange(o):O.create([o])}}}function md(t,n){for(var i,e,r,e,i=0;i<t.ranges.length;i++)if(r=(e=t.ranges[i]).from,e=e.to,r<=n&&n<=e)return O.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0));return null}function pd(t,n,i,e){var r,n,e,n,i;i&&(r=t.posAtCoords({x:n.clientX,y:n.clientY},!1),n.preventDefault(),n=t.inputState.mouseSelection,e=e&&n&&n.dragging&&n.dragMove?{from:n.dragging.from,to:n.dragging.to}:null,n={from:r,insert:i},i=t.state.changes(e?[e,n]:n),t.focus(),t.dispatch({changes:i,selection:{anchor:i.mapPos(r,-1),head:i.mapPos(r,1)},userEvent:e?"move.drop":"input.drop"}))}function kd(t,n){var i,e,i=t.dom.parentNode;i&&((e=i.appendChild(document.createElement("textarea"))).style.cssText="position: fixed; left: -10000px; top: 10px",e.value=n,e.focus(),e.selectionEnd=n.length,e.selectionStart=0,setTimeout(function(){e.remove(),t.focus()},50))}function gd(t){var n,i,e,r,o,u,s,a,h,f,c,n=[],i=[],e=!1,r=F(t.selection.ranges);try{for(r.s();!(o=r.n()).done;)(u=o.value).empty||(n.push(t.sliceDoc(u.from,u.to)),i.push(u))}catch(t){r.e(t)}finally{r.f()}if(!n.length){s=-1,a=F(t.selection.ranges);try{for(a.s();!(h=a.n()).done;)f=h.value.from,(c=t.doc.lineAt(f)).number>s&&(n.push(c.text),i.push({from:c.from,to:Math.min(t.doc.length,c.to+1)})),s=c.number}catch(t){a.e(t)}finally{a.f()}e=!0}return{text:n.join(t.lineBreak),ranges:i,linewise:e}}function wd(t,n){var i,e,r,o,u,i=[],e=F(t.facet(Sn));try{for(e.s();!(r=e.n()).done;)(u=(o=r.value)(t,n))&&i.push(u)}catch(t){e.e(t)}finally{e.f()}return i?t.update({effects:i,annotations:Mi.of(!0)}):null}function bd(n){setTimeout(function(){var t,t,t=n.hasFocus;t!=n.inputState.notifiedFocused&&((t=wd(n.state,t))?n.dispatch(t):n.update([]))},10)}function Md(t){A(this,Md),this.lineWrapping=t,this.doc=k.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}function xd(t,n){A(this,xd),this.from=t,this.heights=n,this.index=0}function Sd(t,n,i,e,r,o){A(this,Sd),this.from=t,this.length=n,this.top=i,this.height=e,this.children=r,this.deco=o}function Cd(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2;A(this,Cd),this.length=t,this.height=n,this.flags=i}function jd(t,n,i){var t;return A(this,jd),(t=xf.call(this,t,n)).deco=i,t}function Pd(t,n){var t;return A(this,Pd),(t=Cf.call(this,t,n,null)).collapsed=0,t.widgetHeight=0,t}function Od(t){return A(this,Od),Pf.call(this,t,0)}function Ed(t,n,i){var n;return A(this,Ed),(n=Ef.call(this,t.length+n+i.length,t.height+i.height,n|(t.outdated||i.outdated?2:0))).left=t,n.right=i,n.size=t.size+i.size,n}function Ad(t,n){var i,e;null==t[n]&&(i=t[n-1])instanceof Di&&(e=t[n+1])instanceof Di&&t.splice(n-1,3,new Di(i.length+1+e.length))}function Dd(t,n){A(this,Dd),this.pos=t,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}function Rd(t,n,i){var e=new Li;return j.compare(t,n,i,e,0),e.changes}function Id(){A(this,Id),this.changes=[]}function Td(t,n){for(var i,e,r,o,u,s,a,h,f,c,l,i=t.getBoundingClientRect(),e=t.ownerDocument,r=e.defaultView||window,o=Math.max(0,i.left),u=Math.min(r.innerWidth,i.right),s=Math.max(0,i.top),a=Math.min(r.innerHeight,i.bottom),h=t.parentNode;h&&h!=e.body;)if(1==h.nodeType)f=h,c=window.getComputedStyle(f),(f.scrollHeight>f.clientHeight||f.scrollWidth>f.clientWidth)&&"visible"!=c.overflow&&(l=f.getBoundingClientRect(),o=Math.max(o,l.left),u=Math.min(u,l.right),s=Math.max(s,l.top),a=h==t.parentNode?l.bottom:Math.min(a,l.bottom)),h="absolute"==c.position||"fixed"==c.position?f.offsetParent:f.parentNode;else{if(11!=h.nodeType)break;h=h.host}return{left:o-i.left,right:Math.max(o,u)-i.left,top:s-(i.top+n),bottom:Math.max(s,a)-(i.top+n)}}function Ld(t,n){var t=t.getBoundingClientRect();return{left:0,right:t.right-t.left,top:n,bottom:t.bottom-(t.top+n)}}function Bd(t,n,i){A(this,Bd),this.from=t,this.to=n,this.size=i}function _d(t,n){var i;return A(this,_d),(i=Df.call(this)).size=t,i.vertical=n,i}function Fd(t){A(this,Fd),this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=Ui,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=E.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;var n=t.facet(Tn).some(function(t){return"function"!=typeof t&&"cm-lineWrapping"==t.class});this.heightOracle=new Si(n),this.stateDeco=t.facet(Ln).filter(function(t){return"function"!=typeof t}),this.heightMap=Oi.empty().applyChanges(this.stateDeco,k.empty,this.heightOracle.setDoc(t.doc),[new Nn(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=m.set(this.lineGaps.map(function(t){return t.draw(!1)})),this.computeVisibleRanges()}function Nd(t,n,i){var e=[],r=t,o=0;return j.spans(i,t,n,{span:function t(){},point:function t(n,i){r<n&&(e.push({from:r,to:n}),o+=n-r),r=i}},20),r<n&&(e.push({from:r,to:n}),o+=n-r),{total:o,ranges:e}}function Ud(t,n){var i,e,r,o,u,s,a,u,i=t.total,e=t.ranges;if(n<=0)return e[0].from;if(1<=n)return e[e.length-1].to;for(r=Math.floor(i*n),o=0;;o++){if(s=(u=e[o]).from,r<=(u=(a=u.to)-s))return s+r;r-=u}}function Hd(t,n){var i,e,r,o,u,s,i=0,e=F(t.ranges);try{for(e.s();!(r=e.n()).done;){if(u=(o=r.value).from,n<=(s=o.to)){i+=n-u;break}i+=s-u}}catch(t){e.e(t)}finally{e.f()}return i/t.total}function zd(t,n){var i,e,r,i=F(t);try{for(i.s();!(e=i.n()).done;)if(n(r=e.value))return r}catch(t){i.e(t)}finally{i.f()}}function Wd(r,o,t){var u,n,i,e,s,a;A(this,Wd),i=n=u=0,this.viewports=t.map(function(t){var n,t,i,e,n=t.from,t=t.to,i=o.lineAt(n,d.ByPos,r,0,0).top,e=o.lineAt(t,d.ByPos,r,0,0).bottom;return u+=e-i,{from:n,to:t,top:i,bottom:e,domTop:0,domBottom:0}}),this.scale=(7e6-u)/(o.height-u),e=F(this.viewports);try{for(e.s();!(s=e.n()).done;)(a=s.value).domTop=i+(a.top-n)*this.scale,i=a.domBottom=a.domTop+(a.bottom-a.top),n=a.bottom}catch(t){e.e(t)}finally{e.f()}}function Vd(t,n){var i,e;return 1==n.scale?t:(i=n.toDOM(t.top),e=n.toDOM(t.bottom),new ji(t.from,t.length,i,e-i,t.children&&t.children.map(function(t){return Vd(t,n)}),t.deco))}function $d(i,t,e){return new _t(t,{finish:function t(n){return/&/.test(n)?n.replace(/&\w*/,function(t){if("&"==t)return i;if(e&&e[t])return e[t];throw new RangeError("Unsupported selector: ".concat(t))}):i+" "+n}})}function qd(e,t){var r,n,o,i,u,s,u,a,h,u,f,c,s,a,h,l,v,d,y,m,p,u,t,i,n=t.newSel,o=e.state.selection.main,i=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;return t.bounds?(s=(u=t.bounds).from,u=u.to,a=o.from,h=null,(8===i||g.android&&t.text.length<u-s)&&(a=o.to,h="end"),(u=Gd(e.state.doc.sliceString(s,u,ti),t.text,a-s,h))&&(g.chrome&&13==i&&u.toB==u.from+2&&"\uffff\uffff"==t.text.slice(u.from,u.toB)&&u.toB--,r={from:s+u.from,to:s+u.toA,insert:k.of(t.text.slice(u.from,u.toB).split(ti))})):n&&(!e.hasFocus&&e.state.facet(En)||n.main.eq(o))&&(n=null),!(!r&&!n||(!r&&t.typeOver&&!o.empty&&n&&n.main.empty?r={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,o.to)}:r&&r.from>=o.from&&r.to<=o.to&&(r.from!=o.from||r.to!=o.to)&&o.to-o.from-(r.to-r.from)<=4?r={from:o.from,to:o.to,insert:e.state.doc.slice(o.from,r.from).append(r.insert).append(e.state.doc.slice(r.to,o.to))}:(g.mac||g.android)&&r&&r.from==r.to&&r.from==o.head-1&&/^\. ?$/.test(r.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(n&&2==r.insert.length&&(n=O.single(n.main.anchor-1,n.main.head-1)),r={from:o.from,to:o.to,insert:k.of([" "])}):g.chrome&&r&&r.from==r.to&&r.from==o.head&&"\n "==r.insert.toString()&&e.lineWrapping&&(n=n&&O.single(n.main.anchor-1,n.main.head-1),r={from:o.from,to:o.to,insert:k.of([" "])}),r?(f=e.state,g.ios&&e.inputState.flushIOSKey(e)||g.android&&(r.from==o.from&&r.to==o.to&&1==r.insert.length&&2==r.insert.lines&&j0(e.contentDOM,"Enter",13)||(r.from==o.from-1&&r.to==o.to&&0==r.insert.length||8==i&&r.insert.length<r.to-r.from)&&j0(e.contentDOM,"Backspace",8)||r.from==o.from&&r.to==o.to+1&&0==r.insert.length&&j0(e.contentDOM,"Delete",46))||(c=r.insert.toString(),e.state.facet(xn).some(function(t){return t(e,r.from,r.to,c)}))||(0<=e.inputState.composing&&e.inputState.composing++,s=r.from>=o.from&&r.to<=o.to&&r.to-r.from>=(o.to-o.from)/3&&(!n||n.main.empty&&n.main.from==r.from+r.insert.length)&&e.inputState.composing<0?(a=o.from<r.from?f.sliceDoc(o.from,r.from):"",h=o.to>r.to?f.sliceDoc(r.to,o.to):"",f.replaceSelection(e.state.toText(a+r.insert.sliceString(0,void 0,e.state.lineBreak)+h))):(l=f.changes(r),v=n&&n.main.to<=l.newLength?n.main:void 0,1<f.selection.ranges.length&&0<=e.inputState.composing&&r.to<=o.to&&r.to>=o.to-10?(d=e.state.sliceDoc(r.from,r.to),y=Av(e)||e.state.doc.lineAt(o.head),m=o.to-r.to,p=o.to-o.from,f.changeByRange(function(t){var n,i,i,n;return t.from==o.from&&t.to==o.to?{changes:l,range:v||t.map(l)}:(i=(n=t.to-m)-d.length,t.to-t.from!=p||e.state.sliceDoc(i,n)!=d||y&&t.to>=y.from&&t.from<=y.to?{range:t}:(i=f.changes({from:i,to:n,insert:r.insert}),n=t.to-o.to,{changes:i,range:v?O.range(Math.max(0,v.anchor+n),Math.max(0,v.head+n)):t.map(i)}))})):{changes:l,selection:v&&f.selection.replaceRange(v)}),u="input.type",(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,u+=".compose",e.inputState.compositionFirstChange)&&(u+=".start",e.inputState.compositionFirstChange=!1),e.dispatch(s,{scrollIntoView:!0,userEvent:u})),0):!n||n.main.eq(o)||(t=!1,i="select",e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),i=e.inputState.lastSelectionOrigin),e.dispatch({selection:n,scrollIntoView:t,userEvent:i}),0)))}function Gd(t,n,i,e){for(var r,o,u,s,a,h,f,r=Math.min(t.length,n.length),o=0;o<r&&t.charCodeAt(o)==n.charCodeAt(o);)o++;if(o==r&&t.length==n.length)return null;for(u=t.length,s=n.length;0<u&&0<s&&t.charCodeAt(u-1)==n.charCodeAt(s-1);)u--,s--;return"end"==e&&(i-=u+(a=Math.max(0,o-Math.min(u,s)))-o),u<o&&t.length<n.length?(s=(o-=h=i<=o&&u<=i?o-i:0)+(s-u),u=o):s<o&&(u=(o-=f=i<=o&&s<=i?o-i:0)+(u-s),s=o),{from:o,toA:u,toB:s}}function Jd(t){var n,t,i,e,r,t,n=[];return t.root.activeElement==t.contentDOM&&(i=(t=t.observer.selectionRange).anchorNode,e=t.anchorOffset,r=t.focusNode,t=t.focusOffset,i)&&(n.push(new ii(i,e)),r==i&&t==e||n.push(new ii(r,t))),n}function Kd(t,n){var i,t;return 0!=t.length&&(i=t[0].pos,t=2==t.length?t[1].pos:i,-1<i)&&-1<t?O.single(i+n,t+n):null}function Qd(r){var o=this;A(this,Qd),this.view=r,this.active=!1,this.selectionRange=new Gt,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=r.contentDOM,this.observer=new MutationObserver(function(t){var n,i,e,n=F(t);try{for(n.s();!(i=n.n()).done;)e=i.value,o.queue.push(e)}catch(t){n.e(t)}finally{n.f()}(g.ie&&g.ie_version<=11||g.ios&&r.composing)&&t.some(function(t){return"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length})?o.flushSoon():o.flush()}),Xi&&(this.onCharData=function(t){o.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),o.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver(function(){var t;(null==(t=o.view.docView)?void 0:t.lastUpdate)<Date.now()-75&&o.onResize()}),this.resizeScroll.observe(r.scrollDOM),this.resizeContent=new ResizeObserver(function(){return o.view.requestMeasure()}),this.resizeContent.observe(r.contentDOM)),this.addWindowListeners(this.win=r.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver(function(t){o.parentCheck<0&&(o.parentCheck=setTimeout(o.listenForScroll.bind(o),1e3)),0<t.length&&0<t[t.length-1].intersectionRatio!=o.intersecting&&(o.intersecting=!o.intersecting,o.intersecting!=o.view.inView)&&o.onScrollChanged(document.createEvent("Event"))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(function(t){0<t.length&&0<t[t.length-1].intersectionRatio&&o.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}function Xd(t,n,i){for(var e,e;n;){if((e=l.get(n))&&e.parent==t)return e;n=(e=n.parentNode)!=t.dom?e:0<i?n.nextSibling:n.previousSibling}return null}function Zd(t){var n,i,e,r,o,t,t;function u(t){t.preventDefault(),t.stopImmediatePropagation(),n=t.getTargetRanges()[0]}return n=null,t.contentDOM.addEventListener("beforeinput",u,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",u,!0),n?(i=n.startContainer,e=n.startOffset,r=n.endContainer,o=n.endOffset,y0((t=t.docView.domAtPos(t.state.selection.main.anchor)).node,t.offset,r,o)&&(i=(t=[r,o,i,e])[0],e=t[1],r=t[2],o=t[3]),{anchorNode:i,anchorOffset:e,focusNode:r,focusOffset:o}):null}function Yd(){var n,t,i,e,r,n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};A(this,Yd),this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this.hue=t.dispatch||function(t){return n.update([t])},this.dispatch=this.dispatch.bind(this),this.Nkt=t.root||P0(t.parent)||document,this.viewState=new Fi(t.state||C.create(t)),this.plugins=this.state.facet(Dn).map(function(t){return new Rn(t)}),i=F(this.plugins);try{for(i.s();!(e=i.n()).done;)(r=e.value).update(this)}catch(t){i.e(t)}finally{i.f()}this.observer=new Zi(this),this.inputState=new si(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new ei(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}function t1(t,n,i,e){A(this,t1),this.from=t,this.to=n,this.dir=i,this.order=e}function n1(t,n,i){for(var e,r,o,o,e=t.state.facet(n),r=e.length-1;0<=r;r--)(o="function"==typeof(o=e[r])?o(t):o)&&Q0(o,i);return i}function i1(t,n){var i,t,e,r,o,u,s,a,i=t.split(/-(?!$)/),t=i[i.length-1];for("Space"==t&&(t=" "),s=0;s<i.length-1;++s)if(a=i[s],/^(cmd|meta|m)$/i.test(a))u=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))o=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==n?u=!0:r=!0}return e&&(t="Alt-"+t),r&&(t="Ctrl-"+t),u&&(t="Meta-"+t),t=o?"Shift-"+t:t}function e1(t,n,i){return n.altKey&&(t="Alt-"+t),n.ctrlKey&&(t="Ctrl-"+t),n.metaKey&&(t="Meta-"+t),t=!1!==i&&n.shiftKey?"Shift-"+t:t}function r1(t){var t,n,t=t.facet(ee),n=re.get(t);return n||re.set(t,n=u1(t.reduce(function(t,n){return t.concat(n)},[]))),n}function o1(t,n,i){return s1(r1(t.state),n,t,i)}function u1(t,n){var h,f,r,c,i,e,o,u,s,a,l,v,d,y,m,p,k,g,h=1<arguments.length&&void 0!==n?n:ie,f=Object.create(null),r=Object.create(null),c=function t(n,i){var e=r[n];if(null==e)r[n]=i;else if(e!=i)throw new Error("Key binding "+n+" is used both as a regular binding and as a multi-stroke prefix")},i=function t(e,n,i,r){for(var n,n,o,u,s,a,n,n,o=f[e]||(f[e]=Object.create(null)),u=n.split(/ (?!$)/).map(function(t){return i1(t,h)}),s=function t(){var i=u.slice(0,a).join(" ");c(i,!0),o[i]||(o[i]={preventDefault:!0,run:[function(t){var n=oe={view:t,prefix:i,scope:e};return setTimeout(function(){oe==n&&(oe=null)},ue),!0}]})},a=1;a<u.length;a++)s();n=u.join(" "),c(n,!1),n=o[n]||(o[n]={preventDefault:!1,run:(null==(n=null==(n=o.$de)?void 0:n.run)?void 0:n.slice())||[]}),i&&n.run.push(i),r&&(n.preventDefault=!0)},e=F(t);try{for(e.s();!(o=e.n()).done;){if(s=(u=o.value).scope?u.scope.split(" "):["editor"],u.any){a=F(s);try{for(a.s();!(l=a.n()).done;)for(y in v=l.value,(d=f[v]||(f[v]=Object.create(null))).$de||(d.$de={preventDefault:!1,run:[]}),d)d[y].run.push(u.any)}catch(t){a.e(t)}finally{a.f()}}if(m=u[h]||u.key){p=F(s);try{for(p.s();!(k=p.n()).done;)i(g=k.value,m,u.run,u.preventDefault),u.shift&&i(g,"Shift-"+m,u.shift,u.preventDefault)}catch(t){p.e(t)}finally{p.f()}}}}catch(t){e.e(t)}finally{e.f()}return f}function s1(t,o,u,n){var i,e,r,s,a,h,f,t,n,c,i=h0(o),e,r=nl(Yc(i,0))==i.length&&" "!=i,s="",a=!1;if(oe&&oe.view==u&&oe.scope==n&&(s=oe.prefix+" ",a=fi.indexOf(o.keyCode)<0)&&(oe=null),h=new Set,f=function t(n){var i,e,r;if(n){i=F(n.run);try{for(i.s();!(e=i.n()).done;)if(r=e.value,!h.has(r)&&(h.add(r),r(u,o)))return!0}catch(t){i.e(t)}finally{i.f()}n.preventDefault&&(a=!0)}return!1},t=t[n]){if(f(t[s+e1(i,o,!r)]))return!0;if(r&&(o.altKey||o.metaKey||o.ctrlKey)&&!(g.windows&&o.ctrlKey&&o.altKey)&&(n=Ut[o.keyCode])&&n!=i){if(f(t[s+e1(n,o,!0)]))return!0;if(o.shiftKey&&(c=Ht[o.keyCode])!=i&&c!=n&&f(t[s+e1(c,o,!1)]))return!0}else if(r&&o.shiftKey&&f(t[s+e1(i,o,!0)]))return!0;if(f(t.$de))return!0}return a}function a1(t,n,i,e,r){A(this,a1),this.className=t,this.left=n,this.top=i,this.width=e,this.height=r}function h1(t){var n,i,n=t.scrollDOM.getBoundingClientRect(),i;return{left:(t.textDirection==E.LTR?n.left:n.right-t.scrollDOM.clientWidth)-t.scrollDOM.scrollLeft,top:n.top-t.scrollDOM.scrollTop}}function f1(t,n,i){var n=O.cursor(n);return{from:Math.max(i.from,t.moveToLineBoundary(n,!1,!0).from),to:Math.min(i.to,t.moveToLineBoundary(n,!0,!0).from),type:P.Text}}function c1(t,n){var i,e,r,o,i=t.lineBlockAt(n);if(Array.isArray(i.type)){e=F(i.type);try{for(e.s();!(r=e.n()).done;)if((o=r.value).to>n||o.to==n&&(o.to==i.to||o.type==P.Text))return o}catch(t){e.e(t)}finally{e.f()}}return i}function l1(w,r,t){var n,i,b,e,o,u,e,e,M,x,e,s,a,h,n,i,t;return t.to<=w.viewport.from||t.from>=w.viewport.to?[]:(n=Math.max(t.from,w.viewport.from),i=Math.min(t.to,w.viewport.to),b=w.textDirection==E.LTR,e=w.contentDOM,o=e.getBoundingClientRect(),u=h1(w),e=(e=e.querySelector(".cm-line"))&&window.getComputedStyle(e),M=o.left+(e?parseInt(e.paddingLeft)+Math.min(0,parseInt(e.textIndent)):0),x=o.right-(e?parseInt(e.paddingRight):0),e=c1(w,n),s=c1(w,i),a=e.type==P.Text?e:null,h=s.type==P.Text?s:null,w.lineWrapping&&(a=a&&f1(w,n,a),h=h&&f1(w,i,h)),a&&h&&a.from==h.from?c(l(t.from,t.to,a)):(n=a?l(t.from,null,a):v(e,!1),i=h?l(null,t.to,h):v(s,!0),t=[],(a||e).to<(h||s).from-(a&&h?1:0)?t.push(f(M,n.bottom,x,i.top)):n.bottom<i.top&&w.elementAtHeight((n.bottom+i.top)/2).type==P.Text&&(n.bottom=i.top=(n.bottom+i.top)/2),c(n).concat(t).concat(c(i))));function f(t,n,i,e){return new se(r,t-u.left,n-u.top-.01,i-t,e-n+.01)}function c(t){for(var n,i,e,r,o,n=t.top,i=t.bottom,e=t.horizontal,r=[],o=0;o<e.length;o+=2)r.push(f(e[o],n,e[o+1],i));return r}function l(t,n,o){var u,s,a,i,e,r,h,f,c,l,v,d,y,m,p,k;function g(t,n,i,e,r){var t,i,t=w.coordsAtPos(t,t==o.to?-2:2),i=w.coordsAtPos(i,i==o.from?2:-2);t&&i&&(u=Math.min(t.top,i.top,u),s=Math.max(t.bottom,i.bottom,s),r==E.LTR?a.push(b&&n?M:t.left,b&&e?x:i.right):a.push(!b&&e?M:i.left,!b&&n?x:t.right))}s=-(u=1e9),a=[],i=null!=t?t:o.from,e=null!=n?n:o.to,r=F(w.visibleRanges);try{for(r.s();!(h=r.n()).done;)if((f=h.value).to>i&&f.from<e)for(c=Math.max(f.from,i),l=Math.min(f.to,e);;){v=w.state.doc.lineAt(c),d=F(w.bidiSpans(v));try{for(d.s();!(y=d.n()).done&&(p=(m=y.value).from+v.from,k=m.to+v.from,!(l<=p));)c<k&&g(Math.max(p,c),null==t&&p<=i,Math.min(k,l),null==n&&e<=k,m.dir)}catch(t){d.e(t)}finally{d.f()}if(l<=(c=v.to+1))break}}catch(t){r.e(t)}finally{r.f()}return 0==a.length&&g(i,null==t,e,null==n,w.textDirection),{top:u,bottom:s,horizontal:a}}function v(t,n){var n=o.top+(n?t.top:t.bottom);return{top:n,bottom:n,horizontal:[]}}}function v1(t,n){return t.constructor==n.constructor&&t.eq(n)}function d1(t,n){A(this,d1),this.view=t,this.layer=n,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,t)}function y1(n){return[u.define(function(t){return new ae(t,n)}),he.of(n)]}function m1(){var t;return[ce.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),le,ve,de,jn.of(!0)]}function p1(t){return t.startState.facet(ce)!=t.state.facet(ce)}function k1(t,n){n.style.animationDuration=t.facet(ce).cursorBlinkRate+"ms"}function g1(t){A(this,g1),this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}function w1(){return[me,pe]}function b1(t,n,i,e,r){n.lastIndex=0;for(var o=t.iterRange(i,e),u=i,s;!o.next().done;u+=o.value.length)if(!o.lineBreak)for(;s=n.exec(o.value);)r(u+s.index,s)}function M1(t,n){var i,e,r,o,u,s,a,i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;e=[],r=F(i);try{for(r.s();!(o=r.n()).done;)s=(u=o.value).from,a=u.to,s=Math.max(t.state.doc.lineAt(s).from,s-n),a=Math.min(t.state.doc.lineAt(a).to,a+n),e.length&&e[e.length-1].to>=s?e[e.length-1].to=a:e.push({from:s,to:a})}catch(t){r.e(t)}finally{r.f()}return e}function x1(t){A(this,x1);var n=t.regexp,r=t.decoration,o=t.decorate,i=t.boundary,t=t.maxLength,t=void 0===t?1e3:t;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,o)this.addMatch=function(t,n,i,e){return o(e,i,i+t[0].length,t,n)};else if("function"==typeof r)this.addMatch=function(t,n,i,e){var n=r(t,n,i);n&&e(i,i+t[0].length,n)};else{if(!r)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=function(t,n,i,e){return e(i,i+t[0].length,r)}}this.boundary=i,this.maxLength=t}function S1(){var t,n;return null==Me&&"undefined"!=typeof document&&document.body&&(n=document.body.style,Me=null!=(null!=(t=n.tabSize)?t:n.MozTabSize)),Me}function C1(){var t;return[xe.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),j1()]}function j1(){return Se=Se||u.fromClass((D(n,[{key:"makeDecorator",value:function t(o){var u=this;return new ke({regexp:o.specialChars,decoration:function t(n,i,e){var r,n,r,i,e,r=i.state.doc,n=Yc(n[0],0);return 9==n?(r=r.lineAt(e),i=i.state.tabSize,e=o0(r.text,i,e-r.from),m.replace({widget:new Pe((i-e%i)*u.view.defaultCharacterWidth)})):u.decorationCache[n]||(u.decorationCache[n]=m.replace({widget:new je(o,n)}))},boundary:o.replaceTabs?void 0:/[^]/})}},{key:"update",value:function t(n){var i=n.state.facet(xe);n.startState.facet(xe)!=i?(this.decorator=this.makeDecorator(i),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}}]),n),{decorations:function t(n){return n.decorations}});function n(t){A(this,n),this.view=t,this.decorations=m.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(xe)),this.decorations=this.decorator.createDeco(t)}}function P1(t){return 32<=t?Ce:10==t?"\u2424":String.fromCharCode(9216+t)}function O1(t,n){var i;return A(this,O1),(i=If.call(this)).options=t,i.code=n,i}function E1(t){var n;return A(this,E1),(n=Lf.call(this)).width=t,n}function A1(){A(this,A1),this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}function D1(){return[Oe,Tn.of(function(t){var t;return(null==(t=t.plugin(Oe))?void 0:t.attrs)||null})]}function R1(){return Ae}function I1(t){A(this,I1),this.decorations=this.getDeco(t)}function T1(t){var n;return A(this,T1),(n=_f.call(this)).content=t,n}function L1(n){return u.fromClass((D(i,[{key:"decorations",get:function t(){return this.view.state.doc.length?m.none:this.placeholder}}]),i),{decorations:function t(n){return n.decorations}});function i(t){A(this,i),this.view=t,this.placeholder=m.set([m.widget({widget:new De(n),side:1}).range(0)])}}function B1(t,n,i){var e,r,o,u,s,a,h,f,c,l,v,d,y,e=Math.min(n.line,i.line),r=Math.max(n.line,i.line),o=[];if(n.off>Re||i.off>Re||n.col<0||i.col<0)for(u=Math.min(n.off,i.off),s=Math.max(n.off,i.off),a=e;a<=r;a++)(h=t.doc.line(a)).length<=s&&o.push(O.range(h.from+u,h.to+s));else for(f=Math.min(n.col,i.col),c=Math.max(n.col,i.col),l=e;l<=r;l++)(d=u0((v=t.doc.line(l)).text,f,t.tabSize,!0))<0?o.push(O.cursor(v.to)):(y=u0(v.text,c,t.tabSize),o.push(O.range(v.from+d,v.from+y)));return o}function _1(t,n){var i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-n)/t.defaultCharacterWidth)):-1}function F1(t,n){var i,e,r,n,i=t.posAtCoords({x:n.clientX,y:n.clientY},!1),e=t.state.doc.lineAt(i),r=i-e.from,n=Re<r?-1:r==e.length?_1(t,n.clientX):o0(e.text,t.state.tabSize,i-e.from);return{line:e.number,col:n,off:r}}function N1(r,t){var o=F1(r,t),u=r.state.selection;return o?{update:function t(n){var i,i;n.docChanged&&(i=n.changes.mapPos(n.startState.doc.line(o.line).from),i=n.state.doc.lineAt(i),o={line:i.number,col:o.col,off:Math.min(o.off,i.length)},u=u.map(n.changes))},get:function t(n,i,e){var n,n,n=F1(r,n);return n&&(n=B1(r.state,o,n)).length?e?O.create(n.concat(u.ranges)):O.create(n):u}}:null}function U1(t){var i=(null==t?void 0:t.eventFilter)||function(t){return t.altKey&&0==t.button};return p.mouseSelectionStyle.of(function(t,n){return i(n)?N1(t,n):null})}function H1(){var t,n,i,e,r;function o(t){A(this,o),this.view=t,this.isDown=!1}return n=gc(Ie[(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).key||"Alt"],2),i=n[0],e=n[1],[r=u.fromClass((D(o,[{key:"set",value:function t(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}}]),o),{eventHandlers:{keydown:function t(n){this.set(n.keyCode==i||e(n))},keyup:function t(n){n.keyCode!=i&&e(n)||this.set(!1)},mousemove:function t(n){this.set(e(n))}}}),p.contentAttributes.of(function(t){var t;return null!=(t=t.plugin(r))&&t.isDown?Te:null})]}function z1(t,n,i){A(this,z1),this.facet=n,this.createTooltipView=i,this.input=t.state.facet(n),this.tooltips=this.input.filter(function(t){return t}),this.tooltipViews=this.tooltips.map(i)}function W1(){var t;return _e.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})}function V1(t){var t=t.win;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}function $1(t){var n,i,n=this;A(this,$1),this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1,i=t.state.facet(_e),this.position=i.position,this.parent=i.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Be(t,He,function(t){return n.createTooltip(t)}),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver(function(t){Date.now()>n.lastTransaction-50&&0<t.length&&t[t.length-1].intersectionRatio<1&&n.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}function q1(t){var n=this;A(this,q1),this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Be(t,ze,function(t){return n.createHostedView(t)})}function G1(t,n,i,e,r){A(this,G1),this.view=t,this.source=n,this.field=i,this.setHover=e,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}function J1(t){for(var n=t;n;n=n.parentNode)if(1==n.nodeType&&n.classList.contains("cm-tooltip"))return 1}function K1(t,n,i,e,r,o){var u,n,t,s,a,h,f,u=document.createRange(),n=t.domAtPos(n),t=t.domAtPos(i);for(u.setEnd(t.node,t.offset),u.setStart(n.node,n.offset),s=u.getClientRects(),u.detach(),a=0;a<s.length;a++)if(h=s[a],(f=Math.max(h.top-r,r-h.bottom,h.left-e,e-h.right))<=o)return 1}function Q1(n){var a,h,i,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},h=v.define(),i=w.define({create:function t(){return null},update:function t(n,i){var e,r,o,u,s;if(n&&(a.hideOnChange&&(i.docChanged||i.selection)||a.hideOn&&a.hideOn(i,n)))return null;if(n&&i.docChanged){if(null==(e=i.changes.mapPos(n.pos,-1,f.TrackDel)))return null;(r=Object.assign(Object.create(null),n)).pos=e,null!=n.end&&(r.end=i.changes.mapPos(n.end)),n=r}o=F(i.effects);try{for(o.s();!(u=o.n()).done;)(s=u.value).is(h)&&(n=s.value),s.is(qe)&&(n=null)}catch(t){o.e(t)}finally{o.f()}return n},provide:function t(n){return ze.from(n)}});return[i,u.define(function(t){return new $e(t,n,i,h,a.hoverTime||300)}),Ve]}function X1(t,n){var t,n,t=t.plugin(Ne);return!t||(n=t.manager.tooltips.indexOf(n))<0?null:t.manager.tooltipViews[n]}function Z1(t){return t.facet(ze).some(function(t){return t})}function Y1(t){var t;null!=(t=t.plugin(Ne))&&t.maybeMeasure()}function ty(t){return t?[Ge.of(t)]:[]}function ny(t,n){var t,n,t=t.plugin(Je),n=t?t.specs.indexOf(n):-1;return-1<n?t.panels[n]:null}function iy(n){var t,i,e,r;A(this,iy),this.input=n.state.facet(Qe),this.specs=this.input.filter(function(t){return t}),this.panels=this.specs.map(function(t){return t(n)}),t=n.state.facet(Ge),this.top=new Ke(n,!0,t.topContainer),this.bottom=new Ke(n,!1,t.bottomContainer),this.top.sync(this.panels.filter(function(t){return t.top})),this.bottom.sync(this.panels.filter(function(t){return!t.top})),i=F(this.panels);try{for(i.s();!(e=i.n()).done;)(r=e.value).dom.classList.add("cm-panel"),r.mount&&r.mount()}catch(t){i.e(t)}finally{i.f()}}function ey(t,n,i){A(this,ey),this.view=t,this.top=n,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}function ry(t){var n=t.nextSibling;return t.remove(),n}function oy(){return A(this,oy),Nf.apply(this,arguments)}function uy(t){return[sy(),Ye.of(Object.assign(Object.assign({},Ze),t))]}function sy(t){var n=[nr];return t&&!1===t.fixed&&n.push(tr.of(!0)),n}function ay(n){var i,t,e;A(this,ay),this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Ye).map(function(t){return new er(n,t)}),i=F(this.gutters);try{for(i.s();!(t=i.n()).done;)e=t.value,this.dom.appendChild(e.dom)}catch(t){i.e(t)}finally{i.f()}this.fixed=!n.state.facet(tr),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}function hy(t){return Array.isArray(t)?t:[t]}function fy(t,n,i){for(;t.value&&t.from<=i;)t.from==i&&n.push(t.value),t.next()}function cy(t,n,i){A(this,cy),this.gutter=t,this.height=i,this.i=0,this.cursor=j.iter(t.markers,n.from)}function ly(r,o){var u,t,n,u=this;for(n in A(this,ly),this.view=r,this.config=o,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),t=function t(e){u.dom.addEventListener(e,function(t){var n,i,i,i,n=t.target;if(n!=u.dom&&u.dom.contains(n)){for(;n.parentNode!=u.dom;)n=n.parentNode;i=((i=n.getBoundingClientRect()).top+i.bottom)/2}else i=t.clientY;i=r.lineBlockAtHeight(i-r.documentTop),o.domEventHandlers[e](r,i,t)&&t.preventDefault()})},o.domEventHandlers)t(n);this.markers=hy(o.markers(r)),o.initialSpacer&&(this.spacer=new rr(r,0,0,[o.initialSpacer(r)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}function vy(t,n,i,e){A(this,vy),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,i,e)}function dy(t,n){if(t.length==n.length){for(var i=0;i<t.length;i++)if(!t[i].compare(n[i]))return;return 1}}function yy(t){var n;return A(this,yy),(n=Hf.call(this)).number=t,n}function my(t,n){return t.state.facet(ur).formatNumber(n,t.state)}function py(){var t;return[ur.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),sy(),ar]}function ky(t){for(var n=9;n<t;)n=10*n+9;return n}function gy(){var t;return A(this,gy),(t=Wf.apply(this,arguments)).elementClass="cm-activeLineGutter",t}function wy(){return fr}function by(t){var n=cr.get(t);return n||cr.set(t,n=m.mark({attributes:"\t"===t?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":t.replace(/ /g,"\xb7")}})),n}function My(i){return u.define(function(t){return{decorations:i.createDeco(t),update:function t(n){this.decorations=i.updateDeco(n,this.decorations)}}},{decorations:function t(n){return n.decorations}})}function xy(){return lr}function Sy(){return vr}function Cy(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};A(this,Cy),this.id=mr++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||function(){throw new Error("This node type doesn't define a deserialize function")}}function jy(t,n,i){var e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;A(this,jy),this.name=t,this.props=n,this.id=i,this.flags=e}function Py(t){A(this,Py),this.types=t;for(var n=0;n<t.length;n++)if(t[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}function Oy(t,n,i,e,r){var o,u,s,a,h;if(A(this,Oy),this.type=t,this.children=n,this.positions=i,this.length=e,this.props=null,r&&r.length){this.props=Object.create(null),o=F(r);try{for(o.s();!(u=o.n()).done;)a=(s=gc(u.value,2))[0],h=s[1],this.props["number"==typeof a?a:a.id]=h}catch(t){o.e(t)}finally{o.f()}}}function Ey(t,n){A(this,Ey),this.buffer=t,this.index=n}function Ay(t,n,i){A(this,Ay),this.buffer=t,this.length=n,this.set=i}function Dy(t,n,i,e){switch(t){case-2:return i<n;case-1:return n<=e&&i<n;case 0:return i<n&&n<e;case 1:return i<=n&&n<e;case 2:return n<e;case 4:return 1}}function Ry(t,n){for(var i,e,i=t.childBefore(n);i&&(e=i.lastChild)&&e.to==i.to;)i=e.type.isError&&e.from==e.to?(t=i,e.prevSibling):e;return t}function Iy(t,n,i,e){for(var r,o,u,s,a,h;t.from==t.to||(i<1?t.from>=n:t.from>n)||(-1<i?t.to<=n:t.to<n);){if(!(o=!e&&t instanceof Cr&&t.index<0?null:t.parent))return t;t=o}if(u=e?0:Mr.IgnoreOverlays,e)for(a=(s=t).parent;a;a=(s=a).parent)s instanceof Cr&&s.index<0&&(null==(r=a.enter(n,i,u))?void 0:r.from)!=s.from&&(t=a);for(;;){if(!(h=t.enter(n,i,u)))return t;t=h}}function Ty(t,n,i,e){A(this,Ty),this.oMi=t,this.from=n,this.index=i,this.sft=e}function Ly(t,n,i,e){var r=t.cursor(),o=[];if(!r.firstChild())return o;if(null!=i)for(;!r.type.is(i);)if(!r.nextSibling())return o;for(;;){if(null!=e&&r.type.is(e))return o;if(r.type.is(n)&&o.push(r.node),!r.nextSibling())return null==e?o:[]}}function By(t,n,i){for(var e,r,e=2<arguments.length&&void 0!==i?i:n.length-1,r=t.parent;0<=e;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(n[e]&&n[e]!=r.name)return!1;e--}}return!0}function _y(t,n,i){A(this,_y),this.context=t,this.sft=n,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}function Fy(t){var n,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(A(this,Fy),this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Cr)this.yieldNode(t);else{for(this.oMi=t.context.parent,this.buffer=t.context,i=t.sft;i;i=i.sft)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}function Ny(t){return t.children.some(function(t){return t instanceof Sr||!t.type.isAnonymous||Ny(t)})}function Uy(t){var n,i,S,n,C,n,j,n,P,O,E,A,D,e,r,i;function R(t,n,i,e,r){for(var o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,n,o=O.id,u=O.start,s=O.end,a=O.size,h=D;a<0;){if(O.next(),-1==a)return f=j[o],i.push(f),void e.push(u-t);if(-3==a)return void(A=o);if(-4==a)return void(D=o);throw new RangeError("Unrecognized record size: ".concat(a))}if(c=E[o],d=u-t,s-u<=C&&(v=B(O.pos-n,r))){for(y=new Uint16Array(v.size-v.skip),m=O.pos-v.size,p=y.length;O.pos>m;)p=_(v.start,y,p);l=new Sr(y,s-v.start,S),d=v.start-t}else{for(k=O.pos-a,O.next(),g=[],w=[],b=P<=o?o:-1,M=0,x=s;O.pos>k;)0<=b&&O.id==b&&0<=O.size?(O.end<=x-C&&(T(g,w,u,M,O.end,x,b,h),M=g.length,x=O.end),O.next()):R(u,k,g,w,b);0<=b&&0<M&&M<g.length&&T(g,w,u,M,u,x,b,h),g.reverse(),w.reverse(),l=-1<b&&0<M?(n=I(c),zy(c,g,w,0,g.length,0,s-u,n,n)):L(c,g,w,s-u,h-s)}i.push(l),e.push(d)}function I(s){return function(t,n,i){var e=0,r=t.length-1,o,u;if(0<=r&&(o=t[r])instanceof b){if(!r&&o.type==s&&o.length==i)return o;(u=o.prop(M.lookAhead))&&(e=n[r]+o.length+u)}return L(s,t,n,i,e)}}function T(t,n,i,e,r,o,u,s){for(var a=[],h=[];t.length>e;)a.push(t.pop()),h.push(n.pop()+i-r);t.push(L(S.types[u],a,h,o-r,s-o)),n.push(r-i)}function L(t,n,i,e,r,o){var r,o,u,u,r=4<arguments.length&&void 0!==r?r:0,o=5<arguments.length?o:void 0;return A&&(u=[M.contextHash,A],o=o?[u].concat(o):[u]),25<r&&(u=[M.lookAhead,r],o=o?[u].concat(o):[u]),new b(t,n,i,e,o)}function B(t,n){var i,e,r,o,u,s,a,h,f,c,l,i=O.fork(),e=0,r=0,o=0,u=i.end-C,s={size:0,start:0,skip:0};t:for(a=i.pos-t;i.pos>a;)if(h=i.size,i.id==n&&0<=h)s.size=e,s.start=r,s.skip=o,o+=4,e+=4,i.next();else{if(f=i.pos-h,h<0||f<a||i.start<u)break;for(c=i.id>=P?4:0,l=i.start,i.next();i.pos>f;){if(i.size<0){if(-3!=i.size)break t;c+=4}else i.id>=P&&(c+=4);i.next()}r=l,e+=h,o+=c}return(n<0||e==t)&&(s.size=e,s.start=r,s.skip=o),4<s.size?s:void 0}function _(t,n,i){var e,r,o,u,s,a,e=O.id,r=O.start,o=O.end,u=O.size;if(O.next(),0<=u&&e<P){if(s=i,4<u)for(a=O.pos-(u-4);O.pos>a;)i=_(t,n,i);n[--i]=s,n[--i]=o-t,n[--i]=r-t,n[--i]=e}else-3==u?A=e:-4==u&&(D=e);return i}for(i=t.buffer,S=t.nodeSet,n=t.maxBufferLength,C=void 0===n?yr:n,n=t.reused,j=void 0===n?[]:n,n=t.minRepeatType,P=void 0===n?S.types.length:n,O=Array.isArray(i)?new xr(i,i.length):i,E=S.types,D=A=0,e=[],r=[];0<O.pos;)R(t.start||0,t.bufferStart||0,e,r,-1);return i=null!=(n=t.length)?n:e.length?r[0]+e[0].length:0,new b(E[t.topID],e.reverse(),r.reverse(),i)}function Hy(t,n){var i,e,r,o;if(!t.isAnonymous||n instanceof Sr||n.type!=t)return 1;if(null==(i=Er.get(n))){i=1,e=F(n.children);try{for(e.s();!(r=e.n()).done;){if((o=r.value).type!=t||!(o instanceof b)){i=1;break}i+=Hy(t,o)}}catch(t){e.e(t)}finally{e.f()}Er.set(n,i)}return i}function zy(c,t,n,i,e,l,r,o,v){for(var u,s,d,y,m,u=0,s=i;s<e;s++)u+=Hy(c,t[s]);function p(t,n,i,e,r){for(var o,u,s,a,h,f,f,o=i;o<e;){for(s=n[u=o],a=Hy(c,t[o]),o++;o<e&&(h=Hy(c,t[o]),!(d<=a+h));o++)a+=h;if(o==u+1){if(d<a){p((f=t[u]).children,f.positions,0,f.children.length,n[u]+r);continue}y.push(t[u])}else f=n[o-1]+t[o-1].length-s,y.push(zy(c,t,n,u,o,s,f,null,v));m.push(s+r-l)}}return d=Math.ceil(1.5*u/8),y=[],m=[],p(t,n,i,e,0),(o||v)(y,m,r)}function Wy(t,n,i,e){var r,o,r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o=5<arguments.length&&void 0!==arguments[5]&&arguments[5];A(this,Wy),this.from=t,this.to=n,this.tree=i,this.offset=e,this.open=(r?1:0)|(o?2:0)}function Vy(){A(this,Vy)}function $y(t){A(this,$y),this.string=t}function qy(t,n,i){A(this,qy),this.set=t,this.base=n,this.modified=i,this.id=Ir++}function Gy(){A(this,Gy),this.instances=[],this.id=Lr++}function Jy(t,i){return t.length==i.length&&t.every(function(t,n){return t==i[n]})}function Ky(t){for(var n,i,e,r,n=[[]],i=0;i<t.length;i++)for(e=0,r=n.length;e<r;e++)n.push(n[e].concat(t[i]));return n.sort(function(t,n){return n.length-t.length})}function Qy(t){var n,i,e,r,o,u,s,a,h,f,c,l,v,d,y,n=Object.create(null);for(i in t){e=t[i],Array.isArray(e)||(e=[e]),r=F(i.split(" "));try{for(r.s();!(o=r.n()).done;)if(u=o.value){for(s=[],a=2,h=u,f=0;;){if("..."==h&&0<f&&f+3==u.length){a=1;break}if(!(c=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(h)))throw new RangeError("Invalid path: "+u);if(s.push("*"==c[0]?"":'"'==c[0][0]?JSON.parse(c[0]):c[0]),(f+=c[0].length)==u.length)break;if(l=u[f++],f==u.length&&"!"==l){a=0;break}if("/"!=l)throw new RangeError("Invalid path: "+u);h=u.slice(f)}if(!(d=s[v=s.length-1]))throw new RangeError("Invalid path: "+u);y=new Fr(e,a,0<v?s.slice(0,v):null),n[d]=y.sort(n[d])}}catch(t){r.e(t)}finally{r.f()}}return _r.add(n)}function Xy(t,n,i,e){A(this,Xy),this.tags=t,this.mode=n,this.context=i,this.next=e}function Zy(t,n){var f,i,e,r,o,u,s,t,n,t,c,f=Object.create(null),i=F(t);try{for(i.s();!(e=i.n()).done;)if(r=e.value,Array.isArray(r.tag)){o=F(r.tag);try{for(o.s();!(u=o.n()).done;)s=u.value,f[s.id]=r.class}catch(t){o.e(t)}finally{o.f()}}else f[r.tag.id]=r.class}catch(t){i.e(t)}finally{i.f()}return n=(t=n||{}).scope,t=t.all,c=void 0===t?null:t,{style:function t(n){var i,e,r,o,u,s,a,h,i=c,e=F(n);try{for(e.s();!(r=e.n()).done;){u=F((o=r.value).set);try{for(u.s();!(s=u.n()).done;)if(a=s.value,h=f[a.id]){i=i?i+" "+h:h;break}}catch(t){u.e(t)}finally{u.f()}}}catch(t){e.e(t)}finally{e.f()}return i},scope:n}}function Yy(t,n){var i,e,r,o,u,i=null,e=F(t);try{for(e.s();!(r=e.n()).done;)(u=(o=r.value).style(n))&&(i=i?i+" "+u:u)}catch(t){e.e(t)}finally{e.f()}return i}function tm(t,n,i,e,r){var e,r,n,e=3<arguments.length&&void 0!==e?e:0,r=4<arguments.length&&void 0!==r?r:t.length,n=new Nr(e,Array.isArray(n)?n:[n],i);n.highlightRange(t.cursor(),e,r,"",n.highlighters),n.flush(r)}function nm(t,n,i){A(this,nm),this.at=t,this.highlighters=n,this.span=i,this.class=""}function im(t){for(var n=t.type.prop(_r);n&&n.context&&!t.matchContext(n.context);)n=n.next;return n||null}function em(n){return y.define({combine:n?function(t){return t.concat(n)}:void 0})}function rm(t,n){var i,e,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"";A(this,rm),this.data=t,this.name=e,C.prototype.hasOwnProperty("tree")||Object.defineProperty(C.prototype,"tree",{get:function t(){return R(this)}}),this.parser=n,this.extension=[io.of(this),C.languageData.of(function(t,n,i){var e,r,o,r,u,s,a,h,f,e=om(t,n,i),r=e.type.prop(qr);if(!r)return[];if(o=t.facet(r),r=e.type.prop(Gr)){u=e.resolve(n-e.from,i),s=F(r);try{for(s.s();!(a=s.n()).done;)if((h=a.value).test(u,t))return f=t.facet(h.facet),"replace"==h.type?f:f.concat(o)}catch(t){s.e(t)}finally{s.f()}}return o})].concat(i)}function om(t,n,i){var e,r,o,e=t.facet(io),r=R(t).topNode;if(!e||e.allowsNesting)for(o=r;o;o=o.enter(n,i,Mr.ExcludeBuffers))o.type.isTop&&(r=o);return r}function um(t,n,i){var t;return A(this,um),(t=$f.call(this,t,n,[],i)).parser=n,t}function R(t){var t=t.field(Jr.state,!1);return t?t.tree:b.empty}function sm(t,n){var i,t,t,e,i,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:50,t=null==(t=t.field(Jr.state,!1))?void 0:t.context;return t?(e=t.viewport,t.updateViewport({from:0,to:n}),i=t.isDone(n)||t.work(i,n)?t.tree:null,t.updateViewport(e),i):null}function am(t){var n,t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.doc.length;return(null==(t=t.field(Jr.state,!1))?void 0:t.context.isDone(n))||!1}function hm(t){var n,i,n,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t.viewport.to,i,n=sm(t.state,n,2<arguments.length&&void 0!==arguments[2]?arguments[2]:100);return n!=R(t.state)&&t.dispatch({}),!!n}function fm(t){var t;return(null==(t=t.plugin(no))?void 0:t.isWorking())||!1}function cm(t){A(this,cm),this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}function lm(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];vartree=3<arguments.length?arguments[3]:void 0,vartreeLen=4<arguments.length?arguments[4]:void 0,varviewport=5<arguments.length?arguments[5]:void 0,varskipped=6<arguments.length?arguments[6]:void 0,varscheduleOn=7<arguments.length?arguments[7]:void 0,A(this,lm),this.parser=t,this.state=n,this.fragments=i,this.tree=tree,this.treeLen=treeLen,this.viewport=viewport,this.skipped=skipped,this.scheduleOn=scheduleOn,this.parse=null,this.tempSkipped=[]}function vm(t,n,i){return Ar.applyChanges(t,[{fromA:n,toA:i,fromB:n,toB:i}])}function dm(t){A(this,dm),this.context=t,this.tree=t.tree}function ym(t){A(this,ym),this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}function mm(t,n,i,e,r){var o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:void 0;A(this,mm),this.name=t,this.alias=n,this.extensions=i,this.filename=e,this.loadFunc=r,this.support=o,this.loading=null}function pm(t){var n=t.facet(ro);return 9==n.charCodeAt(0)?t.tabSize*n.length:n.length}function km(t,n){var i,e,r,o,i="",e=t.tabSize,r=t.facet(ro)[0];if("\t"==r){for(;e<=n;)i+="\t",n-=e;r=" "}for(o=0;o<n;o++)i+=r;return i}function gm(t,n){var i,e,r,o,u,i=F((t=t instanceof C?new oo(t):t).state.facet(eo));try{for(i.s();!(e=i.n()).done;)if(void 0!==(o=(r=e.value)(t,n)))return o}catch(t){i.e(t)}finally{i.f()}return(u=R(t.state))?Mm(t,u,n):null}function wm(t,n,i){for(var e,r,o,u,s,a,h,f,e=Object.create(null),r=new oo(t,{overrideIndentation:function t(n){var n;return null!=(n=e[n])?n:-1}}),o=[],u=n;u<=i;)u=(s=t.doc.lineAt(u)).to+1,null!=(a=gm(r,s.from))&&(/\S/.test(s.text)||(a=0),(h=/^\s*/.exec(s.text)[0])!=(f=km(t,a)))&&(e[s.from]=a,o.push({from:s.from,to:s.from+h.length,insert:f}));return t.changes(o)}function bm(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};A(this,bm),this.state=t,this.options=n,this.unit=pm(t)}function Mm(t,n,i){return Cm(n.resolveInner(i).enterUnfinishedNodesBefore(i),i,t)}function xm(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function Sm(t){var n,n,n,i,e,n=t.type.prop(uo);return n||((n=t.firstChild)&&(n=n.type.prop(M.closedBy))?(i=t.lastChild,e=i&&-1<n.indexOf(i.name),function(t){return Dm(t,!0,1,void 0,e&&!xm(t)?i.from:void 0)}):null==t.parent?jm:null)}function Cm(t,n,i){for(;t;t=t.parent){var e=Sm(t);if(e)return e(so.create(i,n,t))}return null}function jm(){return 0}function Pm(t,n,i){var e;return A(this,Pm),(e=Gf.call(this,t.state,t.options)).base=t,e.pos=n,e.node=i,e}function Om(t,n){for(var i=n;i;i=i.parent)if(t==i)return 1}function Em(t){var n,i,e,r,t,o,u,s,n=t.node,i=n.childAfter(n.from),e=n.lastChild;if(!i)return null;for(r=t.options.simulateBreak,t=t.state.doc.lineAt(i.from),o=null==r||r<=t.from?t.to:Math.min(t.to,r),u=i.to;;){if(!(s=n.childAfter(u))||s==e)return null;if(!s.type.isSkipped)return s.from<o?i:null;u=s.to}}function Am(t){var n=t.closing,i=t.align,e=void 0===i||i,i=t.units,r=void 0===i?1:i;return function(t){return Dm(t,e,r,n)}}function Dm(t,n,i,e,r){var o,u,o,e,o=t.textAfter,u=o.match(/^\s*/)[0].length,o=e&&o.slice(u,u+e.length)==e||r==t.pos+u,e=n?Em(t):null;return e?o?t.column(e.from):t.column(e.to):t.baseIndent+(o?0:t.unit*i)}function Rm(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=t.except,t=t.units,e=void 0===t?1:t;return function(t){var n=i&&i.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}function Im(){return C.transactionFilter.of(function(t){var n,i,e,r,o,u,s,a,h,f,c,l,v,d,y;if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;if(!(n=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head)).length)return t;if(i=t.newDoc,(e=t.newSelection.main.head)>(r=i.lineAt(e)).from+ao)return t;if(o=i.sliceString(r.from,e),!n.some(function(t){return t.test(o)}))return t;s=-1,a=[],h=F((u=t.state).selection.ranges);try{for(h.s();!(f=h.n()).done;)c=f.value.head,(l=u.doc.lineAt(c)).from!=s&&(s=l.from,null!=(v=gm(u,l.from)))&&(d=/^\s*/.exec(l.text)[0])!=(y=km(u,v))&&a.push({from:l.from,to:l.from+d.length,insert:y})}catch(t){h.e(t)}finally{h.f()}return a.length?[t,{changes:a,sequential:!0}]:t})}function Tm(t){var n=t.firstChild,i=t.lastChild;return n&&n.to<i.from?{from:n.to,to:i.type.isError?t.to:i.from}:null}function Lm(t,n,i){var e,r,o,u,s,s,e=R(t);if(e.length<i)return null;for(o=null,u=r=e.resolveInner(i,1);u;u=u.parent)if(!(u.to<=i||u.from>i)){if(o&&u.from<n)break;(s=u.type.prop(fo))&&(u.to<e.length-50||e.length==t.doc.length||!Bm(u))&&(s=s(u,t))&&s.from<=i&&s.from>=n&&s.to>i&&(o=s)}return o}function Bm(t){var n=t.lastChild;return n&&n.to==t.to&&n.type.isError}function _m(t,n,i){var e,r,o,u,e=F(t.facet(ho));try{for(e.s();!(r=e.n()).done;)if(u=(o=r.value)(t,n,i))return u}catch(t){e.e(t)}finally{e.f()}return Lm(t,n,i)}function Fm(t,n){var i=n.mapPos(t.from,1),n=n.mapPos(t.to,-1);return n<=i?void 0:{from:i,to:n}}function Nm(i){var e,n,r,t,e=[],n=F(i.state.selection.ranges);try{for(t=function t(){var n=r.value.head;if(e.some(function(t){return t.from<=n&&t.to>=n}))return 1;e.push(i.lineBlockAt(n))},n.s();!(r=n.n()).done;)t()}catch(t){n.e(t)}finally{n.f()}return e}function Um(t){return t.field(vo,!1)||j.empty}function Hm(t,n,i){var t,e,e=null;return null!=(t=t.field(vo,!1))&&t.between(n,i,function(t,n){(!e||e.from>t)&&(e={from:t,to:n})}),e}function zm(t,i,e){var r=!1;return t.between(i,i,function(t,n){t==i&&n==e&&(r=!0)}),r}function Wm(t,n){return t.field(vo,!1)?n:n.concat(v.appendConfig.of(qm()))}function Vm(t,n,i){var i,e,n,i=!(2<arguments.length&&void 0!==i)||i,e=t.state.doc.lineAt(n.from).number,n=t.state.doc.lineAt(n.to).number;return p.announce.of("".concat(t.state.phrase(i?"Folded lines":"Unfolded lines")," ").concat(e," ").concat(t.state.phrase("to")," ").concat(n,"."))}function $m(t,n){for(var i,e,i=n;;){if((e=_m(t.state,i.from,i.to))&&e.to>n.from)return e;if(!i.from)return null;i=t.lineBlockAt(i.from-1)}}function qm(t){var n=[vo,wo];return t&&n.push(mo.of(t)),n}function Gm(){return A(this,Gm),Kf.apply(this,arguments)}function Jm(t,n){var i;return A(this,Jm),(i=Xf.call(this)).config=t,i.open=n,i}function Km(){var t,i,s,a,e,r;function n(t){A(this,n),this.from=t.viewport.from,this.markers=this.buildMarkers(t)}return t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=Object.assign(Object.assign({},ko),t),s=new go(i,!0),a=new go(i,!1),e=u.fromClass((D(n,[{key:"update",value:function t(n){(n.docChanged||n.viewportChanged||n.startState.facet(io)!=n.state.facet(io)||n.startState.field(vo,!1)!=n.state.field(vo,!1)||R(n.startState)!=R(n.state)||i.foldingChanged(n))&&(this.markers=this.buildMarkers(n.view))}},{key:"buildMarkers",value:function t(n){var i,e,r,o,u,i=new Ot,e=F(n.viewportLineBlocks);try{for(e.s();!(r=e.n()).done;)o=r.value,(u=Hm(n.state,o.from,o.to)?a:_m(n.state,o.from,o.to)?s:null)&&i.add(o.from,o.from,u)}catch(t){e.e(t)}finally{e.f()}return i.finish()}}]),n)),r=i.domEventHandlers,[e,uy({class:"cm-foldGutter",markers:function t(n){var n;return(null==(n=n.plugin(e))?void 0:n.markers)||j.empty},initialSpacer:function t(){return new go(i,!1)},domEventHandlers:Object.assign(Object.assign({},r),{click:function t(n,i,e){var e,e;return!((!r.click||!r.click(n,i,e))&&((e=Hm(n.state,i.from,i.to))?(n.dispatch({effects:lo.of(e)}),0):!(e=_m(n.state,i.from,i.to))||(n.dispatch({effects:co.of(e)}),0)))}})}),qm()]}function Qm(t,n){var i,e,r;function o(t){var n=_t.newName();return(i=i||Object.create(null))["."+n]=t,n}A(this,Qm),this.specs=t,e="string"==typeof n.all?n.all:n.all?o(n.all):void 0,r=n.scope,this.scope=r instanceof Jr?function(t){return t.prop(qr)==r.data}:r?function(t){return t==r}:void 0,this.style=Zy(t.map(function(t){return{tag:t.tag,class:t.class||o(Object.assign({},t,{tag:null}))}}),{all:e}).style,this.module=i?new _t(i):null,this.themeType=n.themeType}function Xm(t){var n=t.facet(Mo);return n.length?n:t.facet(xo)}function Zm(n,t){var i=[Co],e;return n instanceof bo&&(n.module&&i.push(p.styleModule.of(n.module)),e=n.themeType),null!=t&&t.fallback?i.push(xo.of(n)):i.push(e?Mo.computeN([p.darkTheme],function(t){return t.facet(p.darkTheme)==("dark"==e)?[n]:[]}):Mo.of(n)),i}function Ym(t,n,i){var t,e,r,o,u,s,t=Xm(t),e=null;if(t){r=F(t);try{for(r.s();!(o=r.n()).done;)(!(u=o.value).scope||i&&u.scope(i))&&(s=u.style(n))&&(e=e?e+" "+s:s)}catch(t){r.e(t)}finally{r.f()}}return e}function tp(t){A(this,tp),this.markCache=Object.create(null),this.tree=R(t.state),this.decorations=this.buildDeco(t,Xm(t.state))}function np(t){var n,i,n=[],i=t.matched?Eo:Ao;return n.push(i.range(t.start.from,t.start.to)),t.end&&n.push(i.range(t.end.from,t.end.to)),n}function ip(){var t;return[Oo.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),Do]}function ep(t,n,i){var e,e,e=t.prop(n<0?M.openedBy:M.closedBy);return e||(1==t.name.length&&-1<(e=i.indexOf(t.name))&&e%2==(n<0?1:0)?[i[e+n]]:null)}function rp(t){var n=t.type.prop(Ro);return n?n(t.node):t}function op(t,n,i){for(var e,r,o,e,u,s,a,h,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=e.maxScanDistance||jo,o=e.brackets||Po,e=R(t),u=e.resolveInner(n,i),s=u;s;s=s.parent)if((a=ep(s.type,i,o))&&s.from<s.to&&(h=rp(s))&&(0<i?n>=h.from&&n<h.to:n>h.from&&n<=h.to))return up(t,n,i,s,h,a,o);return sp(t,n,i,e,u.type,r,o)}function up(t,n,i,e,r,o,u){var s,a,h,f,c,c,s=e.parent,a={from:r.from,to:r.to},h=0,f=null==s?void 0:s.cursor();if(f&&(i<0?f.childBefore(e.from):f.childAfter(e.to)))do{if(i<0?f.to<=e.from:f.from>=e.to){if(0==h&&-1<o.indexOf(f.type.name)&&f.from<f.to)return{start:a,end:(c=rp(f))?{from:c.from,to:c.to}:void 0,matched:!0};if(ep(f.type,i,u))h++;else if(ep(f.type,-i,u)){if(0==h)return{start:a,end:(c=rp(f))&&c.from<c.to?{from:c.from,to:c.to}:void 0,matched:!1};h--}}}while(i<0?f.prevSibling():f.nextSibling());return{start:a,matched:!1}}function sp(t,n,i,e,r,o,u){var s,a,h,f,c,l,v,d,y,m,p,s=i<0?t.sliceDoc(n-1,n):t.sliceDoc(n,n+1),a=u.indexOf(s);if(a<0||a%2==0!=0<i)return null;for(h={from:i<0?n-1:n,to:0<i?n+1:n},f=t.doc.iterRange(n,0<i?t.doc.length:0),l=c=0;!f.next().done&&l<=o;){for(v=f.value,i<0&&(l+=v.length),d=n+l*i,y=0<i?0:v.length-1,m=0<i?v.length:-1;y!=m;y+=i)if(!((p=u.indexOf(v[y]))<0||e.resolveInner(d+y,1).type!=r))if(p%2==0==0<i)c++;else{if(1==c)return{start:h,end:{from:d+y,to:d+y+1},matched:p>>1==a>>1};c--}0<i&&(l+=v.length)}return f.done?{start:h,matched:!1}:null}function ap(t,n,i,e,r){var e,r,o,u,e=3<arguments.length&&void 0!==e?e:0,r=4<arguments.length&&void 0!==r?r:0;for(null==n&&-1==(n=t.search(/[^\s\u00a0]/))&&(n=t.length),o=r,u=e;u<n;u++)9==t.charCodeAt(u)?o+=i-o%i:o++;return o}function hp(t,n,i,e){A(this,hp),this.string=t,this.tabSize=n,this.indentUnit=i,this.overrideIndent=e,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}function fp(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||function(){},startState:t.startState||function(){return!0},copyState:t.copyState||cp,indent:t.indent||function(){return null},languageData:t.languageData||{},tokenTable:t.tokenTable||Bo}}function cp(t){var n,i,e;if("object"!=Rc(t))return t;for(i in n={},t)e=t[i],n[i]=e instanceof Array?e.slice():e;return n}function lp(t){var i,n,e,r,o,u,s;function a(){return A(this,a),s.apply(this,arguments)}return A(this,lp),n=em(t.languageData),e=fp(t),x(a,Dr),s=S(a),D(a,[{key:"createParse",value:function t(n,i,e){return new Lo(r,n,i,e)}}]),o=new a,(i=Yf.call(this,n,o,[eo.of(function(t,n){return i.getIndent(t,n)})],t.name)).topNode=bp(n),r=Ec(i),i.streamParser=e,i.stateAfter=new M({perNode:!0}),i.tokenTable=t.tokenTable?new $o(e.tokenTable):qo,i}function vp(t,n,i,e,r){var o,u,s,a,s,o=e<=i&&i+n.length<=r&&n.prop(t.stateAfter);if(o)return{state:t.streamParser.copyState(o),pos:i+n.length};for(u=n.children.length-1;0<=u;u--)if(s=n.children[u],a=i+n.positions[u],s=s instanceof b&&a<r&&vp(t,s,a,e,r))return s;return null}function dp(t,n,i,e,r){var o,u,s,a;if(r&&i<=0&&e>=n.length)return n;for(r||n.type!=t.topNode||(r=!0),o=n.children.length-1;0<=o;o--)if(u=n.positions[o],s=n.children[o],a=void 0,u<e&&s instanceof b){if(a=dp(t,s,i-u,e-u,r))return r?new b(n.type,n.children.slice(0,o).concat(a),n.positions.slice(0,o+1),u+a.length):a;break}return null}function yp(t,n,i,e){var r,o,u,s,a,h,f,r=F(n);try{for(r.s();!(o=r.n()).done;)if(s=(u=o.value).from+(u.openStart?25:0),a=u.to-(u.openEnd?25:0),h=s<=i&&i<a&&vp(t,u.tree,0-u.offset,i,a),f=void 0,h&&(f=dp(t,u.tree,i+u.offset,h.pos+u.offset,!1)))return{state:h.state,tree:f}}catch(t){r.e(t)}finally{r.f()}return{state:t.streamParser.startState(e?pm(e):4),tree:b.empty}}function mp(t,n,i,e){var n,t,i,e,r,o;for(A(this,mp),this.lang=t,this.input=n,this.fragments=i,this.ranges=e,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=e[e.length-1].to,n=Xr.get(),e=(i=yp(t,i,t=e[0].from,null==n?void 0:n.state)).state,r=i.tree,this.state=e,this.parsedPos=this.chunkStart=t+r.length,o=0;o<r.children.length;o++)this.chunks.push(r.children[o]),this.chunkPos.push(r.positions[o]);n&&this.parsedPos<n.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(pm(n.state)),n.skipUntilInView(this.parsedPos,n.viewport.from),this.parsedPos=n.viewport.from),this.moveRangeIndex()}function pp(t,n,i){var e,r;for(n.start=n.pos,e=0;e<10;e++)if(r=t(n,i),n.pos>n.start)return r;throw new Error("Stream parser failed to advance stream.")}for(Xn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/,D(bv,[{key:"dir",get:function t(){return this.level%2?zn:Hn}},{key:"side",value:function t(n,i){return this.dir==i==n?this.to:this.from}}],[{key:"find",value:function t(n,i,e,r){for(var o,u,s,o=-1,u=0;u<n.length;u++)if((s=n[u]).from<=i&&s.to>=i){if(s.level==e)return u;(o<0||(0!=r?r<0?s.from<i:s.to>i:n[o].level>s.level))&&(o=u)}if(o<0)throw new RangeError("Index out of range");return o}}]),Zn=bv,z=[],Yn="",ti="\uffff",D(Cv,[{key:"append",value:function t(n){this.text+=n}},{key:"lineBreak",value:function t(){this.text+=ti}},{key:"readRange",value:function t(n,i){var e,r,o,u,s,a;if(n){for(e=n.parentNode,r=n;this.findPointBefore(e,r),o=this.text.length,this.readNode(r),(u=r.nextSibling)!=i;)s=l.get(r),a=l.get(u),(s&&a?s.breakAfter:(s?s.breakAfter:jv(r))||jv(u)&&("BR"!=r.nodeName||r.cmIgnore)&&this.text.length>o)&&this.lineBreak(),r=u;this.findPointBefore(e,i)}return this}},{key:"readTextNode",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,i=n.nodeValue,e=F(this.points);try{for(e.s();!(r=e.n()).done;)(o=r.value).node==n&&(o.pos=this.text.length+Math.min(o.offset,i.length))}catch(t){e.e(t)}finally{e.f()}for(u=0,s=this.lineSeparator?null:/\r\n?|\n/g;a=-1,h=1,f=void 0,this.lineSeparator?(a=i.indexOf(this.lineSeparator,u),h=this.lineSeparator.length):(f=s.exec(i))&&(a=f.index,h=f[0].length),this.append(i.slice(u,a<0?i.length:a)),!(a<0);){if(this.lineBreak(),1<h){c=F(this.points);try{for(c.s();!(l=c.n()).done;)(v=l.value).node==n&&v.pos>this.text.length&&(v.pos-=h-1)}catch(t){c.e(t)}finally{c.f()}}u=a+h}}},{key:"readNode",value:function t(n){var i,i,e;if(!n.cmIgnore)if(null!=(i=(i=l.get(n))&&i.overrideDOMText))for(this.findPointInside(n,i.length),e=i.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value);else 3==n.nodeType?this.readTextNode(n):"BR"==n.nodeName?n.nextSibling&&this.lineBreak():1==n.nodeType&&this.readRange(n.firstChild,null)}},{key:"findPointBefore",value:function t(n,i){var e,r,o,e=F(this.points);try{for(e.s();!(r=e.n()).done;)(o=r.value).node==n&&n.childNodes[o.offset]==i&&(o.pos=this.text.length)}catch(t){e.e(t)}finally{e.f()}}},{key:"findPointInside",value:function t(n,i){var e,r,o,e=F(this.points);try{for(e.s();!(r=e.n()).done;)o=r.value,(3==n.nodeType?o.node==n:n.contains(o.node))&&(o.pos=this.text.length+Math.min(i,o.offset))}catch(t){e.e(t)}finally{e.f()}}}]),ni=Cv,ii=D(function t(n,i){A(this,t),this.node=n,this.offset=i,this.pos=-1}),x(Pv,l),pf=S(Pv),D(Pv,[{key:"length",get:function t(){return this.view.state.doc.length}},{key:"update",value:function t(n){var e,i,r,o,u,e=this,i=n.changedRanges;return 0<this.minWidth&&i.length&&(i.every(function(t){var n=t.fromA,i;return t.toA<e.minWidthFrom||n>e.minWidthTo})?(this.minWidthFrom=n.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=n.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=m.none:(n.transactions.length||this.dirty)&&(this.compositionDeco=Dv(this.view,n.changes)),(g.ie||g.chrome)&&!this.compositionDeco.size&&n&&n.state.doc.lines!=n.startState.doc.lines&&(this.forceSelection=!0),u=Bv(r=this.decorations,o=this.updateDeco(),n.changes),i=Nn.extendWithRanges(i,u),(0!=this.dirty||0!=i.length)&&(this.updateInner(i,n.startState.doc.length),n.transactions.length&&(this.lastUpdate=Date.now()),!0)}},{key:"updateInner",value:function t(n,i){var e,r,o,u,s,a,e=this;if(this.view.viewState.mustMeasureContent=!0,this.updateChildren(n,i),(r=this.view.observer).ignore(function(){e.dom.style.height=e.view.viewState.contentHeight+"px",e.dom.style.flexBasis=e.minWidth?e.minWidth+"px":"";var t=g.chrome||g.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;e.sync(e.view,t),e.dirty=0,t&&(t.written||r.selectionRange.focusNode!=t.node)&&(e.forceSelection=!0),e.dom.style.height=""}),o=[],this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){u=F(this.children);try{for(u.s();!(s=u.n()).done;)(a=s.value)instanceof yn&&a.widget instanceof ri&&o.push(a.dom)}catch(t){u.e(t)}finally{u.f()}}r.updateGaps(o)}},{key:"updateChildren",value:function t(n,i){for(var e,r,o,u,s,a,o,a,o,h,f,a,s,c,s,u,l,v,e=this.childCursor(i),r=n.length-1;o=0<=r?n[r]:null;r--)u=o.fromA,s=o.toA,a=o.fromB,o=o.toB,o=(a=mn.build(this.view.state.doc,a,o,this.decorations,this.dynamicDecorationMap)).content,h=a.breakAtStart,f=a.openStart,a=a.openEnd,c=(s=e.findPos(s,1)).i,s=s.off,T0(this,l=(u=e.findPos(u,-1)).i,v=u.off,c,s,o,h,f,a)}},{key:"updateSelection",value:function t(){var e,n,i,r,n,o,n,u,s,a,h,f,e=this,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];!n&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange(),n=(r=this.view.root.activeElement)==this.dom,o=!n&&v0(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r)),(n||i||o)&&(n=this.forceSelection,this.forceSelection=!1,u=this.view.state.selection.main,s=this.domAtPos(u.anchor),a=u.empty?s:this.domAtPos(u.head),g.gecko&&u.empty&&!this.compositionDeco.size&&Ov(s)&&(h=document.createTextNode(""),this.view.observer.ignore(function(){return s.node.insertBefore(h,s.node.childNodes[s.offset]||null)}),s=a=new Qt(h,0),n=!0),f=this.view.observer.selectionRange,!n&&f.focusNode&&y0(s.node,s.offset,f.anchorNode,f.anchorOffset)&&y0(a.node,a.offset,f.focusNode,f.focusOffset)||(this.view.observer.ignore(function(){var t,n,i,n,i;if(g.android&&g.chrome&&e.dom.contains(f.focusNode)&&_v(f.focusNode,e.dom)&&(e.dom.blur(),e.dom.focus({preventScroll:!0})),t=f0(e.view.root))if(u.empty)g.gecko&&(n=Tv(s.node,s.offset))&&3!=n&&(i=Iv(s.node,s.offset,1==n?1:-1))&&(s=new Qt(i,1==n?0:i.nodeValue.length)),t.collapse(s.node,s.offset),null!=u.bidiLevel&&null!=f.cursorBidiLevel&&(f.cursorBidiLevel=u.bidiLevel);else if(t.extend){t.collapse(s.node,s.offset);try{t.extend(a.node,a.offset)}catch(t){}}else n=document.createRange(),u.anchor>u.head&&(s=(i=[a,s])[0],a=i[1]),n.setEnd(a.node,a.offset),n.setStart(s.node,s.offset),t.removeAllRanges(),t.addRange(n);o&&e.view.root.activeElement==e.dom&&(e.dom.blur(),r)&&r.focus()}),this.view.observer.setSelectionRange(s,a)),this.impreciseAnchor=s.precise?null:new Qt(f.anchorNode,f.anchorOffset),this.impreciseHead=a.precise?null:new Qt(f.focusNode,f.focusOffset))}},{key:"enforceCursorAssoc",value:function t(){var n,i,e,r,o,r,u,s,s,u,s,u;this.compositionDeco.size||(i=(n=this.view).state.selection.main,e=f0(n.root),o=(r=n.observer.selectionRange).anchorNode,r=r.anchorOffset,e&&i.empty&&i.assoc&&e.modify&&(u=dn.find(this,i.head))&&(s=u.posAtStart,i.head==s||i.head==s+u.length||(s=this.coordsAt(i.head,-1),u=this.coordsAt(i.head,1),!s)||!u||s.bottom>u.top||(s=this.domAtPos(i.head+i.assoc),e.collapse(s.node,s.offset),e.modify("move",i.assoc<0?"forward":"backward","lineboundary"),n.observer.readSelectionRange(),u=n.observer.selectionRange,n.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=i.from&&e.collapse(o,r))))}},{key:"nearest",value:function t(n){for(var i,e,i=n;i;){if((e=l.get(i))&&e.rootView==this)return e;i=i.parentNode}return null}},{key:"posFromDOM",value:function t(n,i){var e=this.nearest(n);if(e)return e.localPosFromDOM(n,i)+e.posAtStart;throw new RangeError("Trying to find position for a DOM position outside of the document")}},{key:"domAtPos",value:function t(n){for(var n,i,e,r,n=this.childCursor().findPos(n,-1),i=n.i,e=n.off;i<this.children.length-1&&!(e<(r=this.children[i]).length||r instanceof dn);)i++,e=0;return this.children[i].domAtPos(e)}},{key:"coordsAt",value:function t(n,i){for(var e,r,o,u,e=this.length,r=this.children.length-1;;r--){if((u=e-(o=this.children[r]).breakAfter-o.length)<n||n==u&&o.type!=P.WidgetBefore&&o.type!=P.WidgetAfter&&(!r||2==i||this.children[r-1].breakAfter||this.children[r-1].type==P.WidgetBefore&&-2<i))return o.coordsAt(n-u,i);e=u}}},{key:"measureVisibleLineHeights",value:function t(n){for(var i,e,r,o,u,s,a,h,f,c,l,v,d,d,d,v,i=[],e=n.from,r=n.to,o=this.view.contentDOM.clientWidth,u=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,s=-1,a=this.view.textDirection==E.LTR,h=0,f=0;f<this.children.length&&!(r<(l=h+(c=this.children[f]).length));f++)e<=h&&(v=c.dom.getBoundingClientRect(),i.push(v.height),u)&&(d=(d=c.dom.lastChild)?d0(d):[]).length&&(d=d[d.length-1],s<(v=a?d.right-v.left:v.right-d.left))&&(s=v,this.minWidth=o,this.minWidthFrom=h,this.minWidthTo=l),h=l+c.breakAfter;return i}},{key:"textDirectionAt",value:function t(n){var i,n=this.childPos(n,1).i;return"rtl"==getComputedStyle(this.children[n].dom).direction?E.RTL:E.LTR}},{key:"measureTextSize",value:function t(){var n,i,e,r,o,u,s,a,h,n=this,i=F(this.children);try{for(i.s();!(e=i.n()).done;)if((r=e.value)instanceof dn&&(o=r.measureTextSize()))return o}catch(t){i.e(t)}finally{i.f()}return(u=document.createElement("div")).className="cm-line",u.style.width="99999px",u.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(function(){n.dom.appendChild(u);var t=d0(u.firstChild)[0];s=u.getBoundingClientRect().height,a=t?t.width/27:7,h=t?t.height:s,u.remove()}),{lineHeight:s,charWidth:a,textHeight:h}}},{key:"childCursor",value:function t(){var n,i,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.length,i=this.children.length;return i&&(n-=this.children[--i].length),new Zt(this.children,n,i)}},{key:"computeBlockGapDeco",value:function t(){for(var n,i,e,r,o,u,s,n=[],i=this.view.viewState,e=0,r=0;e<(u=(o=r==i.viewports.length?null:i.viewports[r])?o.from-1:this.length)&&(s=i.lineBlockAt(u).bottom-i.lineBlockAt(e).top,n.push(m.replace({widget:new ri(s),block:!0,inclusive:!0,isBlockGap:!0}).range(e,u))),o;r++)e=o.to+1;return m.set(n)}},{key:"updateDeco",value:function t(){for(var e,n,i,e=this,n=this.view.state.facet(Ln).map(function(t,n){var i;return(e.dynamicDecorationMap[n]="function"==typeof t)?t(e.view):t}),i=n.length;i<n.length+3;i++)this.dynamicDecorationMap[i]=!1;return this.decorations=[].concat(yc(n),[this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco])}},{key:"scrollIntoView",value:function t(n){var i,e,r,r,e,i=n.range,e=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);e&&(!i.empty&&(r=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(e={left:Math.min(e.left,r.left),top:Math.min(e.top,r.top),right:Math.max(e.right,r.right),bottom:Math.max(e.bottom,r.bottom)}),r=mv(this.view),e={left:e.left-r.left,top:e.top-r.top,right:e.right+r.right,bottom:e.bottom+r.bottom},b0(this.view.scrollDOM,e,i.head<i.anchor?-1:1,n.x,n.y,n.xMargin,n.yMargin,this.view.textDirection==E.LTR))}}]),ei=Pv,x(Ev,Yt),gf=S(Ev),D(Ev,[{key:"toDOM",value:function t(){var n=document.createElement("div");return this.updateDOM(n),n}},{key:"eq",value:function t(n){return n.height==this.height}},{key:"updateDOM",value:function t(n){return n.style.height=this.height+"px",!0}},{key:"estimatedHeight",get:function t(){return this.height}}]),ri=Ev,x(Rv,Yt),bf=S(Rv),D(Rv,[{key:"eq",value:function t(n){return this.top==n.top&&this.text==n.text}},{key:"toDOM",value:function t(){return this.top}},{key:"ignoreEvent",value:function t(){return!1}},{key:"customView",get:function t(){return hn}}]),oi=Rv,D(Lv,[{key:"compareRange",value:function t(n,i){uv(n,i,this.changes)}},{key:"comparePoint",value:function t(n,i){uv(n,i,this.changes)}}]),ui=Lv,D(id,[{key:"setSelectionOrigin",value:function t(n){this.lastSelectionOrigin=n,this.lastSelectionTime=Date.now()}},{key:"ensureHandlers",value:function t(i,n){var e,r,o,u,s,a,h,f,e=this;this.customHandlers=[],u=F(n);try{for(u.s();!(s=u.n()).done;)if(o=null==(r=(a=s.value).update(i).spec)?void 0:r.domEventHandlers)for(f in this.customHandlers.push({plugin:a.value,handlers:o}),h=function t(n){e.registeredEvents.indexOf(n)<0&&"scroll"!=n&&(e.registeredEvents.push(n),i.contentDOM.addEventListener(n,function(t){ad(i,t)&&e.runCustomHandlers(n,i,t)&&t.preventDefault()}))},o)h(f)}catch(t){u.e(t)}finally{u.f()}}},{key:"runCustomHandlers",value:function t(n,i,e){var r,o,u,s,r=F(this.customHandlers);try{for(r.s();!(o=r.n()).done;)if(s=(u=o.value).handlers[n])try{if(s.call(u.plugin,e,i)||e.defaultPrevented)return!0}catch(t){vv(i.state,t)}}catch(t){r.e(t)}finally{r.f()}return!1}},{key:"runScrollHandlers",value:function t(n,i){var e,r,o,u;this.lastScrollTop=n.scrollDOM.scrollTop,this.lastScrollLeft=n.scrollDOM.scrollLeft,e=F(this.customHandlers);try{for(e.s();!(r=e.n()).done;)if(u=(o=r.value).handlers.scroll)try{u.call(o.plugin,i,n)}catch(t){vv(n.state,t)}}catch(t){e.e(t)}finally{e.f()}}},{key:"keydown",value:function t(n,i){var e,r,e=this;return this.lastKeyCode=i.keyCode,this.lastKeyTime=Date.now(),9==i.keyCode&&Date.now()<this.lastEscPress+2e3||(27!=i.keyCode&&fi.indexOf(i.keyCode)<0&&(n.inputState.lastEscPress=0),!g.android||!g.chrome||i.synthetic||13!=i.keyCode&&8!=i.keyCode?!(!g.ios||i.synthetic||i.altKey||i.metaKey||!((r=ai.find(function(t){return t.keyCode==i.keyCode}))&&!i.ctrlKey||-1<hi.indexOf(i.key)&&i.ctrlKey&&!i.shiftKey)||(this.pendingIOSKey=r||i,setTimeout(function(){return e.flushIOSKey(n)},250),0)):(n.observer.delayAndroidKey(i.key,i.keyCode),!0))}},{key:"flushIOSKey",value:function t(n){var i=this.pendingIOSKey;return!!i&&(this.pendingIOSKey=void 0,j0(n.contentDOM,i.key,i.keyCode))}},{key:"ignoreDuringComposition",value:function t(n){return!!/^key/.test(n.type)&&(0<this.composing||!!(g.safari&&!g.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&!(this.compositionPendingKey=!1))}},{key:"mustFlushObserver",value:function t(n){return"keydown"==n.type&&229!=n.keyCode}},{key:"startMouseSelection",value:function t(n){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=n}},{key:"update",value:function t(n){this.mouseSelection&&this.mouseSelection.update(n),n.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}},{key:"destroy",value:function t(){this.mouseSelection&&this.mouseSelection.destroy()}}]),si=id,ai=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],hi="dthko",fi=[16,17,18,20,91,92,224,225],ci=6,D(rd,[{key:"start",value:function t(n){!1===this.dragging&&(n.preventDefault(),this.select(n))}},{key:"move",value:function t(n){var i,e,r,i,o;if(0==n.buttons)return this.destroy();!1===this.dragging&&(this.select(this.lastEvent=n),r=e=0,i=(null==(i=this.scrollParent)?void 0:i.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=mv(this.view),n.clientX-o.left<=i.left+6?e=-ed(i.left-n.clientX):n.clientX+o.right>=i.right-6&&(e=ed(n.clientX-i.right)),n.clientY-o.top<=i.top+6?r=-ed(i.top-n.clientY):n.clientY+o.bottom>=i.bottom-6&&(r=ed(n.clientY-i.bottom)),this.setScrollSpeed(e,r))}},{key:"up",value:function t(n){null==this.dragging&&this.select(this.lastEvent),this.dragging||n.preventDefault(),this.destroy()}},{key:"destroy",value:function t(){this.setScrollSpeed(0,0);var n=this.view.contentDOM.ownerDocument;n.removeEventListener("mousemove",this.move),n.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}},{key:"setScrollSpeed",value:function t(n,i){var e=this;this.scrollSpeed={x:n,y:i},n||i?this.scrolling<0&&(this.scrolling=setInterval(function(){return e.scroll()},50)):-1<this.scrolling&&(clearInterval(this.scrolling),this.scrolling=-1)}},{key:"scroll",value:function t(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}},{key:"skipAtoms",value:function t(n){for(var i,e,r,o,u,u,s,i=null,e=0;e<n.ranges.length;e++)o=null,(r=n.ranges[e]).empty?(u=td(this.atoms,r.from,0))!=r.from&&(o=O.cursor(u,-1)):(u=td(this.atoms,r.from,-1),s=td(this.atoms,r.to,1),u==r.from&&s==r.to||(o=O.range(r.from==r.anchor?u:s,r.from==r.head?u:s))),o&&((i=i||n.ranges.slice())[e]=o);return i?O.create(i,n.mainIndex):n}},{key:"select",value:function t(n){var i=this.view,n=this.skipAtoms(this.style.get(n,this.extend,this.multiple));!this.mustSelect&&n.eq(i.state.selection)&&n.main.assoc==i.state.selection.main.assoc||this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}},{key:"update",value:function t(n){var i=this;n.docChanged&&this.dragging&&(this.dragging=this.dragging.map(n.changes)),this.style.update(n)&&setTimeout(function(){return i.select(i.lastEvent)},20)}}]),li=rd,s=Object.create(null),vi=Object.create(null),di=g.ie&&g.ie_version<15||g.ios&&g.webkit_version<604,s.keydown=function(t,n){t.inputState.setSelectionOrigin("select"),27==n.keyCode&&(t.inputState.lastEscPress=Date.now())},s.touchstart=function(t,n){t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},s.touchmove=function(t){t.inputState.setSelectionOrigin("select.pointer")},vi.touchstart=vi.touchmove={passive:!0},s.mousedown=function(t,n){var i,e,r,o,u;if(t.observer.flush(),!(t.inputState.lastTouchTime>Date.now()-2e3)){i=null,e=F(t.state.facet(wn));try{for(e.s();!(r=e.n()).done&&!(i=(o=r.value)(t,n)););}catch(t){e.e(t)}finally{e.f()}(i=i||0!=n.button?i:yd(t,n))&&(u=t.root.activeElement!=t.contentDOM,t.inputState.startMouseSelection(new li(t,n,i,u)),u&&t.observer.ignore(function(){return S0(t.contentDOM)}),t.inputState.mouseSelection)&&t.inputState.mouseSelection.start(n)}},yi=function t(n,i){return n>=i.top&&n<=i.bottom},mi=function t(n,i,e){return yi(i,e)&&n>=e.left&&n<=e.right},pi=g.ie&&g.ie_version<=11,ki=null,wi=gi=0,s.dragstart=function(t,n){var i,e,i=t.state.selection.main,e=t.inputState.mouseSelection;e&&(e.dragging=i),n.dataTransfer&&(n.dataTransfer.setData("Text",t.state.sliceDoc(i.from,i.to)),n.dataTransfer.effectAllowed="copyMove")},s.drop=function(n,i){var e,r,o,u,t,s;if(i.dataTransfer){if(n.state.readOnly)return i.preventDefault();if((e=i.dataTransfer.files)&&e.length)for(i.preventDefault(),r=Array(e.length),u=function t(){++o==e.length&&pd(n,i,r.filter(function(t){return null!=t}).join(n.state.lineBreak),!1)},t=function t(n){var i=new FileReader;i.onerror=u,i.onload=function(){/[\x00-\x08\x0e-\x1f]{2}/.test(i.result)||(r[n]=i.result),u()},i.readAsText(e[n])},s=o=0;s<e.length;s++)t(s);else pd(n,i,i.dataTransfer.getData("Text"),!0)}},s.paste=function(t,n){if(t.state.readOnly)return n.preventDefault();t.observer.flush();var i=di?null:n.clipboardData;i?(fd(t,i.getData("text/plain")||i.getData("text/uri-text")),n.preventDefault()):hd(t)},bi=null,s.copy=s.cut=function(t,n){var i,e,r,i,i,i=gd(t.state),e=i.text,r=i.ranges,i=i.linewise;(e||i)&&(bi=i?e:null,(i=di?null:n.clipboardData)?(n.preventDefault(),i.clearData(),i.setData("text/plain",e)):kd(t,e),"cut"!=n.type||t.state.readOnly||t.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"}))},Mi=gt.define(),s.focus=function(t){t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),bd(t)},s.blur=function(t){t.observer.clearSelectionRange(),bd(t)},s.compositionstart=s.compositionupdate=function(t){null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0)},s.compositionend=function(t){t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=0<t.observer.pendingRecords().length,t.inputState.compositionFirstChange=null,g.chrome&&g.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(function(){return t.observer.flush()}):setTimeout(function(){t.inputState.composing<0&&t.docView.compositionDeco.size&&t.update([])},50)},s.contextmenu=function(t){t.inputState.lastContextMenu=Date.now()},s.beforeinput=function(n,i){var t,t,e;g.chrome&&g.android&&(t=ai.find(function(t){return t.inputType==i.inputType}))&&(n.observer.delayAndroidKey(t.key,t.keyCode),"Backspace"!=t.key&&"Delete"!=t.key||(e=(null==(t=window.visualViewport)?void 0:t.height)||0,setTimeout(function(){var t;((null==(t=window.visualViewport)?void 0:t.height)||0)>e+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)))},xi=["pre-wrap","normal","pre-line","break-spaces"],D(Md,[{key:"heightForGap",value:function t(n,i){var e=this.doc.lineAt(i).number-this.doc.lineAt(n).number+1;return this.lineWrapping&&(e+=Math.max(0,Math.ceil((i-n-e*this.lineLength*.5)/this.lineLength))),this.lineHeight*e}},{key:"heightForLine",value:function t(n){var i;return this.lineWrapping?(1+Math.max(0,Math.ceil((n-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}},{key:"setDoc",value:function t(n){return this.doc=n,this}},{key:"mustRefreshForWrapping",value:function t(n){return-1<xi.indexOf(n)!=this.lineWrapping}},{key:"mustRefreshForHeights",value:function t(n){for(var i,e,r,i=!1,e=0;e<n.length;e++)(r=n[e])<0?e++:this.heightSamples[Math.floor(10*r)]||(i=!0,this.heightSamples[Math.floor(10*r)]=!0);return i}},{key:"refresh",value:function t(n,i,e,r,o,u){var n,s,a,h,n=-1<xi.indexOf(n),s=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=n;if(this.lineWrapping=n,this.lineHeight=i,this.charWidth=e,this.textHeight=r,this.lineLength=o,s)for(this.heightSamples={},a=0;a<u.length;a++)(h=u[a])<0?a++:this.heightSamples[Math.floor(10*h)]=!0;return s}}]),Si=Md,D(xd,[{key:"more",get:function t(){return this.index<this.heights.length}}]),Ci=xd,D(Sd,[{key:"type",get:function t(){var n,n,n;return null!=(n=null!=(n=this.children)?n:null==(n=this.deco)?void 0:n.type)?n:P.Text}},{key:"widget",get:function t(){return this.deco&&this.deco.widget}},{key:"to",get:function t(){return this.from+this.length}},{key:"bottom",get:function t(){return this.top+this.height}},{key:"join",value:function t(n){var i=(this.children||[this]).concat(n.children||[n]);return new Sd(this.from,this.length+n.length,this.top,this.height+n.height,i,null)}}]),ji=Sd,(i=d=d||{})[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",d=i,Pi=.001,D(Cd,[{key:"outdated",get:function t(){return 0<(2&this.flags)},set:function t(n){this.flags=(n?2:0)|-3&this.flags}},{key:"setHeight",value:function t(n,i){this.height!=i&&(Math.abs(this.height-i)>Pi&&(n.heightChanged=!0),this.height=i)}},{key:"replace",value:function t(n,i,e){return Cd.of(e)}},{key:"decomposeLeft",value:function t(n,i){i.push(this)}},{key:"decomposeRight",value:function t(n,i){i.push(this)}},{key:"applyChanges",value:function t(n,i,e,r){for(var o,u,s,a,h,f,c,a,l,v,v,o=this,u=e.doc,s=r.length-1;0<=s;s--){for(h=(a=r[s]).fromA,f=a.toA,c=a.fromB,a=a.toB,a+=(v=(l=o.lineAt(h,d.ByPosNoHeight,e.setDoc(i),0,0)).to>=f?l:o.lineAt(f,d.ByPosNoHeight,e,0,0)).to-f,f=v.to;0<s&&l.from<=r[s-1].toA;)h=r[s-1].fromA,c=r[s-1].fromB,s--,h<l.from&&(l=o.lineAt(h,d.ByPosNoHeight,e,0,0));c+=l.from-h,h=l.from,v=Ti.build(e.setDoc(u),n,c,a),o=o.replace(h,f,v)}return o.updateHeight(e,0)}}],[{key:"empty",value:function t(){return new Ai(0,0)}},{key:"of",value:function t(n){var i,e,r,o,u,u,s,s,a;if(1==n.length)return n[0];for(e=n.length,o=r=i=0;;)if(i==e)if(2*o<r)(u=n[i-1]).break?n.splice(--i,1,u.left,null,u.right):n.splice(--i,1,u.left,u.right),e+=1+u.break,r-=u.size;else{if(!(2*r<o))break;(u=n[e]).break?n.splice(e,1,u.left,null,u.right):n.splice(e,1,u.left,u.right),e+=2+u.break,o-=u.size}else r<o?(s=n[i++])&&(r+=s.size):(s=n[--e])&&(o+=s.size);return a=0,null==n[i-1]?(a=1,i--):null==n[i]&&(a=1,e++),new Ri(Cd.of(n.slice(0,i)),a,Cd.of(n.slice(e)))}}]),(Oi=Cd).prototype.size=1,x(jd,Oi),xf=S(jd),D(jd,[{key:"blockAt",value:function t(n,i,e,r){return new ji(r,this.length,e,this.height,null,this.deco)}},{key:"lineAt",value:function t(n,i,e,r,o){return this.blockAt(0,e,r,o)}},{key:"forEachLine",value:function t(n,i,e,r,o,u){n<=o+this.length&&o<=i&&u(this.blockAt(0,e,r,o))}},{key:"updateHeight",value:function t(n){var i,e,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length?arguments[3]:void 0;return r&&r.from<=i&&r.more&&this.setHeight(n,r.heights[r.index++]),this.outdated=!1,this}},{key:"toString",value:function t(){return"block(".concat(this.length,")")}}]),x(Pd,Ei=jd),Cf=S(Pd),D(Pd,[{key:"replace",value:function t(n,i,e){var r=e[0];return 1==e.length&&(r instanceof Pd||r instanceof Di&&4&r.flags)&&Math.abs(this.length-r.length)<10?(r instanceof Di?r=new Pd(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):Oi.of(e)}},{key:"updateHeight",value:function t(n){var i,e,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length?arguments[3]:void 0;return r&&r.from<=i&&r.more?this.setHeight(n,r.heights[r.index++]):(e||this.outdated)&&this.setHeight(n,Math.max(this.widgetHeight,n.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}},{key:"toString",value:function t(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")")}}]),Ai=Pd,x(Od,Oi),Pf=S(Od),D(Od,[{key:"heightMetrics",value:function t(n,i){var e,i,r,o,u,n,e=n.doc.lineAt(i).number,i=n.doc.lineAt(i+this.length).number,r=i-e+1,u=0;return n.lineWrapping?(o=(n=Math.min(this.height,n.lineHeight*r))/r,this.length>1+r&&(u=(this.height-n)/(this.length-r-1))):o=this.height/r,{firstLine:e,lastLine:i,perLine:o,perChar:u}}},{key:"blockAt",value:function t(n,i,e,r){var o,u,s,a,o,r,r,o,h,r,h,o,s,o=this.heightMetrics(i,r),u=o.firstLine,s=o.lastLine,a=o.perLine,o=o.perChar;return i.lineWrapping?(r=r+Math.round(Math.max(0,Math.min(1,(n-e)/this.height))*this.length),o=a+(r=i.doc.lineAt(r)).length*o,h=Math.max(e,n-o/2),new ji(r.from,r.length,h,o,null,null)):(r=Math.max(0,Math.min(s-u,Math.floor((n-e)/a))),o=(h=i.doc.line(u+r)).from,s=h.length,new ji(o,s,e+a*r,a,null,null))}},{key:"lineAt",value:function t(n,i,e,r,o){var i,u,i,i,u,s,i,e,n,s,u;return i==d.ByHeight?this.blockAt(n,e,r,o):i==d.ByPosNoHeight?(u=(i=e.doc.lineAt(n)).from,i=i.to,new ji(u,i-u,0,0,null,null)):(u=(i=this.heightMetrics(e,o)).firstLine,s=i.perLine,i=i.perChar,n=s+(e=e.doc.lineAt(n)).length*i,u=r+s*(s=e.number-u)+i*(e.from-o-s),new ji(e.from,e.length,Math.max(r,Math.min(u,r+this.height-n)),n,null,null))}},{key:"forEachLine",value:function t(n,i,e,r,o,u){var s,a,h,f,c,l,v,d,d;for(n=Math.max(n,o),i=Math.min(i,o+this.length),a=(s=this.heightMetrics(e,o)).firstLine,h=s.perLine,f=s.perChar,c=n,l=r;c<=i;)v=e.doc.lineAt(c),c==n&&(l+=h*(d=v.number-a)+f*(n-o-d)),d=h+f*v.length,u(new ji(v.from,v.length,l,d,null,null)),l+=d,c=v.to+1}},{key:"replace",value:function t(n,i,e){var i,r,r,i=this.length-i;return 0<i&&((r=e[e.length-1])instanceof Od?e[e.length-1]=new Od(r.length+i):e.push(null,new Od(i-1))),0<n&&((r=e[0])instanceof Od?e[0]=new Od(n+r.length):e.unshift(new Od(n-1),null)),Oi.of(e)}},{key:"decomposeLeft",value:function t(n,i){i.push(new Od(n-1),null)}},{key:"decomposeRight",value:function t(n,i){i.push(null,new Od(this.length-n-1))}},{key:"updateHeight",value:function t(n){var i,e,r,o,u,s,a,h,f,f,c,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length?arguments[3]:void 0,o=i+this.length;if(r&&r.from<=i+this.length&&r.more){for(u=[],s=Math.max(i,r.from),a=-1,r.from>i&&u.push(new Od(r.from-i-1).updateHeight(n,i));s<=o&&r.more;)h=n.doc.lineAt(s).length,u.length&&u.push(null),f=r.heights[r.index++],-1==a?a=f:Math.abs(f-a)>=Pi&&(a=-2),(f=new Ai(h,f)).outdated=!1,u.push(f),s+=h+1;return s<=o&&u.push(null,new Od(o-s).updateHeight(n,s)),c=Oi.of(u),(a<0||Math.abs(c.height-this.height)>=Pi||Math.abs(a-this.heightMetrics(n,i).perLine)>=Pi)&&(n.heightChanged=!0),c}return(e||this.outdated)&&(this.setHeight(n,n.heightForGap(i,i+this.length)),this.outdated=!1),this}},{key:"toString",value:function t(){return"gap(".concat(this.length,")")}}]),Di=Od,x(Ed,Oi),Ef=S(Ed),D(Ed,[{key:"break",get:function t(){return 1&this.flags}},{key:"blockAt",value:function t(n,i,e,r){var o=e+this.left.height;return n<o?this.left.blockAt(n,i,e,r):this.right.blockAt(n,i,o,r+this.left.length+this.break)}},{key:"lineAt",value:function t(n,i,e,r,o){var u,s,a,n,i,u=r+this.left.height,s=o+this.left.length+this.break,a=i==d.ByHeight?n<u:n<s,n=a?this.left.lineAt(n,i,e,r,o):this.right.lineAt(n,i,e,u,s);return this.break||(a?n.to<s:n.from>s)?n:(i=i==d.ByPosNoHeight?d.ByPosNoHeight:d.ByPos,a?n.join(this.right.lineAt(s,i,e,u,s)):this.left.lineAt(s,i,e,r,o).join(n))}},{key:"forEachLine",value:function t(n,i,e,r,o,u){var s,a,h,s=r+this.left.height,a=o+this.left.length+this.break;this.break?(n<a&&this.left.forEachLine(n,i,e,r,o,u),a<=i&&this.right.forEachLine(n,i,e,s,a,u)):(n<(h=this.lineAt(a,d.ByPos,e,r,o)).from&&this.left.forEachLine(n,h.from-1,e,r,o,u),h.to>=n&&h.from<=i&&u(h),i>h.to&&this.right.forEachLine(h.to+1,i,e,s,a,u))}},{key:"replace",value:function t(n,i,e){var r,o,r,u,s,a,e,r=this.left.length+this.break;if(i<r)return this.balanced(this.left.replace(n,i,e),this.right);if(n>this.left.length)return this.balanced(this.left,this.right.replace(n-r,i-r,e));o=[],0<n&&this.decomposeLeft(n,o),r=o.length,u=F(e);try{for(u.s();!(s=u.n()).done;)a=s.value,o.push(a)}catch(t){u.e(t)}finally{u.f()}return 0<n&&Ad(o,r-1),i<this.length&&(e=o.length,this.decomposeRight(i,o),Ad(o,e)),Oi.of(o)}},{key:"decomposeLeft",value:function t(n,i){var e=this.left.length;if(n<=e)return this.left.decomposeLeft(n,i);i.push(this.left),this.break&&++e<=n&&i.push(null),e<n&&this.right.decomposeLeft(n-e,i)}},{key:"decomposeRight",value:function t(n,i){var e=this.left.length,r=e+this.break;if(r<=n)return this.right.decomposeRight(n-r,i);n<e&&this.left.decomposeRight(n,i),this.break&&n<r&&i.push(null),i.push(this.right)}},{key:"balanced",value:function t(n,i){return n.size>2*i.size||i.size>2*n.size?Oi.of(this.break?[n,null,i]:[n,i]):(this.left=n,this.right=i,this.height=n.height+i.height,this.outdated=n.outdated||i.outdated,this.size=n.size+i.size,this.length=n.length+this.break+i.length,this)}},{key:"updateHeight",value:function t(n){var i,e,r,o,u,s,a,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length?arguments[3]:void 0,o=this.left,u=this.right,s=i+o.length+this.break,a=null;return r&&r.from<=i+o.length&&r.more?a=o=o.updateHeight(n,i,e,r):o.updateHeight(n,i,e),r&&r.from<=s+u.length&&r.more?a=u=u.updateHeight(n,s,e,r):u.updateHeight(n,s,e),a?this.balanced(o,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}},{key:"toString",value:function t(){return this.left+(this.break?" ":"-")+this.right}}]),Ri=Ed,Ii=5,D(Dd,[{key:"isCovered",get:function t(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}},{key:"span",value:function t(n,i){var e,r;-1<this.lineStart&&(e=Math.min(i,this.lineEnd),(r=this.nodes[this.nodes.length-1])instanceof Ai?r.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new Ai(e-this.pos,-1)),(this.writtenTo=e)<i)&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1),this.pos=i}},{key:"point",value:function t(n,i,e){var r,o;n<i||e.heightRelevant?((r=e.widget?e.widget.estimatedHeight:0)<0&&(r=this.oracle.lineHeight),o=i-n,e.block?this.addBlock(new Ei(o,r,e)):(o||5<=r)&&this.addLineDeco(r,o)):n<i&&this.span(n,i),-1<this.lineEnd&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}},{key:"enterLine",value:function t(){var n,i,n;-1<this.lineStart||(i=(n=this.oracle.doc.lineAt(this.pos)).from,n=n.to,this.lineStart=i,this.lineEnd=n,this.writtenTo<i&&((this.writtenTo<i-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,i-1)),this.nodes.push(null)),this.pos>i&&this.nodes.push(new Ai(this.pos-i,-1)),this.writtenTo=this.pos)}},{key:"blankContent",value:function t(n,i){var e=new Di(i-n);return this.oracle.doc.lineAt(n).to==i&&(e.flags|=4),e}},{key:"ensureLine",value:function t(){var n,n;return this.enterLine(),(n=this.nodes.length?this.nodes[this.nodes.length-1]:null)instanceof Ai||(n=new Ai(0,-1),this.nodes.push(n)),n}},{key:"addBlock",value:function t(n){var i,i;this.enterLine(),(i=null==(i=n.deco)?void 0:i.type)!=P.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(n),this.writtenTo=this.pos=this.pos+n.length,i!=P.WidgetBefore&&(this.covering=n)}},{key:"addLineDeco",value:function t(n,i){var e=this.ensureLine();e.length+=i,e.collapsed+=i,e.widgetHeight=Math.max(e.widgetHeight,n),this.writtenTo=this.pos=this.pos+i}},{key:"finish",value:function t(n){var i,e,r,o,u,i=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(-1<this.lineStart)||i instanceof Ai||this.isCovered?(this.writtenTo<this.pos||null==i)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Ai(0,-1)),e=n,r=F(this.nodes);try{for(r.s();!(o=r.n()).done;)(u=o.value)instanceof Ai&&u.updateHeight(this.oracle,e),e+=u?u.length:1}catch(t){r.e(t)}finally{r.f()}return this.nodes}}],[{key:"build",value:function t(n,i,e,r){var n=new Dd(e,n);return j.spans(i,e,r,n,0),n.finish(e)}}]),Ti=Dd,D(Id,[{key:"compareRange",value:function t(){}},{key:"comparePoint",value:function t(n,i,e,r){(n<i||e&&e.heightRelevant||r&&r.heightRelevant)&&uv(n,i,this.changes,5)}}]),Li=Id,D(Bd,[{key:"draw",value:function t(n){return m.replace({widget:new _i(this.size,n)}).range(this.from,this.to)}}],[{key:"same",value:function t(n,i){var e,r,o;if(n.length!=i.length)return!1;for(e=0;e<n.length;e++)if(r=n[e],o=i[e],r.from!=o.from||r.to!=o.to||r.size!=o.size)return!1;return!0}}]),Bi=Bd,x(_d,Yt),Df=S(_d),D(_d,[{key:"eq",value:function t(n){return n.size==this.size&&n.vertical==this.vertical}},{key:"toDOM",value:function t(){var n=document.createElement("div");return this.vertical?n.style.height=this.size+"px":(n.style.width=this.size+"px",n.style.height="2px",n.style.display="inline-block"),n}},{key:"estimatedHeight",get:function t(){return this.vertical?this.size:-1}}]),_i=_d,D(Fd,[{key:"updateForViewport",value:function t(){for(var r,o,u,n,s,r=this,o=[this.viewport],u=this.state.selection.main,n=function t(){var i,n,e,n,i=s?u.head:u.anchor;o.some(function(t){var n=t.from,t=t.to;return n<=i&&i<=t})||(e=(n=r.lineBlockAt(i)).from,n=n.to,o.push(new Ni(e,n)))},s=0;s<=1;s++)n();this.viewports=o.sort(function(t,n){return t.from-n.from}),this.scaler=this.heightMap.height<=7e6?Ui:new Hi(this.heightOracle,this.heightMap,this.viewports)}},{key:"updateViewportLines",value:function t(){var n=this;this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,function(t){n.viewportLines.push(1==n.scaler.scale?t:Vd(t,n.scaler))})}},{key:"update",value:function t(n){var i,e,r,r,e,e,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.state=n.state,e=this.stateDeco,this.stateDeco=this.state.facet(Ln).filter(function(t){return"function"!=typeof t}),r=n.changedRanges,r=Nn.extendWithRanges(r,Rd(e,this.stateDeco,n?n.changes:K.empty(this.state.doc.length))),e=this.heightMap.height,this.heightMap=this.heightMap.applyChanges(this.stateDeco,n.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=e&&(n.flags|=2),e=r.length?this.mapViewport(this.viewport,n.changes):this.viewport,(i&&(i.range.head<e.from||i.range.head>e.to)||!this.viewportIsAppropriate(e))&&(e=this.getViewport(0,i)),r=!n.changes.empty||2&n.flags||e.from!=this.viewport.from||e.to!=this.viewport.to,this.viewport=e,this.updateForViewport(),r&&this.updateViewportLines(),(this.lineGaps.length||4e3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,n.changes))),n.flags|=this.computeVisibleRanges(),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&n.selectionSet&&n.view.lineWrapping&&n.state.selection.main.empty&&n.state.selection.main.assoc&&!n.state.facet(jn)&&(this.mustEnforceCursorAssoc=!0)}},{key:"measure",value:function t(n){var i,e,r,o,u,s,a,h,f,c,e,c,e,i,c,c,l,s,a,v,s,d,y,m,p,o,i=n.contentDOM,e=window.getComputedStyle(i),r=this.heightOracle,o=e.whiteSpace;if(this.defaultTextDirection="rtl"==e.direction?E.RTL:E.LTR,u=this.heightOracle.mustRefreshForWrapping(o),s=i.getBoundingClientRect(),a=u||this.mustMeasureContent||this.contentDOMHeight!=s.height,this.contentDOMHeight=s.height,this.mustMeasureContent=!1,f=h=0,c=parseInt(e.paddingTop)||0,e=parseInt(e.paddingBottom)||0,this.paddingTop==c&&this.paddingBottom==e||(this.paddingTop=c,this.paddingBottom=e,h|=10),this.editorWidth!=n.scrollDOM.clientWidth&&(r.lineWrapping&&(a=!0),this.editorWidth=n.scrollDOM.clientWidth,h|=8),e=(c=(this.printing?Ld:Td)(i,this.paddingTop)).top-this.pixelViewport.top,i=c.bottom-this.pixelViewport.bottom,this.pixelViewport=c,(c=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left)!=this.inView&&(this.inView=c)&&(a=!0),!this.inView&&!this.scrollTarget)return 0;if(c=s.width,this.contentDOMWidth==c&&this.editorHeight==n.scrollDOM.clientHeight||(this.contentDOMWidth=s.width,this.editorHeight=n.scrollDOM.clientHeight,h|=8),a){l=n.docView.measureVisibleLineHeights(this.viewport),((u=r.mustRefreshForHeights(l)?!0:u)||r.lineWrapping&&Math.abs(c-this.contentDOMWidth)>r.charWidth)&&(a=(s=n.docView.measureTextSize()).lineHeight,v=s.charWidth,s=s.textHeight,u=0<a&&r.refresh(o,a,v,s,c/v,l))&&(n.docView.minWidth=0,h|=8),0<e&&0<i?f=Math.max(e,i):e<0&&i<0&&(f=Math.min(e,i)),r.heightChanged=!1,d=F(this.viewports);try{for(d.s();!(y=d.n()).done;)p=(m=y.value).from==this.viewport.from?l:n.docView.measureVisibleLineHeights(m),this.heightMap=(u?Oi.empty().applyChanges(this.stateDeco,k.empty,this.heightOracle,[new Nn(0,0,0,n.state.doc.length)]):this.heightMap).updateHeight(r,0,u,new Ci(m.from,p))}catch(t){d.e(t)}finally{d.f()}r.heightChanged&&(h|=2)}return(o=!this.viewportIsAppropriate(this.viewport,f)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to))&&(this.viewport=this.getViewport(f,this.scrollTarget)),this.updateForViewport(),(2&h||o)&&this.updateViewportLines(),(this.lineGaps.length||4e3<this.viewport.to-this.viewport.from)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,n)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,n.docView.enforceCursorAssoc()),h}},{key:"visibleTop",get:function t(){return this.scaler.fromDOM(this.pixelViewport.top)}},{key:"visibleBottom",get:function t(){return this.scaler.fromDOM(this.pixelViewport.bottom)}},{key:"getViewport",value:function t(n,i){var n,e,r,o,u,o,u,n,s,i,n=.5-Math.max(-.5,Math.min(.5,n/1e3/2)),e=this.heightMap,r=this.heightOracle,o=this.visibleTop,u=this.visibleBottom,o=new Ni(e.lineAt(o-1e3*n,d.ByHeight,r,0,0).from,e.lineAt(u+1e3*(1-n),d.ByHeight,r,0,0).to);return i&&((u=i.range.head)<o.from||u>o.to)&&(n=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),s=e.lineAt(u,d.ByPos,r,0,0),i="center"==i.y?(s.top+s.bottom)/2-n/2:"start"==i.y||"nearest"==i.y&&u<o.from?s.top:s.bottom-n,o=new Ni(e.lineAt(i-500,d.ByHeight,r,0,0).from,e.lineAt(i+n+500,d.ByHeight,r,0,0).to)),o}},{key:"mapViewport",value:function t(n,i){var e=i.mapPos(n.from,-1),i=i.mapPos(n.to,1);return new Ni(this.heightMap.lineAt(e,d.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,d.ByPos,this.heightOracle,0,0).to)}},{key:"viewportIsAppropriate",value:function t(n){var i,n,e,r,o,u,s,a,h,i=n.from,n=n.to,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return!this.inView||(o=(r=this.heightMap.lineAt(i,d.ByPos,this.heightOracle,0,0)).top,s=(u=this.heightMap.lineAt(n,d.ByPos,this.heightOracle,0,0)).bottom,a=this.visibleTop,h=this.visibleBottom,(0==i||o<=a-Math.max(10,Math.min(-e,250)))&&(n==this.state.doc.length||s>=h+Math.max(10,Math.min(e,250)))&&a-2e3<o&&s<h+2e3)}},{key:"mapLineGaps",value:function t(n,i){var e,r,o,u;if(!n.length||i.empty)return n;e=[],r=F(n);try{for(r.s();!(o=r.n()).done;)u=o.value,i.touchesRange(u.from,u.to)||e.push(new Bi(i.mapPos(u.from),i.mapPos(u.to),u.size))}catch(t){r.e(t)}finally{r.f()}return e}},{key:"ensureLineGaps",value:function t(c,l){var v,d,n,y,i,m,e,r,o,u,s,a,h,f,p,k,g,w,b,M,x,S,C,j,P,v=this,d=this.heightOracle.lineWrapping,n=d?1e4:2e3,y=n>>1,i=n<<1;if(this.defaultTextDirection!=E.LTR&&!d)return[];m=[],e=function t(i,e,r,n){var o,u,s,a,h,o,f;if(!(e-i<y)){for(o=v.state.selection.main,u=[o.from],o.empty||u.push(o.to),s=0,a=u;s<a.length;s++)if(i<(h=a[s])&&h<e)return t(i,h-10,r,n),void t(h+10,e,r,n);(o=zd(c,function(n){return n.from>=r.from&&n.to<=r.to&&Math.abs(n.from-i)<y&&Math.abs(n.to-e)<y&&!u.some(function(t){return n.from<t&&n.to>t})}))||(e<r.to&&l&&d&&l.visibleRanges.some(function(t){return t.from<=e&&t.to>=e})&&(f=l.moveToLineBoundary(O.cursor(e),!1,!0).head,i<f)&&(e=f),o=new Bi(i,e,v.gapSize(r,i,e,n))),m.push(o)}},r=F(this.viewportLines);try{for(r.s();!(o=r.n()).done;)(u=o.value).length<i||(s=Nd(u.from,u.to,this.stateDeco)).total<i||(a=this.scrollTarget?this.scrollTarget.range.head:null,f=h=void 0,f=d?(p=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,g=k=void 0,g=null!=a?(k=(w=Hd(s,a))-(b=((this.visibleBottom-this.visibleTop)/2+p)/u.height),w+b):(k=(this.visibleTop-u.top-p)/u.height,(this.visibleBottom-u.top+p)/u.height),h=Ud(s,k),Ud(s,g)):(M=s.total*this.heightOracle.charWidth,x=n*this.heightOracle.charWidth,C=S=void 0,C=null!=a?(S=(j=Hd(s,a))-(P=((this.pixelViewport.right-this.pixelViewport.left)/2+x)/M),j+P):(S=(this.pixelViewport.left-x)/M,(this.pixelViewport.right+x)/M),h=Ud(s,S),Ud(s,C)),h>u.from&&e(u.from,h,u,s),f<u.to&&e(f,u.to,u,s))}catch(t){r.e(t)}finally{r.f()}return m}},{key:"gapSize",value:function t(n,i,e,r){var e=Hd(r,e)-Hd(r,i);return this.heightOracle.lineWrapping?n.height*e:r.total*this.heightOracle.charWidth*e}},{key:"updateLineGaps",value:function t(n){var i=this;Bi.same(n,this.lineGaps)||(this.lineGaps=n,this.lineGapDeco=m.set(n.map(function(t){return t.draw(i.heightOracle.lineWrapping)})))}},{key:"computeVisibleRanges",value:function t(){var n,e,n,n=this.stateDeco;return this.lineGaps.length&&(n=n.concat(this.lineGapDeco)),e=[],j.spans(n,this.viewport.from,this.viewport.to,{span:function t(n,i){e.push({from:n,to:i})},point:function t(){}},20),n=e.length!=this.visibleRanges.length||this.visibleRanges.some(function(t,n){return t.from!=e[n].from||t.to!=e[n].to}),this.visibleRanges=e,n?4:0}},{key:"lineBlockAt",value:function t(n){return n>=this.viewport.from&&n<=this.viewport.to&&this.viewportLines.find(function(t){return t.from<=n&&t.to>=n})||Vd(this.heightMap.lineAt(n,d.ByPos,this.heightOracle,0,0),this.scaler)}},{key:"lineBlockAtHeight",value:function t(n){return Vd(this.heightMap.lineAt(this.scaler.fromDOM(n),d.ByHeight,this.heightOracle,0,0),this.scaler)}},{key:"elementAtHeight",value:function t(n){return Vd(this.heightMap.blockAt(this.scaler.fromDOM(n),this.heightOracle,0,0),this.scaler)}},{key:"docHeight",get:function t(){return this.scaler.toDOM(this.heightMap.height)}},{key:"contentHeight",get:function t(){return this.docHeight+this.paddingTop+this.paddingBottom}}]),Fi=Fd,Ni=D(function t(n,i){A(this,t),this.from=n,this.to=i}),Ui={toDOM:function t(n){return n},fromDOM:function t(n){return n},scale:1},D(Wd,[{key:"toDOM",value:function t(n){for(var i,e,r,o,i=0,e=0,r=0;;i++){if(!(o=i<this.viewports.length?this.viewports[i]:null)||n<o.top)return r+(n-e)*this.scale;if(n<=o.bottom)return o.domTop+(n-o.top);e=o.bottom,r=o.domBottom}}},{key:"fromDOM",value:function t(n){for(var i,e,r,o,i=0,e=0,r=0;;i++){if(!(o=i<this.viewports.length?this.viewports[i]:null)||n<o.domTop)return e+(n-r)/this.scale;if(n<=o.domBottom)return o.top+(n-o.domTop);e=o.bottom,r=o.domBottom}}}]),Hi=Wd,zi=y.define({combine:function t(n){return n.join(" ")}}),Wi=y.define({combine:function t(n){return-1<n.indexOf(!0)}}),Vi=_t.newName(),$i=_t.newName(),qi=_t.newName(),Ji=$d("."+Vi,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Gi={"&light":"."+$i,"&dark":"."+qi}),Ki=D(function t(n,i,e,r){var r,o,r,i,e,e,i,o;A(this,t),this.typeOver=r,this.bounds=null,this.text="",o=(r=n.docView).impreciseHead,r=r.impreciseAnchor,n.state.readOnly&&-1<i?this.newSel=null:-1<i&&(this.bounds=n.docView.domBoundsAround(i,e,0))?(i=o||r?[]:Jd(n),(e=new ni(i,n.state)).readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=e.text,this.newSel=Kd(i,this.bounds.from)):(e=n.observer.selectionRange,i=o&&o.node==e.focusNode&&o.offset==e.focusOffset||!c0(n.contentDOM,e.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(e.focusNode,e.focusOffset),o=r&&r.node==e.anchorNode&&r.offset==e.anchorOffset||!c0(n.contentDOM,e.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(e.anchorNode,e.anchorOffset),this.newSel=O.single(o,i))}),Qi={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Xi=g.ie&&g.ie_version<=11,D(Qd,[{key:"onScrollChanged",value:function t(n){this.view.inputState.runScrollHandlers(this.view,n),this.intersecting&&this.view.measure()}},{key:"onScroll",value:function t(n){this.intersecting&&this.flush(!1),this.onScrollChanged(n)}},{key:"onResize",value:function t(){var n=this;this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(function(){n.resizeTimeout=-1,n.view.requestMeasure()},50))}},{key:"onPrint",value:function t(){var n=this;this.view.viewState.printing=!0,this.view.measure(),setTimeout(function(){n.view.viewState.printing=!1,n.view.requestMeasure()},500)}},{key:"updateGaps",value:function t(i){var n,e,r;if(this.gapIntersection&&(i.length!=this.gaps.length||this.gaps.some(function(t,n){return t!=i[n]}))){this.gapIntersection.disconnect(),n=F(i);try{for(n.s();!(e=n.n()).done;)r=e.value,this.gapIntersection.observe(r)}catch(t){n.e(t)}finally{n.f()}this.gaps=i}}},{key:"onSelectionChange",value:function t(n){var i,e,r,o,i=this.selectionChanged;this.readSelectionRange()&&!this.delayedAndroidKey&&(e=this.view,r=this.selectionRange,e.state.facet(En)?e.root.activeElement==this.dom:v0(e.dom,r))&&((o=r.anchorNode&&e.docView.nearest(r.anchorNode))&&o.ignoreEvent(n)?i||(this.selectionChanged=!1):(g.ie&&g.ie_version<=11||g.android&&g.chrome)&&!e.state.selection.main.empty&&r.focusNode&&y0(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1))}},{key:"readSelectionRange",value:function t(){var n,i,e,n=this.view,i=g.safari&&11==n.root.nodeType&&l0(this.dom.ownerDocument)==this.dom&&Zd(this.view)||f0(n.root);return!(!i||this.selectionRange.eq(i)||((e=v0(this.dom,i))&&!this.selectionChanged&&n.inputState.lastFocusTime>Date.now()-200&&n.inputState.lastTouchTime<Date.now()-300&&E0(this.dom,i)?(this.view.inputState.lastFocusTime=0,n.docView.updateSelection(),1):(this.selectionRange.setRange(i),e&&(this.selectionChanged=!0),0)))}},{key:"setSelectionRange",value:function t(n,i){this.selectionRange.set(n.node,n.offset,i.node,i.offset),this.selectionChanged=!1}},{key:"clearSelectionRange",value:function t(){this.selectionRange.set(null,0,null,0)}},{key:"listenForScroll",value:function t(){var n,i,e,r,o,u,s,a,h;for(this.parentCheck=-1,n=0,i=null,e=this.dom;e;)if(1==e.nodeType)!i&&n<this.scrollTargets.length&&this.scrollTargets[n]==e?n++:i=i||this.scrollTargets.slice(0,n),i&&i.push(e),e=e.assignedSlot||e.parentNode;else{if(11!=e.nodeType)break;e=e.host}if(i=n<this.scrollTargets.length&&!i?this.scrollTargets.slice(0,n):i){r=F(this.scrollTargets);try{for(r.s();!(o=r.n()).done;)(u=o.value).removeEventListener("scroll",this.onScroll)}catch(t){r.e(t)}finally{r.f()}s=F(this.scrollTargets=i);try{for(s.s();!(a=s.n()).done;)(h=a.value).addEventListener("scroll",this.onScroll)}catch(t){s.e(t)}finally{s.f()}}}},{key:"ignore",value:function t(n){if(!this.active)return n();try{return this.stop(),n()}finally{this.start(),this.clear()}}},{key:"start",value:function t(){this.active||(this.observer.observe(this.dom,Qi),Xi&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}},{key:"stop",value:function t(){this.active&&(this.active=!1,this.observer.disconnect(),Xi)&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData)}},{key:"clear",value:function t(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}},{key:"delayAndroidKey",value:function t(n,i){var e,n,r,e=this;this.delayedAndroidKey||(this.flushingAndroidKey=this.view.win.requestAnimationFrame(r=function t(){var n,i,n=e.delayedAndroidKey;!n||(e.clearDelayedAndroidKey(),e.view.inputState.lastKeyCode=n.keyCode,e.view.inputState.lastKeyTime=Date.now(),i=e.flush())||!n.force||j0(e.dom,n.key,n.keyCode)})),this.delayedAndroidKey&&"Enter"!=n||(this.delayedAndroidKey={key:n,keyCode:i,force:this.lastChange<Date.now()-50||!(null==(n=this.delayedAndroidKey)||!n.force)})}},{key:"clearDelayedAndroidKey",value:function t(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}},{key:"flushSoon",value:function t(){var n=this;this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(function(){n.delayedFlush=-1,n.flush()}))}},{key:"forceFlush",value:function t(){0<=this.delayedFlush&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}},{key:"pendingRecords",value:function t(){var n,i,e,n=F(this.observer.takeRecords());try{for(n.s();!(i=n.n()).done;)e=i.value,this.queue.push(e)}catch(t){n.e(t)}finally{n.f()}return this.queue}},{key:"processRecords",value:function t(){var n,i,e,r,o,u,s,a,n=this.pendingRecords();n.length&&(this.queue=[]),r=!(e=i=-1),o=F(n);try{for(o.s();!(u=o.n()).done;)s=u.value,(a=this.readMutation(s))&&(a.typeOver&&(r=!0),e=-1==i?(i=a.from,a.to):(i=Math.min(a.from,i),Math.max(a.to,e)))}catch(t){o.e(t)}finally{o.f()}return{from:i,to:e,typeOver:r}}},{key:"readChange",value:function t(){var n,i,e,n,r,n=this.processRecords(),i=n.from,e=n.to,n=n.typeOver,r=this.selectionChanged&&v0(this.dom,this.selectionRange);return i<0&&!r?null:(-1<i&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Ki(this.view,i,e,n))}},{key:"flush",value:function t(){var n,i,e,i,n;return!(0<=this.delayedFlush||this.delayedAndroidKey||(0<arguments.length&&void 0!==arguments[0]&&!arguments[0]||this.readSelectionRange(),!(i=this.readChange())))&&(e=this.view.state,i=qd(this.view,i),this.view.state==e&&this.view.update([]),i)}},{key:"readMutation",value:function t(n){var i,e,r,i=this.view.docView.nearest(n.target);return!i||i.ignoreMutation(n)?null:(i.markDirty("attributes"==n.type),"attributes"==n.type&&(i.dirty|=4),"childList"==n.type?(e=Xd(i,n.previousSibling||n.target.previousSibling,-1),r=Xd(i,n.nextSibling||n.target.nextSibling,1),{from:e?i.posAfter(e):i.posAtStart,to:r?i.posBefore(r):i.posAtEnd,typeOver:!1}):"characterData"==n.type?{from:i.posAtStart,to:i.posAtEnd,typeOver:n.target.nodeValue==n.oldValue}:null)}},{key:"setWindow",value:function t(n){n!=this.win&&(this.removeWindowListeners(this.win),this.win=n,this.addWindowListeners(this.win))}},{key:"addWindowListeners",value:function t(n){n.addEventListener("resize",this.onResize),n.addEventListener("beforeprint",this.onPrint),n.addEventListener("scroll",this.onScroll),n.document.addEventListener("selectionchange",this.onSelectionChange)}},{key:"removeWindowListeners",value:function t(n){n.removeEventListener("scroll",this.onScroll),n.removeEventListener("resize",this.onResize),n.removeEventListener("beforeprint",this.onPrint),n.document.removeEventListener("selectionchange",this.onSelectionChange)}},{key:"destroy",value:function t(){var n,n,n,n,i,e,r;this.stop(),null!=(n=this.intersection)&&n.disconnect(),null!=(n=this.gapIntersection)&&n.disconnect(),null!=(n=this.resizeScroll)&&n.disconnect(),null!=(n=this.resizeContent)&&n.disconnect(),i=F(this.scrollTargets);try{for(i.s();!(e=i.n()).done;)(r=e.value).removeEventListener("scroll",this.onScroll)}catch(t){i.e(t)}finally{i.f()}this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}]),Zi=Qd,D(Yd,[{key:"state",get:function t(){return this.viewState.state}},{key:"viewport",get:function t(){return this.viewState.viewport}},{key:"visibleRanges",get:function t(){return this.viewState.visibleRanges}},{key:"inView",get:function t(){return this.viewState.inView}},{key:"composing",get:function t(){return 0<this.inputState.composing}},{key:"compositionStarted",get:function t(){return 0<=this.inputState.composing}},{key:"root",get:function t(){return this.Nkt}},{key:"win",get:function t(){return this.dom.ownerDocument.defaultView||window}},{key:"dispatch",value:function t(){var n,n,n=1==arguments.length&&(arguments.length<=0?void 0:arguments[0])instanceof Mt?arguments.length<=0?void 0:arguments[0]:(n=this.state).update.apply(n,arguments);this.hue(n,this)}},{key:"update",value:function t(n){var i,e,r,t,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,S,i=this;if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");r=e=!1,o=this.state,u=F(n);try{for(u.s();!(s=u.n()).done;){if((a=s.value).startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=a.state}}catch(t){u.e(t)}finally{u.f()}if(this.destroyed)this.viewState.state=o;else{if(h=this.hasFocus,f=0,c=null,n.some(function(t){return t.annotation(Mi)})?(this.inputState.notifiedFocused=h,f=1):h==this.inputState.notifiedFocused||(this.inputState.notifiedFocused=h,c=wd(o,h))||(f=1),l=this.observer.delayedAndroidKey,v=null,l?(this.observer.clearDelayedAndroidKey(),(!(v=this.observer.readChange())||this.state.doc.eq(o.doc))&&this.state.selection.eq(o.selection)||(v=null)):this.observer.clear(),o.facet(C.phrases)!=this.state.facet(C.phrases))return this.setState(o);(t=Un.create(this,o,n)).flags|=f,d=this.viewState.scrollTarget;try{this.updateState=2,y=F(n);try{for(y.s();!(m=y.n()).done;){p=m.value,d=d&&d.map(p.changes),p.scrollIntoView&&(k=p.state.selection.main,d=new Pn(k.empty?k:O.cursor(k.head,k.head>k.anchor?-1:1))),g=F(p.effects);try{for(g.s();!(w=g.n()).done;)(b=w.value).is(On)&&(d=b.value)}catch(t){g.e(t)}finally{g.f()}}}catch(t){y.e(t)}finally{y.f()}this.viewState.update(t,d),this.bidiCache=ne.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),e=this.docView.update(t),this.state.facet(Fn)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(n),this.docView.updateSelection(e,n.some(function(t){return t.isUserEvent("select.pointer")}))}finally{this.updateState=0}if(t.startState.facet(zi)!=t.state.facet(zi)&&(this.viewState.mustMeasureContent=!0),(e||r||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!t.empty){M=F(this.state.facet(Mn));try{for(M.s();!(x=M.n()).done;)(S=x.value)(t)}catch(t){M.e(t)}finally{M.f()}}(c||v)&&Promise.resolve().then(function(){c&&i.state==c.startState&&i.dispatch(c),v&&!qd(i,v)&&l.force&&j0(i.contentDOM,l.key,l.keyCode)})}}},{key:"setState",value:function t(n){var i,e,r,o,u,s,a;if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)this.viewState.state=n;else{this.updateState=2,i=this.hasFocus;try{e=F(this.plugins);try{for(e.s();!(r=e.n()).done;)(o=r.value).destroy(this)}catch(t){e.e(t)}finally{e.f()}this.viewState=new Fi(n),this.plugins=n.facet(Dn).map(function(t){return new Rn(t)}),this.pluginMap.clear(),u=F(this.plugins);try{for(u.s();!(s=u.n()).done;)(a=s.value).update(this)}catch(t){u.e(t)}finally{u.f()}this.docView=new ei(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}}},{key:"updatePlugins",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,i=n.startState.facet(Dn),e=n.state.facet(Dn);if(i!=e){r=[],o=F(e);try{for(o.s();!(u=o.n()).done;)s=u.value,(a=i.indexOf(s))<0?r.push(new Rn(s)):((h=this.plugins[a]).mustUpdate=n,r.push(h))}catch(t){o.e(t)}finally{o.f()}f=F(this.plugins);try{for(f.s();!(c=f.n()).done;)(l=c.value).mustUpdate!=n&&l.destroy(this)}catch(t){f.e(t)}finally{f.f()}this.plugins=r,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else{v=F(this.plugins);try{for(v.s();!(d=v.n()).done;)(y=d.value).mustUpdate=n}catch(t){v.e(t)}finally{v.f()}}for(m=0;m<this.plugins.length;m++)this.plugins[m].update(this)}},{key:"measure",value:function t(){var n,i,e,i,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,n=this,i=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(!this.destroyed){-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,i&&this.observer.forceFlush(),e=null,r=(i=this.scrollDOM).scrollHeight,o=i.scrollTop,s=r-(u=i.clientHeight)-4<o?r:o;try{for(a=0;this.updateState=1,h=this.viewport,f=this.viewState.lineBlockAtHeight(s),(c=this.viewState.measure(this))||this.measureRequests.length||null!=this.viewState.scrollTarget;a++){if(5<a){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}for(l=[],4&c||(v=[l,this.measureRequests],this.measureRequests=v[0],l=v[1]),d=l.map(function(t){try{return t.read(n)}catch(t){return vv(n.state,t),te}}),y=Un.create(this,this.state,[]),p=m=!1,y.flags|=c,e?e.flags|=c:e=y,this.updateState=2,y.empty||(this.updatePlugins(y),this.inputState.update(y),this.updateAttrs(),m=this.docView.update(y)),k=0;k<l.length;k++)if(d[k]!=te)try{(g=l[k]).write&&g.write(d[k],this)}catch(t){vv(this.state,t)}if(this.viewState.editorHeight&&(this.viewState.scrollTarget?(this.docView.scrollIntoView(this.viewState.scrollTarget),p=!(this.viewState.scrollTarget=null)):(1<(w=this.viewState.lineBlockAt(f.from).top-f.top)||w<-1)&&(this.scrollDOM.scrollTop+=w,p=!0)),m&&this.docView.updateSelection(!0),this.viewport.from==h.from&&this.viewport.to==h.to&&!p&&0==this.measureRequests.length)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty){b=F(this.state.facet(Mn));try{for(b.s();!(M=b.n()).done;)(x=M.value)(e)}catch(t){b.e(t)}finally{b.f()}}}}},{key:"themeClasses",get:function t(){return Vi+" "+(this.state.facet(Wi)?qi:$i)+" "+this.state.facet(zi)}},{key:"updateAttrs",value:function t(){var i,e,r,n,i=this,e=n1(this,In,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(En)?"true":"false",class:"cm-content",style:"".concat(g.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};return this.state.readOnly&&(r["aria-readonly"]="true"),n1(this,Tn,r),n=this.observer.ignore(function(){var t,n,t=Z0(i.contentDOM,i.contentAttrs,r),n=Z0(i.dom,i.editorAttrs,e);return t||n}),this.editorAttrs=e,this.contentAttrs=r,n}},{key:"showAnnouncements",value:function t(n){var i,e,r,o,u,s,a,h,i=!0,e=F(n);try{for(e.s();!(r=e.n()).done;){u=F((o=r.value).effects);try{for(u.s();!(s=u.n()).done;)(a=s.value).is(Yd.announce)&&(i&&(this.announceDOM.textContent=""),i=!1,(h=this.announceDOM.appendChild(document.createElement("div"))).textContent=a.value)}catch(t){u.e(t)}finally{u.f()}}}catch(t){e.e(t)}finally{e.f()}}},{key:"mountStyles",value:function t(){this.styleModules=this.state.facet(Fn),_t.mount(this.root,this.styleModules.concat(Ji).reverse())}},{key:"readMeasured",value:function t(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&-1<this.measureScheduled&&this.measure(!1)}},{key:"requestMeasure",value:function t(n){var i,e,i=this;if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(function(){return i.measure()})),n&&!(-1<this.measureRequests.indexOf(n))){if(null!=n.key)for(e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===n.key)return void(this.measureRequests[e]=n);this.measureRequests.push(n)}}},{key:"plugin",value:function t(n){var i=this.pluginMap.get(n);return(void 0===i||i&&i.spec!=n)&&this.pluginMap.set(n,i=this.plugins.find(function(t){return t.spec==n})||null),i&&i.update(this).value}},{key:"documentTop",get:function t(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}},{key:"documentPadding",get:function t(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}},{key:"elementAtHeight",value:function t(n){return this.readMeasured(),this.viewState.elementAtHeight(n)}},{key:"lineBlockAtHeight",value:function t(n){return this.readMeasured(),this.viewState.lineBlockAtHeight(n)}},{key:"viewportLineBlocks",get:function t(){return this.viewState.viewportLines}},{key:"lineBlockAt",value:function t(n){return this.viewState.lineBlockAt(n)}},{key:"contentHeight",get:function t(){return this.viewState.contentHeight}},{key:"moveByChar",value:function t(n,i,e){return nd(this,n,Xv(this,n,i,e))}},{key:"moveByGroup",value:function t(n,i){var e=this;return nd(this,n,Xv(this,n,i,function(t){return Zv(e,n.head,t)}))}},{key:"moveToLineBoundary",value:function t(n,i){var e;return Qv(this,n,i,!(2<arguments.length&&void 0!==arguments[2])||arguments[2])}},{key:"moveVertically",value:function t(n,i,e){return nd(this,n,Yv(this,n,i,e))}},{key:"domAtPos",value:function t(n){return this.docView.domAtPos(n)}},{key:"posAtDOM",value:function t(n){var i;return this.docView.posFromDOM(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)}},{key:"posAtCoords",value:function t(n){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return this.readMeasured(),qv(this,n,i)}},{key:"coordsAtPos",value:function t(n){var i,e,r,o,u,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return this.readMeasured(),(e=this.docView.coordsAt(n,i))&&e.left!=e.right?(r=this.state.doc.lineAt(n),g0(e,(u=(o=this.bidiSpans(r))[Zn.find(o,n-r.from,-1,i)]).dir==E.LTR==0<i)):e}},{key:"defaultCharacterWidth",get:function t(){return this.viewState.heightOracle.charWidth}},{key:"defaultLineHeight",get:function t(){return this.viewState.heightOracle.lineHeight}},{key:"textDirection",get:function t(){return this.viewState.defaultTextDirection}},{key:"textDirectionAt",value:function t(n){var i;return!this.state.facet(Cn)||n<this.viewport.from||n>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(n))}},{key:"lineWrapping",get:function t(){return this.viewState.heightOracle.lineWrapping}},{key:"bidiSpans",value:function t(n){var i,e,r,o,u;if(n.length>Yi)return xv(n.length);i=this.textDirectionAt(n.from),e=F(this.bidiCache);try{for(e.s();!(r=e.n()).done;)if((o=r.value).from==n.from&&o.dir==i)return o.order}catch(t){e.e(t)}finally{e.f()}return u=Mv(n.text,i),this.bidiCache.push(new ne(n.from,n.to,i,u)),u}},{key:"hasFocus",get:function t(){var n;return(this.dom.ownerDocument.hasFocus()||g.safari&&(null==(n=this.inputState)?void 0:n.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}},{key:"focus",value:function t(){var n=this;this.observer.ignore(function(){S0(n.contentDOM),n.docView.updateSelection()})}},{key:"setRoot",value:function t(n){this.Nkt!=n&&(this.Nkt=n,this.observer.setWindow((9==n.nodeType?n:n.ownerDocument).defaultView||window),this.mountStyles())}},{key:"destroy",value:function t(){var n,i,e,n=F(this.plugins);try{for(n.s();!(i=n.n()).done;)(e=i.value).destroy(this)}catch(t){n.e(t)}finally{n.f()}this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),-1<this.measureScheduled&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}}],[{key:"scrollIntoView",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return On.of(new Pn("number"==typeof n?O.cursor(n):n,i.y,i.x,i.yMargin,i.xMargin))}},{key:"domEventHandlers",value:function t(n){return u.define(function(){return{}},{eventHandlers:n})}},{key:"theme",value:function t(n,i){var e,e,e=_t.newName(),e=[zi.of(e),Fn.of($d(".".concat(e),n))];return i&&i.dark&&e.push(Wi.of(!0)),e}},{key:"baseTheme",value:function t(n){return st.lowest(Fn.of($d("."+Vi,n,Gi)))}},{key:"findFromDOM",value:function t(n){var n,i,i,i=n.querySelector(".cm-content"),i=i&&l.get(i)||l.get(n);return(null==(n=null==i?void 0:i.rootView)?void 0:n.view)||null}}]),(p=Yd).styleModule=Fn,p.inputHandler=xn,p.focusChangeEffect=Sn,p.perLineTextDirection=Cn,p.exceptionSink=bn,p.updateListener=Mn,p.editable=En,p.mouseSelectionStyle=wn,p.dragMovesSelection=gn,p.clickAddsSelectionRange=kn,p.decorations=Ln,p.atomicRanges=Bn,p.scrollMargins=_n,p.darkTheme=Wi,p.contentAttributes=Tn,p.editorAttributes=In,p.lineWrapping=p.contentAttributes.of({class:"cm-lineWrapping"}),p.announce=v.define(),Yi=4096,te={},D(t1,null,[{key:"update",value:function t(n,i){var e,r,o,u;if(i.empty)return n;for(e=[],r=n.length?n[n.length-1].dir:E.LTR,o=Math.max(0,n.length-10);o<n.length;o++)(u=n[o]).dir!=r||i.touchesRange(u.from,u.to)||e.push(new t1(i.mapPos(u.from,1),i.mapPos(u.to,-1),u.dir,u.order));return e}}]),ne=t1,ie=g.mac?"mac":g.windows?"win":g.linux?"linux":"key",o=st.default(p.domEventHandlers({keydown:function t(n,i){return s1(r1(i.state),n,i,"editor")}})),ee=y.define({enables:o}),re=new WeakMap,oe=null,ue=4e3,D(a1,[{key:"draw",value:function t(){var n=document.createElement("div");return n.className=this.className,this.adjust(n),n}},{key:"update",value:function t(n,i){return i.className==this.className&&(this.adjust(n),!0)}},{key:"adjust",value:function t(n){n.style.left=this.left+"px",n.style.top=this.top+"px",null!=this.width&&(n.style.width=this.width+"px"),n.style.height=this.height+"px"}},{key:"eq",value:function t(n){return this.left==n.left&&this.top==n.top&&this.width==n.width&&this.height==n.height&&this.className==n.className}}],[{key:"forRange",value:function t(n,i,e){var r,o;return e.empty?(r=n.coordsAtPos(e.head,e.assoc||1))?(o=h1(n),[new a1(i,r.left-o.left,r.top-o.top,null,r.bottom-r.top)]):[]:l1(n,i,e)}}]),se=a1,D(d1,[{key:"update",value:function t(n){n.startState.facet(he)!=n.state.facet(he)&&this.setOrder(n.state),(this.layer.update(n,this.dom)||n.geometryChanged)&&n.view.requestMeasure(this.measureReq)}},{key:"setOrder",value:function t(n){for(var i=0,e=n.facet(he);i<e.length&&e[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}},{key:"measure",value:function t(){return this.layer.markers(this.view)}},{key:"draw",value:function t(n){var i,e,r,o,u,s,a,i=this;if(n.length!=this.drawn.length||n.some(function(t,n){return!v1(t,i.drawn[n])})){e=this.dom.firstChild,r=0,o=F(n);try{for(o.s();!(u=o.n()).done;)(s=u.value).update&&e&&s.constructor&&this.drawn[r].constructor&&s.update(e,this.drawn[r])?(e=e.nextSibling,r++):this.dom.insertBefore(s.draw(),e)}catch(t){o.e(t)}finally{o.f()}for(;e;)a=e.nextSibling,e.remove(),e=a;this.drawn=n}}},{key:"destroy",value:function t(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}]),ae=d1,he=y.define(),fe=!g.ios,ce=y.define({combine:function t(n){return Hl(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:function t(n,i){return Math.min(n,i)},drawRangeCursor:function t(n,i){return n||i}})}}),le=y1({above:!0,markers:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,i=n.state,e=i.facet(ce),r=[],o=F(i.selection.ranges);try{for(o.s();!(u=o.n()).done;)if(a=(s=u.value)==i.selection.main,s.empty?!a||fe:e.drawRangeCursor){h=a?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",f=s.empty?s:O.cursor(s.head,s.head>s.anchor?-1:1),c=F(se.forRange(n,h,f));try{for(c.s();!(l=c.n()).done;)v=l.value,r.push(v)}catch(t){c.e(t)}finally{c.f()}}}catch(t){o.e(t)}finally{o.f()}return r},update:function t(n,i){n.transactions.some(function(t){return t.selection})&&(i.style.animationName="cm-blink"==i.style.animationName?"cm-blink2":"cm-blink");var e=p1(n);return e&&k1(n.state,i),n.docChanged||n.selectionSet||e},mount:function t(n,i){k1(i.state,n)},class:"cm-cursorLayer"}),ve=y1({above:!1,markers:function t(n){return n.state.selection.ranges.map(function(t){return t.empty?[]:se.forRange(n,"cm-selectionBackground",t)}).reduce(function(t,n){return t.concat(n)})},update:function t(n,i){return n.docChanged||n.selectionSet||n.viewportChanged||p1(n)},class:"cm-selectionLayer"}),tn={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}},fe&&(tn[".cm-line"].caretColor="transparent !important"),de=st.highest(p.theme(tn)),ye=v.define({map:function t(n,i){return null==n?null:i.mapPos(n)}}),me=w.define({create:function t(){return null},update:function t(n,i){return null!=n&&(n=i.changes.mapPos(n)),i.effects.reduce(function(t,n){return n.is(ye)?n.value:t},n)}}),pe=u.fromClass((D(g1,[{key:"update",value:function t(n){var i,e,e=n.state.field(me);null==e?null!=this.cursor&&(null!=(i=this.cursor)&&i.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(me)!=e||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}},{key:"readPos",value:function t(){var n,n,i,n=this.view.state.field(me),n=null!=n&&this.view.coordsAtPos(n);return n?(i=this.view.scrollDOM.getBoundingClientRect(),{left:n.left-i.left+this.view.scrollDOM.scrollLeft,top:n.top-i.top+this.view.scrollDOM.scrollTop,height:n.bottom-n.top}):null}},{key:"drawCursor",value:function t(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}},{key:"destroy",value:function t(){this.cursor&&this.cursor.remove()}},{key:"setDropPos",value:function t(n){this.view.state.field(me)!=n&&this.view.dispatch({effects:ye.of(n)})}}]),g1),{eventHandlers:{dragover:function t(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave:function t(n){n.target!=this.view.contentDOM&&this.view.contentDOM.contains(n.relatedTarget)||this.setDropPos(null)},dragend:function t(){this.setDropPos(null)},drop:function t(){this.setDropPos(null)}}}),D(x1,[{key:"createDeco",value:function t(i){var e,n,r,o,u,s,a,h,e=this,n=new Ot,r=n.add.bind(n),o=F(M1(i,this.maxLength));try{for(o.s();!(u=o.n()).done;)a=(s=u.value).from,h=s.to,b1(i.state.doc,this.regexp,a,h,function(t,n){e.addMatch(n,i,t,r)})}catch(t){o.e(t)}finally{o.f()}return n.finish()}},{key:"updateDeco",value:function t(r,n){var o=1e9,u=-1;return r.docChanged&&r.changes.iterChanges(function(t,n,i,e){e>r.view.viewport.from&&i<r.view.viewport.to&&(o=Math.min(i,o),u=Math.max(e,u))}),r.viewportChanged||1e3<u-o?this.createDeco(r.view):-1<u?this.updateRange(r.view,n.map(r.changes),o,u):n}},{key:"updateRange",value:function t(c,l,v,d){var y,n,m,i,y=this,n=F(c.visibleRanges);try{for(i=function t(){var n,i,e,r,o,u,s,a,h,f,n=m.value,i=Math.max(n.from,v),e=Math.min(n.to,d);if(i<e){if(o=(r=c.state.doc.lineAt(i)).to<e?c.state.doc.lineAt(e):r,u=Math.max(n.from,r.from),s=Math.min(n.to,o.to),y.boundary){for(;i>r.from;i--)if(y.boundary.test(r.text[i-1-r.from])){u=i;break}for(;e<o.to;e++)if(y.boundary.test(o.text[e-o.from])){s=e;break}}if(a=[],f=function t(n,i,e){return a.push(e.range(n,i))},r==o)for(y.regexp.lastIndex=u-r.from;(h=y.regexp.exec(r.text))&&h.index<s-r.from;)y.addMatch(h,c,h.index+r.from,f);else b1(c.state.doc,y.regexp,u,s,function(t,n){y.addMatch(n,c,t,f)});l=l.update({filterFrom:u,filterTo:s,filter:function t(n,i){return n<u||s<i},add:a})}},n.s();!(m=n.n()).done;)i()}catch(t){n.e(t)}finally{n.f()}return l}}]),ke=x1,ge=null!=/x/.unicode?"gu":"g",we=new RegExp("[\0-\b\n-\x1f\x7f-\x9f\xad\u061c\u200b\u200e\u200f\u2028\u2029\u202d\u202e\u2066\u2067\u2069\ufeff\ufff9-\ufffc]",ge),be={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},Me=null,xe=y.define({combine:function t(n){var n=Hl(n,{render:null,specialChars:we,addSpecialChars:null});return(n.replaceTabs=!S1())&&(n.specialChars=new RegExp("\t|"+n.specialChars.source,ge)),n.addSpecialChars&&(n.specialChars=new RegExp(n.specialChars.source+"|"+n.addSpecialChars.source,ge)),n}}),Se=null,Ce="\u2022",x(O1,Yt),If=S(O1),D(O1,[{key:"eq",value:function t(n){return n.code==this.code}},{key:"toDOM",value:function t(n){var i,n,e,e,i=P1(this.code),n=n.state.phrase("Control character")+" "+(be[this.code]||"0x"+this.code.toString(16)),e=this.options.render&&this.options.render(this.code,n,i);return e||((e=document.createElement("span")).textContent=i,e.title=n,e.setAttribute("aria-label",n),e.className="cm-specialChar",e)}},{key:"ignoreEvent",value:function t(){return!1}}]),je=O1,x(E1,Yt),Lf=S(E1),D(E1,[{key:"eq",value:function t(n){return n.width==this.width}},{key:"toDOM",value:function t(){var n=document.createElement("span");return n.textContent="\t",n.className="cm-tab",n.style.width=this.width+"px",n}},{key:"ignoreEvent",value:function t(){return!1}}]),Pe=E1,Oe=u.fromClass((D(A1,[{key:"update",value:function t(n){var n,n,n=n.view,n=n.viewState.editorHeight-n.defaultLineHeight-n.documentPadding.top-.5;n!=this.height&&(this.height=n,this.attrs={style:"padding-bottom: ".concat(n,"px")})}}]),A1)),Ee=m.line({class:"cm-activeLine"}),Ae=u.fromClass((D(I1,[{key:"update",value:function t(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}},{key:"getDeco",value:function t(n){var i,e,r,o,u,s,i=-1,e=[],r=F(n.state.selection.ranges);try{for(r.s();!(o=r.n()).done;)u=o.value,(s=n.lineBlockAt(u.head)).from>i&&(e.push(Ee.range(s.from)),i=s.from)}catch(t){r.e(t)}finally{r.f()}return m.set(e)}}]),I1),{decorations:function t(n){return n.decorations}}),x(T1,Yt),_f=S(T1),D(T1,[{key:"toDOM",value:function t(){var n=document.createElement("span");return n.className="cm-placeholder",n.style.pointerEvents="none",n.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?n.setAttribute("aria-label","placeholder "+this.content):n.setAttribute("aria-hidden","true"),n}},{key:"coordsAt",value:function t(n){var i,n,i,n,i=n.firstChild?d0(n.firstChild):[];return i.length?(n=window.getComputedStyle(n.parentNode),i=g0(i[0],"rtl"!=n.direction),n=parseInt(n.lineHeight),i.bottom-i.top>1.5*n?{left:i.left,right:i.right,top:i.top,bottom:i.top+n}:i):null}},{key:"ignoreEvent",value:function t(){return!1}}]),De=T1,Re=2e3,Ie={Alt:[18,function(t){return!!t.altKey}],Control:[17,function(t){return!!t.ctrlKey}],Shift:[16,function(t){return!!t.shiftKey}],Meta:[91,function(t){return!!t.metaKey}]},Te={style:"cursor: crosshair"},Le="-10000px",D(z1,[{key:"update",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,e=n.state.facet(this.facet),r=e.filter(function(t){return t});if(e===this.input){o=F(this.tooltipViews);try{for(o.s();!(u=o.n()).done;)(s=u.value).update&&s.update(n)}catch(t){o.e(t)}finally{o.f()}return!1}for(a=[],h=0;h<r.length;h++)if(c=-1,f=r[h]){for(l=0;l<this.tooltips.length;l++)(v=this.tooltips[l])&&v.create==f.create&&(c=l);c<0?a[h]=this.createTooltipView(f):(d=a[h]=this.tooltipViews[c]).update&&d.update(n)}y=F(this.tooltipViews);try{for(y.s();!(m=y.n()).done;)p=m.value,a.indexOf(p)<0&&(p.dom.remove(),null!=(i=p.destroy))&&i.call(p)}catch(t){y.e(t)}finally{y.f()}return this.input=e,this.tooltips=r,this.tooltipViews=a,!0}}]),Be=z1,_e=y.define({combine:function t(n){var i,i,i;return{position:g.ios?"absolute":(null==(i=n.find(function(t){return t.position}))?void 0:i.position)||"fixed",parent:(null==(i=n.find(function(t){return t.parent}))?void 0:i.parent)||null,tooltipSpace:(null==(i=n.find(function(t){return t.tooltipSpace}))?void 0:i.tooltipSpace)||V1}}}),Fe=new WeakMap,Ne=u.fromClass((D($1,[{key:"createContainer",value:function t(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}},{key:"observeIntersection",value:function t(){var n,i,e;if(this.intersectionObserver){this.intersectionObserver.disconnect(),n=F(this.manager.tooltipViews);try{for(n.s();!(i=n.n()).done;)e=i.value,this.intersectionObserver.observe(e.dom)}catch(t){n.e(t)}finally{n.f()}}}},{key:"measureSoon",value:function t(){var n=this;this.measureTimeout<0&&(this.measureTimeout=setTimeout(function(){n.measureTimeout=-1,n.maybeMeasure()},50))}},{key:"update",value:function t(n){var i,i,n,e,r,o,u,s,a;if(n.transactions.length&&(this.lastTransaction=Date.now()),(i=this.manager.update(n))&&this.observeIntersection(),i=i||n.geometryChanged,(n=n.state.facet(_e)).position!=this.position){this.position=n.position,e=F(this.manager.tooltipViews);try{for(e.s();!(r=e.n()).done;)(o=r.value).dom.style.position=this.position}catch(t){e.e(t)}finally{e.f()}i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer(),u=F(this.manager.tooltipViews);try{for(u.s();!(s=u.n()).done;)a=s.value,this.container.appendChild(a.dom)}catch(t){u.e(t)}finally{u.f()}i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}},{key:"createTooltip",value:function t(n){var i,n,i=n.create(this.view);return i.dom.classList.add("cm-tooltip"),n.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")&&((n=document.createElement("div")).className="cm-tooltip-arrow",i.dom.appendChild(n)),i.dom.style.position=this.position,i.dom.style.top=Le,this.container.appendChild(i.dom),i.mount&&i.mount(this.view),i}},{key:"destroy",value:function t(){var n,i,e,r,o;this.view.win.removeEventListener("resize",this.measureSoon),e=F(this.manager.tooltipViews);try{for(e.s();!(r=e.n()).done;)(o=r.value).dom.remove(),null!=(n=o.destroy)&&n.call(o)}catch(t){e.e(t)}finally{e.f()}null!=(i=this.intersectionObserver)&&i.disconnect(),clearTimeout(this.measureTimeout)}},{key:"readMeasure",value:function t(){var i,n,i=this,n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map(function(t,n){var n=i.manager.tooltipViews[n];return n.getCoords?n.getCoords(t.pos):i.view.coordsAtPos(t.pos)}),size:this.manager.tooltipViews.map(function(t){var n;return t.dom.getBoundingClientRect()}),space:this.view.state.facet(_e).tooltipSpace(this.view)}}},{key:"writeMeasure",value:function t(n){for(var i,e,r,o,u,s,a,h,f,c,l,v,d,y,i,m,p,k,s,g,w,b,M,x,e=n.editor,r=n.space,o=[],u=0;u<this.manager.tooltips.length;u++)if(s=this.manager.tooltips[u],h=(a=this.manager.tooltipViews[u]).dom,f=n.pos[u],c=n.size[u],!f||f.bottom<=Math.max(e.top,r.top)||f.top>=Math.min(e.bottom,r.bottom)||f.right<Math.max(e.left,r.left)-.1||f.left>Math.min(e.right,r.right)+.1)h.style.top=Le;else{if(v=(l=s.arrow?a.dom.querySelector(".cm-tooltip-arrow"):null)?7:0,d=c.right-c.left,y=null!=(i=Fe.get(a))?i:c.bottom-c.top,i=a.offset||Ue,m=this.view.textDirection==E.LTR,p=c.width>r.right-r.left?m?r.left:r.right-c.width:m?Math.min(f.left-(l?14:0)+i.x,r.right-d):Math.max(r.left,f.left-d+(l?14:0)-i.x),k=!!s.above,(s=((k=!s.strictSide&&(k?f.top-(c.bottom-c.top)-i.y<r.top:f.bottom+(c.bottom-c.top)+i.y>r.bottom)&&k==r.bottom-f.bottom>f.top-r.top?!k:k)?f.top-r.top:r.bottom-f.bottom)-v)<y&&!1!==a.resize){if(s<this.view.defaultLineHeight){h.style.top=Le;continue}Fe.set(a,y),h.style.height=(y=s)+"px"}else h.style.height&&(h.style.height="");if(g=k?f.top-y-v-i.y:f.bottom+v+i.y,w=p+d,!0!==a.overlap){b=F(o);try{for(b.s();!(M=b.n()).done;)(x=M.value).left<w&&x.right>p&&x.top<g+y&&x.bottom>g&&(g=k?x.top-y-2-v:x.bottom+v+2)}catch(t){b.e(t)}finally{b.f()}}"absolute"==this.position?(h.style.top=g-n.parent.top+"px",h.style.left=p-n.parent.left+"px"):(h.style.top=g+"px",h.style.left=p+"px"),l&&(l.style.left="".concat(f.left+(m?i.x:-i.x)-(p+14-7),"px")),!0!==a.overlap&&o.push({left:p,top:g,right:w,bottom:g+y}),h.classList.toggle("cm-tooltip-above",k),h.classList.toggle("cm-tooltip-below",!k),a.positioned&&a.positioned(n.space)}}},{key:"maybeMeasure",value:function t(){var n,i,e;if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView)&&(this.inView=this.view.inView,!this.inView)){n=F(this.manager.tooltipViews);try{for(n.s();!(i=n.n()).done;)(e=i.value).dom.style.top=Le}catch(t){n.e(t)}finally{n.f()}}}}]),$1),{eventHandlers:{scroll:function t(){this.maybeMeasure()}}}),rn=p.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7,"px"),width:"".concat(14,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7,"px solid transparent"),borderRight:"".concat(7,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7,"px"),"&:before":{borderTop:"".concat(7,"px solid #bbb")},"&:after":{borderTop:"".concat(7,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7,"px"),"&:before":{borderBottom:"".concat(7,"px solid #bbb")},"&:after":{borderBottom:"".concat(7,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ue={x:0,y:0},He=y.define({enables:[Ne,rn]}),ze=y.define(),D(q1,[{key:"createHostedView",value:function t(n){var n=n.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(n.dom),this.mounted&&n.mount&&n.mount(this.view),n}},{key:"mount",value:function t(n){var i,e,r,i=F(this.manager.tooltipViews);try{for(i.s();!(e=i.n()).done;)(r=e.value).mount&&r.mount(n)}catch(t){i.e(t)}finally{i.f()}this.mounted=!0}},{key:"positioned",value:function t(n){var i,e,r,i=F(this.manager.tooltipViews);try{for(i.s();!(e=i.n()).done;)(r=e.value).positioned&&r.positioned(n)}catch(t){i.e(t)}finally{i.f()}}},{key:"update",value:function t(n){this.manager.update(n)}},{key:"destroy",value:function t(){var n,i,e,r,i=F(this.manager.tooltipViews);try{for(i.s();!(e=i.n()).done;)null!=(n=(r=e.value).destroy)&&n.call(r)}catch(t){i.e(t)}finally{i.f()}}}],[{key:"create",value:function t(n){return new q1(n)}}]),We=q1,Ve=He.compute([ze],function(t){var t=t.facet(ze).filter(function(t){return t});return 0===t.length?null:{pos:Math.min.apply(Math,yc(t.map(function(t){return t.pos}))),end:Math.max.apply(Math,yc(t.filter(function(t){return null!=t.end}).map(function(t){return t.end}))),create:We.create,above:t[0].above,arrow:t.some(function(t){return t.arrow})}}),D(G1,[{key:"update",value:function t(){var n=this;this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(function(){return n.startHover()},20))}},{key:"active",get:function t(){return this.view.state.field(this.field)}},{key:"checkHover",value:function t(){var n;this.hoverTimeout=-1,this.active||((n=Date.now()-this.lastMove.time)<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-n):this.startHover())}},{key:"startHover",value:function t(){var n,i,e,r,o,o,i,u,n=this;clearTimeout(this.restartTimeout),i=this.lastMove,null==(e=this.view.contentDOM.contains(i.target)?this.view.posAtCoords(i):null)||null==(r=this.view.coordsAtPos(e))||i.y<r.top||i.y>r.bottom||i.x<r.left-this.view.defaultCharacterWidth||i.x>r.right+this.view.defaultCharacterWidth||(o=(o=this.view.bidiSpans(this.view.state.doc.lineAt(e)).find(function(t){return t.from<=e&&t.to>=e}))&&o.dir==E.RTL?-1:1,null!=(i=this.source(this.view,e,i.x<r.left?-o:o))&&i.then?(u=this.pending={pos:e},i.then(function(t){n.pending==u&&(n.pending=null,t)&&n.view.dispatch({effects:n.setHover.of(t)})},function(t){return vv(n.view.state,t,"hover tooltip")})):i&&this.view.dispatch({effects:this.setHover.of(i)}))}},{key:"mousemove",value:function t(n){var i,i,e,r,i;this.lastMove={x:n.clientX,y:n.clientY,target:n.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime)),((i=this.active)&&!J1(this.lastMove.target)||this.pending)&&((r=(e=i||this.pending).pos)==(i=null!=(i=null==i?void 0:i.end)?i:r)?this.view.posAtCoords(this.lastMove)!=r:!K1(this.view,r,i,n.clientX,n.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}},{key:"mouseleave",value:function t(n){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!J1(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}},{key:"destroy",value:function t(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}]),$e=G1,n=(qe=v.define()).of(null),Ge=y.define({combine:function t(n){var i,e,r,o,u,r=F(n);try{for(r.s();!(o=r.n()).done;)u=o.value,i=i||u.topContainer,e=e||u.bottomContainer}catch(t){r.e(t)}finally{r.f()}return{topContainer:i,bottomContainer:e}}}),Je=u.fromClass((D(iy,[{key:"update",value:function t(n){var i,i,i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,i=n.state.facet(Ge);if(this.top.container!=i.topContainer&&(this.top.sync([]),this.top=new Ke(n.view,!0,i.topContainer)),this.bottom.container!=i.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ke(n.view,!1,i.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses(),(i=n.state.facet(Qe))!=this.input){e=[],r=[],o=[],u=[],s=F(i=i.filter(function(t){return t}));try{for(s.s();!(a=s.n()).done;)h=a.value,f=this.specs.indexOf(h),c=void 0,f<0?(c=h(n.view),u.push(c)):(c=this.panels[f]).update&&c.update(n),e.push(c),(c.top?r:o).push(c)}catch(t){s.e(t)}finally{s.f()}for(this.specs=i,this.panels=e,this.top.sync(r),this.bottom.sync(o),l=0,v=u;l<v.length;l++)(d=v[l]).dom.classList.add("cm-panel"),d.mount&&d.mount()}else{y=F(this.panels);try{for(y.s();!(m=y.n()).done;)(p=m.value).update&&p.update(n)}catch(t){y.e(t)}finally{y.f()}}}},{key:"destroy",value:function t(){this.top.sync([]),this.bottom.sync([])}}]),iy),{provide:function t(n){return p.scrollMargins.of(function(t){var t=t.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})}}),D(ey,[{key:"sync",value:function t(n){var i,e,r,i=F(this.panels);try{for(i.s();!(e=i.n()).done;)(r=e.value).destroy&&n.indexOf(r)<0&&r.destroy()}catch(t){i.e(t)}finally{i.f()}this.panels=n,this.syncDOM()}},{key:"syncDOM",value:function t(){var n,i,e,r,o;if(0==this.panels.length)this.dom&&(this.dom.remove(),this.dom=void 0);else{this.dom||(this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0",(n=this.container||this.view.dom).insertBefore(this.dom,this.top?n.firstChild:null)),i=this.dom.firstChild,e=F(this.panels);try{for(e.s();!(r=e.n()).done;)if((o=r.value).dom.parentNode==this.dom){for(;i!=o.dom;)i=ry(i);i=i.nextSibling}else this.dom.insertBefore(o.dom,i)}catch(t){e.e(t)}finally{e.f()}for(;i;)i=ry(i)}}},{key:"scrollMargin",value:function t(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}},{key:"syncClasses",value:function t(){var n,i,e,r,o,u;if(this.container&&this.classes!=this.view.themeClasses){n=F(this.classes.split(" "));try{for(n.s();!(i=n.n()).done;)(e=i.value)&&this.container.classList.remove(e)}catch(t){n.e(t)}finally{n.f()}r=F((this.classes=this.view.themeClasses).split(" "));try{for(r.s();!(o=r.n()).done;)(u=o.value)&&this.container.classList.add(u)}catch(t){r.e(t)}finally{r.f()}}}}]),Ke=ey,Qe=y.define({enables:Je}),x(oy,t),Nf=S(oy),D(oy,[{key:"compare",value:function t(n){return this==n||this.constructor==n.constructor&&this.eq(n)}},{key:"eq",value:function t(n){return!1}},{key:"destroy",value:function t(n){}}]),(en=oy).prototype.elementClass="",en.prototype.toDOM=void 0,en.prototype.mapMode=f.TrackBefore,en.prototype.startSide=en.prototype.endSide=-1,en.prototype.point=!0,Xe=y.define(),Ze={class:"",renderEmptyElements:!1,elementStyle:"",markers:function t(){return j.empty},lineMarker:function t(){return null},widgetMarker:function t(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Ye=y.define(),tr=y.define({combine:function t(n){return n.some(function(t){return t})}}),nr=u.fromClass((D(ay,[{key:"update",value:function t(n){var i,e,i;this.updateGutters(n)&&(i=this.prevViewport,e=n.view.viewport,i=Math.min(i.to,e.to)-Math.max(i.from,e.from),this.syncGutters(i<.8*(e.to-e.from))),n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(tr)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}},{key:"syncGutters",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,i=this,e=this.dom.nextSibling;n&&this.dom.remove(),r=j.iter(this.view.state.facet(Xe),this.view.viewport.from),o=[],u=this.gutters.map(function(t){return new ir(t,i.view.viewport,-i.view.documentPadding.top)}),s=F(this.view.viewportLineBlocks);try{for(s.s();!(a=s.n()).done;)if(h=a.value,o.length&&(o=[]),Array.isArray(h.type)){f=!0,c=F(h.type);try{for(c.s();!(l=c.n()).done;)if((v=l.value).type==P.Text&&f){fy(r,o,v.from),d=F(u);try{for(d.s();!(y=d.n()).done;)(m=y.value).line(this.view,v,o)}catch(t){d.e(t)}finally{d.f()}f=!1}else if(v.widget){p=F(u);try{for(p.s();!(k=p.n()).done;)(g=k.value).widget(this.view,v)}catch(t){p.e(t)}finally{p.f()}}}catch(t){c.e(t)}finally{c.f()}}else if(h.type==P.Text){fy(r,o,h.from),w=F(u);try{for(w.s();!(b=w.n()).done;)(M=b.value).line(this.view,h,o)}catch(t){w.e(t)}finally{w.f()}}}catch(t){s.e(t)}finally{s.f()}x=F(u);try{for(x.s();!(S=x.n()).done;)(C=S.value).finish()}catch(t){x.e(t)}finally{x.f()}n&&this.view.scrollDOM.insertBefore(this.dom,e)}},{key:"updateGutters",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,i=n.startState.facet(Ye),e=n.state.facet(Ye),r=n.docChanged||n.heightChanged||n.viewportChanged||!j.eq(n.startState.facet(Xe),n.state.facet(Xe),n.view.viewport.from,n.view.viewport.to);if(i==e){o=F(this.gutters);try{for(o.s();!(u=o.n()).done;)(s=u.value).update(n)&&(r=!0)}catch(t){o.e(t)}finally{o.f()}}else{r=!0,a=[],h=F(e);try{for(h.s();!(f=h.n()).done;)c=f.value,(l=i.indexOf(c))<0?a.push(new er(this.view,c)):(this.gutters[l].update(n),a.push(this.gutters[l]))}catch(t){h.e(t)}finally{h.f()}v=F(this.gutters);try{for(v.s();!(d=v.n()).done;)(y=d.value).dom.remove(),a.indexOf(y)<0&&y.destroy()}catch(t){v.e(t)}finally{v.f()}for(m=0,p=a;m<p.length;m++)this.dom.appendChild((k=p[m]).dom);this.gutters=a}return r}},{key:"destroy",value:function t(){var n,i,e,n=F(this.gutters);try{for(n.s();!(i=n.n()).done;)(e=i.value).destroy()}catch(t){n.e(t)}finally{n.f()}this.dom.remove()}}]),ay),{provide:function t(i){return p.scrollMargins.of(function(t){var n=t.plugin(i);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==E.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null})}}),D(cy,[{key:"addElement",value:function t(n,i,e){var r,o,u,r=this.gutter,o=i.top-this.height;this.i==r.elements.length?(u=new rr(n,i.height,o,e),r.elements.push(u),r.dom.appendChild(u.dom)):r.elements[this.i].update(n,i.height,o,e),this.height=i.bottom,this.i++}},{key:"line",value:function t(n,i,e){var r,e,e,r=[];fy(this.cursor,r,i.from),e.length&&(r=r.concat(e)),(e=this.gutter.config.lineMarker(n,i,r))&&r.unshift(e),e=this.gutter,0==r.length&&!e.config.renderEmptyElements||this.addElement(n,i,r)}},{key:"widget",value:function t(n,i){var e=this.gutter.config.widgetMarker(n,i.widget,i);e&&this.addElement(n,i,[e])}},{key:"finish",value:function t(){for(var n,i,n=this.gutter;n.elements.length>this.i;)i=n.elements.pop(),n.dom.removeChild(i.dom),i.destroy()}}]),ir=cy,D(ly,[{key:"update",value:function t(n){var i,e,e,i=this.markers;return this.markers=hy(this.config.markers(n.view)),this.spacer&&this.config.updateSpacer&&(e=this.config.updateSpacer(this.spacer.markers[0],n))!=this.spacer.markers[0]&&this.spacer.update(n.view,0,0,[e]),e=n.view.viewport,!j.eq(this.markers,i,e.from,e.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(n)}},{key:"destroy",value:function t(){var n,i,e,n=F(this.elements);try{for(n.s();!(i=n.n()).done;)(e=i.value).destroy()}catch(t){n.e(t)}finally{n.f()}}}]),er=ly,D(vy,[{key:"update",value:function t(n,i,e,r){this.height!=i&&(this.dom.style.height=(this.height=i)+"px"),this.above!=e&&(this.dom.style.marginTop=(this.above=e)?e+"px":""),dy(this.markers,r)||this.setMarkers(n,r)}},{key:"setMarkers",value:function t(n,i){for(var e,r,o,u,s,a,h,f,c,l,l,e="cm-gutterElement",r=this.dom.firstChild,o=0,u=0;;){if(s=u,h=!1,a=o<i.length?i[o++]:null){for((f=a.elementClass)&&(e+=" "+f),c=u;c<this.markers.length;c++)if(this.markers[c].compare(a)){s=c,h=!0;break}}else s=this.markers.length;for(;u<s;)(l=this.markers[u++]).toDOM&&(l.destroy(r),l=r.nextSibling,r.remove(),r=l);if(!a)break;a.toDOM&&(h?r=r.nextSibling:this.dom.insertBefore(a.toDOM(n),r)),h&&u++}this.dom.className=e,this.markers=i}},{key:"destroy",value:function t(){this.setMarkers(null,[])}}]),rr=vy,or=y.define(),ur=y.define({combine:function t(n){return Hl(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function t(n,i){var o,e,u,o=Object.assign({},n),e=function t(){var e=o[u],r=i[u];o[u]=e?function(t,n,i){return e(t,n,i)||r(t,n,i)}:r};for(u in i)e();return o}})}}),x(yy,en),Hf=S(yy),D(yy,[{key:"eq",value:function t(n){return this.number==n.number}},{key:"toDOM",value:function t(){return document.createTextNode(this.number)}}]),sr=yy,ar=Ye.compute([ur],function(t){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function t(n){return n.state.facet(or)},lineMarker:function t(n,i,e){return e.some(function(t){return t.toDOM})?null:new sr(my(n,n.state.doc.lineAt(i.from).number))},widgetMarker:function t(){return null},lineMarkerChange:function t(n){return n.startState.facet(ur)!=n.state.facet(ur)},initialSpacer:function t(n){return new sr(my(n,ky(n.state.doc.lines)))},updateSpacer:function t(n,i){var i=my(i.view,ky(i.view.state.doc.lines));return i==n.number?n:new sr(i)},domEventHandlers:t.facet(ur).domEventHandlers}}),x(gy,en),Wf=S(gy),hr=new(D(gy)),fr=Xe.compute(["selection"],function(t){var n,i,e,r,o,u,n=[],i=-1,e=F(t.selection.ranges);try{for(e.s();!(r=e.n()).done;)o=r.value,i<(u=t.doc.lineAt(o.head).from)&&(i=u,n.push(hr.range(u)))}catch(t){e.e(t)}finally{e.f()}return j.of(n)}),cr=new Map,lr=My(new ke({regexp:/\t| +/g,decoration:function t(n){return by(n[0])},boundary:/\S/})),vr=My(new ke({regexp:/\s+$/g,decoration:m.mark({class:"cm-trailingSpace"}),boundary:/\S/})),nn={HeightMap:Oi,HeightOracle:Si,MeasuredHeights:Ci,QueryType:d,ChangedRange:Nn,computeOrder:Mv,moveVisually:Sv},dr=L.View=Object.freeze({__proto__:null,BidiSpan:Zn,BlockInfo:ji,get BlockType(){return P},Decoration:m,get Direction(){return E},EditorView:p,GutterMarker:en,MatchDecorator:ke,RectangleMarker:se,ViewPlugin:u,ViewUpdate:Un,WidgetType:Yt,qde:nn,closeHoverTooltips:n,crosshairCursor:H1,drawSelection:m1,dropCursor:w1,getPanel:ny,getTooltip:X1,gutter:uy,gutterLineClass:Xe,gutters:sy,hasHoverTooltips:Z1,highlightActiveLine:R1,highlightActiveLineGutter:wy,highlightSpecialChars:C1,highlightTrailingWhitespace:Sy,highlightWhitespace:xy,hoverTooltip:Q1,keymap:ee,layer:y1,lineNumberMarkers:or,lineNumbers:py,logException:vv,panels:ty,placeholder:L1,rectangularSelection:U1,repositionTooltips:Y1,runScopeHandlers:o1,scrollPastEnd:D1,showPanel:Qe,showTooltip:He,tooltips:W1}),yr=1024,mr=0,pr=D(function t(n,i){A(this,t),this.from=n,this.to=i}),D(Cy,[{key:"add",value:function t(n){var i=this;if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof n&&(n=gr.match(n)),function(t){var t=n(t);return void 0===t?null:[i,t]}}}]),(M=Cy).closedBy=new M({deserialize:function t(n){return n.split(" ")}}),M.openedBy=new M({deserialize:function t(n){return n.split(" ")}}),M.group=new M({deserialize:function t(n){return n.split(" ")}}),M.contextHash=new M({perNode:!0}),M.lookAhead=new M({perNode:!0}),M.mounted=new M({perNode:!0}),kr=Object.create(null),D(jy,[{key:"prop",value:function t(n){return this.props[n.id]}},{key:"isTop",get:function t(){return 0<(1&this.flags)}},{key:"isSkipped",get:function t(){return 0<(2&this.flags)}},{key:"isError",get:function t(){return 0<(4&this.flags)}},{key:"isAnonymous",get:function t(){return 0<(8&this.flags)}},{key:"is",value:function t(n){var i;return"string"==typeof n?this.name==n||!!(i=this.prop(M.group))&&-1<i.indexOf(n):this.id==n}}],[{key:"define",value:function t(n){var i,e,r,o,u,s,i=n.props&&n.props.length?Object.create(null):kr,e=(n.top?1:0)|(n.skipped?2:0)|(n.error?4:0)|(null==n.name?8:0),r=new jy(n.name||"",i,n.id,e);if(n.props){o=F(n.props);try{for(o.s();!(u=o.n()).done;)if(s=u.value,s=Array.isArray(s)?s:s(r)){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");i[s[0].id]=s[1]}}catch(t){o.e(t)}finally{o.f()}}return r}},{key:"match",value:function t(n){var r,i,e,o,u,r=Object.create(null);for(i in n){e=F(i.split(" "));try{for(e.s();!(o=e.n()).done;)u=o.value,r[u]=n[i]}catch(t){e.e(t)}finally{e.f()}}return function(t){for(var n,i,e,n=t.prop(M.group),i=-1;i<(n?n.length:0);i++)if(e=r[i<0?t.name:n[i]])return e}}}]),(gr=jy).none=new gr("",Object.create(null),0,8),D(Py,[{key:"extend",value:function t(){for(var n,i,e,r,o,u,s,a,h,f,c,l,n=[],i=arguments.length,e=new Array(i),r=0;r<i;r++)e[r]=arguments[r];o=F(this.types);try{for(o.s();!(u=o.n()).done;){s=u.value,a=null,h=F(e);try{for(h.s();!(f=h.n()).done;)(l=(c=f.value)(s))&&((a=a||Object.assign({},s.props))[l[0].id]=l[1])}catch(t){h.e(t)}finally{h.f()}n.push(a?new gr(s.name,a,s.id,s.flags):s)}}catch(t){o.e(t)}finally{o.f()}return new Py(n)}}]),zt=Py,wr=new WeakMap,br=new WeakMap,(e=Mr=Mr||{})[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays",D(Oy,[{key:"toString",value:function t(){var n,i,e,r,o,u,n=this.prop(M.mounted);if(n&&!n.overlay)return n.tree.toString();i="",e=F(this.children);try{for(e.s();!(r=e.n()).done;)(u=(o=r.value).toString())&&(i&&(i+=","),i+=u)}catch(t){e.e(t)}finally{e.f()}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(i.length?"("+i+")":""):i}},{key:"cursor",value:function t(){var n;return new Or(this.topNode,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}},{key:"cursorAt",value:function t(n){var i,e,r,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=wr.get(this)||this.topNode,r=new Or(r);return r.moveTo(n,i),wr.set(this,r.oMi),r}},{key:"topNode",get:function t(){return new Cr(this,0,0,null)}},{key:"resolve",value:function t(n){var i,n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=Iy(wr.get(this)||this.topNode,n,i,!1);return wr.set(this,n),n}},{key:"resolveInner",value:function t(n){var i,n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=Iy(br.get(this)||this.topNode,n,i,!0);return br.set(this,n),n}},{key:"iterate",value:function t(n){for(var i,e,r,o,r,u,r,s,a,h,i=n.enter,e=n.leave,r=n.from,o=void 0===r?0:r,r=n.to,u=void 0===r?this.length:r,r=n.mode||0,s=0<(r&Mr.IncludeAnonymous),a=this.cursor(r|Mr.IncludeAnonymous);;){if(h=!1,a.from<=u&&a.to>=o&&(!s&&a.type.isAnonymous||!1!==i(a))){if(a.firstChild())continue;h=!0}for(;h&&e&&(s||!a.type.isAnonymous)&&e(a),!a.nextSibling();){if(!a.parent())return;h=!0}}}},{key:"prop",value:function t(n){return n.perNode?this.props?this.props[n.id]:void 0:this.type.prop(n)}},{key:"propValues",get:function t(){var n,i,n=[];if(this.props)for(i in this.props)n.push([+i,this.props[i]]);return n}},{key:"balance",value:function t(){var e,n,e=this,n;return this.children.length<=8?this:zy(gr.none,this.children,this.positions,0,this.children.length,0,this.length,function(t,n,i){return new Oy(e.type,t,n,i,e.propValues)},(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).makeTree||function(t,n,i){return new Oy(gr.none,t,n,i)})}}],[{key:"build",value:Uy}]),(b=Oy).empty=new b(gr.none,[],[],0),D(Ey,[{key:"id",get:function t(){return this.buffer[this.index-4]}},{key:"start",get:function t(){return this.buffer[this.index-3]}},{key:"end",get:function t(){return this.buffer[this.index-2]}},{key:"size",get:function t(){return this.buffer[this.index-1]}},{key:"pos",get:function t(){return this.index}},{key:"next",value:function t(){this.index-=4}},{key:"fork",value:function t(){return new Ey(this.buffer,this.index)}}]),xr=Ey,D(Ay,[{key:"type",get:function t(){return gr.none}},{key:"toString",value:function t(){for(var n,i,n=[],i=0;i<this.buffer.length;)n.push(this.childString(i)),i=this.buffer[i+3];return n.join(",")}},{key:"childString",value:function t(n){var i,e,i,r,o,i=this.buffer[n],e=this.buffer[n+3],i=this.set.types[i],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),e==(n+=4))return r;for(o=[];n<e;)o.push(this.childString(n)),n=this.buffer[n+3];return r+"("+o.join(",")+")"}},{key:"findChild",value:function t(n,i,e,r,o){for(var u,s,a,u=this.buffer,s=-1,a=n;a!=i&&!(Dy(o,r,u[a+1],u[a+2])&&(s=a,0<e));a=u[a+3]);return s}},{key:"slice",value:function t(n,i,e){for(var r,o,u,s,a,h,r=this.buffer,o=new Uint16Array(i-n),u=0,s=n,a=0;s<i;)o[a++]=r[s++],o[a++]=r[s++]-e,h=o[a++]=r[s++]-e,o[a++]=r[s++]-n,u=Math.max(u,h);return new Ay(o,u,this.set)}}]),Sr=Ay,D(Ty,[{key:"type",get:function t(){return this.oMi.type}},{key:"name",get:function t(){return this.oMi.type.name}},{key:"to",get:function t(){return this.from+this.oMi.length}},{key:"nextChild",value:function t(n,i,e,r){for(var o,u,s,a,h,f,c,l,v,v,d,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,u=this;;){for(a=(s=u.oMi).children,h=s.positions,f=0<i?a.length:-1;n!=f;n+=i)if(c=a[n],Dy(r,e,l=h[n]+u.from,l+c.length))if(c instanceof Sr){if(!(o&Mr.ExcludeBuffers)&&-1<(v=c.findChild(0,c.buffer.length,i,e-l,r)))return new Pr(new jr(u,c,n,l),null,v)}else if(o&Mr.IncludeAnonymous||!c.type.isAnonymous||Ny(c))return v=void 0,o&Mr.IgnoreMounts||!c.props||!(v=c.prop(M.mounted))||v.overlay?(d=new Ty(c,l,n,u),o&Mr.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(i<0?c.children.length-1:0,i,e,r)):new Ty(v.tree,l,n,u);if(o&Mr.IncludeAnonymous||!u.type.isAnonymous)return null;if(n=0<=u.index?u.index+i:i<0?-1:u.sft.oMi.children.length,!(u=u.sft))return null}}},{key:"firstChild",get:function t(){return this.nextChild(0,1,0,4)}},{key:"lastChild",get:function t(){return this.nextChild(this.oMi.children.length-1,-1,0,4)}},{key:"childAfter",value:function t(n){return this.nextChild(0,1,n,2)}},{key:"childBefore",value:function t(n){return this.nextChild(this.oMi.children.length-1,-1,n,-2)}},{key:"enter",value:function t(n,i){var e,r,o,u,s,a,h,f,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(e&Mr.IgnoreOverlays)&&(r=this.oMi.prop(M.mounted))&&r.overlay){o=n-this.from,u=F(r.overlay);try{for(u.s();!(s=u.n()).done;)if(h=(a=s.value).from,f=a.to,(0<i?h<=o:h<o)&&(i<0?o<=f:o<f))return new Ty(r.tree,r.overlay[0].from+this.from,-1,this)}catch(t){u.e(t)}finally{u.f()}}return this.nextChild(0,1,n,i,e)}},{key:"nextSignificantParent",value:function t(){for(var n=this;n.type.isAnonymous&&n.sft;)n=n.sft;return n}},{key:"parent",get:function t(){return this.sft?this.sft.nextSignificantParent():null}},{key:"nextSibling",get:function t(){return this.sft&&0<=this.index?this.sft.nextChild(this.index+1,1,0,4):null}},{key:"prevSibling",get:function t(){return this.sft&&0<=this.index?this.sft.nextChild(this.index-1,-1,0,4):null}},{key:"cursor",value:function t(){var n;return new Or(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}},{key:"tree",get:function t(){return this.oMi}},{key:"toTree",value:function t(){return this.oMi}},{key:"resolve",value:function t(n){var i;return Iy(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,!1)}},{key:"resolveInner",value:function t(n){var i;return Iy(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,!0)}},{key:"enterUnfinishedNodesBefore",value:function t(n){return Ry(this,n)}},{key:"getChild",value:function t(n){var i,e,n,i,e,n=Ly(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);return n.length?n[0]:null}},{key:"getChildren",value:function t(n){var i,e,i,e;return Ly(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)}},{key:"toString",value:function t(){return this.oMi.toString()}},{key:"node",get:function t(){return this}},{key:"matchContext",value:function t(n){return By(this,n)}}]),Cr=Ty,jr=D(function t(n,i,e,r){A(this,t),this.parent=n,this.buffer=i,this.index=e,this.start=r}),D(_y,[{key:"name",get:function t(){return this.type.name}},{key:"from",get:function t(){return this.context.start+this.context.buffer.buffer[this.index+1]}},{key:"to",get:function t(){return this.context.start+this.context.buffer.buffer[this.index+2]}},{key:"child",value:function t(n,i,e){var r,r,r=this.context.buffer,r=r.findChild(this.index+4,r.buffer[this.index+3],n,i-this.context.start,e);return r<0?null:new _y(this.context,this,r)}},{key:"firstChild",get:function t(){return this.child(1,0,4)}},{key:"lastChild",get:function t(){return this.child(-1,0,4)}},{key:"childAfter",value:function t(n){return this.child(1,n,2)}},{key:"childBefore",value:function t(n){return this.child(-1,n,-2)}},{key:"enter",value:function t(n,i){var e,r,r,e;return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:0)&Mr.ExcludeBuffers||(r=(r=this.context.buffer).findChild(this.index+4,r.buffer[this.index+3],0<i?1:-1,n-this.context.start,i))<0?null:new _y(this.context,this,r)}},{key:"parent",get:function t(){return this.sft||this.context.parent.nextSignificantParent()}},{key:"externalSibling",value:function t(n){return this.sft?null:this.context.parent.nextChild(this.context.index+n,n,0,4)}},{key:"nextSibling",get:function t(){var n,i,n=this.context.buffer,i=n.buffer[this.index+3];return i<(this.sft?n.buffer[this.sft.index+3]:n.buffer.length)?new _y(this.context,this.sft,i):this.externalSibling(1)}},{key:"prevSibling",get:function t(){var n,i,n=this.context.buffer,i=this.sft?this.sft.index+4:0;return this.index==i?this.externalSibling(-1):new _y(this.context,this.sft,n.findChild(i,this.index,-1,0,4))}},{key:"cursor",value:function t(){var n;return new Or(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}},{key:"tree",get:function t(){return null}},{key:"toTree",value:function t(){var n,i,e,r,o,u,n=[],i=[],e=this.context.buffer,r=this.index+4,o=e.buffer[this.index+3];return r<o&&(u=e.buffer[this.index+1],n.push(e.slice(r,o,u)),i.push(0)),new b(this.type,n,i,this.to-this.from)}},{key:"resolve",value:function t(n){var i;return Iy(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,!1)}},{key:"resolveInner",value:function t(n){var i;return Iy(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,!0)}},{key:"enterUnfinishedNodesBefore",value:function t(n){return Ry(this,n)}},{key:"toString",value:function t(){return this.context.buffer.childString(this.index)}},{key:"getChild",value:function t(n){var i,e,n,i,e,n=Ly(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);return n.length?n[0]:null}},{key:"getChildren",value:function t(n){var i,e,i,e;return Ly(this,n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)}},{key:"node",get:function t(){return this}},{key:"matchContext",value:function t(n){return By(this,n)}}]),Pr=_y,D(Fy,[{key:"name",get:function t(){return this.type.name}},{key:"yieldNode",value:function t(n){return!!n&&(this.oMi=n,this.type=n.type,this.from=n.from,this.to=n.to,!0)}},{key:"yieldBuf",value:function t(n,i){this.index=n;var e=this.buffer,r=e.start,e=e.buffer;return this.type=i||e.set.types[e.buffer[n]],this.from=r+e.buffer[n+1],this.to=r+e.buffer[n+2],!0}},{key:"yield",value:function t(n){return!!n&&(n instanceof Cr?(this.buffer=null,this.yieldNode(n)):(this.buffer=n.context,this.yieldBuf(n.index,n.type)))}},{key:"toString",value:function t(){return this.buffer?this.buffer.buffer.childString(this.index):this.oMi.toString()}},{key:"enterChild",value:function t(n,i,e){var r,r;return this.buffer?!((r=(r=this.buffer.buffer).findChild(this.index+4,r.buffer[this.index+3],n,i-this.buffer.start,e))<0)&&(this.stack.push(this.index),this.yieldBuf(r)):this.yield(this.oMi.nextChild(n<0?this.oMi.oMi.children.length-1:0,n,i,e,this.mode))}},{key:"firstChild",value:function t(){return this.enterChild(1,0,4)}},{key:"lastChild",value:function t(){return this.enterChild(-1,0,4)}},{key:"childAfter",value:function t(n){return this.enterChild(1,n,2)}},{key:"childBefore",value:function t(n){return this.enterChild(-1,n,-2)}},{key:"enter",value:function t(n,i){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.mode;return this.buffer?!(e&Mr.ExcludeBuffers)&&this.enterChild(1,n,i):this.yield(this.oMi.enter(n,i,e))}},{key:"parent",value:function t(){var t;return this.buffer?this.stack.length?this.yieldBuf(this.stack.pop()):(t=this.mode&Mr.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent(),this.buffer=null,this.yieldNode(t)):this.yieldNode(this.mode&Mr.IncludeAnonymous?this.oMi.sft:this.oMi.parent)}},{key:"sibling",value:function t(n){var i,e,r,r;if(!this.buffer)return!!this.oMi.sft&&this.yield(this.oMi.index<0?null:this.oMi.sft.nextChild(this.oMi.index+n,n,0,4,this.mode));if(i=this.buffer.buffer,e=this.stack.length-1,n<0){if(r=e<0?0:this.stack[e]+4,this.index!=r)return this.yieldBuf(i.findChild(r,this.index,-1,0,4))}else if((r=i.buffer[this.index+3])<(e<0?i.buffer.length:i.buffer[this.stack[e]+3]))return this.yieldBuf(r);return e<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+n,n,0,4,this.mode))}},{key:"nextSibling",value:function t(){return this.sibling(1)}},{key:"prevSibling",value:function t(){return this.sibling(-1)}},{key:"atLastNode",value:function t(n){var i,e,r,o,u,s,a,h,f,r=this.buffer;if(r){if(0<n){if(this.index<r.buffer.buffer.length)return!1}else for(o=0;o<this.index;o++)if(r.buffer.buffer[o+3]<this.index)return!1;i=r.index,e=r.parent}else i=(u=this.oMi).index,e=u.sft;for(;e;i=(s=e).index,e=s.sft)if(-1<i)for(a=i+n,h=n<0?-1:e.oMi.children.length;a!=h;a+=n)if(f=e.oMi.children[a],this.mode&Mr.IncludeAnonymous||f instanceof Sr||!f.type.isAnonymous||Ny(f))return!1;return!0}},{key:"move",value:function t(n,i){if(i&&this.enterChild(n,0,4))return!0;for(;;){if(this.sibling(n))return!0;if(this.atLastNode(n)||!this.parent())return!1}}},{key:"next",value:function t(){var n;return this.move(1,!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}},{key:"prev",value:function t(){var n;return this.move(-1,!(0<arguments.length&&void 0!==arguments[0])||arguments[0])}},{key:"moveTo",value:function t(n){for(var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;(this.from==this.to||(i<1?this.from>=n:this.from>n)||(-1<i?this.to<=n:this.to<n))&&this.parent(););for(;this.enterChild(1,n,i););return this}},{key:"node",get:function t(){var n,i,e,r,o,u,s;if(!this.buffer)return this.oMi;if(i=null,e=0,(n=this.bufferNode)&&n.context==this.buffer)t:for(r=this.index,o=this.stack.length;0<=o;){for(u=n;u;u=u.sft)if(u.index==r){if(r==this.index)return u;i=u,e=o+1;break t}r=this.stack[--o]}for(s=e;s<this.stack.length;s++)i=new Pr(this.buffer,i,this.stack[s]);return this.bufferNode=new Pr(this.buffer,i,this.index)}},{key:"tree",get:function t(){return this.buffer?null:this.oMi.oMi}},{key:"iterate",value:function t(n,i){for(var e,r,e=0;;){if(r=!1,this.type.isAnonymous||!1!==n(this)){if(this.firstChild()){e++;continue}this.type.isAnonymous||(r=!0)}for(;r&&i&&i(this),r=this.type.isAnonymous,!this.nextSibling();){if(!e)return;this.parent(),e--,r=!0}}}},{key:"matchContext",value:function t(n){var i,e,r,o,u;if(!this.buffer)return By(this.node,n);for(e=(i=this.buffer.buffer).set.types,r=n.length-1,o=this.stack.length-1;0<=r;o--){if(o<0)return By(this.node,n,r);if(!(u=e[i.buffer[this.stack[o]]]).isAnonymous){if(n[r]&&n[r]!=u.name)return!1;r--}}return!0}}]),Or=Fy,Er=new WeakMap,D(Wy,[{key:"openStart",get:function t(){return 0<(1&this.open)}},{key:"openEnd",get:function t(){return 0<(2&this.open)}}],[{key:"addTree",value:function t(n){var i,e,r,o,u,s,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e,r=[new Wy(0,n.length,n,0,!1,2<arguments.length&&void 0!==arguments[2]&&arguments[2])],o=F(i);try{for(o.s();!(u=o.n()).done;)(s=u.value).to>n.length&&r.push(s)}catch(t){o.e(t)}finally{o.f()}return r}},{key:"applyChanges",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,v,d,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:128;if(!i.length)return n;for(r=[],o=1,u=n.length?n[0]:null,h=a=s=0;;s++){if(e<=(c=(f=s<i.length?i[s]:null)?f.fromA:1e9)-a)for(;u&&u.from<c&&((a>=(l=u).from||c<=l.to||h)&&(v=Math.max(l.from,a)-h,l=(d=Math.min(l.to,c)-h)<=v?null:new Wy(v,d,l.tree,l.offset+h,0<s,!!f)),l&&r.push(l),!(u.to>c));)u=o<n.length?n[o++]:null;if(!f)break;a=f.toA,h=f.toA-f.toB}return r}}]),Ar=Wy,D(Vy,[{key:"startParse",value:function t(n,i,e){return"string"==typeof n&&(n=new Rr(n)),e=e?e.length?e.map(function(t){return new pr(t.from,t.to)}):[new pr(0,0)]:[new pr(0,n.length)],this.createParse(n,i||[],e)}},{key:"parse",value:function t(n,i,e){var t,r;for(t=this.startParse(n,i,e);;)if(r=t.advance())return r}}]),Dr=Vy,D($y,[{key:"length",get:function t(){return this.string.length}},{key:"chunk",value:function t(n){return this.string.slice(n)}},{key:"lineChunks",get:function t(){return!1}},{key:"read",value:function t(n,i){return this.string.slice(n,i)}}]),Rr=$y,new M({perNode:!0}),Ir=0,D(qy,null,[{key:"define",value:function t(n){var i,e,r,o;if(null!=n&&n.base)throw new Error("Can not derive from a modified tag");if((i=new qy([],null,[])).set.push(i),n){e=F(n.set);try{for(e.s();!(r=e.n()).done;)o=r.value,i.set.push(o)}catch(t){e.e(t)}finally{e.f()}}return i}},{key:"defineModifier",value:function t(){var n=new Br;return function(t){return-1<t.modified.indexOf(n)?t:Br.get(t.base||t,t.modified.concat(n).sort(function(t,n){return t.id-n.id}))}}}]),Tr=qy,Lr=0,D(Gy,null,[{key:"get",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,v,d,y;if(!i.length)return n;if(e=i[0].instances.find(function(t){return t.base==n&&Jy(i,t.modified)}))return e;o=new Tr(r=[],n,i),u=F(i);try{for(u.s();!(s=u.n()).done;)(a=s.value).instances.push(o)}catch(t){u.e(t)}finally{u.f()}h=Ky(i),f=F(n.set);try{for(f.s();!(c=f.n()).done;)if(!(l=c.value).modified.length){v=F(h);try{for(v.s();!(d=v.n()).done;)y=d.value,r.push(Gy.get(l,y))}catch(t){v.e(t)}finally{v.f()}}}catch(t){f.e(t)}finally{f.f()}return o}}]),Br=Gy,_r=new M,D(Xy,[{key:"opaque",get:function t(){return 0==this.mode}},{key:"inherit",get:function t(){return 1==this.mode}},{key:"sort",value:function t(n){return!n||n.depth<this.depth?(this.next=n,this):(n.next=this.sort(n.next),n)}},{key:"depth",get:function t(){return this.context?this.context.length:0}}]),(Fr=Xy).empty=new Fr([],2,null),D(nm,[{key:"startSpan",value:function t(n,i){i!=this.class&&(this.flush(n),n>this.at&&(this.at=n),this.class=i)}},{key:"flush",value:function t(n){n>this.at&&this.class&&this.span(this.at,n,this.class)}},{key:"highlightRange",value:function t(n,i,e,r,o){var u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,u=n.type,s=n.from,a=n.to;if(!(e<=s||a<=i||(h=r,(c=Yy(o=u.isTop?this.highlighters.filter(function(t){return!t.scope||t.scope(u)}):o,(f=im(n)||Fr.empty).tags))&&(h&&(h+=" "),h+=c,1==f.mode)&&(r+=(r?" ":"")+c),this.startSpan(Math.max(i,s),h),f.opaque)))if((l=n.tree&&n.tree.prop(M.mounted))&&l.overlay){for(v=n.node.enter(l.overlay[0].from+s,1),d=this.highlighters.filter(function(t){return!t.scope||t.scope(l.tree.type)}),y=n.firstChild(),m=0,p=s;;m++){if(g=(k=m<l.overlay.length?l.overlay[m]:null)?k.from+s:a,(w=Math.max(i,p))<(b=Math.min(e,g))&&y)for(;n.from<b&&(this.highlightRange(n,w,b,r,o),this.startSpan(Math.min(b,n.to),h),!(n.to>=g))&&n.nextSibling(););if(!k||e<g)break;i<(p=k.to+s)&&(this.highlightRange(v.cursor(),Math.max(i,k.from+s),Math.min(e,p),"",d),this.startSpan(Math.min(e,p),h))}y&&n.parent()}else if(n.firstChild()){l&&(r="");do{if(!(n.to<=i)){if(n.from>=e)break;this.highlightRange(n,i,e,r,o),this.startSpan(Math.min(e,n.to),h)}}while(n.nextSibling());n.parent()}}}]),Nr=nm,i=(r=Tr.define)(),o=r(),tn=r(o),rn=r(o),nn=r(),n=r(nn),e=r(nn),a=r(),Ur=r(a),Hr=r(),zr=r(),Wr=r(),Vr=r(Wr),$r=r(),Zy([{tag:(h={comment:i,lineComment:r(i),blockComment:r(i),docComment:r(i),name:o,variableName:r(o),typeName:tn,tagName:r(tn),propertyName:rn,attributeName:r(rn),className:r(o),labelName:r(o),namespace:r(o),macroName:r(o),literal:nn,string:n,docString:r(n),character:r(n),attributeValue:r(n),number:e,integer:r(e),float:r(e),bool:r(nn),regexp:r(nn),escape:r(nn),color:r(nn),url:r(nn),keyword:Hr,self:r(Hr),null:r(Hr),atom:r(Hr),unit:r(Hr),modifier:r(Hr),operatorKeyword:r(Hr),controlKeyword:r(Hr),definitionKeyword:r(Hr),moduleKeyword:r(Hr),operator:zr,derefOperator:r(zr),arithmeticOperator:r(zr),logicOperator:r(zr),bitwiseOperator:r(zr),compareOperator:r(zr),updateOperator:r(zr),definitionOperator:r(zr),typeOperator:r(zr),controlOperator:r(zr),punctuation:Wr,separator:r(Wr),bracket:Vr,angleBracket:r(Vr),squareBracket:r(Vr),paren:r(Vr),brace:r(Vr),content:a,heading:Ur,heading1:r(Ur),heading2:r(Ur),heading3:r(Ur),heading4:r(Ur),heading5:r(Ur),heading6:r(Ur),contentSeparator:r(a),list:r(a),quote:r(a),emphasis:r(a),strong:r(a),link:r(a),monospace:r(a),strikethrough:r(a),inserted:r(),deleted:r(),changed:r(),invalid:r(),meta:$r,documentMeta:r($r),annotation:r($r),processingInstruction:r($r),definition:Tr.defineModifier(),constant:Tr.defineModifier(),function:Tr.defineModifier(),standard:Tr.defineModifier(),local:Tr.defineModifier(),special:Tr.defineModifier()}).link,class:"tok-link"},{tag:h.heading,class:"tok-heading"},{tag:h.emphasis,class:"tok-emphasis"},{tag:h.strong,class:"tok-strong"},{tag:h.keyword,class:"tok-keyword"},{tag:h.atom,class:"tok-atom"},{tag:h.bool,class:"tok-bool"},{tag:h.url,class:"tok-url"},{tag:h.labelName,class:"tok-labelName"},{tag:h.inserted,class:"tok-inserted"},{tag:h.deleted,class:"tok-deleted"},{tag:h.literal,class:"tok-literal"},{tag:h.string,class:"tok-string"},{tag:h.number,class:"tok-number"},{tag:[h.regexp,h.escape,h.special(h.string)],class:"tok-string2"},{tag:h.variableName,class:"tok-variableName"},{tag:h.local(h.variableName),class:"tok-variableName tok-local"},{tag:h.definition(h.variableName),class:"tok-variableName tok-definition"},{tag:h.special(h.variableName),class:"tok-variableName2"},{tag:h.definition(h.propertyName),class:"tok-propertyName tok-definition"},{tag:h.typeName,class:"tok-typeName"},{tag:h.namespace,class:"tok-namespace"},{tag:h.className,class:"tok-className"},{tag:h.macroName,class:"tok-macroName"},{tag:h.propertyName,class:"tok-propertyName"},{tag:h.operator,class:"tok-operator"},{tag:h.comment,class:"tok-comment"},{tag:h.meta,class:"tok-meta"},{tag:h.invalid,class:"tok-invalid"},{tag:h.punctuation,class:"tok-punctuation"}]),qr=new M,Gr=new M,D(rm,[{key:"isActiveAt",value:function t(n,i){var e;return om(n,i,2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1).type.prop(qr)==this.data}},{key:"findRegions",value:function t(n){var f,i,c,e,f=this,i=n.facet(io);return(null==i?void 0:i.data)==this.data?[{from:0,to:n.doc.length}]:i&&i.allowsNesting?(c=[],(e=function t(n,i){var e,r,o,u,s,a,h;if(n.prop(qr)==f.data)c.push({from:i,to:i+n.length});else{if(e=n.prop(M.mounted)){if(e.tree.prop(qr)==f.data){if(e.overlay){r=F(e.overlay);try{for(r.s();!(o=r.n()).done;)u=o.value,c.push({from:u.from+i,to:u.to+i})}catch(t){r.e(t)}finally{r.f()}}else c.push({from:i,to:i+n.length});return}if(e.overlay&&(s=c.length,t(e.tree,e.overlay[0].from+i),c.length>s))return}for(a=0;a<n.children.length;a++)(h=n.children[a])instanceof b&&t(h,n.positions[a]+i)}})(R(n),0),c):[]}},{key:"allowsNesting",get:function t(){return!0}}]),(Jr=rm).setState=v.define(),x(um,Jr),$f=S(um),D(um,[{key:"configure",value:function t(n,i){return new um(this.data,this.parser.configure(n),i||this.name)}},{key:"allowsNesting",get:function t(){return this.parser.hasWrappers()}}],[{key:"define",value:function t(n){var i=em(n.languageData);return new um(i,n.parser.configure({props:[qr.add(function(t){return t.isTop?i:void 0})]}),n.name)}}]),i=um,D(cm,[{key:"length",get:function t(){return this.doc.length}},{key:"syncTo",value:function t(n){return this.string=this.cursor.next(n-this.cursorPos).value,this.cursorPos=n+this.string.length,this.cursorPos-this.string.length}},{key:"chunk",value:function t(n){return this.syncTo(n),this.string}},{key:"lineChunks",get:function t(){return!0}},{key:"read",value:function t(n,i){var e=this.cursorPos-this.string.length;return n<e||i>=this.cursorPos?this.doc.sliceString(n,i):this.string.slice(n-e,i-e)}}]),Kr=cm,Qr=null,D(lm,[{key:"startParse",value:function t(){return this.parser.startParse(new Kr(this.state.doc),this.fragments)}},{key:"work",value:function t(e,r){var o=this;return null!=r&&r>=this.state.doc.length&&(r=void 0),this.tree!=b.empty&&this.isDone(null!=r?r:this.state.doc.length)?(this.takeTree(),!0):this.withContext(function(){var t,n,i;for("number"==typeof e&&(n=Date.now()+e,e=function t(){return Date.now()>n}),o.parse||(o.parse=o.startParse()),null!=r&&(null==o.parse.stoppedAt||o.parse.stoppedAt>r)&&r<o.state.doc.length&&o.parse.stopAt(r);;){if(i=o.parse.advance()){if(o.fragments=o.withoutTempSkipped(Ar.addTree(i,o.fragments,null!=o.parse.stoppedAt)),o.treeLen=null!=(t=o.parse.stoppedAt)?t:o.state.doc.length,o.tree=i,o.parse=null,!(o.treeLen<(null!=r?r:o.state.doc.length)))return!0;o.parse=o.startParse()}if(e())return!1}})}},{key:"takeTree",value:function t(){var n,i,e,n=this;this.parse&&(i=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>i)&&this.parse.stopAt(i),this.withContext(function(){for(;!(e=n.parse.advance()););}),this.treeLen=i,this.tree=e,this.fragments=this.withoutTempSkipped(Ar.addTree(this.tree,this.fragments,!0)),this.parse=null)}},{key:"withContext",value:function t(n){var i=Qr;Qr=this;try{return n()}finally{Qr=i}}},{key:"withoutTempSkipped",value:function t(n){for(var i;i=this.tempSkipped.pop();)n=vm(n,i.from,i.to);return n}},{key:"changes",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,v,e=this.fragments,r=this.tree,o=this.treeLen,u=this.viewport,s=this.skipped;if(this.takeTree(),!n.empty&&(a=[],n.iterChangedRanges(function(t,n,i,e){return a.push({fromA:t,toA:n,fromB:i,toB:e})}),e=Ar.applyChanges(e,a),r=b.empty,o=0,u={from:n.mapPos(u.from,-1),to:n.mapPos(u.to,1)},this.skipped.length)){s=[],h=F(this.skipped);try{for(h.s();!(f=h.n()).done;)c=f.value,(l=n.mapPos(c.from,1))<(v=n.mapPos(c.to,-1))&&s.push({from:l,to:v})}catch(t){h.e(t)}finally{h.f()}}return new lm(this.parser,i,e,r,o,u,s,this.scheduleOn)}},{key:"updateViewport",value:function t(n){var i,e,r,o,r;if(this.viewport.from==n.from&&this.viewport.to==n.to)return!1;for(this.viewport=n,i=this.skipped.length,e=0;e<this.skipped.length;e++)o=(r=this.skipped[e]).from,r=r.to,o<n.to&&r>n.from&&(this.fragments=vm(this.fragments,o,r),this.skipped.splice(e--,1));return!(this.skipped.length>=i||(this.reset(),0))}},{key:"reset",value:function t(){this.parse&&(this.takeTree(),this.parse=null)}},{key:"skipUntilInView",value:function t(n,i){this.skipped.push({from:n,to:i})}},{key:"isDone",value:function t(n){n=Math.min(n,this.state.doc.length);var i=this.fragments;return this.treeLen>=n&&i.length&&0==i[0].from&&i[0].to>=n}}],[{key:"create",value:function t(n,i,e){return new lm(n,i,[],b.empty,0,e,[],null)}},{key:"getSkippingParser",value:function t(a){return x(n,Dr),e=S(n),D(n,[{key:"createParse",value:function t(n,i,o){var u,s,e,u=o[0].from,s=o[o.length-1].to,e;return{parsedPos:u,advance:function t(){var n,i,e,r,n=Qr;if(n){i=F(o);try{for(i.s();!(e=i.n()).done;)r=e.value,n.tempSkipped.push(r)}catch(t){i.e(t)}finally{i.f()}a&&(n.scheduleOn=n.scheduleOn?Promise.all([n.scheduleOn,a]):a)}return this.parsedPos=s,new b(gr.none,[],[],s-u)},stoppedAt:null,stopAt:function t(){}}}}]),new n;function n(){return A(this,n),e.apply(this,arguments)}var i,e}},{key:"get",value:function t(){return Qr}}]),Xr=lm,D(dm,[{key:"apply",value:function t(n){var i,n;return n.docChanged||this.tree!=this.context.tree?(i=this.context.changes(n.changes,n.state),n=this.context.treeLen==n.startState.doc.length?void 0:Math.max(n.changes.mapPos(this.context.treeLen),i.viewport.to),i.work(20,n)||i.takeTree(),new dm(i)):this}}],[{key:"init",value:function t(n){var i,n,i=Math.min(3e3,n.doc.length),n=Xr.create(n.facet(io).parser,n,{from:0,to:i});return n.work(20,i)||n.takeTree(),new dm(n)}}]),Zr=dm,Jr.state=w.define({create:Zr.init,update:function t(n,i){var e,r,o,e=F(i.effects);try{for(e.s();!(r=e.n()).done;)if((o=r.value).is(Jr.setState))return o.value}catch(t){e.e(t)}finally{e.f()}return i.startState.facet(io)!=i.state.facet(io)?Zr.init(i.state):n.apply(i)}}),Yr=function t(n){var i=setTimeout(function(){return n()},500);return function(){return clearTimeout(i)}},"undefined"!=typeof requestIdleCallback&&(Yr=function t(n){var i=-1,e=setTimeout(function(){i=requestIdleCallback(n,{timeout:400})},100);return function(){return i<0?clearTimeout(e):cancelIdleCallback(i)}}),to="undefined"!=typeof navigator&&null!=(tn=navigator.scheduling)&&tn.isInputPending?function(){return navigator.scheduling.isInputPending()}:null,no=u.fromClass((D(ym,[{key:"update",value:function t(n){var i=this.view.state.field(Jr.state).context;(i.updateViewport(n.view.viewport)||this.view.viewport.to>i.treeLen)&&this.scheduleWork(),n.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(i)}},{key:"scheduleWork",value:function t(){var n,i;this.working||(i=(n=this.view.state).field(Jr.state)).tree==i.context.tree&&i.context.isDone(n.doc.length)||(this.working=Yr(this.work))}},{key:"work",value:function t(n){var i,e,r,e,o,u,n,r;this.working=null,i=Date.now(),this.chunkEnd<i&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=i+3e4,this.chunkBudget=3e3),this.chunkBudget<=0||(r=(e=this.view).state,e=e.viewport.to,(o=r.field(Jr.state)).tree==o.context.tree&&o.context.isDone(e+1e5))||(u=Date.now()+Math.min(this.chunkBudget,100,n&&!to?Math.max(25,n.timeRemaining()-5):1e9),n=o.context.treeLen<e&&r.doc.length>e+1e3,r=o.context.work(function(){return to&&to()||Date.now()>u},e+(n?0:1e5)),this.chunkBudget-=Date.now()-i,(r||this.chunkBudget<=0)&&(o.context.takeTree(),this.view.dispatch({effects:Jr.setState.of(new Zr(o.context))})),0<this.chunkBudget&&(!r||n)&&this.scheduleWork(),this.checkAsyncSchedule(o.context))}},{key:"checkAsyncSchedule",value:function t(n){var i=this;n.scheduleOn&&(this.workScheduled++,n.scheduleOn.then(function(){return i.scheduleWork()}).catch(function(t){return vv(i.view.state,t)}).then(function(){return i.workScheduled--}),n.scheduleOn=null)}},{key:"destroy",value:function t(){this.working&&this.working()}},{key:"isWorking",value:function t(){return!!(this.working||0<this.workScheduled)}}]),ym),{eventHandlers:{focus:function t(){this.scheduleWork()}}}),io=y.define({combine:function t(n){return n.length?n[0]:null},enables:function t(n){return[Jr.state,no,p.contentAttributes.compute([n],function(t){var t=t.facet(n);return t&&t.name?{"data-language":t.name}:{}})]}}),rn=D(function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];A(this,t),this.language=n,this.support=i,this.extension=[n,i]}),D(mm,[{key:"load",value:function t(){var n=this;return this.loading||(this.loading=this.loadFunc().then(function(t){return n.support=t},function(t){throw n.loading=null,t}))}}],[{key:"of",value:function t(n){var i=n.load,e=n.support;if(!i){if(!e)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");i=function t(){return Promise.resolve(e)}}return new mm(n.name,(n.alias||[]).concat(n.name).map(function(t){return t.toLowerCase()}),n.extensions||[],n.filename,i,e)}},{key:"matchFilename",value:function t(n,i){var e,r,o,u,s,a,h,e=F(n);try{for(e.s();!(r=e.n()).done;)if((o=r.value).filename&&o.filename.test(i))return o}catch(t){e.e(t)}finally{e.f()}if(u=/\.([^.]+)$/.exec(i)){s=F(n);try{for(s.s();!(a=s.n()).done;)if(-1<(h=a.value).extensions.indexOf(u[1]))return h}catch(t){s.e(t)}finally{s.f()}}return null}},{key:"matchLanguageName",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,v,e=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];i=i.toLowerCase(),r=F(n);try{for(r.s();!(o=r.n()).done;)if((u=o.value).alias.some(function(t){return t==i}))return u}catch(t){r.e(t)}finally{r.f()}if(e){s=F(n);try{for(s.s();!(a=s.n()).done;){f=F((h=a.value).alias);try{for(f.s();!(c=f.n()).done;)if(l=c.value,-1<(v=i.indexOf(l))&&(2<l.length||!/\w/.test(i[v-1])&&!/\w/.test(i[v+l.length])))return h}catch(t){f.e(t)}finally{f.f()}}}catch(t){s.e(t)}finally{s.f()}}return null}}]),o=mm,eo=y.define(),ro=y.define({combine:function t(n){if(!n.length)return"  ";var i=n[0];if(!i||/\S/.test(i)||Array.from(i).some(function(t){return t!=i[0]}))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return i}}),D(bm,[{key:"lineAt",value:function t(n){var i,e,r,o,r,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,e=this.state.doc.lineAt(n),r=this.options,o=r.simulateBreak,r=r.simulateDoubleBreak;return null!=o&&o>=e.from&&o<=e.to?r&&o==n?{text:"",from:n}:(i<0?o<n:o<=n)?{text:e.text.slice(o-e.from),from:o}:{text:e.text.slice(0,o-e.from),from:e.from}:e}},{key:"textAfterPos",value:function t(n){var i,e,r,e,i;return this.options.simulateDoubleBreak&&n==this.options.simulateBreak?"":(r=(e=this.lineAt(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)).text,e=e.from,r.slice(n-e,Math.min(r.length,n+100-e)))}},{key:"column",value:function t(n){var i,e,r,e,n,e,i,e=this.lineAt(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1),r=e.text,e=e.from,n=this.countColumn(r,n-e),e=this.options.overrideIndentation?this.options.overrideIndentation(e):-1;return-1<e&&(n+=e-this.countColumn(r,r.search(/\S|$/))),n}},{key:"countColumn",value:function t(n){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.length;return o0(n,this.state.tabSize,i)}},{key:"lineIndent",value:function t(n){var i,n,e,n,r,r,i,n=this.lineAt(n,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1),e=n.text,n=n.from,r=this.options.overrideIndentation;return r&&-1<(r=r(n))?r:this.countColumn(e,e.search(/\S|$/))}},{key:"simulatedBreak",get:function t(){return this.options.simulateBreak||null}}]),oo=bm,uo=new M,x(Pm,oo),Gf=S(Pm),D(Pm,[{key:"textAfter",get:function t(){return this.textAfterPos(this.pos)}},{key:"baseIndent",get:function t(){for(var n,i,n=this.state.doc.lineAt(this.node.from);;){for(i=this.node.resolve(n.from);i.parent&&i.parent.from==i.from;)i=i.parent;if(Om(i,this.node))break;n=this.state.doc.lineAt(i.from)}return this.lineIndent(n.from)}},{key:"continue",value:function t(){var n=this.node.parent;return n?Cm(n,this.pos,this.base):0}}],[{key:"create",value:function t(n,i,e){return new Pm(n,i,e)}}]),so=Pm,n=function t(n){return n.baseIndent},ao=200,ho=y.define(),fo=new M,co=v.define({map:Fm}),lo=v.define({map:Fm}),vo=w.define({create:function t(){return m.none},update:function t(n,i){var e,r,o,u,s;n=n.map(i.changes),e=F(i.effects);try{for(o=function t(){var e=r.value;e.is(co)&&!zm(n,e.value.from,e.value.to)?n=n.update({add:[po.range(e.value.from,e.value.to)]}):e.is(lo)&&(n=n.update({filter:function t(n,i){return e.value.from!=n||e.value.to!=i},filterFrom:e.value.from,filterTo:e.value.to}))},e.s();!(r=e.n()).done;)o()}catch(t){e.e(t)}finally{e.f()}return n=i.selection&&(u=!1,s=i.selection.main.head,n.between(s,s,function(t,n){t<s&&s<n&&(u=!0)}),u)?n.update({filterFrom:s,filterTo:s,filter:function t(n,i){return i<=s||s<=n}}):n},provide:function t(n){return p.decorations.from(n)},toJSON:function t(n,i){var e=[];return n.between(0,i.doc.length,function(t,n){e.push(t,n)}),e},fromJSON:function t(n){var i,e,r,o;if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");for(i=[],e=0;e<n.length;){if(r=n[e++],o=n[e++],"number"!=typeof r||"number"!=typeof o)throw new RangeError("Invalid JSON for fold state");i.push(po.range(r,o))}return m.set(i,!0)}}),e=function t(n){var i,e,r,o,u,s,i=[],e=F(Nm(n));try{for(e.s();!(r=e.n()).done;)o=r.value,(u=Hm(n.state,o.from,o.to))?i.push(lo.of(u),Vm(n,u,!1)):(s=$m(n,o))&&i.push(co.of(s),Vm(n,s))}catch(t){e.e(t)}finally{e.f()}return 0<i.length&&n.dispatch({effects:Wm(n.state,i)}),!!i.length},Vr=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:nn=function t(n){var i,e,r,o,i=F(Nm(n));try{for(i.s();!(e=i.n()).done;)if(r=e.value,o=_m(n.state,r.from,r.to))return n.dispatch({effects:Wm(n.state,[co.of(o),Vm(n,o)])}),!0}catch(t){i.e(t)}finally{i.f()}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Hr=function t(n){var i,e,r,o,u;if(!n.state.field(vo,!1))return!1;i=[],e=F(Nm(n));try{for(e.s();!(r=e.n()).done;)o=r.value,(u=Hm(n.state,o.from,o.to))&&i.push(lo.of(u),Vm(n,u,!1))}catch(t){e.e(t)}finally{e.f()}return i.length&&n.dispatch({effects:i}),0<i.length}},{key:"Ctrl-Alt-[",run:zr=function t(n){for(var i,e,r,o,u,i=n.state,e=[],r=0;r<i.doc.length;)(u=_m(i,(o=n.lineBlockAt(r)).from,o.to))&&e.push(co.of(u)),r=(u?n.lineBlockAt(u.to):o).to+1;return e.length&&n.dispatch({effects:Wm(n.state,e)}),!!e.length}},{key:"Ctrl-Alt-]",run:Wr=function t(n){var i,e,i=n.state.field(vo,!1);return!(!i||!i.size||(e=[],i.between(0,n.state.doc.length,function(t,n){e.push(lo.of({from:t,to:n}))}),n.dispatch({effects:e}),0))}}],yo={placeholderDOM:null,placeholderText:"\u2026"},mo=y.define({combine:function t(n){return Hl(n,yo)}}),po=m.replace({widget:(x(Gm,Yt),Kf=S(Gm),D(Gm,[{key:"toDOM",value:function t(e){var n,i,r,o,n=e.state,i=n.facet(mo),r=function t(n){var i,i,i=e.lineBlockAt(e.posAtDOM(n.target)),i=Hm(e.state,i.from,i.to);i&&e.dispatch({effects:lo.of(i)}),n.preventDefault()};return i.placeholderDOM?i.placeholderDOM(e,r):((o=document.createElement("span")).textContent=i.placeholderText,o.setAttribute("aria-label",n.phrase("folded code")),o.title=n.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=r,o)}}]),new Gm)}),ko={openText:"\u2304",closedText:"\u203a",markerDOM:null,domEventHandlers:{},foldingChanged:function t(){return!1}},x(Jm,en),Xf=S(Jm),D(Jm,[{key:"eq",value:function t(n){return this.config==n.config&&this.open==n.open}},{key:"toDOM",value:function t(n){var i;return this.config.markerDOM?this.config.markerDOM(this.open):((i=document.createElement("span")).textContent=this.open?this.config.openText:this.config.closedText,i.title=n.state.phrase(this.open?"Fold line":"Unfold line"),i)}}]),go=Jm,wo=p.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),D(Qm,null,[{key:"define",value:function t(n,i){return new Qm(n,i||{})}}]),bo=Qm,Mo=y.define(),xo=y.define({combine:function t(n){return n.length?[n[0]]:null}}),D(tp,[{key:"update",value:function t(n){var i,e,r,i=R(n.state),e=Xm(n.state),r=e!=Xm(n.startState);i.length<n.view.viewport.to&&!r&&i.type==this.tree.type?this.decorations=this.decorations.map(n.changes):(i!=this.tree||n.viewportChanged||r)&&(this.tree=i,this.decorations=this.buildDeco(n.view,e))}},{key:"buildDeco",value:function t(n,i){var e,r,o,u,s,a,h,e=this;if(!i||!this.tree.length)return m.none;r=new Ot,o=F(n.visibleRanges);try{for(o.s();!(u=o.n()).done;)a=(s=u.value).from,h=s.to,tm(this.tree,i,function(t,n,i){r.add(t,n,e.markCache[i]||(e.markCache[i]=m.mark({class:i})))},a,h)}catch(t){o.e(t)}finally{o.f()}return r.finish()}}]),Co=st.high(u.fromClass(tp,{decorations:function t(n){return n.decorations}})),Ur=bo.define([{tag:h.meta,color:"#404740"},{tag:h.link,textDecoration:"underline"},{tag:h.heading,textDecoration:"underline",fontWeight:"bold"},{tag:h.emphasis,fontStyle:"italic"},{tag:h.strong,fontWeight:"bold"},{tag:h.strikethrough,textDecoration:"line-through"},{tag:h.keyword,color:"#708"},{tag:[h.atom,h.bool,h.url,h.contentSeparator,h.labelName],color:"#219"},{tag:[h.literal,h.inserted],color:"#164"},{tag:[h.string,h.deleted],color:"#a11"},{tag:[h.regexp,h.escape,h.special(h.string)],color:"#e40"},{tag:h.definition(h.variableName),color:"#00f"},{tag:h.local(h.variableName),color:"#30a"},{tag:[h.typeName,h.namespace],color:"#085"},{tag:h.className,color:"#167"},{tag:[h.special(h.variableName),h.macroName],color:"#256"},{tag:h.definition(h.propertyName),color:"#00c"},{tag:h.comment,color:"#940"},{tag:h.invalid,color:"#f00"}]),a=p.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),jo=1e4,Po="()[]{}",Oo=y.define({combine:function t(n){return Hl(n,{afterCursor:!0,brackets:Po,maxScanDistance:jo,renderMatch:np})}}),Eo=m.mark({class:"cm-matchingBracket"}),Ao=m.mark({class:"cm-nonmatchingBracket"}),r=w.define({create:function t(){return m.none},update:function t(n,i){var e,r,o,u,s,a;if(!i.docChanged&&!i.selection)return n;e=[],r=i.state.facet(Oo),o=F(i.state.selection.ranges);try{for(o.s();!(u=o.n()).done;)(s=u.value).empty&&(a=op(i.state,s.head,-1,r)||0<s.head&&op(i.state,s.head-1,1,r)||r.afterCursor&&(op(i.state,s.head,1,r)||s.head<i.state.doc.length&&op(i.state,s.head+1,-1,r)))&&(e=e.concat(r.renderMatch(a,i.state)))}catch(t){o.e(t)}finally{o.f()}return m.set(e,!0)},provide:function t(n){return p.decorations.from(n)}}),Do=[r,a],Ro=new M,D(hp,[{key:"eol",value:function t(){return this.pos>=this.string.length}},{key:"sol",value:function t(){return 0==this.pos}},{key:"peek",value:function t(){return this.string.charAt(this.pos)||void 0}},{key:"next",value:function t(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}},{key:"eat",value:function t(n){var i,n,i=this.string.charAt(this.pos),n="string"==typeof n?i==n:i&&(n instanceof RegExp?n.test(i):n(i));if(n)return++this.pos,i}},{key:"eatWhile",value:function t(n){for(var i=this.pos;this.eat(n););return this.pos>i}},{key:"eatSpace",value:function t(){for(var n=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>n}},{key:"skipToEnd",value:function t(){this.pos=this.string.length}},{key:"skipTo",value:function t(n){var n=this.string.indexOf(n,this.pos);if(-1<n)return this.pos=n,!0}},{key:"backUp",value:function t(n){this.pos-=n}},{key:"column",value:function t(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ap(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}},{key:"indentation",value:function t(){var n;return null!=(n=this.overrideIndent)?n:ap(this.string,null,this.tabSize)}},{key:"match",value:function t(n,i,e){var r,o,t;return"string"==typeof n?(r=function t(n){return e?n.toLowerCase():n})(o=this.string.substr(this.pos,n.length))==r(n)?(!1!==i&&(this.pos+=n.length),!0):null:(t=this.string.slice(this.pos).match(n))&&0<t.index?null:(t&&!1!==i&&(this.pos+=t[0].length),t)}},{key:"current",value:function t(){return this.string.slice(this.start,this.pos)}}]),Io=hp,To=new WeakMap,x(lp,Jr),Yf=S(lp),D(lp,[{key:"getIndent",value:function t(n,i){for(var e,r,o,u,e,s,a,h,f,c,l,e,e=R(n.state),r=e.resolve(i);r&&r.type!=this.topNode;)r=r.parent;if(!r)return null;if(o=void 0,(u=n.options.overrideIndentation)&&null!=(o=To.get(n.state))&&o<i-1e4&&(o=void 0),1e4<i-(s=(e=vp(this,e,0,r.from,null!=o?o:i))?(a=e.state,e.pos+1):(a=this.streamParser.startState(n.unit),0)))return null;for(;s<i;){if(h=n.state.doc.lineAt(s),f=Math.min(i,h.to),h.length)for(c=u?u(h.from):-1,l=new Io(h.text,n.state.tabSize,n.unit,c<0?void 0:c);l.pos<f-h.from;)pp(this.streamParser.token,l,a);else this.streamParser.blankLine(a,n.unit);if(f==i)break;s=h.to+1}return e=n.lineAt(i),u&&null==o&&To.set(n.state,e.from),this.streamParser.indent(a,/^\s*(.*)/.exec(e.text)[1],n)}},{key:"allowsNesting",get:function t(){return!1}}],[{key:"define",value:function t(n){return new lp(n)}}]),$r=lp,D(mp,[{key:"advance",value:function t(){var n,i,e,n=Xr.get(),i=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),e=Math.min(i,this.chunkStart+2048);for(n&&(e=Math.min(e,n.viewport.to));this.parsedPos<e;)this.parseLine(n);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=i?this.finish():n&&this.parsedPos>=n.viewport.to?(n.skipUntilInView(this.parsedPos,i),this.finish()):null}},{key:"stopAt",value:function t(n){this.stoppedAt=n}},{key:"lineAfter",value:function t(n){var i,e,i=this.input.chunk(n);return this.input.lineChunks?"\n"==i&&(i=""):-1<(e=i.indexOf("\n"))&&(i=i.slice(0,e)),n+i.length<=this.to?i:i.slice(0,this.to-n)}},{key:"nextLine",value:function t(){for(var n,i,e,r,o,o,u,n=this.parsedPos,i=this.lineAfter(n),e=n+i.length,r=this.rangeIndex;!(e<=(o=this.ranges[r].to))&&(i=i.slice(0,o-(e-i.length)),++r!=this.ranges.length);)o=this.ranges[r].from,i+=u=this.lineAfter(o),e=o+u.length;return{line:i,end:e}}},{key:"skipGapsTo",value:function t(n,i,e){for(var r,o,u;r=this.ranges[this.rangeIndex].to,o=n+i,!(0<e?o<r:o<=r);)i+=(u=this.ranges[++this.rangeIndex].from)-r;return i}},{key:"moveRangeIndex",value:function t(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}},{key:"emitToken",value:function t(n,i,e,r,o){var u;return 1<this.ranges.length&&(i+=o=this.skipGapsTo(i,o,1),u=this.chunk.length,e+=o=this.skipGapsTo(e,o,-1),r+=this.chunk.length-u),this.chunk.push(n,i,e,r),o}},{key:"parseLine",value:function t(n){var i,e,i,r,o,u,s,i=this.nextLine(),e=i.line,i=i.end,r=0,o=this.lang.streamParser,u=new Io(e,n?n.state.tabSize:4,n?pm(n.state):2);if(u.eol())o.blankLine(this.state,u.indentUnit);else for(;!(u.eol()||((s=pp(o.token,u,this.state))&&(r=this.emitToken(this.lang.tokenTable.resolve(s),this.parsedPos+u.start,this.parsedPos+u.pos,4,r)),1e4<u.start)););this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}},{key:"finishChunk",value:function t(){var n=b.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Fo,topID:0,maxBufferLength:2048,reused:this.chunkReused}),n=new b(n.type,n.children,n.positions,n.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]);this.chunks.push(n),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}},{key:"finish",value:function t(){return new b(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}]),Lo=mp,Bo=Object.create(null),_o=[gr.none],Fo=new zt(_o),No=[],Uo=Object.create(null),Ho=0,zo=[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]];Ho<zo.length;Ho++)Vo=(Wo=gc(zo[Ho],2))[0],Wo=Wo[1],Uo[Vo]=wp(Bo,Wo);function kp(t){A(this,kp),this.extra=t,this.table=Object.assign(Object.create(null),Uo)}function gp(t,n){-1<No.indexOf(t)||(No.push(t),console.warn(n))}function wp(t,n){var i,e,r,o,u,n,n,i=null,e=F(n.split("."));try{for(e.s();!(r=e.n()).done;)(u=t[o=r.value]||h[o])?"function"==typeof u?i?i=u(i):gp(o,"Modifier ".concat(o," used at start of tag")):i?gp(o,"Tag ".concat(o," used as modifier")):i=u:gp(o,"Unknown highlighting tag ".concat(o))}catch(t){e.e(t)}finally{e.f()}return i?(n=n.replace(/ /g,"_"),n=gr.define({id:_o.length,name:n,props:[Qy(dc({},n,i))]}),_o.push(n),n.id):0}function bp(t){var n=gr.define({id:_o.length,name:"Document",props:[qr.add(function(){return t})]});return _o.push(n),n}function Mp(t,n,i){A(this,Mp),this.state=t,this.pos=n,this.explicit=i,this.abortListeners=[]}function xp(t){var t,n,t=Object.keys(t).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(/[^\w\s]/g,"\\$&"),"]")}function Sp(t){var n,i,e,r,o,u,t,n=Object.create(null),i=Object.create(null),e=F(t);try{for(e.s();!(r=e.n()).done;)for(n[(o=r.value.label)[0]]=!0,u=1;u<o.length;u++)i[o[u]]=!0}catch(t){e.e(t)}finally{e.f()}return t=xp(n)+xp(i)+"*$",[new RegExp("^"+t),new RegExp(t)]}function Cp(t){var i,n,t,e,r,i=t.map(function(t){return"string"==typeof t?{label:t}:t}),n,t=gc(i.every(function(t){return/^\w+$/.test(t.label)})?[/\w*$/,/\w+$/]:Sp(i),2),e=t[0],r=t[1];return function(t){var n=t.matchBefore(r);return n||t.explicit?{from:n?n.from:t.pos,options:i,validFor:e}:null}}function jp(i,e){return function(t){for(var n=R(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(-1<i.indexOf(n.name))return e(t);if(n.type.isTop)break}return null}}function Pp(i,e){return function(t){for(var n=R(t.state).resolveInner(t.pos,-1);n;n=n.parent){if(-1<i.indexOf(n.name))return null;if(n.type.isTop)break}return e(t)}}function Op(t){return t.selection.main.from}function Ep(t,n){var n,i,n,e,i=t.source,n=n&&"^"!=i[0],e="$"!=i[i.length-1];return n||e?new RegExp("".concat(n?"^":"","(?:").concat(i,")").concat(e?"$":""),null!=(n=t.flags)?n:t.ignoreCase?"i":""):t}function Ap(n,i,e,r){var o=n.selection.main,u=e-o.from,s=r-o.from;return Object.assign(Object.assign({},n.changeByRange(function(t){return t!=o&&e!=r&&n.sliceDoc(t.from+u,t.from+s)!=n.sliceDoc(e,r)?{range:t}:{changes:{from:t.from+u,to:r==o.from?t.to:t.from+s,insert:i},range:O.cursor(t.from+u+i.length)}})),{userEvent:"input.complete"})}function Dp(t){var n;return Array.isArray(t)?((n=Xo.get(t))||Xo.set(t,n=Cp(t)),n):t}function Rp(t){var n,i,e,i,r;for(A(this,Rp),this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],n=0;n<t.length;)e=nl(i=Yc(t,n)),this.chars.push(i),r=(i=t.slice(n,n+e)).toUpperCase(),this.folded.push(Yc(r==i?i.toLowerCase():r,0)),n+=e;this.astral=t.length!=this.chars.length}function Ip(t,n){return t?n?t+" "+n:t:n}function Tp(t,n,i,e,r){var t,o,u,s,a,h,f,c,l,e,l,t=t.textDirection==E.RTL,o=t,u=!1,s="top",f=n.left-r.left,c=r.right-n.right,l=e.right-e.left,e=e.bottom-e.top;return o&&f<Math.min(l,c)?o=!1:!o&&c<Math.min(l,f)&&(o=!0),l<=(o?f:c)?(a=Math.max(r.top,Math.min(i.top,r.bottom-e))-n.top,h=Math.min(400,o?f:c)):(u=!0,h=Math.min(400,(t?n.right:r.right-n.left)-30),a=e<=(l=r.bottom-n.bottom)||l>n.top?i.bottom-n.top:(s="bottom",n.bottom-i.top)),{style:"".concat(s,": ").concat(a,"px; max-width: ").concat(h,"px"),class:"cm-completionInfo-"+(u?t?"left-narrow":"right-narrow":o?"left":"right")}}function Lp(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"option";return function(t){var n,i,e,e,n,n=t.state.field(mu,!1);return!(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<t.state.facet(nu).interactionDelay||(i=1,"page"==o&&(e=X1(t,n.open.tooltip))&&(i=Math.max(2,Math.floor(e.dom.offsetHeight/e.dom.querySelector("li").offsetHeight)-1)),e=n.open.options.length,(n=-1<n.open.selected?n.open.selected+i*(r?1:-1):r?0:e-1)<0?n="page"==o?0:e-1:e<=n&&(n="page"==o?e-1:0),t.dispatch({effects:yu.of(n)}),0))}}function Bp(t){var n,i,e;A(this,Bp),this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0,n=F(t.state.field(mu).active);try{for(n.s();!(i=n.n()).done;)1==(e=i.value).state&&this.startQuery(e)}catch(t){n.e(t)}finally{n.f()}}function _p(t,n){var i,e,i=n.completion.apply||n.completion.label,e=t.state.field(mu).active.find(function(t){return t.source==n.source});return e instanceof vu&&("string"==typeof i?t.dispatch(Object.assign(Object.assign({},Ap(t.state,i,e.from,e.to)),{annotations:Qo.of(n.completion)})):i(t,n.completion,e.from,e.to),!0)}function Fp(t){var n=t.addToOptions.slice();return t.icons&&n.push({render:function t(n){var i,e,e=document.createElement("div");return e.classList.add("cm-completionIcon"),n.type&&(i=e.classList).add.apply(i,yc(n.type.split(/\s+/g).map(function(t){return"cm-completionIcon-"+t}))),e.setAttribute("aria-hidden","true"),e},position:20}),n.push({render:function t(n,i,e){var r,o,u,s,a,h,f,r=document.createElement("span");for(r.className="cm-completionLabel",o=n.label,u=0,s=1;s<e.length;)a=e[s++],h=e[s++],u<a&&r.appendChild(document.createTextNode(o.slice(u,a))),(f=r.appendChild(document.createElement("span"))).appendChild(document.createTextNode(o.slice(a,h))),f.className="cm-completionMatchedText",u=h;return u<o.length&&r.appendChild(document.createTextNode(o.slice(u))),r},position:50},{render:function t(n){var i;return n.detail?((i=document.createElement("span")).className="cm-completionDetail",i.textContent=n.detail,i):null},position:80}),n.sort(function(t,n){return t.position-n.position}).map(function(t){return t.render})}function Np(t,n,i){var e,e;return t<=i?{from:0,to:t}:(n=n<0?0:n)<=t>>1?{from:(e=Math.floor(n/i))*i,to:(e+1)*i}:{from:t-((e=Math.floor((t-n)/i))+1)*i,to:t-e*i}}function Up(e,t){var r,t,n,o,n,i,r=this;A(this,Up),this.view=e,this.stateField=t,this.info=null,this.placeInfoReq={read:function t(){return r.measureInfo()},write:function t(n){return r.placeInfo(n)},key:this},this.space=null,this.currentClass="",n=(t=e.state.field(t)).open,o=n.options,n=n.selected,i=e.state.facet(nu),this.optionContent=Fp(i),this.optionClass=i.optionClass,this.tooltipClass=i.tooltipClass,this.range=Np(o.length,n,i.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",function(t){for(var n=t.target,i;n&&n!=r.dom;n=n.parentNode)if("LI"==n.nodeName&&(i=/-(\d+)$/.exec(n.id))&&+i[1]<o.length)return _p(e,o[+i[1]]),void t.preventDefault()}),this.dom.addEventListener("focusout",function(t){var n=e.state.field(r.stateField,!1);n&&n.tooltip&&e.state.facet(nu).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:Yo.of(null)})}),this.list=this.dom.appendChild(this.createListBox(o,t.id,this.range)),this.list.addEventListener("scroll",function(){r.info&&r.view.requestMeasure(r.placeInfoReq)})}function Hp(n){return function(t){return new su(t,n)}}function zp(t,n){var i,n,i=t.getBoundingClientRect(),n=n.getBoundingClientRect();n.top<i.top?t.scrollTop-=i.top-n.top:n.bottom>i.bottom&&(t.scrollTop+=n.bottom-i.bottom)}function Wp(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function Vp(t,n){var e,r,i,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,B,x,S,C,j,P,O,E,A,D,R,I,T,L,e=[],r=null,i=function t(n){var n,i;e.push(n),(n=n.completion.section)&&(r=r||[],i="string"==typeof n?n:n.name,r.some(function(t){return t.name==i})||r.push("string"==typeof n?{name:i}:n))},o=F(t);try{for(o.s();!(u=o.n()).done;)if((s=u.value).hasResult())if(!1===s.result.filter){a=s.result.getMatch,h=F(s.result.options);try{for(h.s();!(f=h.n()).done;){if(c=f.value,l=[1e9-e.length],a){v=F(a(c));try{for(v.s();!(d=v.n()).done;)y=d.value,l.push(y)}catch(t){v.e(t)}finally{v.f()}}i(new Ko(c,s.source,l,l[0]))}}catch(t){h.e(t)}finally{h.f()}}else{m=new tu(n.sliceDoc(s.from,s.to)),p=void 0,k=F(s.result.options);try{for(k.s();!(g=k.n()).done;)w=g.value,(p=m.match(w.label))&&i(new Ko(w,s.source,p,p[0]+(w.boost||0)))}catch(t){k.e(t)}finally{k.f()}}}catch(t){o.e(t)}finally{o.f()}if(r){b=Object.create(null),M=0,x=F(r.sort(B=function t(n,i){var e,e;return(null!=(e=n.rank)?e:1e9)-(null!=(e=i.rank)?e:1e9)||(n.name<i.name?-1:1)}));try{for(x.s();!(S=x.n()).done;)C=S.value,M-=1e5,b[C.name]=M}catch(t){x.e(t)}finally{x.f()}j=F(e);try{for(j.s();!(P=j.n()).done;)(E=(O=P.value).completion.section)&&(O.score+=b["string"==typeof E?E:E.name])}catch(t){j.e(t)}finally{j.f()}}A=[],D=null,R=n.facet(nu).compareCompletions,I=F(e.sort(function(t,n){return n.score-t.score||R(t.completion,n.completion)}));try{for(I.s();!(T=I.n()).done;)L=T.value,!D||D.label!=L.completion.label||D.detail!=L.completion.detail||null!=D.type&&null!=L.completion.type&&D.type!=L.completion.type||D.apply!=L.completion.apply?A.push(L):Wp(L.completion)>Wp(D)&&(A[A.length-1]=L),D=L.completion}catch(t){I.e(t)}finally{I.f()}return A}function $p(t,n,i,e,r,o){A(this,$p),this.options=t,this.attrs=n,this.tooltip=i,this.timestamp=e,this.selected=r,this.disabled=o}function qp(t,n,i){A(this,qp),this.active=t,this.id=n,this.open=i}function Gp(t,n){var i,e,r,o;if(t==n)return 1;for(e=i=0;;){for(;i<t.length&&!t[i].hasResult;)i++;for(;e<n.length&&!n[e].hasResult;)e++;if(r=i==t.length,o=e==n.length,r||o)return r==o;if(t[i++].result!=n[e++].result)return}}function Jp(t,n){var i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return-1<n&&(i["aria-activedescendant"]=t+"-"+n),i}function Kp(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}function Qp(t,n){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1;A(this,Qp),this.source=t,this.state=n,this.explicitPos=i}function Xp(t,n,i,e,r){var t;return A(this,Xp),(t=nc.call(this,t,2,n)).result=i,t.from=e,t.to=r,t}function Zp(t,n,i,e){var r;if(t)return r=n.sliceDoc(i,e),"function"==typeof t?t(r,i,e,n):Ep(t,!0).test(r)}function Yp(t,n,i){A(this,Yp),this.field=t,this.from=n,this.to=i}function tk(t,n){A(this,tk),this.lines=t,this.fieldPositions=n}function nk(){return A(this,nk),ec.apply(this,arguments)}function ik(t,n){A(this,ik),this.ranges=t,this.active=n,this.deco=m.set(t.map(function(t){return(t.from==t.to?bu:Mu).range(t.from,t.to)}))}function ek(t,n){return O.create(t.filter(function(t){return t.field==n}).map(function(t){return O.range(t.from,t.to)}))}function rk(t){var u=wu.parse(t);return function(t,n,i,e){var r,o,r,i,e,o,r=u.instantiate(t.state,i),o=r.text,r=r.ranges,i={changes:{from:i,to:e,insert:k.of(o)},scrollIntoView:!0,annotations:n?Qo.of(n):void 0};r.length&&(i.selection=ek(r,0)),1<r.length&&(e=new xu(r,0),o=i.effects=[Su.of(e)],void 0===t.state.field(ju,!1))&&o.push(v.appendConfig.of([ju,Eu,Au,pu])),t.dispatch(t.state.update(i))}}function ok(o){return function(t){var n,t,i,e,r,n=t.state,t=t.dispatch,i=n.field(ju,!1);return!(!i||o<0&&0==i.active||(e=i.active+o,r=0<o&&!i.ranges.some(function(t){return t.field==e+o}),t(n.update({selection:ek(i.ranges,e),effects:Su.of(r?null:new xu(i.ranges,e))})),0))}}function uk(t){var n=t.field(ju,!1);return!(!n||!n.ranges.some(function(t){return t.field==n.active+1}))}function sk(t){var t=t.field(ju,!1);return!!(t&&0<t.active)}function ak(t,n){return Object.assign(Object.assign({},n),{apply:rk(t)})}function hk(n){var n=n.replace(/[\\[.+*?(){|^$]/g,"\\$&");try{return new RegExp("[\\p{Alphabetic}\\p{Number}_".concat(n,"]+"),"ug")}catch(t){return new RegExp("[w".concat(n,"]"),"g")}}function fk(t,n){return new RegExp(n(t.source),t.unicode?"u":"")}function ck(t){return Du[t]||(Du[t]=new WeakMap)}function lk(t,n,i,e,r){for(var o,u,s,a,o=t.iterLines(),u=0;!o.next().done;){for(s=o.value,a=void 0,n.lastIndex=0;a=n.exec(s);)if(!e[a[0]]&&u+a.index!=r&&(i.push({type:"text",label:a[0]}),e[a[0]]=!0,2e3<=i.length))return;u+=s.length+1}}function vk(t,n,i,e,r){var o,u,s,a,h,f,c,l,v,d,y,o=1e3<=t.length,u=o&&n.get(t);if(u)return u;if(s=[],a=Object.create(null),t.children){h=0,f=F(t.children);try{for(f.s();!(c=f.n()).done;){if(1e3<=(l=c.value).length){v=F(vk(l,n,i,e-h,r-h));try{for(v.s();!(d=v.n()).done;)a[(y=d.value).label]||(a[y.label]=!0,s.push(y))}catch(t){v.e(t)}finally{v.f()}}else lk(l,i,s,a,r-h);h+=l.length+1}}catch(t){f.e(t)}finally{f.f()}}else lk(t,i,s,a,r);return o&&s.length<2e3&&n.set(t,s),s}function dk(){return A(this,dk),oc.apply(this,arguments)}function yk(){return[Fu,Lu]}function mk(t){for(var n=0;n<Bu.length;n+=2)if(Bu.charCodeAt(n)==t)return Bu.charAt(n+1);return tl(t<128?t:t+1)}function pk(t,n){return t.languageDataAt("closeBrackets",n)[0]||Ru}function kk(t,n){var i,e,r,o,u,s,i=pk(t,t.selection.main.head),e=i.brackets||Ru.brackets,r=F(e);try{for(r.s();!(o=r.n()).done;){if(s=mk(Yc(u=o.value,0)),n==u)return s==u?Sk(t,u,-1<e.indexOf(u+u+u),i):Mk(t,u,s,i.before||Ru.before);if(n==s&&gk(t,t.selection.main.from))return xk(t,u,s)}}catch(t){r.e(t)}finally{r.f()}return null}function gk(t,n){var i=!1;return t.field(Lu).between(0,t.doc.length,function(t){t==n&&(i=!0)}),i}function wk(t,n){var t=t.sliceString(n,n+2);return t.slice(0,nl(Yc(t,0)))}function bk(t,n){var t=t.sliceString(n-2,n);return nl(Yc(t,0))==t.length?t:t.slice(1)}function Mk(i,e,r,o){var u=null,t=i.changeByRange(function(t){var n;return t.empty?!(n=wk(i.doc,t.head))||/\s/.test(n)||-1<o.indexOf(n)?{changes:{insert:e+r,from:t.head},effects:Iu.of(t.head+e.length),range:O.cursor(t.head+e.length)}:{range:u=t}:{changes:[{insert:e,from:t.from},{insert:r,from:t.to}],effects:Iu.of(t.to+e.length),range:O.range(t.anchor+e.length,t.head+e.length)}});return u?null:i.update(t,{scrollIntoView:!0,userEvent:"input.type"})}function xk(n,t,i){var e=null,r=n.changeByRange(function(t){return t.empty&&wk(n.doc,t.head)==i?{changes:{from:t.head,to:t.head+i.length,insert:i},range:O.cursor(t.head+i.length)}:e={range:t}});return e?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Sk(o,u,s,t){var a,h,t,a=t.stringPrefixes||Ru.stringPrefixes,h=null,t=o.changeByRange(function(t){var n,i,e,r,e;if(!t.empty)return{changes:[{insert:u,from:t.from},{insert:u,from:t.to}],effects:Iu.of(t.to+u.length),range:O.range(t.anchor+u.length,t.head+u.length)};if(n=t.head,(i=wk(o.doc,n))==u){if(Ck(o,n))return{changes:{insert:u+u,from:n},effects:Iu.of(n+u.length),range:O.cursor(n+u.length)};if(gk(o,n))return{changes:{from:n,to:n+(e=(r=s&&o.sliceDoc(n,n+3*u.length)==u+u+u)?u+u+u:u).length,insert:e},range:O.cursor(n+e.length)}}else{if(s&&o.sliceDoc(n-2*u.length,n)==u+u&&-1<(e=Pk(o,n-2*u.length,a))&&Ck(o,e))return{changes:{insert:u+u+u+u,from:n},effects:Iu.of(n+u.length),range:O.cursor(n+u.length)};if(o.charCategorizer(n)(i)!=c.Word&&-1<Pk(o,n,a)&&!jk(o,n,u,a))return{changes:{insert:u+u,from:n},effects:Iu.of(n+u.length),range:O.cursor(n+u.length)}}return{range:h=t}});return h?null:o.update(t,{scrollIntoView:!0,userEvent:"input.type"})}function Ck(t,n){var t=R(t).resolveInner(n+1);return t.parent&&t.from==n}function jk(t,n,i,e){for(var r,o,u,s,a,h,s,r=R(t).resolveInner(n,-1),o=e.reduce(function(t,n){return Math.max(t,n.length)},0),u=0;u<5;u++){if(!(a=(s=t.sliceDoc(r.from,Math.min(r.to,r.from+i.length+o))).indexOf(i))||-1<a&&-1<e.indexOf(s.slice(0,a))){for(h=r.firstChild;h&&h.from==r.from&&h.to-h.from>i.length+a;){if(t.sliceDoc(h.to-i.length,h.to)==i)return;h=h.firstChild}return 1}if(!(s=r.to==n&&r.parent))break;r=s}}function Pk(t,n,i){var e,r,o,u,s,e=t.charCategorizer(n);if(e(t.sliceDoc(n-1,n))!=c.Word)return n;r=F(i);try{for(r.s();!(o=r.n()).done;)if(s=n-(u=o.value).length,t.sliceDoc(s,n)==u&&e(t.sliceDoc(s-1,s))!=c.Word)return s}catch(t){r.e(t)}finally{r.f()}return-1}function Ok(){var t;return[mu,nu.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),uu,Uu,pu]}function Ek(t){var t=t.field(mu,!1);return t&&t.active.some(function(t){return 1==t.state})?"pending":t&&t.active.some(function(t){return 0!=t.state})?"active":null}function Ak(t){var t,t,n,t=null==(t=t.field(mu,!1))?void 0:t.open;return!t||t.disabled?[]:((n=Hu.get(t.options))||Hu.set(t.options,n=t.options.map(function(t){return t.completion})),n)}function Dk(t){var t,t,t=null==(t=t.field(mu,!1))?void 0:t.open;return t&&!t.disabled&&0<=t.selected?t.options[t.selected].completion:null}function Rk(t){var t,t,t=null==(t=t.field(mu,!1))?void 0:t.open;return t&&!t.disabled&&0<=t.selected?t.selected:null}function Ik(t){return yu.of(t)}function Tk(e,r){return function(t){var n,t,i,n=t.state,t=t.dispatch;return!n.readOnly&&!!(i=e(r,n))&&(t(n.update(i)),!0)}}function Lk(t,n){var t=t.languageDataAt("commentTokens",n);return t.length?t[0]:{}}function Bk(t,n,i,e){var r,n,o,u,s,a,h,f,c,o,h,u,r=n.open,n=n.close,o=t.sliceDoc(i-$u,i),u=t.sliceDoc(e,e+$u),s=/\s*$/.exec(o)[0].length,a=/^\s*/.exec(u)[0].length,h=o.length-s;return o.slice(h-r.length,h)==r&&u.slice(a,a+n.length)==n?{open:{pos:i-s,margin:s&&1},close:{pos:e+a,margin:a&&1}}:(e-i<=2*$u?f=c=t.sliceDoc(i,e):(f=t.sliceDoc(i,i+$u),c=t.sliceDoc(e-$u,e)),o=/^\s*/.exec(f)[0].length,h=/\s*$/.exec(c)[0].length,u=c.length-h-n.length,f.slice(o,o+r.length)==r&&c.slice(u,u+n.length)==n?{open:{pos:i+o+r.length,margin:/\s/.test(f.charAt(o+r.length))?1:0},close:{pos:e-h-n.length,margin:/\s/.test(c.charAt(u-1))?1:0}}:null)}function _k(t){var n,i,e,r,o,u,s,n=[],i=F(t.selection.ranges);try{for(i.s();!(e=i.n()).done;)r=e.value,o=t.doc.lineAt(r.from),u=r.to<=o.to?o:t.doc.lineAt(r.to),0<=(s=n.length-1)&&n[s].to>o.from?n[s].to=u.to:n.push({from:o.from+/^\s*/.exec(o.text)[0].length,to:u.to})}catch(t){i.e(t)}finally{i.f()}return n}function Fk(t,i){var n,e,r,o,u,s,a,h,f,s,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:i.selection.ranges,e=n.map(function(t){return Lk(i,t.from).block});if(e.every(function(t){return t})){if(r=n.map(function(t,n){return Bk(i,e[n],t.from,t.to)}),2!=t&&!r.every(function(t){return t}))return{changes:i.changes(n.map(function(t,n){return r[n]?[]:[{from:t.from,insert:e[n].open+" "},{from:t.to,insert:" "+e[n].close}]}))};if(1!=t&&r.some(function(t){return t})){for(o=[],u=0;u<r.length;u++)(s=r[u])&&(a=e[u],f=s.open,s=s.close,o.push({from:f.pos-a.open.length,to:f.pos+f.margin},{from:s.pos-s.margin,to:s.pos+a.close.length}));return{changes:o}}}return null}function Nk(t,n){var L,i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,B,j,P,O,E,A,D,R,I,_,T,L,i=[],e=-1,r=F(2<arguments.length&&void 0!==arguments[2]?arguments[2]:n.selection.ranges);try{for(r.s();!(o=r.n()).done;)if(s=(u=o.value).from,a=u.to,h=i.length,f=1e9,c=Lk(n,s).line){for(l=s;l<=a;)(v=n.doc.lineAt(l)).from>e&&(s==a||a>v.from)&&(e=v.from,y=(d=/^\s*/.exec(v.text)[0].length)==v.length,m=v.text.slice(d,d+c.length)==c?d:-1,d<v.text.length&&d<f&&(f=d),i.push({line:v,comment:m,token:c,indent:d,empty:y,single:!1})),l=v.to+1;if(f<1e9)for(p=h;p<i.length;p++)i[p].indent<i[p].line.text.length&&(i[p].indent=f);i.length==h+1&&(i[h].single=!0)}}catch(t){r.e(t)}finally{r.f()}if(2!=t&&i.some(function(t){return t.comment<0&&(!t.empty||t.single)})){k=[],g=F(i);try{for(g.s();!(w=g.n()).done;)M=(b=w.value).line,x=b.token,S=b.indent,C=b.empty,!(B=b.single)&&C||k.push({from:M.from+S,insert:x+" "})}catch(t){g.e(t)}finally{g.f()}return{changes:j=n.changes(k),selection:n.selection.map(j,1)}}if(1!=t&&i.some(function(t){return 0<=t.comment})){P=[],O=F(i);try{for(O.s();!(E=O.n()).done;)D=(A=E.value).line,R=A.comment,I=A.token,0<=R&&(T=(_=D.from+R)+I.length," "==D.text[T-D.from]&&T++,P.push({from:_,to:T}))}catch(t){O.e(t)}finally{O.f()}return{changes:P}}return null}function Uk(t){var i=0;return t.iterChangedRanges(function(t,n){return i=n}),i}function Hk(){var t;return[Qu,Ku.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),p.domEventHandlers({beforeinput:function t(n,i){var e="historyUndo"==n.inputType?Xu:"historyRedo"==n.inputType?Zu:null;return!!e&&(n.preventDefault(),e(i))}})]}function zk(e,r){return function(t){var n,t,i,i,n=t.state,t=t.dispatch;return!(!r&&n.readOnly||!(i=n.field(Qu,!1))||!(i=i.pop(e,n,r))||(t(i),0))}}function Wk(n){return function(t){var t,t,t=t.field(Qu,!1);return t?(t=0==n?t.done:t.undone).length-(t.length&&!t[0].changes?1:0):0}}function Vk(t,n,i,e,r){A(this,Vk),this.changes=t,this.effects=n,this.mapped=i,this.startSelection=e,this.selectionsAfter=r}function $k(t,n,i,e){var r,t,r,t=t.slice(i+20<n+1?n-i-1:0,n);return t.push(e),t}function qk(t,n){var s=[],a=!1;return t.iterChangedRanges(function(t,n){return s.push(t,n)}),n.iterChangedRanges(function(t,n,i,e){for(var r,o,u,r=0;r<s.length;)o=s[r++],u=s[r++],o<=e&&i<=u&&(a=!0)}),a}function Gk(t,i){return t.ranges.length==i.ranges.length&&0===t.ranges.filter(function(t,n){return t.empty!=i.ranges[n].empty}).length}function Jk(t,n){return t.length?n.length?t.concat(n):t:n}function Kk(t,n){var i,e;return t.length?(e=(i=t[t.length-1]).selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-ns))).length&&e[e.length-1].eq(n)?t:(e.push(n),$k(t,t.length-1,1e9,i.setSelAfter(e))):[Yu.selection([n])]}function Qk(t){var n,i,n=t[t.length-1],i=t.slice();return i[t.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),i}function Xk(t,n){var i,e,r,o;if(!t.length)return t;for(i=t.length,e=ts;i;){if((r=Zk(t[i-1],n,e)).changes&&!r.changes.empty||r.effects.length)return(o=t.slice(0,i))[i-1]=r,o;n=r.mapped,i--,e=r.selectionsAfter}return e.length?[Yu.selection(e)]:ts}function Zk(t,n,i){var i,e,r,o,i=Jk(t.selectionsAfter.length?t.selectionsAfter.map(function(t){return t.map(n)}):ts,i);return t.changes?(e=t.changes.map(n),r=n.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(r):r,new Yu(e,v.mapEffects(t.effects,n),o,t.startSelection.map(r),i)):Yu.selection(i)}function Yk(t,n){var i,e,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:void 0;A(this,Yk),this.done=t,this.undone=n,this.prevTime=i,this.prevUserEvent=e}function tg(t,n){return O.create(t.ranges.map(n),t.mainIndex)}function ng(t,n){return t.update({selection:n,scrollIntoView:!0,userEvent:"select"})}function ig(t,n){var i,t,n,i=t.state,t=t.dispatch,n=tg(i.selection,n);return!n.eq(i.selection)&&(t(ng(i,n)),!0)}function eg(t,n){return O.cursor(n?t.to:t.from)}function rg(n,i){return ig(n,function(t){return t.empty?n.moveByChar(t,i):eg(t,i)})}function og(t){return t.textDirectionAt(t.state.selection.main.head)==E.LTR}function ug(n,i){return ig(n,function(t){return t.empty?n.moveByGroup(t,i):eg(t,i)})}function sg(a,i,h){var f=a.state.charCategorizer(i.from);return a.moveByChar(i,h,function(t){var e,r,o,u,s,n,e=c.Space,r=i.from,o=!1,u=!1,s=!1,n=function t(n){if(o)return!1;r+=h?n.length:-n.length;var i=f(n),i;if(i==c.Word&&n.charCodeAt(0)<128&&/[\W_]/.test(n)&&(i=-1),(e=e==c.Space?i:e)!=i)return!1;if(e==c.Word)if(n.toLowerCase()==n){if(!h&&u)return!1;s=!0}else if(s){if(h)return!1;o=!0}else{if(u&&h&&f(i=a.state.sliceDoc(r,r+1))==c.Word&&i.toLowerCase()==i)return!1;u=!0}return!0};return n(t),n})}function ag(n,i){return ig(n,function(t){return t.empty?sg(n,t,i):eg(t,i)})}function hg(t,n,i){var i;return n.type.prop(i)||(i=n.to-n.from)&&(2<i||/[^\s,.;:]/.test(t.sliceDoc(n.from,n.to)))||n.firstChild}function fg(t,n,i){for(var e,r,o,u,s,n,n,e=R(t).resolveInner(n.head),r=i?M.closedBy:M.openedBy,o=n.head;u=i?e.childAfter(o):e.childBefore(o);)hg(t,u,r)?e=u:o=i?u.to:u.from;return n=(s=e.type.prop(r))&&(n=i?op(t,e.from,1):op(t,e.to,-1))&&n.matched?i?n.end.to:n.end.from:i?e.to:e.from,O.cursor(n,i?-1:1)}function cg(i,e){return ig(i,function(t){var n;return t.empty?(n=i.moveVertically(t,e)).head!=t.head?n:i.moveToLineBoundary(t,e):eg(t,e)})}function lg(t){var n,i,e,r,o,u,s,a,n=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,i=0,e=0;if(n){o=F(t.state.facet(p.scrollMargins));try{for(o.s();!(u=o.n()).done;)null!=(a=(s=u.value)(t))&&a.top&&(i=Math.max(null==a?void 0:a.top,i)),null!=a&&a.bottom&&(e=Math.max(null==a?void 0:a.bottom,e))}catch(t){o.e(t)}finally{o.f()}r=t.scrollDOM.clientHeight-i-e}else r=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:e,selfScroll:n,height:Math.max(t.defaultLineHeight,r-5)}}function vg(n,i){var e,t,r,o,u,s,a,s,e=lg(n),t=n.state,r=tg(t.selection,function(t){return t.empty?n.moveVertically(t,i,e.height):eg(t,i)});return!r.eq(t.selection)&&(e.selfScroll&&(u=n.coordsAtPos(t.selection.main.head),a=(s=n.scrollDOM.getBoundingClientRect()).top+e.marginTop,s=s.bottom-e.marginBottom,u)&&u.top>a&&u.bottom<s&&(o=p.scrollIntoView(r.main.head,{y:"start",yMargin:u.top-a})),n.dispatch(ng(t,r),{effects:o}),!0)}function dg(t,n,i){var e,r,i,e=t.lineBlockAt(n.head),r=t.moveToLineBoundary(n,i);return r.head==n.head&&r.head!=(i?e.to:e.from)&&(r=t.moveToLineBoundary(n,i,!1)),r=!i&&r.head==e.from&&e.length&&(i=/^\s*/.exec(t.state.sliceDoc(e.from,Math.min(e.from+100,e.to)))[0].length)&&n.head!=e.from+i?O.cursor(e.from+i):r}function yg(i,t,e){var r=!1,n=tg(i.selection,function(t){var n,n,n=op(i,t.head,-1)||op(i,t.head,1)||0<t.head&&op(i,t.head-1,1)||t.head<i.doc.length&&op(i,t.head+1,-1);return n&&n.end?(r=!0,n=n.start.from==t.head?n.end.to:n.end.from,e?O.range(t.anchor,n):O.cursor(n)):t});return!!r&&(t(ng(i,n)),!0)}function mg(t,i){var n=tg(t.state.selection,function(t){var n=i(t);return O.range(t.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return!n.eq(t.state.selection)&&(t.dispatch(ng(t.state,n)),!0)}function pg(n,i){return mg(n,function(t){return n.moveByChar(t,i)})}function kg(n,i){return mg(n,function(t){return n.moveByGroup(t,i)})}function gg(n,i){return mg(n,function(t){return sg(n,t,i)})}function wg(n,i){return mg(n,function(t){return n.moveVertically(t,i)})}function bg(n,i){return mg(n,function(t){return n.moveVertically(t,i,lg(n).height)})}function Mg(r,o){var u,t,n;return!r.state.readOnly&&(u="delete.selection",!(n=(t=r.state).changeByRange(function(t){var n,i,e,n=t.from,i=t.to;return i=n==i?((e=o(n))<n?e=xg(r,e,!(u="delete.backward")):n<e&&(u="delete.forward",e=xg(r,e,!0)),n=Math.min(n,e),Math.max(i,e)):(n=xg(r,n,!1),xg(r,i,!0)),n==i?{range:t}:{changes:{from:n,to:i},range:O.cursor(n)}})).changes.empty)&&(r.dispatch(t.update(n,{scrollIntoView:!0,userEvent:u,effects:"delete.selection"==u?p.announce.of(t.phrase("Selection deleted")):void 0})),!0)}function xg(n,i,e){var r,t,o;if(n instanceof p){r=F(n.state.facet(p.atomicRanges).map(function(t){return t(n)}));try{for(r.s();!(t=r.n()).done;)(o=t.value).between(i,i,function(t,n){t<i&&i<n&&(i=e?n:t)})}catch(t){r.e(t)}finally{r.f()}}return i}function Sg(t){var n,i,e,r,o,u,s,a,n=[],i=-1,e=F(t.selection.ranges);try{for(e.s();!(r=e.n()).done;)o=r.value,u=t.doc.lineAt(o.from),s=t.doc.lineAt(o.to),o.empty||o.to!=s.from||(s=t.doc.lineAt(o.to-1)),i>=u.number?((a=n[n.length-1]).to=s.to,a.ranges.push(o)):n.push({from:u.from,to:s.to,ranges:[o]}),i=s.number+1}catch(t){e.e(t)}finally{e.f()}return n}function Cg(t,n,i){var e,r,o,u,s,a,h,f,c,l,v,d,y;if(t.readOnly)return!1;e=[],r=[],o=F(Sg(t));try{for(o.s();!(u=o.n()).done;)if(s=u.value,i?s.to!=t.doc.length:0!=s.from)if(h=(a=t.doc.lineAt(i?s.to+1:s.from-1)).length+1,i){e.push({from:s.to,to:a.to},{from:s.from,insert:a.text+t.lineBreak}),f=F(s.ranges);try{for(f.s();!(c=f.n()).done;)l=c.value,r.push(O.range(Math.min(t.doc.length,l.anchor+h),Math.min(t.doc.length,l.head+h)))}catch(t){f.e(t)}finally{f.f()}}else{e.push({from:a.from,to:s.from},{from:s.to,insert:t.lineBreak+a.text}),v=F(s.ranges);try{for(v.s();!(d=v.n()).done;)y=d.value,r.push(O.range(y.anchor-h,y.head-h))}catch(t){v.e(t)}finally{v.f()}}}catch(t){o.e(t)}finally{o.f()}return!!e.length&&(n(t.update({changes:e,scrollIntoView:!0,selection:O.create(r,t.selection.mainIndex),userEvent:"move.line"})),!0)}function jg(t,n,i){var e,r,o,u;if(t.readOnly)return!1;e=[],r=F(Sg(t));try{for(r.s();!(o=r.n()).done;)u=o.value,e.push(i?{from:u.from,insert:t.doc.slice(u.from,u.to)+t.lineBreak}:{from:u.to,insert:t.lineBreak+t.doc.slice(u.from,u.to)})}catch(t){r.e(t)}finally{r.f()}return n(t.update({changes:e,scrollIntoView:!0,userEvent:"input.copyline"})),!0}function Pg(t,n){var i,e,i,n;return/\(\)|\[\]|\{\}/.test(t.sliceDoc(n-1,n+1))?{from:n,to:n}:(e=(i=R(t).resolveInner(n)).childBefore(n),i=i.childAfter(n),e&&i&&e.to<=n&&i.from>=n&&(n=e.type.prop(M.closedBy))&&-1<n.indexOf(i.name)&&t.doc.lineAt(e.to).from==t.doc.lineAt(i.from).from?{from:e.to,to:i.from}:null)}function Og(s){return function(t){var u,t,n,u=t.state,t=t.dispatch;return!u.readOnly&&(n=u.changeByRange(function(t){var n,i,e,t,r,o,o,n=t.from,i=t.to,e=u.doc.lineAt(n),t=!s&&n==i&&Pg(u,n);for(s&&(n=i=(i<=e.to?e:u.doc.lineAt(i)).to),null==(o=gm(r=new oo(u,{simulateBreak:n,simulateDoubleBreak:!!t}),n))&&(o=/^\s*/.exec(u.doc.lineAt(n).text)[0].length);i<e.to&&/\s/.test(e.text[i-e.from]);)i++;return t?(n=t.from,i=t.to):n>e.from&&n<e.from+100&&!/\S/.test(e.text.slice(0,n))&&(n=e.from),o=["",km(u,o)],t&&o.push(km(u,r.lineIndent(e.from,-1))),{changes:{from:n,to:i,insert:k.of(o)},range:O.cursor(n+1+o[1].length)}}),t(u.update(n,{scrollIntoView:!0,userEvent:"input"})),!0)}}function Eg(o,u){var s=-1;return o.changeByRange(function(t){for(var n,i,e,r,n=[],i=t.from;i<=t.to;)(e=o.doc.lineAt(i)).number>s&&(t.empty||t.to>e.from)&&(u(e,n,t),s=e.number),i=e.to+1;return r=o.changes(n),{changes:n,range:O.range(r.mapPos(t.anchor,1),r.mapPos(t.head,1))}})}function I(t,n){var i,e,r,o,u,i=t;if("string"==typeof i&&(i=document.createElement(i)),e=1,(r=n)&&"object"==Rc(r)&&null==r.nodeType&&!Array.isArray(r)){for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&("string"==typeof(u=r[o])?i.setAttribute(o,u):null!=u&&(i[o]=u));e++}for(;e<arguments.length;e++)Ag(i,arguments[e]);return i}function Ag(t,n){if("string"==typeof n)t.appendChild(document.createTextNode(n));else if(null!=n)if(null!=n.nodeType)t.appendChild(n);else{if(!Array.isArray(n))throw new RangeError("Unsupported child node: "+n);for(var i=0;i<n.length;i++)Ag(t,n[i])}}function Dg(t,n,i){A(this,Dg),this.diagnostics=t,this.panel=n,this.selected=i}function Rg(t,n,i){var e,r,o,e=1<arguments.length&&void 0!==n?n:null,r,o=null;return t.between(2<arguments.length&&void 0!==i?i:0,1e9,function(t,n,i){var i=i.spec;if(!e||i.diagnostic==e)return o=new Aa(t,n,i.diagnostic),!1}),o}function Ig(t,n){return!(!t.effects.some(function(t){return t.is(Ra)})&&!t.changes.touchesRange(n.pos))}function Tg(t,n){return t.field(La,!1)?n:n.concat(v.appendConfig.of(Ka))}function Lg(t,n){return{effects:Tg(t,[Ra.of(n)])}}function Bg(t){var t=t.field(La,!1);return t?t.diagnostics.size:0}function _g(n,e,r){var t,i,o,u,s,i,t,i=n.state.field(La).diagnostics,o=[],u=2e8,s=0;return i.between(e-(r<0?1:0),e+(0<r?1:0),function(t,n,i){var i=i.spec;t<=e&&e<=n&&(t==n||(t<e||0<r)&&(e<n||r<0))&&(o.push(i.diagnostic),u=Math.min(t,u),s=Math.max(n,s))}),i=n.state.facet(Na).tooltipFilter,(o=i?i(o):o).length?{pos:u,end:s,above:n.state.doc.lineAt(u).to<s,create:function t(){return{dom:Fg(n,o)}}}:null}function Fg(n,t){return I("ul",{class:"cm-tooltip-lint"},t.map(function(t){return Wg(n,t,!1)}))}function Ng(t){A(this,Ng),this.view=t,this.timeout=-1,this.set=!0;var n,t=t.state.facet(Na).delay;this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}function Ug(t){var n;return[Na.of({source:t,config:1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}}),Fa,Ka]}function Hg(t){var t=t.plugin(Fa);t&&t.force()}function zg(t){var i,n,e,r,o,u,i=[];if(t){n=F(t);try{t:for(n.s();!(e=n.n()).done;){for(r=e.value.name,o=function t(){var n=r[u];if(/[a-zA-Z]/.test(n)&&!i.some(function(t){return t.toLowerCase()==n.toLowerCase()}))return i.push(n),1},u=0;u<r.length;u++)if(o())continue t;i.push("")}}catch(t){n.e(t)}finally{n.f()}}return i}function Wg(s,a,t){var t,h,h=t?zg(a.actions):[];return I("li",{class:"cm-diagnostic cm-diagnostic-"+a.severity},I("span",{class:"cm-diagnosticText"},a.renderMessage?a.renderMessage():a.message),null==(t=a.actions)?void 0:t.map(function(i,t){var e,n,r,o,u,e=!1,n=function t(n){var n;n.preventDefault(),!e&&(e=!0,n=Rg(s.state.field(La).diagnostics,a))&&i.apply(s,n.from,n.to)},r=i.name,o=h[t]?r.indexOf(h[t]):-1,u=o<0?r:[r.slice(0,o),I("u",r.slice(o,o+1)),r.slice(o+1)];return I("button",{type:"button",class:"cm-diagnosticAction",onclick:n,onmousedown:n,"aria-label":" Action: ".concat(r).concat(o<0?"":' (access key "'.concat(h[t],')"'),".")},u)}),a.source&&I("div",{class:"cm-diagnosticSource"},a.source))}function Vg(t){var n;return A(this,Vg),(n=sc.call(this)).diagnostic=t,n}function $g(u){var s,t,n,s=this;A(this,$g),this.view=u,this.items=[],t=function t(n){var i,e,r,o;if(27==n.keyCode)_a(s.view),s.view.focus();else if(38==n.keyCode||33==n.keyCode)s.moveSelection((s.selectedIndex-1+s.items.length)%s.items.length);else if(40==n.keyCode||34==n.keyCode)s.moveSelection((s.selectedIndex+1)%s.items.length);else if(36==n.keyCode)s.moveSelection(0);else if(35==n.keyCode)s.moveSelection(s.items.length-1);else if(13==n.keyCode)s.view.focus();else{if(!(65<=n.keyCode&&n.keyCode<=90&&0<=s.selectedIndex))return;for(e=zg((i=s.items[s.selectedIndex].diagnostic).actions),r=0;r<e.length;r++)e[r].toUpperCase().charCodeAt(0)==n.keyCode&&(o=Rg(s.view.state.field(La).diagnostics,i))&&i.actions[r].apply(u,o.from,o.to)}n.preventDefault()},n=function t(n){for(var i=0;i<s.items.length;i++)s.items[i].dom.contains(n.target)&&s.moveSelection(i)},this.list=I("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=I("div",{class:"cm-panel-lint"},this.list,I("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:function t(){return _a(s.view)}},"\xd7")),this.update()}function qg(t,n){var i;return'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(1<arguments.length&&void 0!==n?n:'viewBox="0 0 40 40"',">").concat(encodeURIComponent(t),"</svg>')")}function Gg(t){return qg('<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="'.concat(t,'" fill="none" stroke-width=".7"/>'),'width="6" height="3"')}function Jg(t){var n;return A(this,Jg),(n=hc.call(this)).diagnostics=t,n.severity=t.reduce(function(t,n){var n=n.severity;return"error"==n||"warning"==n&&"info"==t?n:t},"info"),n}function Kg(r,o){var t;window.addEventListener("mousemove",function t(n){var i,e,i=o.getBoundingClientRect();if(!(n.clientX>i.left-10&&n.clientX<i.right+10&&n.clientY>i.top-10&&n.clientY<i.bottom+10)){for(e=n.target;e;e=e.parentNode)if(1==e.nodeType&&e.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",t),r.state.field(Ga)&&r.dispatch({effects:qa.of(null)})}})}function Qg(i,e,r){var t,n,o;function u(){var t,n,t=i.elementAtHeight(e.getBoundingClientRect().top+5-i.documentTop),n;i.coordsAtPos(t.from)&&i.dispatch({effects:qa.of({pos:t.from,above:!1,create:function t(){return{dom:Fg(i,r),getCoords:function t(){return e.getBoundingClientRect()}}}})}),e.onmouseout=e.onmousemove=null,Kg(i,e)}t=i.state.facet(Qa),n=t.hoverTime,o=setTimeout(u,n),e.onmouseout=function(){clearTimeout(o),e.onmouseout=e.onmousemove=null},e.onmousemove=function(){clearTimeout(o),o=setTimeout(u,n)}}function Xg(t,n){var i,e,r,o,u,s,a,i=Object.create(null),e=F(n);try{for(e.s();!(r=e.n()).done;)o=r.value,(i[(u=t.lineAt(o.from)).from]||(i[u.from]=[])).push(o)}catch(t){e.e(t)}finally{e.f()}for(a in s=[],i)s.push(new Wa(i[a]).range(+a));return j.of(s,!0)}function Zg(){var t;return[Qa.of(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),$a,Va,Ja,Ga]}function Yg(t,n){var t,i,t=t.field(La,!1);if(t&&t.diagnostics.size)for(i=j.iter([t.diagnostics]);i.value;i.next())n(i.value.spec.diagnostic,i.from,i.to)}function tw(t,n){var i,e,r,o,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:t.length,r=4<arguments.length?arguments[4]:void 0,o=5<arguments.length?arguments[5]:void 0;A(this,tw),this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,e),this.bufferStart=i,this.normalize=r?function(t){return r(Za(t))}:Za,this.query=this.normalize(n)}function nw(t,n,i){var e,r,r,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:t.length;if(A(this,nw),this.text=t,this.to=r,this.curLine="",this.done=!1,this.value=th,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new oh(t,n,i,e,r);this.re=new RegExp(n,nh+(null!=i&&i.ignoreCase?"i":"")),this.test=null==i?void 0:i.test,this.iter=t.iter(),r=t.lineAt(e),this.curLineStart=r.from,this.matchPos=ow(t,e),this.getLine(this.curLineStart)}function iw(t,n){A(this,iw),this.from=t,this.text=n}function ew(t,n,i,e,r){A(this,ew),this.text=t,this.to=r,this.done=!1,this.value=th,this.matchPos=ow(t,e),this.re=new RegExp(n,nh+(null!=i&&i.ignoreCase?"i":"")),this.test=null==i?void 0:i.test,this.flat=rh.get(t,e,this.chunkEnd(e+5e3))}function rw(t){try{return new RegExp(t,nh),!0}catch(t){return!1}}function ow(t,n){if(!(n>=t.length))for(var i=t.lineAt(n),e;n<i.to&&56320<=(e=i.text.charCodeAt(n-i.from))&&e<57344;)n++;return n}function uw(s){var a,t;function i(){var t,n,i,t,e,r,o,t,o,u,t,t,t=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(a.value);t&&(i=(n=s.state).doc.lineAt(n.selection.main.head),e=(t=gc(t,5))[1],r=t[2],o=t[3],t=t[4],o=o?+o.slice(1):0,u=r?+r:i.number,r&&t?(t=u/100,e&&(t=t*("-"==e?-1:1)+i.number/n.doc.lines),u=Math.round(n.doc.lines*t)):r&&e&&(u=u*("-"==e?-1:1)+i.number),t=n.doc.line(Math.max(1,Math.min(n.doc.lines,u))),s.dispatch({effects:uh.of(!1),selection:O.cursor(t.from+Math.max(0,Math.min(o,t.length))),scrollIntoView:!0}),s.focus())}return a=I("input",{class:"cm-textfield",name:"line"}),{dom:t=I("form",{class:"cm-gotoLine",onkeydown:function t(n){27==n.keyCode?(n.preventDefault(),s.dispatch({effects:uh.of(!1)}),s.focus()):13==n.keyCode&&(n.preventDefault(),i())},onsubmit:function t(n){n.preventDefault(),i()}},I("label",s.state.phrase("Go to line"),": ",a)," ",I("button",{class:"cm-button",type:"submit"},s.state.phrase("go")))}}function sw(t){var n=[dh,vh];return t&&n.push(fh.of(t)),n}function aw(t,n,i,e){return!(0!=i&&t(n.sliceDoc(i-1,i))==c.Word||e!=n.doc.length&&t(n.sliceDoc(e,e+1))==c.Word)}function hw(t,n,i,e){return t(n.sliceDoc(i,i+1))==c.Word&&t(n.sliceDoc(e-1,e))==c.Word}function fw(t){A(this,fw),this.decorations=this.getDeco(t)}function cw(r,o){for(var t,n,u,t,s,i,e,a,h,t=r.selection,n=t.main,u=t.ranges,t=r.wordAt(n.head),s=t&&t.from==n.from&&t.to==n.to,i=function t(n,i){if(i.next(),!i.done){if(n&&u.some(function(t){return t.from==i.value.from}))return a=n,h=i,0;if(s){var e=r.wordAt(i.value.from);if(!e||e.from!=i.value.from||e.to!=i.value.to)return a=n,h=i,0}return{v:i.value}}if(n)return{v:null};i=new Ya(r.doc,o,0,Math.max(0,u[u.length-1].from-1)),a=n=!0,h=i},a=!1,h=new Ya(r.doc,o,u[u.length-1].to);;)if(0!==(e=i(a,h))&&e)return e.v}function lw(t){return t?[mh.of(t),Bh]:Bh}function vw(t){A(this,vw),this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||rw(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}function dw(t,n,i,e){return new Ya(n.doc,t.unquoted,i,e,t.caseSensitive?void 0:function(t){return t.toLowerCase()},t.wholeWord?yw(n.doc,n.charCategorizer(n.selection.main.head)):void 0)}function yw(r,o){return function(t,n,i,e){return(t<e||e+i.length<n)&&(e=Math.max(0,t-2),i=r.sliceString(e,Math.min(r.length,n+2))),!(o(kw(i,t-e))==c.Word&&o(gw(i,t-e))==c.Word||o(gw(i,n-e))==c.Word&&o(kw(i,n-e))==c.Word)}}function mw(t){return A(this,mw),cc.call(this,t)}function pw(t,n,i,e){return new ih(n.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?ww(n.charCategorizer(n.selection.main.head)):void 0},i,e)}function kw(t,n){return t.slice(Jc(t,n,!1),n)}function gw(t,n){return t.slice(n,Jc(t,n))}function ww(e){return function(t,n,i){return!i[0].length||(e(kw(i.input,i.index))!=c.Word||e(gw(i.input,i.index))!=c.Word)&&(e(gw(i.input,i.index+i[0].length))!=c.Word||e(kw(i.input,i.index+i[0].length))!=c.Word)}}function bw(){return A(this,bw),vc.apply(this,arguments)}function Mw(t){var n=t.field(Mh,!1);return n?n.query.spec:Pw(t)}function xw(t){var t;return null!=(null==(t=t.field(Mh,!1))?void 0:t.panel)}function Sw(t){A(this,Sw),this.view=t,this.decorations=this.highlight(t.state.field(Mh))}function Cw(i){return function(t){var n=t.state.field(Mh,!1);return n&&n.query.spec.valid?i(t,n):Dh(t)}}function jw(t){return t.state.facet(mh).createPanel(t)}function Pw(t,n){var i,i,e,i,e,e,t,e=t.selection.main,e=e.empty||e.to>e.from+100?"":t.sliceDoc(e.from,e.to);return n&&!e?n:(t=t.facet(mh),new ph({search:(null!=(i=null==n?void 0:n.literal)?i:t.literal)?e:e.replace(/\n/g,"\\n"),caseSensitive:null!=(i=null==n?void 0:n.caseSensitive)?i:t.caseSensitive,literal:null!=(e=null==n?void 0:n.literal)?e:t.literal,wholeWord:null!=(i=null==n?void 0:n.wholeWord)?i:t.wholeWord}))}function Ow(t){var t=ny(t,jw);return t&&t.dom.querySelector("[main-field]")}function Ew(t){var n=Ow(t);n&&n==t.root.activeElement&&n.select()}function Aw(n){var i,t;function e(t,n,i){return I("button",{class:"cm-button",name:t,onclick:n,type:"button"},i)}A(i=this,Aw),this.view=n,t=this.query=n.state.field(Mh).query.spec,this.commit=this.commit.bind(this),this.searchField=I("input",{value:t.search,placeholder:Dw(n,"Find"),"aria-label":Dw(n,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=I("input",{value:t.replace,placeholder:Dw(n,"Replace"),"aria-label":Dw(n,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=I("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=I("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=I("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=I("div",{onkeydown:function t(n){return i.keydown(n)},class:"cm-search"},[this.searchField,e("next",function(){return jh(n)},[Dw(n,"next")]),e("prev",function(){return Ph(n)},[Dw(n,"previous")]),e("select",function(){return Oh(n)},[Dw(n,"all")]),I("label",null,[this.caseField,Dw(n,"match case")]),I("label",null,[this.reField,Dw(n,"regexp")]),I("label",null,[this.wordField,Dw(n,"by word")])].concat(yc(n.state.readOnly?[]:[I("br"),this.replaceField,e("replace",function(){return Eh(n)},[Dw(n,"replace")]),e("replaceAll",function(){return Ah(n)},[Dw(n,"replace all")])]),[I("button",{name:"close",onclick:function t(){return Rh(n)},"aria-label":Dw(n,"close"),type:"button"},["\xd7"])]))}function Dw(t,n){return t.state.phrase(n)}function Rw(t,n){var i,n,e,r,i,n,o,u,s,i=n.from,n=n.to,e=t.state.doc.lineAt(i),r=t.state.doc.lineAt(n).to,i=Math.max(e.from,i-Th),n=Math.min(r,n+Th),o=t.state.sliceDoc(i,n);if(i!=e.from)for(u=0;u<Th;u++)if(!Lh.test(o[u+1])&&Lh.test(o[u])){o=o.slice(u);break}if(n!=r)for(s=o.length-1;s>o.length-Th;s--)if(!Lh.test(o[s-1])&&Lh.test(o[s])){o=o.slice(0,s);break}return p.announce.of("".concat(t.state.phrase("current match"),". ").concat(o," ").concat(t.state.phrase("on line")," ").concat(e.number,"."))}D(kp,[{key:"resolve",value:function t(n){return n?this.table[n]||(this.table[n]=wp(this.extra,n)):0}}]),qo=new($o=kp)(Bo),Go=L.Language=Object.freeze({__proto__:null,DocInput:Kr,HighlightStyle:bo,IndentContext:oo,LRLanguage:i,Language:Jr,LanguageDescription:o,LanguageSupport:rn,ParseContext:Xr,StreamLanguage:$r,StringStream:Io,TreeIndentContext:so,bracketMatching:ip,bracketMatchingHandle:Ro,codeFolding:qm,continuedIndent:Rm,defaultHighlightStyle:Ur,defineLanguageFacet:em,delimitedIndent:Am,ensureSyntaxTree:sm,flatIndent:n,foldAll:zr,foldCode:nn,foldEffect:co,foldGutter:Km,foldInside:Tm,foldKeymap:Vr,foldNodeProp:fo,foldService:ho,foldState:vo,foldable:_m,foldedRanges:Um,forceParsing:hm,getIndentUnit:pm,getIndentation:gm,highlightingFor:Ym,indentNodeProp:uo,indentOnInput:Im,indentRange:wm,indentService:eo,indentString:km,indentUnit:ro,language:io,languageDataProp:qr,matchBrackets:op,sublanguageProp:Gr,syntaxHighlighting:Zm,syntaxParserRunning:fm,syntaxTree:R,syntaxTreeAvailable:am,toggleFold:e,unfoldAll:Wr,unfoldCode:Hr,unfoldEffect:lo}),D(Mp,[{key:"tokenBefore",value:function t(n){for(var i=R(this.state).resolveInner(this.pos,-1);i&&n.indexOf(i.name)<0;)i=i.parent;return i?{from:i.from,to:this.pos,text:this.state.sliceDoc(i.from,this.pos),type:i.type}:null}},{key:"matchBefore",value:function t(n){var i,e,i,n,i=this.state.doc.lineAt(this.pos),e=Math.max(i.from,this.pos-250),i=i.text.slice(e-i.from,this.pos-i.from),n=i.search(Ep(n,!1));return n<0?null:{from:e+n,to:this.pos,text:i.slice(n)}}},{key:"aborted",get:function t(){return null==this.abortListeners}},{key:"addEventListener",value:function t(n,i){"abort"==n&&this.abortListeners&&this.abortListeners.push(i)}}]),Jo=Mp,Ko=D(function t(n,i,e,r){A(this,t),this.completion=n,this.source=i,this.match=e,this.score=r}),Qo=gt.define(),Xo=new WeakMap,Zo=v.define(),Yo=v.define(),D(Rp,[{key:"match",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,j,P,O,O;if(0==this.pattern.length)return[-100];if(n.length<this.pattern.length)return null;if(i=this.chars,e=this.folded,r=this.any,o=this.precise,u=this.byWord,1==i.length){if(h=(a=nl(s=Yc(n,0)))==n.length?0:-100,s!=i[0]){if(s!=e[0])return null;h+=-200}return[h,0,a]}if(0==(f=n.indexOf(this.pattern)))return[n.length==this.pattern.length?0:-100,0,this.pattern.length];if(c=i.length,f<(l=0)){for(v=0,d=Math.min(n.length,200);v<d&&l<c;)(y=Yc(n,v))!=i[l]&&y!=e[l]||(r[l++]=v),v+=nl(y);if(l<c)return null}for(k=!1,g=p=m=0,b=w=-1,M=/[a-z]/.test(n),x=!0,S=0,C=Math.min(n.length,200),j=0;S<C&&p<c;)P=Yc(n,S),f<0&&(m<c&&P==i[m]&&(o[m++]=S),g<c)&&(P==i[g]||P==e[g]?(0==g&&(w=S),b=S+1,g++):g=0),O=void 0,O=P<255?48<=P&&P<=57||97<=P&&P<=122?2:65<=P&&P<=90?1:0:(O=tl(P))!=O.toLowerCase()?1:O!=O.toUpperCase()?2:0,(!S||1==O&&M||0==j&&0!=O)&&(i[p]==P||e[p]==P&&(k=!0)?u[p++]=S:u.length&&(x=!1)),j=O,S+=nl(P);return p==c&&0==u[0]&&x?this.result((k?-200:0)-100,u,n):g==c&&0==w?[-200-n.length+(b==n.length?0:-100),0,b]:-1<f?[-700-n.length,f,f+this.pattern.length]:g==c?[-900-n.length,w,b]:p==c?this.result((k?-200:0)-100-700+(x?0:-1100),u,n):2==i.length?null:this.result((r[0]?-700:0)-200-1100,r,n)}},{key:"result",value:function t(n,i,e){var t,r,o,u,s,a;t=[n-e.length],r=1,o=F(i);try{for(o.s();!(u=o.n()).done;)a=(s=u.value)+(this.astral?nl(Yc(e,s)):1),1<r&&t[r-1]==s?t[r-1]=a:(t[r++]=s,t[r++]=a)}catch(t){o.e(t)}finally{o.f()}return t}}]),tu=Rp,nu=y.define({combine:function t(n){return Hl(n,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:function t(){return""},optionClass:function t(){return""},aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Tp,compareCompletions:function t(n,i){return n.label.localeCompare(i.label)},interactionDelay:75},{defaultKeymap:function t(n,i){return n&&i},closeOnBlur:function t(n,i){return n&&i},icons:function t(n,i){return n&&i},tooltipClass:function t(n,i){return function(t){return Ip(n(t),i(t))}},optionClass:function t(n,i){return function(t){return Ip(n(t),i(t))}},addToOptions:function t(n,i){return n.concat(i)}})}}),tn=function t(n){var i=n.state.field(mu,!1);return!(n.state.readOnly||!i||!i.open||i.open.selected<0||Date.now()-i.open.timestamp<n.state.facet(nu).interactionDelay)&&(!!i.open.disabled||_p(n,i.open.options[i.open.selected]))},r=function t(n){var i;return!!n.state.field(mu,!1)&&(n.dispatch({effects:Zo.of(!0)}),!0)},a=function t(n){var i=n.state.field(mu,!1);return!(!i||!i.active.some(function(t){return 0!=t.state})||(n.dispatch({effects:Yo.of(null)}),0))},iu=D(function t(n,i){A(this,t),this.active=n,this.context=i,this.time=Date.now(),this.updates=[],this.done=void 0}),ru=eu=50,ou=1e3,uu=u.fromClass((D(Bp,[{key:"update",value:function t(n){var i,e,r,o,u,s,a,h,u,f,c,l,i=this,e=n.state.field(mu);if(n.selectionSet||n.docChanged||n.startState.field(mu)!=e){for(r=n.transactions.some(function(t){return(t.selection||t.docChanged)&&!Kp(t)}),o=0;o<this.running.length;o++)if(u=this.running[o],r||50<u.updates.length+n.transactions.length&&Date.now()-u.time>ou){s=F(u.context.abortListeners);try{for(s.s();!(a=s.n()).done;){h=a.value;try{h()}catch(t){vv(this.view.state,t)}}}catch(t){s.e(t)}finally{s.f()}u.context.abortListeners=null,this.running.splice(o--,1)}else(u=u.updates).push.apply(u,yc(n.transactions));if(-1<this.debounceUpdate&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(function(n){return 1==n.state&&!i.running.some(function(t){return t.active.source==n.source})})?setTimeout(function(){return i.startUpdate()},50):-1,0!=this.composing){f=F(n.transactions);try{for(f.s();!(c=f.n()).done;)"input"==Kp(l=c.value)?this.composing=2:2==this.composing&&l.selection&&(this.composing=3)}catch(t){f.e(t)}finally{f.f()}}}}},{key:"startUpdate",value:function t(){var i,n,e,r,o,u,i=this;this.debounceUpdate=-1,r=F((e=(n=this.view.state).field(mu)).active);try{for(u=function t(){var n=o.value;1!=n.state||i.running.some(function(t){return t.active.source==n.source})||i.startQuery(n)},r.s();!(o=r.n()).done;)u()}catch(t){r.e(t)}finally{r.f()}}},{key:"startQuery",value:function t(n){var i,e,r,e,o,i=this,e=this.view.state,r=Op(e),e=new Jo(e,r,n.explicitPos==r),o=new iu(n,e);this.running.push(o),Promise.resolve(n.source(e)).then(function(t){o.context.aborted||(o.done=t||null,i.scheduleAccept())},function(t){i.view.dispatch({effects:Yo.of(null)}),vv(i.view.state,t)})}},{key:"scheduleAccept",value:function t(){var n=this;this.running.every(function(t){return void 0!==t.done})?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(function(){return n.accept()},50))}},{key:"accept",value:function t(){var l,v,d,y,n,i,m,l=this;for(-1<this.debounceAccept&&clearTimeout(this.debounceAccept),this.debounceAccept=-1,d=[],y=this.view.state.facet(nu),n=function t(n){var i,e,r,o,u,s,a,h,f,c,i=l.running[n];if(void 0===i.done)return m=n,0;if(l.running.splice(n--,1),i.done){e=new vu(i.active.source,i.active.explicitPos,i.done,i.done.from,null!=(v=i.done.to)?v:Op(i.updates.length?i.updates[0].startState:l.view.state)),r=F(i.updates);try{for(r.s();!(o=r.n()).done;)u=o.value,e=e.update(u,y)}catch(t){r.e(t)}finally{r.f()}if(e.hasResult())return d.push(e),m=n,0}if((s=l.view.state.field(mu).active.find(function(t){return t.source==i.active.source}))&&1==s.state)if(null==i.done){a=new lu(i.active.source,0),h=F(i.updates);try{for(h.s();!(f=h.n()).done;)c=f.value,a=a.update(c,y)}catch(t){h.e(t)}finally{h.f()}1!=a.state&&d.push(a)}else l.startQuery(s);m=n},m=0;m<this.running.length;m++)i=n(m);d.length&&this.view.dispatch({effects:du.of(d)})}}]),Bp),{eventHandlers:{blur:function t(n){var i,i,i=this.view.state.field(mu,!1);i&&i.tooltip&&this.view.state.facet(nu).closeOnBlur&&((i=i.open&&X1(this.view,i.open.tooltip))&&i.dom.contains(n.relatedTarget)||this.view.dispatch({effects:Yo.of(null)}))},compositionstart:function t(){this.composing=1},compositionend:function t(){var n=this;3==this.composing&&setTimeout(function(){return n.view.dispatch({effects:Zo.of(!1)})},20),this.composing=0}}}),D(Up,[{key:"mount",value:function t(){this.updateSel()}},{key:"update",value:function t(n){var n,n,i,e,i,e=n.state.field(this.stateField),i=n.startState.field(this.stateField);this.updateTooltipClass(n.state),e!=i&&(this.updateSel(),(null==(n=e.open)?void 0:n.disabled)!=(null==(n=i.open)?void 0:n.disabled))&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!(null==(i=e.open)||!i.disabled))}},{key:"updateTooltipClass",value:function t(n){var n,i,e,r,o,u,s,n=this.tooltipClass(n);if(n!=this.currentClass){i=F(this.currentClass.split(" "));try{for(i.s();!(e=i.n()).done;)(r=e.value)&&this.dom.classList.remove(r)}catch(t){i.e(t)}finally{i.f()}o=F(n.split(" "));try{for(o.s();!(u=o.n()).done;)(s=u.value)&&this.dom.classList.add(s)}catch(t){o.e(t)}finally{o.f()}this.currentClass=n}}},{key:"positioned",value:function t(n){this.space=n,this.info&&this.view.requestMeasure(this.placeInfoReq)}},{key:"updateSel",value:function t(){var n,i,e,e,r,r,n=this,i=this.view.state.field(this.stateField),e=i.open;(-1<e.selected&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=Np(e.options.length,e.selected,this.view.state.facet(nu).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e.options,i.id,this.range)),this.list.addEventListener("scroll",function(){n.info&&n.view.requestMeasure(n.placeInfoReq)})),this.updateSelectedOption(e.selected)&&(this.info&&(this.info.remove(),this.info=null),r=(e=e.options[e.selected].completion).info)&&(r="string"==typeof r?document.createTextNode(r):r(e))&&("then"in r?r.then(function(t){t&&n.view.state.field(n.stateField,!1)==i&&n.addInfoPane(t)}).catch(function(t){return vv(n.view.state,t,"completion info")}):this.addInfoPane(r))}},{key:"addInfoPane",value:function t(n){var i=this.info=document.createElement("div");i.className="cm-tooltip cm-completionInfo",i.appendChild(n),this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}},{key:"updateSelectedOption",value:function t(n){for(var i,e,r,i=null,e=this.list.firstChild,r=this.range.from;e;e=e.nextSibling,r++)"LI"==e.nodeName&&e.id?r==n?e.hasAttribute("aria-selected")||(e.setAttribute("aria-selected","true"),i=e):e.hasAttribute("aria-selected")&&e.removeAttribute("aria-selected"):r--;return i&&zp(this.list,i),i}},{key:"measureInfo",value:function t(){var n,i,e,n,r,o,n=this.dom.querySelector("[aria-selected]");return!n||!this.info||(i=this.dom.getBoundingClientRect(),e=this.info.getBoundingClientRect(),n=n.getBoundingClientRect(),r=(r=this.space)||{left:0,top:0,right:(o=this.dom.ownerDocument.defaultView||window).innerWidth,bottom:o.innerHeight},n.top>Math.min(r.bottom,i.bottom)-10)||n.bottom<Math.max(r.top,i.top)+10?null:this.view.state.facet(nu).positionInfo(this.view,i,n,e,r)}},{key:"placeInfo",value:function t(n){this.info&&(n?(n.style&&(this.info.style.cssText=n.style),this.info.className="cm-tooltip cm-completionInfo "+(n.class||"")):this.info.style.cssText="top: -1e6px")}},{key:"createListBox",value:function t(n,i,e){var r,o,u,s,a,h,s,f,c,l,s,v,d,y,m,r=document.createElement("ul");for(r.id=i,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true"),r.setAttribute("aria-label",this.view.state.phrase("Completions")),o=null,u=e.from;u<e.to;u++){a=(s=n[u]).completion,h=s.match,(s=a.section)&&(f="string"==typeof s?s:s.name)!=o&&(u>e.from||0==e.from)&&(o=f,"string"!=typeof s&&s.header?r.appendChild(s.header(s)):(c=r.appendChild(document.createElement("completion-section"))).textContent=f),(l=r.appendChild(document.createElement("li"))).id=i+"-"+u,l.setAttribute("role","option"),(s=this.optionClass(a))&&(l.className=s),v=F(this.optionContent);try{for(v.s();!(d=v.n()).done;)(m=(y=d.value)(a,this.view.state,h))&&l.appendChild(m)}catch(t){v.e(t)}finally{v.f()}}return e.from&&r.classList.add("cm-completionListIncompleteTop"),e.to<n.length&&r.classList.add("cm-completionListIncompleteBottom"),r}}]),su=Up,D($p,[{key:"setSelected",value:function t(n,i){return n==this.selected||n>=this.options.length?this:new $p(this.options,Jp(i,n),this.tooltip,this.timestamp,n,this.disabled)}},{key:"map",value:function t(n){return new $p(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:n.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}],[{key:"build",value:function t(n,i,e,r,o){var u,s,a,h,u=Vp(n,i);if(!u.length)return r&&n.some(function(t){return 1==t.state})?new $p(r.options,r.attrs,r.tooltip,r.timestamp,r.selected,!0):null;if(s=i.facet(nu).selectOnOpen?0:-1,r&&r.selected!=s&&-1!=r.selected)for(a=r.options[r.selected].completion,h=0;h<u.length;h++)if(u[h].completion==a){s=h;break}return new $p(u,Jp(e,s),{pos:n.reduce(function(t,n){return n.hasResult()?Math.min(t,n.from):t},1e8),create:Hp(mu),above:o.aboveCursor},r?r.timestamp:Date.now(),s,!1)}}]),au=$p,D(qp,[{key:"update",value:function t(i){var e,n,r,o,u,s,a,h,f,e=this,n=i.state,r=n.facet(nu),o,u=(r.override||n.languageDataAt("autocomplete",Op(n)).map(Dp)).map(function(n){var t;return(e.active.find(function(t){return t.source==n})||new lu(n,e.active.some(function(t){return 0!=t.state})?1:0)).update(i,r)});u.length==this.active.length&&u.every(function(t,n){return t==e.active[n]})&&(u=this.active),(s=this.open)&&i.docChanged&&(s=s.map(i.changes)),i.selection||u.some(function(t){return t.hasResult()&&i.changes.touchesRange(t.from,t.to)})||!Gp(u,this.active)?s=au.build(u,n,this.id,s,r):s&&s.disabled&&!u.some(function(t){return 1==t.state})&&(s=null),!s&&u.every(function(t){return 1!=t.state})&&u.some(function(t){return t.hasResult()})&&(u=u.map(function(t){return t.hasResult()?new lu(t.source,0):t})),a=F(i.effects);try{for(a.s();!(h=a.n()).done;)(f=h.value).is(yu)&&(s=s&&s.setSelected(f.value,this.id))}catch(t){a.e(t)}finally{a.f()}return u==this.active&&s==this.open?this:new qp(u,this.id,s)}},{key:"tooltip",get:function t(){return this.open?this.open.tooltip:null}},{key:"attrs",get:function t(){return this.open?this.open.attrs:fu}}],[{key:"start",value:function t(){return new qp(cu,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}}]),hu=qp,fu={"aria-autocomplete":"list"},cu=[],D(Qp,[{key:"hasResult",value:function t(){return!1}},{key:"update",value:function t(n,i){var e,r,o,u,s,a,h,f,e=Kp(n),r=this;e?r=r.handleUserEvent(n,e,i):n.docChanged?r=r.handleChange(n):n.selection&&0!=r.state&&(r=new Qp(r.source,0)),o=F(n.effects);try{for(o.s();!(u=o.n()).done;)if((s=u.value).is(Zo))r=new Qp(r.source,1,s.value?Op(n.state):-1);else if(s.is(Yo))r=new Qp(r.source,0);else if(s.is(du)){a=F(s.value);try{for(a.s();!(h=a.n()).done;)(f=h.value).source==r.source&&(r=f)}catch(t){a.e(t)}finally{a.f()}}}catch(t){o.e(t)}finally{o.f()}return r}},{key:"handleUserEvent",value:function t(n,i,e){return"delete"!=i&&e.activateOnTyping?new Qp(this.source,1):this.map(n.changes)}},{key:"handleChange",value:function t(n){return n.changes.touchesRange(Op(n.startState))?new Qp(this.source,0):this.map(n.changes)}},{key:"map",value:function t(n){return n.empty||this.explicitPos<0?this:new Qp(this.source,this.state,n.mapPos(this.explicitPos))}}]),x(Xp,lu=Qp),nc=S(Xp),D(Xp,[{key:"hasResult",value:function t(){return!0}},{key:"handleUserEvent",value:function t(n,i,e){var r,r,o,u,i,e,r=n.changes.mapPos(this.from),o=n.changes.mapPos(this.to,1),u=Op(n.state);return(this.explicitPos<0?u<=r:u<this.from)||o<u||"delete"==i&&Op(n.startState)==this.from?new lu(this.source,"input"==i&&e.activateOnTyping?1:0):(i=this.explicitPos<0?-1:n.changes.mapPos(this.explicitPos),Zp(this.result.validFor,n.state,r,o)?new Xp(this.source,i,this.result,r,o):this.result.update&&(e=this.result.update(this.result,r,o,new Jo(n.state,u,0<=i)))?new Xp(this.source,i,e,e.from,null!=(r=e.to)?r:Op(n.state)):new lu(this.source,1,i))}},{key:"handleChange",value:function t(n){return n.changes.touchesRange(this.from,this.to)?new lu(this.source,0):this.map(n.changes)}},{key:"map",value:function t(n){return n.empty?this:new Xp(this.source,this.explicitPos<0?-1:n.mapPos(this.explicitPos),this.result,n.mapPos(this.from),n.mapPos(this.to,1))}}]),vu=Xp,du=v.define({map:function t(n,i){return n.map(function(t){return t.map(i)})}}),yu=v.define(),mu=w.define({create:function t(){return hu.start()},update:function t(n,i){return n.update(i)},provide:function t(n){return[He.from(n,function(t){return t.tooltip}),p.contentAttributes.from(n,function(t){return t.attrs})]}}),pu=p.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"".concat(400,"px"),boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"".concat(30,"px")},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"".concat(30,"px")},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25cb'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25cc'"}},".cm-completionIcon-variable":{"&:after":{content:"'\ud835\udc65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\ud835\udc36'"}},".cm-completionIcon-type":{"&:after":{content:"'\ud835\udc61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222a'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25a1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25a2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),ku=D(function t(n,i,e,r){A(this,t),this.field=n,this.line=i,this.from=e,this.to=r}),D(Yp,[{key:"map",value:function t(n){var i,n,i=n.mapPos(this.from,-1,f.TrackDel),n=n.mapPos(this.to,1,f.TrackDel);return null==i||null==n?null:new Yp(this.field,i,n)}}]),gu=Yp,D(tk,[{key:"instantiate",value:function t(n,i){var e,r,o,u,s,a,h,f,c,l,v,e=[],r=[i],o=n.doc.lineAt(i),u=/^\s*/.exec(o.text)[0],s=F(this.lines);try{for(s.s();!(a=s.n()).done;){if(h=a.value,e.length){for(f=u,c=/^\t*/.exec(h)[0].length,l=0;l<c;l++)f+=n.facet(ro);r.push(i+f.length-c),h=f+h.slice(c)}e.push(h),i+=h.length+1}}catch(t){s.e(t)}finally{s.f()}return{text:e,ranges:v=this.fieldPositions.map(function(t){return new gu(t.field,r[t.line]+t.from,r[t.line]+t.to)})}}}],[{key:"parse",value:function t(n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,i=[],e=[],r=[],u=F(n.split(/\r\n?|\n/));try{for(u.s();!(s=u.n()).done;){for(a=s.value;o=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(a);){for(h=o[1]?+o[1]:null,f=o[2]||o[3]||"",c=-1,l=0;l<i.length;l++)(null!=h?i[l].seq==h:f&&i[l].name==f)&&(c=l);if(c<0){for(v=0;v<i.length&&(null==h||null!=i[v].seq&&i[v].seq<h);)v++;i.splice(v,0,{seq:h,name:f}),c=v,d=F(r);try{for(d.s();!(y=d.n()).done;)(m=y.value).field>=c&&m.field++}catch(t){d.e(t)}finally{d.f()}}r.push(new ku(c,e.length,o.index,o.index+f.length)),a=a.slice(0,o.index)+f+a.slice(o.index+o[0].length)}for(;p=/\\([{}])/.exec(a);){a=a.slice(0,p.index)+p[1]+a.slice(p.index+p[0].length),k=F(r);try{for(k.s();!(g=k.n()).done;)(w=g.value).line==e.length&&w.from>p.index&&(w.from--,w.to--)}catch(t){k.e(t)}finally{k.f()}}e.push(a)}}catch(t){u.e(t)}finally{u.f()}return new tk(e,r)}}]),wu=tk,bu=m.widget({widget:(x(nk,Yt),ec=S(nk),D(nk,[{key:"toDOM",value:function t(){var n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}},{key:"ignoreEvent",value:function t(){return!1}}]),new nk)}),Mu=m.mark({class:"cm-snippetField"}),D(ik,[{key:"map",value:function t(n){var i,e,r,o,u,i=[],e=F(this.ranges);try{for(e.s();!(r=e.n()).done;){if(!(u=(o=r.value).map(n)))return null;i.push(u)}}catch(t){e.e(t)}finally{e.f()}return new ik(i,this.active)}},{key:"selectionInsideField",value:function t(n){var i=this;return n.ranges.every(function(n){return i.ranges.some(function(t){return t.field==i.active&&t.from<=n.from&&t.to>=n.to})})}}]),xu=ik,Su=v.define({map:function t(n,i){return n&&n.map(i)}}),Cu=v.define(),ju=w.define({create:function t(){return null},update:function t(n,i){var e,r,o,e=F(i.effects);try{for(e.s();!(r=e.n()).done;){if((o=r.value).is(Su))return o.value;if(o.is(Cu)&&n)return new xu(n.ranges,o.value)}}catch(t){e.e(t)}finally{e.f()}return n=(n=n&&i.docChanged?n.map(i.changes):n)&&i.selection&&!n.selectionInsideField(i.selection)?null:n},provide:function t(n){return p.decorations.from(n,function(t){return t?t.deco:m.none})}}),zt=ok(1),i=ok(-1),Pu=[{key:"Tab",run:zt,shift:i},{key:"Escape",run:o=function t(n){var i,n,e,i=n.state,n=n.dispatch,e;return!!i.field(ju,!1)&&(n(i.update({effects:Su.of(null)})),!0)}}],Ou=y.define({combine:function t(n){return n.length?n[0]:Pu}}),Eu=st.highest(ee.compute([Ou],function(t){return t.facet(Ou)})),Au=p.domEventHandlers({mousedown:function t(n,i){var e,r,o,e=i.state.field(ju,!1);return!(!e||null==(r=i.posAtCoords({x:n.clientX,y:n.clientY}))||!(o=e.ranges.find(function(t){return t.from<=r&&t.to>=r}))||o.field==e.active||(i.dispatch({selection:ek(e.ranges,o.field),effects:Su.of(e.ranges.some(function(t){return t.field>o.field})?new xu(e.ranges,o.field):null)}),0))}}),Du=Object.create(null),rn=function t(n){var i,e,r,r,o,i=n.state.languageDataAt("wordChars",n.pos).join(""),e=hk(i),r=n.matchBefore(fk(e,function(t){return t+"$"}));return r||n.explicit?{from:r=r?r.from:n.pos,options:o=vk(n.state.doc,ck(i),e,5e4,r),validFor:fk(e,function(t){return"^"+t})}:null},Ru={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Iu=v.define({map:function t(n,i){var i=i.mapPos(n,-1,f.TrackAfter);return null==i?void 0:i}}),x(dk,t),oc=S(dk),(Tu=new(D(dk))).startSide=1,Tu.endSide=-1,Lu=w.define({create:function t(){return j.empty},update:function t(n,i){var e,r,o,u,s;n=(n=i.selection&&(e=i.state.doc.lineAt(i.selection.main.head).from,r=i.startState.doc.lineAt(i.startState.selection.main.head).from,e!=i.changes.mapPos(r,-1))?j.empty:n).map(i.changes),o=F(i.effects);try{for(o.s();!(u=o.n()).done;)(s=u.value).is(Iu)&&(n=n.update({add:[Tu.range(s.value,s.value+1)]}))}catch(t){o.e(t)}finally{o.f()}return n}}),Bu="()[]{}<>",_u="object"==("undefined"==typeof navigator?"undefined":Rc(navigator))&&/Android\b/.test(navigator.userAgent),Fu=p.inputHandler.of(function(t,n,i,e){var r,n;return!((_u?t.composing:t.compositionStarted)||t.state.readOnly||(r=t.state.selection.main,2<e.length)||2==e.length&&1==nl(Yc(e,0))||n!=r.from||i!=r.to||!(n=kk(t.state,e))||(t.dispatch(n),0))}),n=[{key:"Backspace",run:$r=function t(n){var o,n,i,u,s,i,o=n.state,n=n.dispatch;return!o.readOnly&&(i=pk(o,o.selection.main.head),u=i.brackets||Ru.brackets,s=null,i=o.changeByRange(function(t){var n,i,e,r;if(t.empty){n=bk(o.doc,t.head),i=F(u);try{for(i.s();!(e=i.n()).done;)if((r=e.value)==n&&wk(o.doc,t.head)==mk(Yc(r,0)))return{changes:{from:t.head-r.length,to:t.head+r.length},range:O.cursor(t.head-r.length)}}catch(t){i.e(t)}finally{i.f()}}return{range:s=t}}),s||n(o.update(i,{scrollIntoView:!0,userEvent:"delete.backward"})),!s)}}],Nu=[{key:"Ctrl-Space",run:r},{key:"Escape",run:a},{key:"ArrowDown",run:Lp(!0)},{key:"ArrowUp",run:Lp(!1)},{key:"PageDown",run:Lp(!0,"page")},{key:"PageUp",run:Lp(!1,"page")},{key:"Enter",run:tn}],Uu=st.highest(ee.computeN([nu],function(t){return t.facet(nu).defaultKeymap?[Nu]:[]})),Hu=new WeakMap,zu=L.Autocomplete=Object.freeze({__proto__:null,CompletionContext:Jo,acceptCompletion:tn,autocompletion:Ok,clearSnippet:o,closeBrackets:yk,closeBracketsKeymap:n,closeCompletion:a,completeAnyWord:rn,completeFromList:Cp,completionKeymap:Nu,completionStatus:Ek,currentCompletions:Ak,deleteBracketPair:$r,hasNextSnippetField:uk,hasPrevSnippetField:sk,ifIn:jp,ifNotIn:Pp,insertBracket:kk,insertCompletionText:Ap,moveCompletionSelection:Lp,nextSnippetField:zt,pickedCompletion:Qo,prevSnippetField:i,selectedCompletion:Dk,selectedCompletionIndex:Rk,setSelectedCompletion:Ik,snippet:rk,snippetCompletion:ak,snippetKeymap:Ou,startCompletion:r}),zr=function t(n){var i=n.state,i=i.doc.lineAt(i.selection.main.from),i=Lk(n.state,i.from);return i.line?Wu(n):!!i.block&&Vu(n)},Wu=Tk(Nk,0),nn=Tk(Nk,1),e=Tk(Nk,2),Wr=Tk(Fk,0),Hr=Tk(Fk,1),t=Tk(Fk,2),Vu=Tk(function(t,n){return Fk(t,n,_k(n))},0),$u=50,qu=gt.define(),Gu=gt.define(),Ju=y.define(),Ku=y.define({combine:function t(n){return Hl(n,{minDepth:100,newGroupDelay:500,joinToEvent:function t(n,i){return i}},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:function t(i,e){return function(t,n){return i(t,n)||e(t,n)}}})}}),tn=Qu=w.define({create:function t(){return es.empty},update:function t(n,i){var e,r,o,o,u,s,o,u,s,r,e=i.state.facet(Ku),r=i.annotation(qu);return r?(o=i.docChanged?O.single(Uk(i.changes)):void 0,o=Yu.fromTransaction(i,o),s=0==(u=r.side)?n.undone:n.done,s=o?$k(s,s.length,e.minDepth,o):Kk(s,i.startState.selection),new es(0==u?r.rest:s,0==u?s:r.rest)):("full"!=(o=i.annotation(Gu))&&"before"!=o||(n=n.isolate()),!1===i.annotation(Mt.addToHistory)?i.changes.empty?n:n.addMapping(i.changes.desc):(u=Yu.fromTransaction(i),s=i.annotation(Mt.time),r=i.annotation(Mt.userEvent),u?n=n.addChanges(u,s,r,e,i):i.selection&&(n=n.addSelection(i.startState.selection,s,r,e.newGroupDelay)),"full"!=o&&"after"!=o?n:n.isolate()))},toJSON:function t(n){return{done:n.done.map(function(t){return t.toJSON()}),undone:n.undone.map(function(t){return t.toJSON()})}},fromJSON:function t(n){return new es(n.done.map(Yu.fromJSON),n.undone.map(Yu.fromJSON))}}),Xu=zk(0,!1),Zu=zk(1,!1),o=zk(0,!0),a=zk(1,!0),rn=Wk(0),$r=Wk(1),D(Vk,[{key:"setSelAfter",value:function t(n){return new Vk(this.changes,this.effects,this.mapped,this.startSelection,n)}},{key:"toJSON",value:function t(){var n,n,n;return{changes:null==(n=this.changes)?void 0:n.toJSON(),mapped:null==(n=this.mapped)?void 0:n.toJSON(),startSelection:null==(n=this.startSelection)?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(function(t){return t.toJSON()})}}}],[{key:"fromJSON",value:function t(n){return new Vk(n.changes&&K.fromJSON(n.changes),[],n.mapped&&J.fromJSON(n.mapped),n.startSelection&&O.fromJSON(n.startSelection),n.selectionsAfter.map(O.fromJSON))}},{key:"fromTransaction",value:function t(n,i){var e,r,o,u,s,e=ts,r=F(n.startState.facet(Ju));try{for(r.s();!(o=r.n()).done;)(s=(u=o.value)(n)).length&&(e=e.concat(s))}catch(t){r.e(t)}finally{r.f()}return!e.length&&n.changes.empty?null:new Vk(n.changes.invert(n.startState.doc),e,void 0,i||n.startState.selection,ts)}},{key:"selection",value:function t(n){return new Vk(void 0,ts,void 0,void 0,n)}}]),Yu=Vk,ts=[],ns=200,is=/^(input\.type|delete)($|\.)/,D(Yk,[{key:"isolate",value:function t(){return this.prevTime?new Yk(this.done,this.undone):this}},{key:"addChanges",value:function t(n,i,e,r,o){var u=this.done,s=u[u.length-1],u;return new Yk(u=s&&s.changes&&!s.changes.empty&&n.changes&&(!e||is.test(e))&&(!s.selectionsAfter.length&&i-this.prevTime<r.newGroupDelay&&r.joinToEvent(o,qk(s.changes,n.changes))||"input.type.compose"==e)?$k(u,u.length-1,r.minDepth,new Yu(n.changes.compose(s.changes),Jk(n.effects,s.effects),s.mapped,s.startSelection,ts)):$k(u,u.length,r.minDepth,n),ts,i,e)}},{key:"addSelection",value:function t(n,i,e,r){var o=this.done.length?this.done[this.done.length-1].selectionsAfter:ts;return 0<o.length&&i-this.prevTime<r&&e==this.prevUserEvent&&e&&/^select($|\.)/.test(e)&&Gk(o[o.length-1],n)?this:new Yk(Kk(this.done,n),this.undone,i,e)}},{key:"addMapping",value:function t(n){return new Yk(Xk(this.done,n),Xk(this.undone,n),this.prevTime,this.prevUserEvent)}},{key:"pop",value:function t(n,i,e){var r,o,e,r=0==n?this.done:this.undone;return 0==r.length?null:(o=r[r.length-1],e&&o.selectionsAfter.length?i.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:qu.of({side:n,rest:Qk(r)}),userEvent:0==n?"select.undo":"select.redo",scrollIntoView:!0}):o.changes?(e=1==r.length?ts:r.slice(0,r.length-1),o.mapped&&(e=Xk(e,o.mapped)),i.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:qu.of({side:n,rest:e}),filter:!1,userEvent:0==n?"undo":"redo",scrollIntoView:!0})):null)}}]),(es=Yk).empty=new es(ts,ts),zt=[{key:"Mod-z",run:Xu,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Zu,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Zu,preventDefault:!0},{key:"Mod-u",run:o,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:a,preventDefault:!0}],i=function t(n){return rg(n,!0)},r=function t(n){return rg(n,!1)},as=function t(n){return ug(n,!0)},hs=function t(n){return ug(n,!1)},fs=function t(n){return ag(n,!0)},cs=function t(n){return ag(n,!1)},ls=function t(n){return ig(n,function(t){return fg(n.state,t,!og(n))})},vs=function t(n){return ig(n,function(t){return fg(n.state,t,og(n))})},Ss=function t(n){var i,e;return yg(n.state,n.dispatch,!1)},Cs=function t(n){var i,e;return yg(n.state,n.dispatch,!0)},Os=function t(n){return pg(n,!0)},Es=function t(n){return pg(n,!1)},Rs=function t(n){return kg(n,!0)},Is=function t(n){return kg(n,!1)},Ts=function t(n){return gg(n,!0)},Ls=function t(n){return gg(n,!1)},Bs=function t(n){return mg(n,function(t){return fg(n.state,t,!og(n))})},_s=function t(n){return mg(n,function(t){return fg(n.state,t,og(n))})},Ys=function t(n){var i,n,e,i=n.state,n=n.dispatch,e=Sg(i).map(function(t){var n=t.from,t=t.to;return O.range(n,Math.min(t+1,i.doc.length))});return n(i.update({selection:O.create(e),userEvent:"select"})),!0},ta=function t(n){var e,n,i,e=n.state,n=n.dispatch,i=tg(e.selection,function(t){for(var n,i,i=R(e).resolveInner(t.head,1);!(i.from<t.from&&i.to>=t.to||i.to>t.to&&i.from<=t.from||null==(n=i.parent))&&n.parent;)i=i.parent;return O.range(i.to,i.from)});return n(ng(e,i)),!0},na=function t(n){var i,n,e,r,i=n.state,n=n.dispatch,e=i.selection,r=null;return 1<e.ranges.length?r=O.create([e.main]):e.main.empty||(r=O.create([O.cursor(e.main.head)])),!!r&&(n(ng(i,r)),!0)},ia=function t(a,h){return Mg(a,function(t){var n,i,e,r,o,u,s,n=a.state,i=n.doc.lineAt(t);if(!h&&t>i.from&&t<i.from+200&&!/[^ \t]/.test(e=i.text.slice(0,t-i.from))){if("\t"==e[e.length-1])return t-1;for(u=(o=o0(e,n.tabSize))%pm(n)||pm(n),s=0;s<u&&" "==e[e.length-1-s];s++)t--;r=t}else(r=Jc(i.text,t-i.from,h,h)+i.from)==t&&i.number!=(h?n.doc.lines:1)&&(r+=h?1:-1);return r})},oa=function t(h,f){return Mg(h,function(t){for(var n,i,e,r,o,u,s,a,n=t,i=h.state,e=i.doc.lineAt(n),r=i.charCategorizer(n),o=null;;){if(n==(f?e.to:e.from)){n==t&&e.number!=(f?i.doc.lines:1)&&(n+=f?1:-1);break}if(u=Jc(e.text,n-e.from,f)+e.from,a=r(s=e.text.slice(Math.min(n,u)-e.from,Math.max(n,u)-e.from)),null!=o&&a!=o)break;" "==s&&n==t||(o=a),n=u}return n})},fa=function t(n){var i,n,e,r,o,u,s,i=n.state,n=n.dispatch;if(i.readOnly)return!1;for(e=[],r=0,o="",u=i.doc.iter();;){if(u.next(),u.lineBreak||u.done){if(-1<(s=o.search(/\s+$/))&&e.push({from:r-(o.length-s),to:r}),u.done)break;o=""}else o=u.value;r+=u.value.length}return!!e.length&&(n(i.update({changes:e,userEvent:"delete"})),!0)},va=function t(n){var i,e;return Cg(n.state,n.dispatch,!1)},da=function t(n){var i,e;return Cg(n.state,n.dispatch,!0)},ya=function t(n){var i,e;return jg(n.state,n.dispatch,!1)},ma=function t(n){var i,e;return jg(n.state,n.dispatch,!0)},pa=function t(n){var i,e,r;return!n.state.readOnly&&(e=(i=n.state).changes(Sg(i).map(function(t){var n=t.from,t=t.to;return 0<n?n--:t<i.doc.length&&t++,{from:n,to:t}})),r=tg(i.selection,function(t){return n.moveVertically(t,!0)}).map(e),n.dispatch({changes:e,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0)},ga=Og(!(ka=function t(n){var i=n.state,e;return(0,n.dispatch)(i.update(i.replaceSelection(i.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0})),wa=Og(!0),ba=function t(n){var u,n,s,a,i,u=n.state,n=n.dispatch;return!u.readOnly&&(s=Object.create(null),a=new oo(u,{overrideIndentation:function t(n){var n=s[n];return null==n?-1:n}}),(i=Eg(u,function(t,n,i){var e,r,o,e=gm(a,t.from);null!=e&&(/\S/.test(t.text)||(e=0),(r=/^\s*/.exec(t.text)[0])!=(o=km(u,e))||i.from<t.from+r.length)&&(s[t.from]=e,n.push({from:t.from,to:t.from+r.length,insert:o}))})).changes.empty||n(u.update(i,{userEvent:"indent"})),!0)},Ma=function t(n){var i=n.state,n=n.dispatch;return!i.readOnly&&(n(i.update(Eg(i,function(t,n){n.push({from:t.from,insert:i.facet(ro)})}),{userEvent:"input.indent"})),!0)},xa=function t(n){var u=n.state,n=n.dispatch;return!u.readOnly&&(n(u.update(Eg(u,function(t,n){var i,e,r,o,i=/^\s*/.exec(t.text)[0];if(i){for(e=o0(i,u.tabSize),r=0,o=km(u,Math.max(0,e-pm(u)));r<i.length&&r<o.length&&i.charCodeAt(r)==o.charCodeAt(r);)r++;n.push({from:t.from+r,to:t.from+i.length,insert:o.slice(r)})}}),{userEvent:"delete.dedent"})),!0)},Sa=function t(n){var i=n.state,n=n.dispatch;return i.selection.ranges.some(function(t){return!t.empty})?Ma({state:i,dispatch:n}):(n(i.update(i.replaceSelection("\t"),{scrollIntoView:!0,userEvent:"input"})),!0)},ja=[{key:"ArrowLeft",run:rs=function t(n){return rg(n,!og(n))},shift:js=function t(n){return pg(n,!og(n))},preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:us=function t(n){return ug(n,!og(n))},shift:As=function t(n){return kg(n,!og(n))},preventDefault:!0},{mac:"Cmd-ArrowLeft",run:ws=function t(n){return ig(n,function(t){return dg(n,t,!og(n))})},shift:Vs=function t(n){return mg(n,function(t){return dg(n,t,!og(n))})},preventDefault:!0},{key:"ArrowRight",run:os=function t(n){return rg(n,og(n))},shift:Ps=function t(n){return pg(n,og(n))},preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ss=function t(n){return ug(n,og(n))},shift:Ds=function t(n){return kg(n,og(n))},preventDefault:!0},{mac:"Cmd-ArrowRight",run:bs=function t(n){return ig(n,function(t){return dg(n,t,og(n))})},shift:$s=function t(n){return mg(n,function(t){return dg(n,t,og(n))})},preventDefault:!0},{key:"ArrowUp",run:ds=function t(n){return cg(n,!1)},shift:Fs=function t(n){return wg(n,!1)},preventDefault:!0},{mac:"Cmd-ArrowUp",run:Js=function t(n){var i=n.state,e;return(0,n.dispatch)(ng(i,{anchor:0})),!0},shift:Qs=function t(n){var i=n.state,e;return(0,n.dispatch)(ng(i,{anchor:i.selection.main.anchor,head:0})),!0}},{mac:"Ctrl-ArrowUp",run:ms=function t(n){return vg(n,!1)},shift:Us=function t(n){return bg(n,!1)}},{key:"ArrowDown",run:ys=function t(n){return cg(n,!0)},shift:Ns=function t(n){return wg(n,!0)},preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ks=function t(n){var i=n.state,e;return(0,n.dispatch)(ng(i,{anchor:i.doc.length})),!0},shift:Xs=function t(n){var i=n.state,e;return(0,n.dispatch)(ng(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0}},{mac:"Ctrl-ArrowDown",run:ps=function t(n){return vg(n,!0)},shift:Hs=function t(n){return bg(n,!0)}},{key:"PageUp",run:ms,shift:Us},{key:"PageDown",run:ps,shift:Hs},{key:"Home",run:gs=function t(n){return ig(n,function(t){return dg(n,t,!1)})},shift:Ws=function t(n){return mg(n,function(t){return dg(n,t,!1)})},preventDefault:!0},{key:"Mod-Home",run:Js,shift:Qs},{key:"End",run:ks=function t(n){return ig(n,function(t){return dg(n,t,!0)})},shift:zs=function t(n){return mg(n,function(t){return dg(n,t,!0)})},preventDefault:!0},{key:"Mod-End",run:Ks,shift:Xs},{key:"Enter",run:ga},{key:"Mod-a",run:Zs=function t(n){var i=n.state,e;return(0,n.dispatch)(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0}},{key:"Backspace",run:ea=function t(n){return ia(n,!1)},shift:ea},{key:"Delete",run:ra=function t(n){return ia(n,!0)}},{key:"Mod-Backspace",mac:"Alt-Backspace",run:ua=function t(n){return oa(n,!1)}},{key:"Mod-Delete",mac:"Alt-Delete",run:sa=function t(n){return oa(n,!0)}},{mac:"Mod-Backspace",run:ha=function t(i){return Mg(i,function(t){var n=i.lineBlockAt(t).from;return n<t?n:Math.max(0,t-1)})}},{mac:"Mod-Delete",run:aa=function t(i){return Mg(i,function(t){var n=i.lineBlockAt(t).to;return t<n?n:Math.min(i.state.doc.length,t+1)})}}].concat((Ca=[{key:"Ctrl-b",run:rs,shift:js,preventDefault:!0},{key:"Ctrl-f",run:os,shift:Ps},{key:"Ctrl-p",run:ds,shift:Fs},{key:"Ctrl-n",run:ys,shift:Ns},{key:"Ctrl-a",run:Ms=function t(n){return ig(n,function(t){return O.cursor(n.lineBlockAt(t.head).from,1)})},shift:qs=function t(n){return mg(n,function(t){return O.cursor(n.lineBlockAt(t.head).from)})}},{key:"Ctrl-e",run:xs=function t(n){return ig(n,function(t){return O.cursor(n.lineBlockAt(t.head).to,-1)})},shift:Gs=function t(n){return mg(n,function(t){return O.cursor(n.lineBlockAt(t.head).to)})}},{key:"Ctrl-d",run:ra},{key:"Ctrl-h",run:ea},{key:"Ctrl-k",run:aa},{key:"Ctrl-Alt-h",run:ua},{key:"Ctrl-o",run:ca=function t(n){var i,n,e,i=n.state,n=n.dispatch;return!i.readOnly&&(e=i.changeByRange(function(t){return{changes:{from:t.from,to:t.to,insert:k.of(["",""])},range:O.cursor(t.from)}}),n(i.update(e,{scrollIntoView:!0,userEvent:"input"})),!0)}},{key:"Ctrl-t",run:la=function t(n){var r,n,i,r=n.state,n=n.dispatch;return!r.readOnly&&!(i=r.changeByRange(function(t){var n,i,e,i;return t.empty&&0!=t.from&&t.from!=r.doc.length?{changes:{from:e=(n=t.from)==(i=r.doc.lineAt(n)).from?n-1:Jc(i.text,n-i.from,!1)+i.from,to:i=n==i.to?n+1:Jc(i.text,n-i.from,!0)+i.from,insert:r.doc.slice(n,i).append(r.doc.slice(e,n))},range:O.cursor(i)}:{range:t}})).changes.empty&&(n(r.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:ps}]).map(function(t){return{mac:t.key,run:t.run,shift:t.shift}})),Pa=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:ls,shift:Bs},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:vs,shift:_s},{key:"Alt-ArrowUp",run:va},{key:"Shift-Alt-ArrowUp",run:ya},{key:"Alt-ArrowDown",run:da},{key:"Shift-Alt-ArrowDown",run:ma},{key:"Escape",run:na},{key:"Mod-Enter",run:wa},{key:"Alt-l",mac:"Ctrl-l",run:Ys},{key:"Mod-i",run:ta,preventDefault:!0},{key:"Mod-[",run:xa},{key:"Mod-]",run:Ma},{key:"Mod-Alt-\\",run:ba},{key:"Shift-Mod-k",run:pa},{key:"Shift-Mod-\\",run:Ss},{key:"Mod-/",run:zr},{key:"Alt-A",run:Wr}].concat(ja),Oa={key:"Tab",run:Ma,shift:xa},Ea=L.Commands=Object.freeze({__proto__:null,blockComment:Hr,blockUncomment:t,copyLineDown:ma,copyLineUp:ya,cursorCharBackward:r,cursorCharForward:i,cursorCharLeft:rs,cursorCharRight:os,cursorDocEnd:Ks,cursorDocStart:Js,cursorGroupBackward:hs,cursorGroupForward:as,cursorGroupLeft:us,cursorGroupRight:ss,cursorLineBoundaryBackward:gs,cursorLineBoundaryForward:ks,cursorLineBoundaryLeft:ws,cursorLineBoundaryRight:bs,cursorLineDown:ys,cursorLineEnd:xs,cursorLineStart:Ms,cursorLineUp:ds,cursorMatchingBracket:Ss,cursorPageDown:ps,cursorPageUp:ms,cursorSubwordBackward:cs,cursorSubwordForward:fs,cursorSyntaxLeft:ls,cursorSyntaxRight:vs,defaultKeymap:Pa,deleteCharBackward:ea,deleteCharForward:ra,deleteGroupBackward:ua,deleteGroupForward:sa,deleteLine:pa,deleteToLineEnd:aa,deleteToLineStart:ha,deleteTrailingWhitespace:fa,emacsStyleKeymap:Ca,history:Hk,historyField:tn,historyKeymap:zt,indentLess:xa,indentMore:Ma,indentSelection:ba,indentWithTab:Oa,insertBlankLine:wa,insertNewline:ka,insertNewlineAndIndent:ga,insertTab:Sa,invertedEffects:Ju,isolateHistory:Gu,lineComment:nn,lineUncomment:e,moveLineDown:da,moveLineUp:va,redo:Zu,redoDepth:$r,redoSelection:a,selectAll:Zs,selectCharBackward:Es,selectCharForward:Os,selectCharLeft:js,selectCharRight:Ps,selectDocEnd:Xs,selectDocStart:Qs,selectGroupBackward:Is,selectGroupForward:Rs,selectGroupLeft:As,selectGroupRight:Ds,selectLine:Ys,selectLineBoundaryBackward:Ws,selectLineBoundaryForward:zs,selectLineBoundaryLeft:Vs,selectLineBoundaryRight:$s,selectLineDown:Ns,selectLineEnd:Gs,selectLineStart:qs,selectLineUp:Fs,selectMatchingBracket:Cs,selectPageDown:Hs,selectPageUp:Us,selectParentSyntax:ta,selectSubwordBackward:Ls,selectSubwordForward:Ts,selectSyntaxLeft:Bs,selectSyntaxRight:_s,simplifySelection:na,splitLine:ca,standardKeymap:ja,toggleBlockComment:Wr,toggleBlockCommentByLine:Vu,toggleComment:zr,toggleLineComment:Wu,transposeChars:la,undo:Xu,undoDepth:rn,undoSelection:o}),Aa=D(function t(n,i,e){A(this,t),this.from=n,this.to=i,this.diagnostic=e}),D(Dg,null,[{key:"init",value:function t(n,i,e){var n,r,r,n=n,r=e.facet(Na).markerFilter;return r&&(n=r(n)),new Dg(r=m.set(n.map(function(t){return t.from==t.to||t.from==t.to-1&&e.doc.lineAt(t.from).to==t.from?m.widget({widget:new Ua(t),diagnostic:t}).range(t.from):m.mark({attributes:{class:"cm-lintRange cm-lintRange-"+t.severity},diagnostic:t}).range(t.from,t.to)}),!0),i,Rg(r))}}]),Da=Dg,Ra=v.define(),Ia=v.define(),Ta=v.define(),La=w.define({create:function t(){return new Da(m.none,null,null)},update:function t(n,i){var e,r,o,u,s,a;i.docChanged&&(e=n.diagnostics.map(i.changes),r=null,n.selected&&(o=i.changes.mapPos(n.selected.from,1),r=Rg(e,n.selected.diagnostic,o)||Rg(e,null,o)),n=new Da(e,n.panel,r)),u=F(i.effects);try{for(u.s();!(s=u.n()).done;)(a=s.value).is(Ra)?n=Da.init(a.value,n.panel,i.state):a.is(Ia)?n=new Da(n.diagnostics,a.value?za.open:null,n.selected):a.is(Ta)&&(n=new Da(n.diagnostics,n.panel,a.value))}catch(t){u.e(t)}finally{u.f()}return n},provide:function t(n){return[Qe.from(n,function(t){return t.panel}),p.decorations.from(n,function(t){return t.diagnostics})]}}),Ba=m.mark({class:"cm-lintRange cm-lintRange-active"}),_a=function t(n){var i=n.state.field(La,!1);return!(!i||!i.panel||(n.dispatch({effects:Ia.of(!1)}),0))},ma=[{key:"Mod-Shift-m",run:Hr=function t(n){var i,i,i=n.state.field(La,!1);return i&&i.panel||n.dispatch({effects:Tg(n.state,[Ia.of(!0)])}),(i=ny(n,za.open))&&i.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:t=function t(n){var i,e,r,i=n.state.field(La,!1);return!(!i||(e=n.state.selection.main,!(r=i.diagnostics.iter(e.to+1)).value&&(!(r=i.diagnostics.iter(0)).value||r.from==e.from&&r.to==e.to))||(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),0))}}],Fa=u.fromClass((D(Ng,[{key:"run",value:function t(){var n,i,e,r,i,n=this,i=Date.now();i<this.lintTime-10?setTimeout(this.run,this.lintTime-i):(this.set=!1,i=(r=(e=this.view.state).facet(Na)).sources,Promise.all(i.map(function(t){return Promise.resolve(t(n.view))})).then(function(t){var t=t.reduce(function(t,n){return t.concat(n)});n.view.state.doc==e.doc&&n.view.dispatch(Lg(n.view.state,t))},function(t){vv(n.view.state,t)}))}},{key:"update",value:function t(n){var i=n.state.facet(Na);(n.docChanged||i!=n.startState.facet(Na)||i.needsRefresh&&i.needsRefresh(n))&&(this.lintTime=Date.now()+i.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,i.delay)))}},{key:"force",value:function t(){this.set&&(this.lintTime=Date.now(),this.run())}},{key:"destroy",value:function t(){clearTimeout(this.timeout)}}]),Ng)),Na=y.define({combine:function t(n){return Object.assign({sources:n.map(function(t){return t.source})},Hl(n.map(function(t){return t.config}),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:function t(n,i){return n?i?function(t){return n(t)||i(t)}:n:i}}))}}),x(Vg,Yt),sc=S(Vg),D(Vg,[{key:"eq",value:function t(n){return n.diagnostic==this.diagnostic}},{key:"toDOM",value:function t(){return I("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}]),Ua=Vg,Ha=D(function t(n,i){A(this,t),this.diagnostic=i,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Wg(n,i,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}),D($g,[{key:"selectedIndex",get:function t(){var n,i,n=this.view.state.field(La).selected;if(n)for(i=0;i<this.items.length;i++)if(this.items[i].diagnostic==n.diagnostic)return i;return-1}},{key:"update",value:function t(){var s,n,i,a,h,f,c,s=this,n=this.view.state.field(La),i=n.diagnostics,a=n.selected,h=0,f=!1,c=null;for(i.between(0,this.view.state.doc.length,function(t,n,i){for(var e,r,o,u,e=i.spec,r=-1,u=h;u<s.items.length;u++)if(s.items[u].diagnostic==e.diagnostic){r=u;break}r<0?(o=new Ha(s.view,e.diagnostic),s.items.splice(h,0,o),f=!0):(o=s.items[r],h<r&&(s.items.splice(h,r-h),f=!0)),a&&o.diagnostic==a.diagnostic?o.dom.hasAttribute("aria-selected")||(o.dom.setAttribute("aria-selected","true"),c=o):o.dom.hasAttribute("aria-selected")&&o.dom.removeAttribute("aria-selected"),h++});h<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();0==this.items.length&&(this.items.push(new Ha(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),c?(this.list.setAttribute("aria-activedescendant",c.id),this.view.requestMeasure({key:this,read:function t(){return{sel:c.dom.getBoundingClientRect(),panel:s.list.getBoundingClientRect()}},write:function t(n){var i=n.sel,n=n.panel;i.top<n.top?s.list.scrollTop-=n.top-i.top:i.bottom>n.bottom&&(s.list.scrollTop+=i.bottom-n.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}},{key:"sync",value:function t(){var n,i,e,r;function o(){var t=n;n=t.nextSibling,t.remove()}n=this.list.firstChild,i=F(this.items);try{for(i.s();!(e=i.n()).done;)if((r=e.value).dom.parentNode==this.list){for(;n!=r.dom;)o();n=r.dom.nextSibling}else this.list.insertBefore(r.dom,n)}catch(t){i.e(t)}finally{i.f()}for(;n;)o()}},{key:"moveSelection",value:function t(n){var i,n;this.selectedIndex<0||(n=Rg((i=this.view.state.field(La)).diagnostics,this.items[n].diagnostic))&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Ta.of(n)})}}],[{key:"open",value:function t(n){return new $g(n)}}]),za=$g,ya=p.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Gg("#d11")},".cm-lintRange-warning":{backgroundImage:Gg("orange")},".cm-lintRange-info":{backgroundImage:Gg("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),x(Jg,en),hc=S(Jg),D(Jg,[{key:"toDOM",value:function t(n){var i,e,r,i=document.createElement("div");return i.className="cm-lint-marker cm-lint-marker-"+this.severity,e=this.diagnostics,r=n.state.facet(Qa).tooltipFilter,(e=r?r(e):e).length&&(i.onmouseover=function(){return Qg(n,i,e)}),i}}]),Wa=Jg,Va=uy({class:"cm-gutter-lint",markers:function t(n){return n.state.field($a)}}),$a=w.define({create:function t(){return j.empty},update:function t(n,i){var e,r,o,u,s;n=n.map(i.changes),e=i.state.facet(Qa).markerFilter,r=F(i.effects);try{for(r.s();!(o=r.n()).done;)(u=o.value).is(Ra)&&(s=u.value,e&&(s=e(s||[])),n=Xg(i.state.doc,s.slice(0)))}catch(t){r.e(t)}finally{r.f()}return n}}),qa=v.define(),Ga=w.define({create:function t(){return null},update:function t(n,i){return n&&i.docChanged&&(n=Ig(i,n)?null:Object.assign(Object.assign({},n),{pos:i.changes.mapPos(n.pos)})),i.effects.reduce(function(t,n){return n.is(qa)?n.value:t},n)},provide:function t(n){return He.from(n)}}),Ja=p.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:qg('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:qg('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:qg('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),Ka=[La,p.decorations.compute([La],function(t){var t=t.field(La),n=t.selected,t=t.panel;return n&&t&&n.from!=n.to?m.set([Ba.range(n.from,n.to)]):m.none}),Q1(_g,{hideOn:Ig}),ya],Qa=y.define({combine:function t(n){return Hl(n,{hoverTime:300,markerFilter:null,tooltipFilter:null})}}),Xa=L.Lint=Object.freeze({__proto__:null,closeLintPanel:_a,diagnosticCount:Bg,forEachDiagnostic:Yg,forceLinting:Hg,lintGutter:Zg,lintKeymap:ma,linter:Ug,nextDiagnostic:t,openLintPanel:Hr,setDiagnostics:Lg,setDiagnosticsEffect:Ra}),Za="function"==typeof String.prototype.normalize?function(t){return t.normalize("NFKD")}:function(t){return t},D(tw,[{key:"peek",value:function t(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Yc(this.buffer,this.bufferPos)}},{key:"next",value:function t(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}},{key:"nextOverlapping",value:function t(){for(var n,i,e,r,o,u,s,a;;){if((n=this.peek())<0)return this.done=!0,this;for(i=tl(n),e=this.bufferStart+this.bufferPos,this.bufferPos+=nl(n),r=this.normalize(i),o=0,u=e;;o++){if(s=r.charCodeAt(o),a=this.match(s,u))return this.value=a,this;if(o==r.length-1)break;u==e&&o<i.length&&i.charCodeAt(o)==s&&u++}}}},{key:"match",value:function t(n,i){var t,e,r,o;for(t=null,e=0;e<this.matches.length;e+=2)r=this.matches[e],o=!1,this.query.charCodeAt(r)==n&&(r==this.query.length-1?t={from:this.matches[e+1],to:i+1}:(this.matches[e]++,o=!0)),o||(this.matches.splice(e,2),e-=2);return this.query.charCodeAt(0)==n&&(1==this.query.length?t={from:i,to:i+1}:this.matches.push(1,i)),t=t&&this.test&&!this.test(t.from,t.to,this.buffer,this.bufferPos)?null:t}}]),Ya=tw,"undefined"!=typeof Symbol&&(Ya.prototype[Symbol.iterator]=function(){return this}),th={from:-1,to:-1,match:/.*/.exec("")},nh="gm"+(null==/x/.unicode?"":"u"),D(nw,[{key:"getLine",value:function t(n){this.iter.next(n),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}},{key:"nextLine",value:function t(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}},{key:"next",value:function t(){for(var n,i,e,r,n=this.matchPos-this.curLineStart;;)if(this.re.lastIndex=n,i=this.matchPos<=this.to&&this.re.exec(this.curLine)){if(r=(e=this.curLineStart+i.index)+i[0].length,this.matchPos=ow(this.text,r+(e==r?1:0)),e==this.curLineStart+this.curLine.length&&this.nextLine(),(e<r||e>this.value.to)&&(!this.test||this.test(e,r,i)))return this.value={from:e,to:r,match:i},this;n=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),n=0}}}]),ih=nw,eh=new WeakMap,D(iw,[{key:"to",get:function t(){return this.from+this.text.length}}],[{key:"get",value:function t(n,i,e){var r,o,o,u,r=eh.get(n);return!r||r.from>=e||r.to<=i?(o=new iw(i,n.sliceString(i,e)),eh.set(n,o),o):r.from==i&&r.to==e?r:(o=r.text,i<(u=r.from)&&(o=n.sliceString(i,u)+o,u=i),r.to<e&&(o+=n.sliceString(r.to,e)),eh.set(n,new iw(u,o)),new iw(i,o.slice(i-u,e-u)))}}]),rh=iw,D(ew,[{key:"chunkEnd",value:function t(n){return(n>=this.to?this:this.text.lineAt(n)).to}},{key:"next",value:function t(){for(var n,i,e,r;;){if(n=this.re.lastIndex=this.matchPos-this.flat.from,(i=this.re.exec(this.flat.text))&&!i[0]&&i.index==n&&(this.re.lastIndex=1+n,i=this.re.exec(this.flat.text)),i&&(r=(e=this.flat.from+i.index)+i[0].length,this.flat.to>=this.to||i.index+i[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,r,i)))return this.value={from:e,to:r,match:i},this.matchPos=ow(this.text,r+(e==r?1:0)),this;if(this.flat.to==this.to)return this.done=!0,this;this.flat=rh.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}]),oh=ew,"undefined"!=typeof Symbol&&(ih.prototype[Symbol.iterator]=oh.prototype[Symbol.iterator]=function(){return this}),uh=v.define(),sh=w.define({create:function t(){return!0},update:function t(n,i){var e,r,o,e=F(i.effects);try{for(e.s();!(r=e.n()).done;)(o=r.value).is(uh)&&(n=o.value)}catch(t){e.e(t)}finally{e.f()}return n},provide:function t(n){return Qe.from(n,function(t){return t?uw:null})}}),r=function t(n){var i,e,i=ny(n,uw);return i||(e=[uh.of(!0)],null==n.state.field(sh,!1)&&e.push(v.appendConfig.of([sh,ah])),n.dispatch({effects:e}),i=ny(n,uw)),i&&i.dom.querySelector("input").focus(),!0},ah=p.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),hh={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},fh=y.define({combine:function t(n){return Hl(n,hh,{highlightWordAroundCursor:function t(n,i){return n||i},minSelectionLength:Math.min,maxMatches:Math.min})}}),ch=m.mark({class:"cm-selectionMatch"}),lh=m.mark({class:"cm-selectionMatch cm-selectionMatch-main"}),vh=u.fromClass((D(fw,[{key:"update",value:function t(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}},{key:"getDeco",value:function t(n){var i,e,r,o,u,s,r,r,a,h,f,c,l,v,d,y,i=n.state.facet(fh),e=n.state,r=e.selection;if(1<r.ranges.length)return m.none;if(s=null,(o=r.main).empty){if(!i.highlightWordAroundCursor)return m.none;if(!(r=e.wordAt(o.head)))return m.none;s=e.charCategorizer(o.head),u=e.sliceDoc(r.from,r.to)}else{if((r=o.to-o.from)<i.minSelectionLength||200<r)return m.none;if(i.wholeWords){if(u=e.sliceDoc(o.from,o.to),!aw(s=e.charCategorizer(o.head),e,o.from,o.to)||!hw(s,e,o.from,o.to))return m.none}else if(!(u=e.sliceDoc(o.from,o.to).trim()))return m.none}a=[],h=F(n.visibleRanges);try{for(h.s();!(f=h.n()).done;)for(c=f.value,l=new Ya(e.doc,u,c.from,c.to);!l.next().done;)if(d=(v=l.value).from,y=v.to,(!s||aw(s,e,d,y))&&(o.empty&&d<=o.from&&y>=o.to?a.push(lh.range(d,y)):(d>=o.to||y<=o.from)&&a.push(ch.range(d,y)),a.length>i.maxMatches))return m.none}catch(t){h.e(t)}finally{h.f()}return m.set(a)}}]),fw),{decorations:function t(n){return n.decorations}}),dh=p.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),yh=function t(n){var i,n,e,r,i=n.state,n=n.dispatch,e=i.selection,r=O.create(e.ranges.map(function(t){return i.wordAt(t.head)||O.cursor(t.head)}),e.mainIndex);return!r.eq(e)&&(n(i.update({selection:r})),!0)},i=function t(n){var i,n,e,r,e,i=n.state,n=n.dispatch,e=i.selection.ranges;return e.some(function(t){return t.from===t.to})?yh({state:i,dispatch:n}):(r=i.sliceDoc(e[0].from,e[0].to),!i.selection.ranges.some(function(t){return i.sliceDoc(t.from,t.to)!=r})&&!!(e=cw(i,r))&&(n(i.update({selection:i.selection.addRange(O.range(e.from,e.to),!1),effects:p.scrollIntoView(e.to)})),!0))},mh=y.define({combine:function t(n){return Hl(n,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:function t(n){return new Ih(n)},scrollToMatch:function t(n){return p.scrollIntoView(n)}})}}),D(vw,[{key:"unquote",value:function t(n){return this.literal?n:n.replace(/\\([nrt\\])/g,function(t,n){return"n"==n?"\n":"r"==n?"\r":"t"==n?"\t":"\\"})}},{key:"eq",value:function t(n){return this.search==n.search&&this.replace==n.replace&&this.caseSensitive==n.caseSensitive&&this.regexp==n.regexp&&this.wholeWord==n.wholeWord}},{key:"create",value:function t(){return new(this.regexp?gh:kh)(this)}},{key:"getCursor",value:function t(n){var i,e,n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length?arguments[2]:void 0,n=n.doc?n:C.create({doc:n});return null==e&&(e=n.doc.length),(this.regexp?pw:dw)(this,n,i,e)}}]),ph=vw,x(mw,rs=D(function t(n){A(this,t),this.spec=n})),cc=S(mw),D(mw,[{key:"nextMatch",value:function t(n,i,e){var e=dw(this.spec,n,e,n.doc.length).nextOverlapping();return(e=e.done?dw(this.spec,n,0,i).nextOverlapping():e).done?null:e.value}},{key:"prevMatchInRange",value:function t(n,i,e){for(var r,o,u,s,r=e;;){for(o=Math.max(i,r-1e4-this.spec.unquoted.length),u=dw(this.spec,n,o,r),s=null;!u.nextOverlapping().done;)s=u.value;if(s)return s;if(o==i)return null;r-=1e4}}},{key:"prevMatch",value:function t(n,i,e){return this.prevMatchInRange(n,0,i)||this.prevMatchInRange(n,e,n.doc.length)}},{key:"getReplacement",value:function t(n){return this.spec.unquote(this.spec.replace)}},{key:"matchAll",value:function t(n,i){for(var e=dw(this.spec,n,0,n.doc.length),r=[];!e.next().done;){if(i<=r.length)return null;r.push(e.value)}return r}},{key:"highlight",value:function t(n,i,e,r){for(var o=dw(this.spec,n,Math.max(0,i-this.spec.unquoted.length),Math.min(e+this.spec.unquoted.length,n.doc.length));!o.next().done;)r(o.value.from,o.value.to)}}]),kh=mw,x(bw,rs),vc=S(bw),D(bw,[{key:"nextMatch",value:function t(n,i,e){var e=pw(this.spec,n,e,n.doc.length).next();return(e=e.done?pw(this.spec,n,0,i).next():e).done?null:e.value}},{key:"prevMatchInRange",value:function t(n,i,e){for(var r,o,u,s,r=1;;r++){for(o=Math.max(i,e-1e4*r),u=pw(this.spec,n,o,e),s=null;!u.next().done;)s=u.value;if(s&&(o==i||s.from>o+10))return s;if(o==i)return null}}},{key:"prevMatch",value:function t(n,i,e){return this.prevMatchInRange(n,0,i)||this.prevMatchInRange(n,e,n.doc.length)}},{key:"getReplacement",value:function t(i){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,function(t,n){return"$"==n?"$":"&"==n?i.match[0]:"0"!=n&&+n<i.match.length?i.match[n]:t}))}},{key:"matchAll",value:function t(n,i){for(var e=pw(this.spec,n,0,n.doc.length),r=[];!e.next().done;){if(i<=r.length)return null;r.push(e.value)}return r}},{key:"highlight",value:function t(n,i,e,r){for(var o=pw(this.spec,n,Math.max(0,i-250),Math.min(e+250,n.doc.length));!o.next().done;)r(o.value.from,o.value.to)}}]),gh=bw,wh=v.define(),bh=v.define(),Mh=w.define({create:function t(n){return new xh(Pw(n).create(),null)},update:function t(n,i){var e,r,o,e=F(i.effects);try{for(e.s();!(r=e.n()).done;)(o=r.value).is(wh)?n=new xh(o.value.create(),n.panel):o.is(bh)&&(n=new xh(n.query,o.value?jw:null))}catch(t){e.e(t)}finally{e.f()}return n},provide:function t(n){return Qe.from(n,function(t){return t.panel})}}),xh=D(function t(n,i){A(this,t),this.query=n,this.panel=i}),Sh=m.mark({class:"cm-searchMatch"}),Ch=m.mark({class:"cm-searchMatch cm-searchMatch-selected"}),os=u.fromClass((D(Sw,[{key:"update",value:function t(n){var i=n.state.field(Mh);(i!=n.startState.field(Mh)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(i))}},{key:"highlight",value:function t(n){var i,e,r,o,u,s,a,h,f,c,i=n.query,e;if(!n.panel||!i.spec.valid)return m.none;for(r=this.view,o=new Ot,u=0,a=(s=r.visibleRanges).length;u<a;u++){for(f=(h=s[u]).from,c=h.to;u<a-1&&c>s[u+1].from-500;)c=s[++u].to;i.highlight(r.state,f,c,function(n,i){var t=r.state.selection.ranges.some(function(t){return t.from==n&&t.to==i});o.add(n,i,t?Ch:Sh)})}return o.finish()}}]),Sw),{decorations:function t(n){return n.decorations}}),jh=Cw(function(t,n){var n,i,n,i,e,n=n.query,i=t.state.selection.main.to,n=n.nextMatch(t.state,i,i);return!!n&&(i=O.single(n.from,n.to),e=t.state.facet(mh),t.dispatch({selection:i,effects:[Rw(t,n),e.scrollToMatch(i.main,t)],userEvent:"select.search"}),Ew(t),!0)}),Ph=Cw(function(t,n){var n,i,e,n,i,e,n=n.query,i=t.state,e=i.selection.main.from,n=n.prevMatch(i,e,e);return!!n&&(i=O.single(n.from,n.to),e=t.state.facet(mh),t.dispatch({selection:i,effects:[Rw(t,n),e.scrollToMatch(i.main,t)],userEvent:"select.search"}),Ew(t),!0)}),Oh=Cw(function(t,n){var i,n,i,n=n.query.matchAll(t.state,1e3);return!(!n||!n.length||(t.dispatch({selection:O.create(n.map(function(t){return O.range(t.from,t.to)})),userEvent:"select.search.matches"}),0))}),Eh=Cw(function(t,n){var n,i,e,r,e,o,u,s,a,h,e,n=n.query,i=t.state,e=i.selection.main,r=e.from,e=e.to;return!i.readOnly&&!!(o=n.nextMatch(i,r,r))&&(u=[],h=[],o.from==r&&o.to==e&&(a=i.toText(n.getReplacement(o)),u.push({from:o.from,to:o.to,insert:a}),o=n.nextMatch(i,o.from,o.to),h.push(p.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(r).number)+"."))),o&&(e=0==u.length||u[0].from>=o.to?0:o.to-o.from-a.length,s=O.single(o.from-e,o.to-e),h.push(Rw(t,o)),h.push(i.facet(mh).scrollToMatch(s.main,t))),t.dispatch({changes:u,selection:s,effects:h,userEvent:"input.replace"}),!0)}),Ah=Cw(function(t,n){var e,n,i,e=n.query;return!t.state.readOnly&&!!(n=e.matchAll(t.state,1e9).map(function(t){var n,i;return{from:t.from,to:t.to,insert:e.getReplacement(t)}})).length&&(i=t.state.phrase("replaced $ matches",n.length)+".",t.dispatch({changes:n,effects:p.announce.of(i),userEvent:"input.replace.all"}),!0)}),Js=[{key:"Mod-f",run:Dh=function t(n){var i,e,r,i=n.state.field(Mh,!1);return i&&i.panel?(e=Ow(n))&&e!=n.root.activeElement&&((r=Pw(n.state,i.query.spec)).valid&&n.dispatch({effects:wh.of(r)}),e.focus(),e.select()):n.dispatch({effects:[bh.of(!0),i?wh.of(Pw(n.state,i.query.spec)):v.appendConfig.of(Bh)]}),!0},scope:"editor search-panel"},{key:"F3",run:jh,shift:Ph,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:jh,shift:Ph,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Rh=function t(n){var i,i,i=n.state.field(Mh,!1);return!(!i||!i.panel||((i=ny(n,jw))&&i.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:bh.of(!1)}),0))},scope:"editor search-panel"},{key:"Mod-Shift-l",run:Ks=function t(n){var i,n,e,e,r,e,o,u,s,i=n.state,n=n.dispatch,e=i.selection;if(1<e.ranges.length||e.main.empty)return!1;for(r=(e=e.main).from,e=e.to,o=[],u=0,s=new Ya(i.doc,i.sliceDoc(r,e));!s.next().done;){if(1e3<o.length)return!1;s.value.from==r&&(u=o.length),o.push(O.range(s.value.from,s.value.to))}return n(i.update({selection:O.create(o,u),userEvent:"select.search.matches"})),!0}},{key:"Alt-g",run:r},{key:"Mod-d",run:i,preventDefault:!0}],D(Aw,[{key:"commit",value:function t(){var n=new ph({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});n.eq(this.query)||(this.query=n,this.view.dispatch({effects:wh.of(n)}))}},{key:"keydown",value:function t(n){o1(this.view,n,"search-panel")?n.preventDefault():13==n.keyCode&&n.target==this.searchField?(n.preventDefault(),(n.shiftKey?Ph:jh)(this.view)):13==n.keyCode&&n.target==this.replaceField&&(n.preventDefault(),Eh(this.view))}},{key:"update",value:function t(n){var i,e,r,o,u,s,i=F(n.transactions);try{for(i.s();!(e=i.n()).done;){o=F((r=e.value).effects);try{for(o.s();!(u=o.n()).done;)(s=u.value).is(wh)&&!s.value.eq(this.query)&&this.setQuery(s.value)}catch(t){o.e(t)}finally{o.f()}}}catch(t){i.e(t)}finally{i.f()}}},{key:"setQuery",value:function t(n){this.query=n,this.searchField.value=n.search,this.replaceField.value=n.replace,this.caseField.checked=n.caseSensitive,this.reField.checked=n.regexp,this.wordField.checked=n.wholeWord}},{key:"mount",value:function t(){this.searchField.select()}},{key:"pos",get:function t(){return 80}},{key:"top",get:function t(){return this.view.state.facet(mh).top}}]),Ih=Aw,Th=30,Lh=/[\s\.,:;?!]/,hs=p.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Bh=[Mh,st.lowest(os),hs],_h=L.Search=Object.freeze({__proto__:null,RegExpCursor:ih,SearchCursor:Ya,SearchQuery:ph,closeSearchPanel:Rh,findNext:jh,findPrevious:Ph,getSearchQuery:Mw,gotoLine:r,highlightSelectionMatches:sw,openSearchPanel:Dh,replaceAll:Ah,replaceNext:Eh,search:lw,searchKeymap:Js,searchPanelOpen:xw,selectMatches:Oh,selectNextOccurrence:i,selectSelectionMatches:Ks,setSearchQuery:wh}),L.basicSetup=[py(),fr,C1(),Hk(),Km(),m1(),w1(),C.allowMultipleSelections.of(!0),Im(),Zm(Ur,{fallback:!0}),ip(),yk(),Ok(),U1(),H1(),Ae,sw(),ee.of([].concat(n,yc(Pa),Js,zt,Vr,Nu,ma))]},"./dist/plugins/formulaPanel/editor/common/calcUtil.js":function(B,t,n){var a,o,h,f,c;function i(t,n,i,e,r){var o,u,s,a;void 0===r&&(r=!0),o=i.ignoreError,u=i.Hve,s=i.Jde,i.ignoreError=e,i.Hve=r,i.Jde=!0;try{a=n.parse(i,t)}catch(t){}return i.ignoreError=o,i.Hve=u,i.Jde=s,a}function e(t,n,i){if(t){var e;try{e=n.unparse(i,t)}catch(t){}return e}}function r(t,n,i,e,r){var o,u,o,t,s,o=new a.Parser,u=!0,o=n.Mf?(0,h.Vgt)(o,t,n.Mf,i,e,!0):(o.setParserOption(!0),r.ignoreError=!0,t=t.split(""),s=o.parseToTokens(r,t,!1),s=(0,h.fillBlankToTokens)(s,t),(0,h.getExpressTokenImp)(o,n,r,null,s,t,i,e));return U(o,n)}function u(t,n){var i,e,r,o,u;for(t=t.filter(function(t){return t.endIndex<n}),i=[],e=[],r="",o=0;o<t.length;o++)k(u=t[o])?r=u.text:g(u)?(i.push(r),e.push(0)):w(u)&&(r="",i.pop(),e.pop()),0<i.length&&p(u)&&e[e.length-1]++;if(0<i.length)return{functionName:i.pop(),activeParameter:e.pop()}}function s(t,n){for(var i,n,e,r,o,u,s,i=n.parameters||[],n=i.length||0,o=0;o<i.length;o++)if(i[o].repeatable)void 0===e&&(e=o);else if(void 0!==e){r=o-1;break}return t=void 0!==e&&(void 0===r&&(r=i.length-1),e<=t)?r+(s=(t-e)%(u=r-e+1))+1<n?r+s+1:e+s:t}function l(t,n){t=s(t,n);var n=n.parameters?n.parameters.length:0;return Math.min(t,n-1)}function v(t,n,i,e){return void 0===i&&(i=!0),void 0===e&&(e=!1),t.find(function(t){return d(t,n,i,e)})}function d(t,n,i,e){return void 0===e&&(e=!1),((i=void 0===i?!0:i)?n>=t.index:n>t.index)&&(e?n<=t.endIndex+1:n<t.endIndex+1)}function y(t,n,i){return n<=t.index&&i>=t.endIndex+1}function m(t,n){var i,e,r,o,u,u,s,a,h;for(t=t.filter(function(t){return t.endIndex<n}),i=[],e=[],r=[],o=0;o<t.length;o++)k(u=t[o])?(i.push(u.text.toUpperCase()),e.push([]),r.push(0)):w(u)?(i.pop(),e.pop(),r.pop()):p(u)&&(u=(0,c.lastItem)(i),s=(0,c.lastItem)(r),a=(0,c.lastItem)(e),h=t[o-1],("LAMBDA"===u||"LET"===u&&s%2==0)&&E(h)&&a.push(h.text),r[r.length-1]=s+1);return e.filter(function(t){return 0<t.length}).reduce(function(t,n){return t.concat(n)},[])}function p(t){return t.type===f.TokenType.FunctionArgumentSeparator}function k(t){return t.type===f.TokenType.FunctionName}function g(t){return t.type===f.TokenType.FunctionCallStart}function w(t){return t.type===f.TokenType.FunctionCallEnd}function b(t){return t.type===f.TokenType.SubExpressionStart}function M(t){return t.type===f.TokenType.SubExpressionEnd}function x(t){return t.type===f.TokenType.FormulaStart}function S(t){return t.type===f.TokenType.Unknown}function C(t){return S(t)&&T(t.text)===c.LEFT_PARENTHESES}function j(t){return S(t)&&T(t.text)===c.RIGHT_PARENTHESES}function P(t){return E(t)||D(t)}function O(t){return t.type===f.TokenType.OperatorInfix}function _(t){return t.type===f.TokenType.OperatorPrefix}function F(t){return t.type===f.TokenType.Whitespace}function E(t){return t.type===f.TokenType.Name}function A(t){return t.type===f.TokenType.OperatorPostfix&&"#"===t.text}function D(t){return t.type===f.TokenType.CellReference}function R(t){return P(t)&&t.ranges&&0<t.ranges.length}function I(t){for(var n,i,n=0,i=0;i<t.length&&t[i]===c.WHITESPACE;i++)n++;return n}function N(t,n,i){var t,e,r,o,u,s;for(void 0===i&&(i=4),t=I(t),e=[],r=function(){return 0===e.length},o=function(){return e[e.length-1]},u=0;u<n.length;u++)g(s=n[u])||b(s)?e.push(s):w(s)?!r()&&g(o())&&e.pop():M(s)&&!r()&&b(o())&&e.pop();return 0<e.length&&(t+=i),t}function T(t){return t.replace(/\s+/g,"")}function U(t,n){for(var i,e,r,o,u,s,i=[],e=[],r=!1,o=0;o<t.length;o++)(s=H(u=t[o],r))===f.TokenType.ArrayConstStart?(e.push(s),r=!0):s===f.TokenType.FunctionCallStart?(e.push(s),r=!1):s!==f.TokenType.FunctionCallEnd&&s!==f.TokenType.ArrayConstEnd||(e.pop(),r=(0,c.lastItem)(e)===f.TokenType.ArrayConstStart),i.push({type:s,index:u.index,endIndex:u.endIndex,text:u.text,ranges:u.ranges,canDrag:u.canDrag,colorIndex:u.colorIndex});return z(W(i),n)}function H(t,n){var i,e,r,i=t.type,e=t.subType,r=t.text.trim();return 1===i?1===e?"ARRAY"===r?f.TokenType.ArrayConstStart:"@"===r||r===c.LEFT_PARENTHESES?f.TokenType.FunctionCallStart:f.TokenType.FunctionName:2===e?r!==c.RIGHT_PARENTHESES&&n?f.TokenType.ArrayConstEnd:f.TokenType.FunctionCallEnd:(0,o.Df)(r)?f.TokenType.FormulaStart:void 0:3!==i?4===i?f.TokenType.OperatorPrefix:5===i?f.TokenType.OperatorInfix:6===i?f.TokenType.OperatorPostfix:0===i?5===e?f.TokenType.LogicalConst:4===e?f.TokenType.NumberConst:3===e?f.TokenType.StringConst:6===e?f.TokenType.ErrorConst:7===e||12===e?t.isName?f.TokenType.Name:f.TokenType.CellReference:f.TokenType.StringConst:2===i?1===e?f.TokenType.SubExpressionStart:2===e?f.TokenType.SubExpressionEnd:void 0:7===i?f.TokenType.Whitespace:f.TokenType.Unknown:0===e?n&&r===c.COMMA?f.TokenType.ArrayConstItemSeparator:n&&r===c.SEMICOLON?f.TokenType.ArrayConstRowSeparator:f.TokenType.FunctionArgumentSeparator:void 0}function z(t,n){for(var i,e,r,o,i=t.length-2;0<i;i--)e=t[i],A(r=t[i+1])&&D(e)&&R(e)&&(o=new a.CalcReference(n,e.ranges).getSpillRef())&&o.$gt&&(e.text+=r.text,e.endIndex=r.endIndex,e.ranges=o.$gt,t.splice(i+1,1));return t}function W(t){for(var n,i,e,r,o,u,s,r,n=[],i=0;i<t.length;i++)V((e=t[i]).type)&&(r=e.text.match(/^(\s*)(\S+)(\s*)$/))&&4===r.length&&(o=r[0],u=r[1],s=r[2],r=r[3],u||r)?(u&&(e.index+=u.length,e.text=e.text.substring(u.length),n.push(L(e.index,u))),n.push(e),r&&(e.endIndex-=r.length,e.text=e.text.substring(0,s.length),n.push(L(e.endIndex+1,r)))):n.push(e);return n}function V(t){return t===f.TokenType.FunctionCallStart||t===f.TokenType.FunctionCallEnd||t===f.TokenType.ArrayConstStart||t===f.TokenType.ArrayConstEnd}function L(t,n){return{type:f.TokenType.Whitespace,index:t,endIndex:t+n.length-1,text:n}}function $(){return a.Functions.findGlobalFunctions()}Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalFunctions=t.removeWhiteSpace=t.getIndentByPreviousText=t.getLineIndent=t.hasReferenceRanges=t.isReferenceToken=t.isAnchorOperatorToken=t.isNameToken=t.isWhitespaceToken=t.isPrefixOperatorToken=t.isInfixOperatorToken=t.isReferenceOrNameToken=t.isRightParenthesesToken=t.isLeftParenthesesToken=t.isNothingOperandToken=t.isFormulaStartToken=t.isSubExpressionEndToken=t.isSubExpressionStartToken=t.isFunctionCallEndToken=t.isFunctionCallStartToken=t.isFunctionCallToken=t.isFunctionArgumentSeparator=t.getLocalSymbol=t.includeToken=t.isInToken=t.getTokenByPos=t.getActiveParameterInSignatureTip=t.getActiveParameterInParameterResources=t.getSignatureStatus=t.parseToTokens=t.unparse=t.parse=void 0,a=n("CalcEngine"),o=n("Core"),h=n("SheetsCalc"),f=n("./dist/plugins/formulaPanel/editor/interface.js"),c=n("./dist/plugins/formulaPanel/editor/common/util.js"),t.parse=i,t.unparse=e,t.parseToTokens=r,t.getSignatureStatus=u,t.getActiveParameterInParameterResources=s,t.getActiveParameterInSignatureTip=l,t.getTokenByPos=v,t.isInToken=d,t.includeToken=y,t.getLocalSymbol=m,t.isFunctionArgumentSeparator=p,t.isFunctionCallToken=k,t.isFunctionCallStartToken=g,t.isFunctionCallEndToken=w,t.isSubExpressionStartToken=b,t.isSubExpressionEndToken=M,t.isFormulaStartToken=x,t.isNothingOperandToken=S,t.isLeftParenthesesToken=C,t.isRightParenthesesToken=j,t.isReferenceOrNameToken=P,t.isInfixOperatorToken=O,t.isPrefixOperatorToken=_,t.isWhitespaceToken=F,t.isNameToken=E,t.isAnchorOperatorToken=A,t.isReferenceToken=D,t.hasReferenceRanges=R,t.getLineIndent=I,t.getIndentByPreviousText=N,t.removeWhiteSpace=T,t.getGlobalFunctions=$},"./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js":function(L,t,n){var i,r,e,o,u,s,a,h,f,c;function l(t){return t.field(o.tokenField)}function v(t){return t.doc.toJSON().join("\n")}function d(t){return t.field(o.providerField).getFunctions()}function y(t,n){return(0,u.findFunction)(d(t),n)}function m(t){return d(t).map(u.convertToFunctionResource)}function p(t,n){return(0,u.findFunctionResource)(m(t),n)}function k(t){return t.field(o.customNamesField)}function g(t,n){return n=n.toUpperCase(),k(t).find(function(t){return t.getName().toUpperCase()===n})}function w(t){var n,t,t,n,t=t.field(o.themeField).rules.find(function(t){return t.token===e.SyntaxHighlightingTokenType.reference}),t=t?t.color:"black";return Array.isArray(t)?t:[t]}function b(t,n,i){return t.find(function(t){return(0,s.isInToken)(t,n,!0,!0)&&M(t,i)})}function M(t,n){var t=C(t.text,n);return t&&t.type===r.ExpressionType.reference}function x(t){var n,i,t,n,n=t.field(o.calcServiceField),i=t.field(o.calcSourceField),t=t.field(o.activeCellField),n=n.getParserContext(i);return n.row=t.row,n.column=t.col,n}function S(t,n){var i,e,r,e;return t.field(o.isFormulaField)?(i=t.field(o.calcSourceField),r=(e=t.field(o.activeCellField)).row,e=e.col,(0,s.parseToTokens)(n,i,r,e,x(t))):[]}function C(t,n,i){void 0===i&&(i=!1);var n=x(n);return(0,s.parse)(t,new r.Parser,n,!i)}function j(t,n){var n=x(n);return(0,s.unparse)(t,new r.Parser,n)}function P(t){return t.field(o.optionsField)}function O(t){var t=P(t);return c(t.tabSize)?f.DEFAULT_TAB_SIZE:t.tabSize}function E(t){var t=P(t);return c(t.formatWidthLimit)?f.DEFAULT_FORMAT_WIDTH_LIMIT:t.formatWidthLimit}function A(t){return u.WHITESPACE.repeat(O(t))}function D(t){var t=t.field(o.calcSourceField).Mf;if(t)return(0,a.Kde)(t.parent)||t}function R(t){return t.selection.main}function I(t){return t.field(o.providerField).getStructReferences()}function T(t,n,i){var e,t,n,i;return n===i||!!((0,h.kf)(n)&&(0,h.kf)(i)&&(e=new r.Parser,t=x(t),n=(0,s.unparse)((0,s.parse)(n,e,t,!1,!1),e,t),i=(0,s.unparse)((0,s.parse)(i,e,t,!1,!1),e,t),n)&&i&&n===i)}Object.defineProperty(t,"__esModule",{value:!0}),t.isSameFormula=t.getStructReferencesByState=t.getSelection=t.getActiveSheetByState=t.getOneIndentSpaceByState=t.getFormatWidthLimitByState=t.getTabSizeByState=t.getOptionsByState=t.unparseToText=t.parseToExpressionTree=t.parseToTokens=t.getParseContextByState=t.isValidReferenceToken=t.getValidReferenceTokenByPos=t.getReferenceTokenColors=t.getCustomNameByState=t.getCustomNamesByState=t.getFunctionResourceByState=t.getFunctionResourcesByState=t.getFunctionByState=t.getFunctionsByState=t.getTextByState=t.getTokensByState=void 0,i=n("Common"),r=n("CalcEngine"),e=n("./dist/plugins/formulaPanel/editor/interface.js"),o=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),u=n("./dist/plugins/formulaPanel/editor/common/util.js"),s=n("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),a=n("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),h=n("Core"),f=n("./dist/plugins/formulaPanel/editor/common/const.js"),c=i.Common.lt.ht,t.getTokensByState=l,t.getTextByState=v,t.getFunctionsByState=d,t.getFunctionByState=y,t.getFunctionResourcesByState=m,t.getFunctionResourceByState=p,t.getCustomNamesByState=k,t.getCustomNameByState=g,t.getReferenceTokenColors=w,t.getValidReferenceTokenByPos=b,t.isValidReferenceToken=M,t.getParseContextByState=x,t.parseToTokens=S,t.parseToExpressionTree=C,t.unparseToText=j,t.getOptionsByState=P,t.getTabSizeByState=O,t.getFormatWidthLimitByState=E,t.getOneIndentSpaceByState=A,t.getActiveSheetByState=D,t.getSelection=R,t.getStructReferencesByState=I,t.isSameFormula=T},"./dist/plugins/formulaPanel/editor/common/const.js":function(t,n,i){var e,r,o,i;function u(){var t=new e.CalcService;return t.addResolver(new r.SheetReferenceResolver(null)),t.addResolver(new r.StructureReferenceResolver(null)),t}Object.defineProperty(n,"__esModule",{value:!0}),n.defaultTheme=n.defaultSyntaxHighlighRules=n.DEFAULT_ACTIVE_CELL_INFO=n.DEFAULT_FORMULA_EDITOR_OPTIONS=n.defaultCalcSource=n.defaultCalcService=n.DEFAULT_PROVIDER=n.DEFAULT_FORMAT_WIDTH_LIMIT=n.DEFAULT_TAB_SIZE=void 0,e=i("CalcEngine"),r=i("SheetsCalc"),o=i("./dist/plugins/formulaPanel/editor/interface.js"),i=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.DEFAULT_TAB_SIZE=4,n.DEFAULT_FORMAT_WIDTH_LIMIT="auto",n.DEFAULT_PROVIDER={getStructReferences:function(){return[]},getFunctions:i.getGlobalFunctions},n.defaultCalcService=u(),n.defaultCalcSource=new e.CalcSource(n.defaultCalcService),n.DEFAULT_FORMULA_EDITOR_OPTIONS={formatWidthLimit:n.DEFAULT_FORMAT_WIDTH_LIMIT,tabSize:n.DEFAULT_TAB_SIZE},n.DEFAULT_ACTIVE_CELL_INFO={row:0,col:0},n.defaultSyntaxHighlighRules=[{token:o.SyntaxHighlightingTokenType.stringConst,color:"#CC1C1C"},{token:o.SyntaxHighlightingTokenType.errorConst,color:"#CC1C1C"},{token:o.SyntaxHighlightingTokenType.numberConst,color:"#088000"},{token:o.SyntaxHighlightingTokenType.booleanConst,color:"#088000"},{token:o.SyntaxHighlightingTokenType.function,color:"#1C1CFF"},{token:o.SyntaxHighlightingTokenType.argumentSeparator,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorPrefix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorInfix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.operatorPostfix,color:"#FF0000"},{token:o.SyntaxHighlightingTokenType.reference,color:["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"]}],n.defaultTheme={rules:n.defaultSyntaxHighlighRules}},"./dist/plugins/formulaPanel/editor/common/formatter.js":function(t,n,i){var r,v,o,d,y,m;function e(t,n){var i,e,t,e,i=new v.Parser,e=n.parseContext,t=(0,o.parse)(t,i,e,!1,!1);if(t)return e=r(r({parser:i,oneIndentTab:d.WHITESPACE.repeat(n.tabSize)},n),u()),d.EQUAL+p(t,0,e,d.EQUAL)}function u(){return{arrayListSeparator:v.Parser.arrayListSeparator||d.COMMA,arrayGroupSeparator:v.Parser.arrayGroupSeparator||d.SEMICOLON,listSeparator:v.Parser.listSeparator||d.COMMA,numberDecimalSeparator:v.Parser.numberDecimalSeparator||d.FULL_STOP}}function p(t,n,i,e,r,o){var u,u,s;return void 0===e&&(e=""),void 0===r&&(r=""),void 0===o&&(o=!0),t?(u=f(t,i),C(u=S(n,i,o)+u,i,e,r)&&((s=t.type)===v.ExpressionType.operator?u=a(t,n,i,e,r,o):s===v.ExpressionType.function?u=l(t,n,i,e,r,o):s===v.ExpressionType.parentheses?u=b(t,n,i,o):s===v.ExpressionType.array&&(u=g(t,n,i,o))),u):""}function f(t,n){var i,e;return t?(i=t.type)===v.ExpressionType.operator?s(t,n):i===v.ExpressionType.function?k(t,n):i===v.ExpressionType.parentheses?d.LEFT_PARENTHESES+f(t.value,n)+d.RIGHT_PARENTHESES:(i===v.ExpressionType.array?w:M)(t,n):""}function a(t,n,i,e,r,o){var u,s,u,a,o,h,u=t.operatorType,s=A(u),u=O(u)?S(n,i,o)+s+p(t.value,n,i,e,r,!1):2===u?p(t.value,n,i,e,s+r,o)+s:18===u?c(t,n,i,o):D(u)?(o=e+(a=p(t.value,n,i,e,d.WHITESPACE+s+m+r))+d.WHITESPACE+s,C(h=f(t.value2,i),i,o+d.WHITESPACE,r)?(h=p(t.value2,n+1,i,o+m,r),a+d.WHITESPACE+s+m+h):a+d.WHITESPACE+s+d.WHITESPACE+h):(a=p(t.value,n,i,e,r))+s+(h=p(t.value2,n,i,e+a+s,r,!1));return u}function s(t,n){var i,e,t,r,o,i=t.operatorType,e=A(i),t=O(i)?e+f(t.value,n):2===i?f(t.value,n)+e:(r=f(t.value,n),o=f(t.value2,n),18===i?h(t,n):D(i)?r+d.WHITESPACE+e+d.WHITESPACE+o:r+e+o);return t}function c(t,n,i,e){return S(n,i,e)+M(t,i)}function h(t,n){return M(t,n)}function l(t,n,i,e,r,o){var u,s,a,h,f,c,l,u=S(n,i,o),s=(0,v.isFunction)(t.function)&&t.function.name||t.functionName;if(s===y)return p(t.arguments[0],n,i,e,"#"+r,o)+"#";if("@"===s)return u+"@"+p(t.arguments[0],n,i,e+u+"@",r,!1);if(a=!s&&t.function instanceof v.Expression?p(t.function,n,i,e,r,o)+d.LEFT_PARENTHESES:u+s+d.LEFT_PARENTHESES,0===(f=(h=t.arguments||[]).length))return a+d.RIGHT_PARENTHESES;for(a+=m,c=0;c<f;c++)a+=p(l=h[c],n+1,i),c!==f-1&&(a+=i.listSeparator),a+=m;return a+S(n,i)+d.RIGHT_PARENTHESES}function k(t,n){var i,e,r,o,u,s,i=(0,v.isFunction)(t.function)&&t.function.name||t.functionName;if(i===y)return f(t.arguments[0],n)+"#";if("@"===i)return"@"+f(t.arguments[0],n);for(e=!i&&t.function instanceof v.Expression?f(t.function,n)+d.LEFT_PARENTHESES:R(i)+d.LEFT_PARENTHESES,o=(r=t.arguments||[]).length,u=0;u<o;u++)e+=f(s=r[u],n),u!==o-1&&(e+=n.listSeparator+d.WHITESPACE);return e+d.RIGHT_PARENTHESES}function g(t,n,i,e){for(var r,o,u,t,s,a,h,f,r=t.value,o=r.getRowCount(),u=r.getColumnCount(),t=S(n,i,e),s=S(n+1,i),a=t+d.LEFT_CURLY_BRACKETS+m,h=0;h<o;h++){for(a+=s,f=0;f<u;f++)a+=x(r.getValue(h,f),i),f!==u-1&&(a+=i.arrayListSeparator+d.WHITESPACE);h!==o-1&&(a+=i.arrayGroupSeparator),a+=m}return a+S(n,i)+d.RIGHT_CURLY_BRACKETS}function w(t,n){for(var i,e,r,o,u,s,i=t.value,e=i.getRowCount(),r=i.getColumnCount(),o=d.LEFT_CURLY_BRACKETS,u=0;u<e;u++){for(s=0;s<r;s++)o+=x(i.getValue(u,s),n),s!==r-1&&(o+=n.arrayListSeparator+d.WHITESPACE);u!==e-1&&(o+=n.arrayGroupSeparator+d.WHITESPACE)}return o+d.RIGHT_CURLY_BRACKETS}function b(t,n,i,e){var t,r,t=p(t.value,n+1,i),r;return S(n,i,e)+d.LEFT_PARENTHESES+m+t+m+S(n,i)+d.RIGHT_PARENTHESES}function M(t,n){var i=[];return n.parser.unparse(n.parseContext,t,i),i.join("")}function x(t,n){var i,i;return"string"==typeof t?i=v.ExpressionType.string:"boolean"==typeof t?i=v.ExpressionType.boolean:"number"==typeof t&&(i=v.ExpressionType.number),void 0===i?t.toString():((i=new v.Expression(i)).value=t,M(i,n))}function S(t,n,i){return(i=void 0===i?!0:i)?n.oneIndentTab.repeat(t):""}function C(t,n,i,e){var i;return t.trim().length>n.widthLimit||(i=j(i)+t+P(e),n.measureTextFunc(i)>n.lineWidthLimit)}function j(t){var n=t.lastIndexOf(m);return-1===n?t:t.substring(n+1)}function P(t){var n=t.indexOf(m);return-1===n?t:t.substring(0,n)}function O(t){return 0===t||1===t}function E(t){return 2===t}function A(t){return v.Z9t[t]}function D(t){return 15!==t&&16!==t&&17!==t&&18!==t}function R(t){var n,n,n=(0,v.getMapping)()&&(0,v.getMapping)().builtInFunctionsMapping,n=n&&n[t];return t=n&&n.alias?n.alias:t}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,e,r,i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.format=void 0,v=i("CalcEngine"),o=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),d=i("./dist/plugins/formulaPanel/editor/common/util.js"),y="ANCHORARRAY",m="\n",n.format=e},"./dist/plugins/formulaPanel/editor/common/spreadUtil.js":function(t,n,i){var e,r;function o(t){if(t)return(0,e.jf)(t)}function u(t){var i,n,e,i=(0,r.getGlobalFunctions)(),n=function(n){Object.keys(n).forEach(function(t){i.push(n[t])})};return t&&(n(t.Amt),(e=o(t))&&n(e.Amt),t.options.allowDynamicArray||(i=i.filter(function(t){return!t.isDynamicArrayFunction}))),i}Object.defineProperty(n,"__esModule",{value:!0}),n.getFunctionsByWorkbook=n.Kde=void 0,e=i("Core"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.Kde=o,n.getFunctionsByWorkbook=u},"./dist/plugins/formulaPanel/editor/common/util.js":function(t,n,i){var u,e,i,e,r;function o(t){var n,n=(n=t.description())&&s(n);return{name:t.name,description:null==n?void 0:n.description,parameters:null==n?void 0:n.parameters}}function s(t){for(var n,i,e,r,o,n=[],i=t.parameters||[],e=0;e<i.length;e++)(o=2<(r=u({},i[e])).name.length&&r.name.startsWith("[")&&r.name.endsWith("]"))&&(r.optional=!0,r.name=r.name.substring(1,r.name.length-1)),r.repeatable&&(r.optional=!0),n.push(r);return u(u({},t),{parameters:n})}function a(t,n){return n=n.toUpperCase(),(t||[]).find(function(t){return t.name.toUpperCase()===n})}function h(t,n){return n=n.toUpperCase(),(t||[]).find(function(t){return t.name.toUpperCase()===n})}function f(t){return t&&0!==t.length?t.map(c).join(", "):""}function c(t){var n=t.name;return t.optional&&(n="["+n+"]"),n=t.repeatable?"..."+n:n}function l(t){var n=t.name;return t.repeatable&&(n+=", ..."),n=t.optional?"["+n+"]":n}function v(t){return"".concat(t.name,"(").concat(f(t.parameters),")")}function d(t){return"(".concat(r().FORMULA," ").concat(v(t))}function y(t){return t[t.length-1]}function m(t){return"gc-formula-editor-tooltip-help-function-"+t}function p(t,n){var e,i,r,o,u,s,e=document.createElement("p");for(e.className=m("title"),(i=function(t,n){var i=document.createElement("span");return i.className=n,i.textContent=t,e.appendChild(i),i})(t.name,(r=function(t){return m("title-"+t)})("function-name")),i("(",r("parentheses")),o=t.parameters||[],u=0;u<o.length;u++)s=r("parameter"),void 0!==n&&n===u&&(s+=" "+r("active-parameter")),i(l(o[u]),s),u!==o.length-1&&i(",",r("parameter-separator"));return i(")",r("parentheses")),e}function k(t){var n=document.createElement("p");return n.textContent=t,n.className=m("description"),n}u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var n,i,e,r,i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.createHelpFunctionDescriptionDom=n.createHelpFunctionTitleDom=n.lastItem=n.getFunctionHoverTitle=n.getFunctionSignatureString=n.getParameterString=n.getParameterListString=n.findFunctionResource=n.findFunction=n.normalizeFunctionDescription=n.convertToFunctionResource=n.END_OF_LINE=n.WHITESPACE=n.RIGHT_CURLY_BRACKETS=n.LEFT_CURLY_BRACKETS=n.RIGHT_PARENTHESES=n.LEFT_PARENTHESES=n.SEMICOLON=n.COMMA=n.FULL_STOP=n.EQUAL=void 0,e=i("Common"),i=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),e=new e.Common.ResourceManager(i.SR,"formulaEditor"),r=e.getResource.bind(e),n.EQUAL="=",n.FULL_STOP=".",n.COMMA=",",n.SEMICOLON=";",n.LEFT_PARENTHESES="(",n.RIGHT_PARENTHESES=")",n.LEFT_CURLY_BRACKETS="{",n.RIGHT_CURLY_BRACKETS="}",n.WHITESPACE=" ",n.END_OF_LINE="\r\n",n.convertToFunctionResource=o,n.normalizeFunctionDescription=s,n.findFunction=a,n.findFunctionResource=h,n.getParameterListString=f,n.getParameterString=c,n.getFunctionSignatureString=v,n.getFunctionHoverTitle=d,n.lastItem=y,n.createHelpFunctionTitleDom=p,n.createHelpFunctionDescriptionDom=k},"./dist/plugins/formulaPanel/editor/editor.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/formulaPanel/editor/editor.res.en.js");n.SR={en:i}},"./dist/plugins/formulaPanel/editor/editor.res.en.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FORMULA=n.INVALID_FORMULA=n.INVALID_EXPRESSION=n.DUPLICATE_IDENTIFIER=n.INVALID_IDENTIFIER_ARGUMENT=n.NO_MATCHED_ARGUMENTS=n.UNKNOWN_SHEET=n.UNKNOWN_NAME=n.MISS_LET_FUNCTION_BODY=n.MISS_RIGHT_PARENTHESES=n.NO_MATH_PARENTHESES=void 0,n.NO_MATH_PARENTHESES="No match parentheses",n.MISS_RIGHT_PARENTHESES="')' is expected.",n.MISS_LET_FUNCTION_BODY="Missing body of LET expression.",n.UNKNOWN_NAME="Unknown name",n.UNKNOWN_SHEET='Unknown sheet "$1"',n.NO_MATCHED_ARGUMENTS="Expected $1 arguments, but got $2",n.INVALID_IDENTIFIER_ARGUMENT="This argument must be an identifier to bind.",n.DUPLICATE_IDENTIFIER="Duplicate identifier $1",n.INVALID_EXPRESSION="Invalid EXPRESSION",n.INVALID_FORMULA="Invalid Formula",n.FORMULA="Formula"},"./dist/plugins/formulaPanel/editor/featureProvider/completion.js":function(t,n,i){var f,c,r,o,l,u,s,i;function a(n,t){var i,t,i,t,i=(0,r.getSignatureStatus)((0,o.getTokensByState)(t.state),t.pos);i&&(t=(0,o.getFunctionResourceByState)(t.state,i.functionName))&&(i=(0,r.getActiveParameterInSignatureTip)(i.activeParameter,t),t=t.parameters&&t.parameters[i])&&t.enum&&t.enum.forEach(function(t){n.push({label:t.value,detail:t.description,type:"enum",apply:t.value})})}function h(n,t){var i,t,e,i=t.state,t=t.pos,e;(0,r.getLocalSymbol)((0,o.getTokensByState)(i),t).forEach(function(t){n.push({label:t,type:"variable",apply:t})})}function v(n,t){var i;(0,o.getCustomNamesByState)(t.state).forEach(function(t){n.push({label:t.getName(),detail:t.getComment()||"",type:"constant",apply:t.getName()})})}function d(n,t){var i;(0,o.getFunctionResourcesByState)(t.state).forEach(function(t){n.push({label:t.name,detail:t.description,type:"function",apply:e})})}function e(t,n,e,r){var o,u,s,a,h,n,o=t.state,u=o.selection.main,s=e-u.from,a=r-u.from,h=n.label,n=o.changeByRange(function(t){var n,i,n=t.from+s,i=t.from+a;return t!==u&&e!==r&&o.sliceDoc(n,i)!==o.sliceDoc(e,r)?{range:t}:{changes:{from:n,to:r===u.from?t.to:i,insert:h+"()"},range:c.State.EditorSelection.cursor(n+h.length+1)}});t.dispatch(f(f({},n),{userEvent:"input.complete",effects:l.triggerSignatureTooltip.of(null)}))}function y(t){return(0,o.getStructReferencesByState)(t.state).map(p)}function m(t,n){var i,i,e,n,i=t.selection.main.head,i=n.text.substring(0,i-n.index);return i&&"["===i[i.length-1]&&(e=i.substring(0,i.length-1),n=(0,o.getStructReferencesByState)(t).find(function(t){return t.name===e}))?n.getColumns().map(p):[]}function p(t){return{label:t.name,detail:t.description,type:"variable"}}function k(t){var n,t,n=t.state.selection.main.head,t=(0,o.getTokensByState)(t.state);return(0,r.getTokenByPos)(t,n,!1,!0)}function g(t){var n,i,e,r,n;return!t.state.field(u.isFormulaField)||(i=k(t))&&i.type===s.TokenType.StringConst?null:(e=t.matchBefore(/\w*/),(r=[]).push.apply(r,m(t.state,i)),a(r,t),e&&e.from===e.to||(h(r,t),d(r,t),v(r,t),r.push.apply(r,y(t))),{from:e?e.from:t.pos,options:r})}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,e,r,i=1,e=arguments.length;i<e;i++)for(r in n=arguments[i])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.autoCompletionExtensions=void 0,c=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),l=i("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),u=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=i("./dist/plugins/formulaPanel/editor/interface.js"),i=c.Autocomplete.autocompletion,n.autoCompletionExtensions=i({override:[g]})},"./dist/plugins/formulaPanel/editor/featureProvider/customField.js":function(t,n,i){var e,r,o,u,s,a,i;function h(t,o){return a.define({create:t,update:function(t,n){for(var i,e,r,i=0,e=n.effects;i<e.length;i++)if((r=e[i]).is(o))return r.value;return t}})}function f(t){return!!t.docChanged||t.effects.some(function(t){return t.is(n.setCalcServiceField)||t.is(n.setCalcSourceField)||t.is(n.setCustomNamesField)||t.is(n.setProviderField)||t.is(n.setActiveCellField)||t.is(n.rebuildFormulaEffect)})}Object.defineProperty(n,"__esModule",{value:!0}),n.needRebuildToken=n.customFields=n.isFormattedFormulaField=n.isFormulaField=n.themeField=n.setThemeField=n.optionsField=n.setOptionsField=n.tokenField=n.rebuildFormulaEffect=n.providerField=n.setProviderField=n.customNamesField=n.setCustomNamesField=n.activeCellField=n.setActiveCellField=n.calcSourceField=n.setCalcSourceField=n.calcServiceField=n.setCalcServiceField=void 0,e=i("Core"),r=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=i("./dist/plugins/formulaPanel/editor/common/const.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),a=r.State.StateField,i=r.State.StateEffect,n.setCalcServiceField=i.define(),n.calcServiceField=h(function(){return u.defaultCalcService},n.setCalcServiceField),n.setCalcSourceField=i.define(),n.calcSourceField=h(function(){return u.defaultCalcSource},n.setCalcSourceField),n.setActiveCellField=i.define(),n.activeCellField=h(function(){return u.DEFAULT_ACTIVE_CELL_INFO},n.setActiveCellField),n.setCustomNamesField=i.define(),n.customNamesField=h(function(){return[]},n.setCustomNamesField),n.setProviderField=i.define(),n.providerField=h(function(){return u.DEFAULT_PROVIDER},n.setProviderField),n.rebuildFormulaEffect=i.define(),n.tokenField=a.define({create:function(t){return(0,o.parseToTokens)(t,(0,o.getTextByState)(t))},update:function(t,n){return f(n)?(0,o.parseToTokens)(n.state,(0,o.getTextByState)(n.state)):t}}),n.setOptionsField=i.define(),n.optionsField=h(function(){return u.DEFAULT_FORMULA_EDITOR_OPTIONS},n.setOptionsField),n.setThemeField=i.define(),n.themeField=h(function(){return u.defaultTheme},n.setThemeField),n.isFormulaField=a.define({create:function(t){return(0,e.kf)((0,o.getTextByState)(t))},update:function(t,n){return n.docChanged?(0,e.kf)((0,o.getTextByState)(n.state)):t}}),n.isFormattedFormulaField=a.define({create:function(){return!0},update:function(t,n){return n.docChanged?!!n.annotation(s.formatDocumentAnnotation):t}}),n.customFields=[n.optionsField,n.themeField,n.isFormulaField,n.isFormattedFormulaField,n.activeCellField,n.calcServiceField,n.calcSourceField,n.customNamesField,n.providerField,n.tokenField],n.needRebuildToken=f},"./dist/plugins/formulaPanel/editor/featureProvider/dbClickRangeSelector.js":function(t,n,i){var e,o,u,s,a;Object.defineProperty(n,"__esModule",{value:!0}),n.doubleClickSelectRangeExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),u=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),a=e.State.EditorSelection,n.doubleClickSelectRangeExtension=e.View.EditorView.mouseSelectionStyle.of(function(e,t){var n,i,r,n;return!e.state.field(s.isFormulaField)||2!==t.detail||0!==t.button||null===(i=e.posAtCoords(t))?null:(r=e.state.selection,{get:function(t,n,i){var t,t,t,t=e.posAtCoords(t);return null!==t&&(t=(0,o.getTokenByPos)((0,u.getTokensByState)(e.state),t))?(t=a.range(t.index,t.endIndex+1),i?r.addRange(t):a.create([t])):r},update:function(t){i=t.changes.mapPos(i),r=r.map(t.changes)}})})},"./dist/plugins/formulaPanel/editor/featureProvider/folding.js":function(t,n,i){var e,f;Object.defineProperty(n,"__esModule",{value:!0}),n.foldExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),f=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n.foldExtension=e.Language.foldService.of(function(t,n,i){for(var e,r,o,n,u,s,a,h,e=t.doc.lineAt(n),r=t.doc.lines,o=(0,f.getLineIndent)(e.text),n=n,u=i,s=e.number+1;s<r&&(a=t.doc.line(s),o<(h=(0,f.getLineIndent)(a.text)));s++)u=a.to;return t.doc.lineAt(n).number===t.doc.lineAt(u).number?null:{from:n=e.to,to:u}})},"./dist/plugins/formulaPanel/editor/featureProvider/formatter.js":function(t,a,n){var i,h,f,c,l,v,e;function d(t,n,i,e){var r,o,u,t,r=s(t),o=s(n),u=n.length,t=function(t,n){var i,e;for(t-=r[t],i=0;i<o.length;i++){if((e=i-o[i])===t&&!n){t=i;break}if(t<e){t=i-1;break}}return t<=u&&0<=t?t:0};return i===e?i=e=t(e,!1):(i=t(i,!0),e=t(e,!1)),[i,e]}function s(t){for(var n,i,e,r,n=function(t){return" "===t||"\n"===t},i=[0],e=1;e<=t.length;e++)r=i[e-1],i.push(r+(n(t[e-1])?1:0));return i}function y(t){var n,i,e,t,t,n,i,e=r(t.scrollDOM.getBoundingClientRect(),t.contentDOM.getBoundingClientRect()),t=t.contentDOM.querySelector(".cm-line");return t&&(t=window.getComputedStyle(t),e-=parseInt(t.paddingLeft,10)+parseInt(t.paddingRight,10)),e}function r(t,n){var i,e,t,i=Math.max(t.left,n.left),e,t=Math.min(t.right,n.right)-i;return 0<=t?t:0}function m(t){var n,t,i,e,n,t=window.getComputedStyle(t.contentDOM).font,i,e=document.createElement("canvas").getContext("2d");return e.font=t,function(t){return e.measureText(t).width}}Object.defineProperty(a,"__esModule",{value:!0}),a.formatDocumentCommand=a.formatDocumentAnnotation=void 0,i=n("./dist/plugins/formulaPanel/editor/codemirror/index.js"),h=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),f=n("./dist/plugins/formulaPanel/editor/common/formatter.js"),c=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),l=n("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),v=Number.MAX_SAFE_INTEGER,a.formatDocumentAnnotation=i.State.Annotation.define(),a.formatDocumentCommand=e=function(t){var n,i,e,r,o,u,s,i,e,r,o,n;return!!t.state.field(c.isFormulaField)&&(i=(0,h.getTabSizeByState)(t.state),e=(0,h.getFormatWidthLimitByState)(t.state),r=v,o=function(t){return 0},"auto"===e&&(r=y(t),e=v,o=m(t)),u=t.state.selection.main,i={absoluteReference:!1,parseContext:s=(0,h.getParseContextByState)(t.state),tabSize:i,widthLimit:e,lineWidthLimit:r,measureTextFunc:o},e=(0,h.getTextByState)(t.state),void 0!==(r=(0,f.format)(e,i)))&&(e!==r&&(o=d(e,r,u.from,u.to),t.dispatch({changes:{from:0,to:t.state.doc.length,insert:r},selection:{anchor:o[0],head:o[1]},annotations:[l.notTriggerSignatureTooltip.of(!0),a.formatDocumentAnnotation.of(!0)]})),!0)}},"./dist/plugins/formulaPanel/editor/featureProvider/hoverTooltips.js":function(t,n,i){var e,o,u,s,a;Object.defineProperty(n,"__esModule",{value:!0}),n.hoverTooltipExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),u=i("./dist/plugins/formulaPanel/editor/common/util.js"),s=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),a=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),n.hoverTooltipExtension=e.View.hoverTooltip(function(t,n){var i,e,e,n,r,i;return!t.state.field(a.isFormulaField)||(e=(0,s.getTokensByState)(t.state),!(e=(0,o.getTokenByPos)(e,n)))||(n=[],r=(0,s.getFunctionResourceByState)(t.state,e.text),(0,o.isFunctionCallToken)(e)&&r&&(n.push((0,u.getFunctionHoverTitle)(r)),r.description)&&n.push(r.description),0===n.length)?null:{pos:e.index,end:e.endIndex+1,above:!0,create:function(){var t=document.createElement("div");return t.className="gc-formula-editor-tooltip-help-function",t.appendChild((0,u.createHelpFunctionTitleDom)(r)),r.description&&t.appendChild((0,u.createHelpFunctionDescriptionDom)(r.description)),{dom:t}}}})},"./dist/plugins/formulaPanel/editor/featureProvider/indent.js":function(t,n,i){var e,r,o;Object.defineProperty(n,"__esModule",{value:!0}),n.indentExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),o=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),n.indentExtension=e.Language.indentService.of(function(t,n){var n;return!(n<=0)&&(n=t.lineAt(n-1))&&n.text?(0,r.getIndentByPreviousText)(n.text,(0,o.getTokensByState)(t.state)):0})},"./dist/plugins/formulaPanel/editor/featureProvider/lint.js":function(t,n,i){var e,r,o,s,f,c,a,u,h,i,l;function v(t,n){return l().NO_MATCHED_ARGUMENTS.replace("$1",t+"").replace("$2",n+"")}function d(t){return l().UNKNOWN_SHEET.replace("$1",t)}function y(t){return l().DUPLICATE_IDENTIFIER.replace("$1",t)}function m(t){var n,i,e,r,o,n=[],i;return t.field(h.isFormulaField)?(e=(0,a.getTextByState)(t),P(n,r=(0,a.getTokensByState)(t),t,e),A(n)||((o=(0,a.parseToExpressionTree)(e,t))?w(n,o,t):O(n,r,t,e),(0,a.parseToExpressionTree)(e,t,!0))||A(n)||p(n,0,e.length,l().INVALID_FORMULA),n):[]}function p(t,n,i,e,r){t.push({from:n,to:i,message:e,severity:r=void 0===r?"error":r})}function k(t,n,i,e){p(t,n.index,n.endIndex+1,i,e=void 0===e?"error":e)}function g(t,n,i,e){p(t,n.lit,n.ywt,i,e=void 0===e?"error":e)}function w(t,n,i){if(n){for(;n.type===s.ExpressionType.parentheses;){if(!n.value)return void g(t,n,l().INVALID_EXPRESSION);n=n.value}var e=n.type;e===s.ExpressionType.name?(0,a.getCustomNameByState)(i,n.value)||g(t,n,l().UNKNOWN_NAME,"warning"):e===s.ExpressionType.operator?(n.value&&w(t,n.value,i),n.value2&&w(t,n.value2,i)):e===s.ExpressionType.function?b(t,n,i):e===s.ExpressionType.reference&&j(t,n)}}function b(t,n,i){var e,r,o,u,e=n.functionName;if("LET"===e)M(t,n,i);else if("LAMBDA"===e)x(t,n,i);else for((0,s.isExpression)(n.function)?w(t,n.function,i):(r=(0,a.getFunctionByState)(i,e))?S(t,n,r):(0,a.getCustomNameByState)(i,e)||p(t,n.lit,n.lit+e.length,l().UNKNOWN_NAME,"warning"),o=n.arguments||[],u=0;u<o.length;u++)w(t,o[u],i)}function M(t,n,i){var e,r,o,u,s,e=n.lit,r=n.ywt,o=n.arguments||[];for(o.length<3&&p(t,e,r,v(3,o.length)),3<=o.length&&o.length%2==0&&p(t,e,r,l().MISS_LET_FUNCTION_BODY),u=[],s=0;s<o.length-1;s++)s%2==0?(C(t,o[s],u),u.push(o[s].value)):w(t,o[s],i);w(t,o[o.length-1],i)}function x(t,n,i){var e,r,o,u,s,e=n.lit,r=n.ywt,o=n.arguments||[];for(o.length<1&&p(t,e,r,v(1,o.length)),u=[],s=0;s<o.length-1;s++)C(t,o[s],u),u.push(o[s].value);w(t,o[o.length-1],i)}function S(t,n,i){var e,r,o,i,n,e=n.lit,r=n.ywt,o=i.minArgs||0,i=i.maxArgs!==u?i.maxArgs:Number.MAX_SAFE_INTEGER,n=n.arguments||[];n.length<o?p(t,e,r,v(o,n.length)):n.length>i&&p(t,e,r,v(i,n.length))}function C(t,n,i){var e,r,e=n.lit,r=n.ywt;!n||8!==n.type&&100!==n.type||-1<n.value.indexOf(".")?p(t,e,r,l().INVALID_IDENTIFIER_ARGUMENT):-1!==i.indexOf(n.value)&&p(t,e,r,y(n.value))}function j(t,n){var i,e,i=n.source,e=i&&i.getName();i instanceof s.ErrorSource&&e&&p(t,n.lit,n.lit+e.length,d(e),"warning")}function P(t,n,i,e){for(var r,o,u,s,a,r=[],o=function(t){return(0,f.isFunctionCallStartToken)(t)||(0,f.isSubExpressionStartToken)(t)||(0,f.isLeftParenthesesToken)(t)},u=function(t){return(0,f.isFunctionCallEndToken)(t)||(0,f.isSubExpressionEndToken)(t)||(0,f.isRightParenthesesToken)(t)},s=0;s<n.length;s++)o(a=n[s])?r.push(a):u(a)&&(0<r.length?r.pop():k(t,a,l().NO_MATH_PARENTHESES));0<r.length&&p(t,e.length,e.length,l().MISS_RIGHT_PARENTHESES)}function O(t,n,i,e){for(var r,o,u,s,a,h,h,r=[],o=[],u=[],s=0;s<n.length;s++)a=n[s],(0,f.isFunctionCallToken)(a)?(r.push({token:a}),u.push([])):(0,f.isSubExpressionStartToken)(a)?o.push({token:a}):(0,f.isFunctionCallEndToken)(a)?0===r.length?k(t,a,l().NO_MATH_PARENTHESES):(h=(0,c.lastItem)(r),r.pop(),u.pop(),h.hasError||(h=E(i,e,h.token,a),t.push.apply(t,h),A(h)&&(r.forEach(function(t){t.hasError=!0}),o.forEach(function(t){t.hasError=!0})))):(0,f.isSubExpressionEndToken)(a)?0===o.length?k(t,a,l().NO_MATH_PARENTHESES):o.pop():(0,f.isFunctionArgumentSeparator)(a)?0!==r.length&&(0,c.lastItem)(u).push(a):(0,f.isRightParenthesesToken)(a)&&k(t,a,l().NO_MATH_PARENTHESES);(0<r.length||0<o.length)&&p(t,e.length,e.length,l().MISS_RIGHT_PARENTHESES)}function E(t,n,i,e){var r,o,i,e,n,r=[],o=i.index,i=e.endIndex+1,e=n.substring(o,i),n=(0,a.parseToExpressionTree)(e,t);return n?(b(r,n,t),r.forEach(function(t){t.from+=o,t.to+=o}),(0,a.parseToExpressionTree)(e,t,!0)||A(r)||p(r,o,i,l().INVALID_EXPRESSION)):p(r,o,i,l().INVALID_EXPRESSION),r}function A(t){return t.some(function(t){return"error"===t.severity})}Object.defineProperty(n,"__esModule",{value:!0}),n.getDiagnostic=n.linterExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("Common"),o=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),s=i("CalcEngine"),f=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),c=i("./dist/plugins/formulaPanel/editor/common/util.js"),a=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=void 0,h=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),i=new r.Common.ResourceManager(o.SR,"formulaEditor"),l=i.getResource.bind(i),n.linterExtension=e.Lint.linter(function(t){return m(t.state)},{needsRefresh:function(t){return t.transactions.some(h.needRebuildToken)}}),n.getDiagnostic=m},"./dist/plugins/formulaPanel/editor/featureProvider/readOnly.js":function(t,n,i){var e,r;function o(t,n){t.dispatch({effects:r.reconfigure(e.State.EditorState.readOnly.of(n))})}Object.defineProperty(n,"__esModule",{value:!0}),n.reconfigureReadOnly=n.readOnlyExtension=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=new e.State.Compartment,n.readOnlyExtension=r.of(e.State.EditorState.readOnly.of(!1)),n.reconfigureReadOnly=o},"./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js":function(t,s,n){var i,o,u,a,h,n,e,r,f,c,n;function l(t){var n,n,i,t,e,r,n=t.selection.main;return n&&n.from===n.to&&(n=n.from,i=(0,o.getSignatureStatus)((0,u.getTokensByState)(t),n))&&(t=(0,u.getFunctionResourceByState)(t,i.functionName))?(r=(0,o.getActiveParameterInSignatureTip)(i.activeParameter,e=t),[{pos:n,above:!0,arrow:!0,create:function(){var t=document.createElement("div");return t.className="gc-formula-editor-tooltip-help-function",t.appendChild((0,h.createHelpFunctionTitleDom)(e,r)),e.description&&t.appendChild((0,h.createHelpFunctionDescriptionDom)(e.description)),{dom:t,overlap:!0}}}]):[]}Object.defineProperty(s,"__esModule",{value:!0}),s.signatureTooltipsExtensions=s.closeParameterHintsCommand=s.triggerParameterHintsCommand=s.hasParameterHints=s.notTriggerSignatureTooltip=s.closeSignatureTooltip=s.triggerSignatureTooltip=void 0,i=n("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=n("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),u=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),a=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),h=n("./dist/plugins/formulaPanel/editor/common/util.js"),n=i.State.StateField,s.triggerSignatureTooltip=i.State.StateEffect.define(),s.closeSignatureTooltip=i.State.StateEffect.define(),s.notTriggerSignatureTooltip=i.State.Annotation.define(),e=n.define({create:function(){return[]},update:function(t,n){var i,e,r,o,u,i;if(!n.state.field(a.isFormulaField))return[];if(e=t&&0<t.length,n.annotation(s.notTriggerSignatureTooltip)&&!e)return[];for(r=0,o=n.effects;r<o.length;r++){if((u=o[r]).is(s.closeSignatureTooltip))return[];if(u.is(s.triggerSignatureTooltip))return l(n.state)}return n.docChanged?l(n.state):e?n.selection?l(n.state):t:[]},provide:function(n){return i.View.showTooltip.computeN([n],function(t){return t.field(n)})}}),s.hasParameterHints=r=function(t){return 0<t.state.field(e).length},s.triggerParameterHintsCommand=f=function(t){return t.dispatch({effects:s.triggerSignatureTooltip.of(null)}),!0},s.closeParameterHintsCommand=c=function(t){return!!(0,s.hasParameterHints)(t)&&(t.dispatch({effects:s.closeSignatureTooltip.of(null)}),!0)},n=i.View.EditorView.updateListener.of(function(t){t.focusChanged&&!t.view.hasFocus&&(0,s.closeParameterHintsCommand)(t.view)}),s.signatureTooltipsExtensions=[e,n]},"./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js":function(t,e,n){var i,r,o,u,s,n,a;function h(t){return"gc-formula-editor-token_"+r.SyntaxHighlightingTokenType[t]}function f(t){var n;return t.field(u.isFormulaField)?a.of(l(t)):a.of([])}function c(t,n){var i={};return isNaN(n)||(i[e.TOKEN_INDEX_ATTRIBUTE_NAME]=n),{class:h(t),attributes:i}}function l(t){var n=(0,o.getTokensByState)(t);return v(n,t),n.map(function(t){var n=m(t);return i.View.Decoration.mark(c(n,t.colorIndex)).range(t.index,t.endIndex+1)})}function v(t,n){var i,e,i=[];t.forEach(function(n){var t;((0,s.isReferenceToken)(n)||(0,s.isNameToken)(n)&&(0,s.hasReferenceRanges)(n))&&(t=i.find(function(t){return d(t,n)}),n.colorIndex=t?t.colorIndex:y(i),i.push(n))}),e=(0,o.getReferenceTokenColors)(n).length,i.forEach(function(t){t.colorIndex=t.colorIndex%e})}function d(t,n){return(0,s.removeWhiteSpace)(t.text).toUpperCase()===(0,s.removeWhiteSpace)(n.text).toUpperCase()}function y(t){return t&&0!==t.length?Math.max.apply(Math,t.map(function(t){return t.colorIndex}))+1:0}function m(t){var n,i,n=t.type,i=r.SyntaxHighlightingTokenType.unknown;return n===r.TokenType.NumberConst?i=r.SyntaxHighlightingTokenType.numberConst:n===r.TokenType.StringConst?i=r.SyntaxHighlightingTokenType.stringConst:n===r.TokenType.LogicalConst?i=r.SyntaxHighlightingTokenType.booleanConst:n===r.TokenType.ErrorConst?i=r.SyntaxHighlightingTokenType.errorConst:n===r.TokenType.CellReference?i=r.SyntaxHighlightingTokenType.reference:n===r.TokenType.Name?i=(0,s.hasReferenceRanges)(t)?r.SyntaxHighlightingTokenType.reference:r.SyntaxHighlightingTokenType.name:n===r.TokenType.OperatorPrefix?i=r.SyntaxHighlightingTokenType.operatorPrefix:n===r.TokenType.OperatorInfix?i=r.SyntaxHighlightingTokenType.operatorInfix:n===r.TokenType.OperatorPostfix?i=r.SyntaxHighlightingTokenType.operatorPostfix:n===r.TokenType.Whitespace?i=r.SyntaxHighlightingTokenType.whitespace:n===r.TokenType.FunctionName||n===r.TokenType.FunctionCallStart||n===r.TokenType.FunctionCallEnd?i=r.SyntaxHighlightingTokenType.function:n===r.TokenType.FunctionArgumentSeparator||n===r.TokenType.ArrayConstRowSeparator||n===r.TokenType.ArrayConstItemSeparator?i=r.SyntaxHighlightingTokenType.argumentSeparator:n!==r.TokenType.SubExpressionStart&&n!==r.TokenType.SubExpressionEnd||(i=r.SyntaxHighlightingTokenType.subExpression),i}Object.defineProperty(e,"__esModule",{value:!0}),e.markReferenceTokenColorIndex=e.syntaxHighlightingTokenClassName=e.syntaxHighlightingField=e.TOKEN_INDEX_ATTRIBUTE_NAME=void 0,i=n("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=n("./dist/plugins/formulaPanel/editor/interface.js"),o=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),s=n("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),n=i.State.StateField,a=i.State.RangeSet,e.TOKEN_INDEX_ATTRIBUTE_NAME="data-token-index",e.syntaxHighlightingField=n.define({create:f,update:function(t,n){return f(n.state)},provide:function(t){return i.View.EditorView.decorations.from(t)}}),e.syntaxHighlightingTokenClassName=h,e.markReferenceTokenColorIndex=v},"./dist/plugins/formulaPanel/editor/featureProvider/tab.js":function(t,n,i){var e,r;Object.defineProperty(n,"__esModule",{value:!0}),n.insertTab=void 0,e=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),n.insertTab=r=function(t){var n;return!t.state.readOnly&&!t.state.selection.ranges.some(function(t){return!t.empty})&&(n=(0,e.getOneIndentSpaceByState)(t.state),t.dispatch(t.state.update(t.state.replaceSelection(n),{scrollIntoView:!0,userEvent:"input"})),!0)}},"./dist/plugins/formulaPanel/editor/featureProvider/theme.js":function(t,n,i){var e,r,o,u,s;function a(t){var n=t.autocompletionStyle,t=t.errorStyle;return u.theme({"& .cm-tooltip-autocomplete":{color:n.color,font:n.font,background:n.backgroundColor,border:n.border,"margin-left":"1em"},"& .cm-tooltip-autocomplete ul li":{padding:"5px"},"& .cm-tooltip-autocomplete ul li .cm-completionIcon-function":{color:n.function_icon.color,font:n.function_icon.font},"& .cm-tooltip-autocomplete ul li .cm-completionLabel":{color:n.function_name.color,font:n.function_name.font},"& .cm-tooltip-autocomplete ul li .cm-completionDetail":{color:n.function_name.color,font:n.function_name.font},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionIcon-function":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionLabel":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected] .cm-completionDetail":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip-autocomplete ul li[aria-selected]":{color:n.activeItem.color,background:n.activeItem.backgroundColor},"& .cm-tooltip .cm-tooltip-lint .cm-diagnostic ":{color:t.color,font:t.font,background:t.backgroundColor}})}function h(t){var e,r,e={},r=function(t,n,i){var t,i,t=(0,o.syntaxHighlightingTokenClassName)(t),i=isNaN(i)?"":"[".concat(o.TOKEN_INDEX_ATTRIBUTE_NAME,'="').concat(i,'"]');e["& .".concat(t).concat(i)]=n};return t.forEach(function(i){Array.isArray(i.color)?(r(i.token,{color:i.color[0]}),i.color.forEach(function(t,n){r(i.token,{color:t},n)})):r(i.token,{color:i.color})}),u.theme(e)}function f(t,n){return u.theme({"& .cm-scroller":{"background-color":t.backgroundColor,color:t.color,font:t.font},".cm-cursor, .cm-dropCursor":{borderLeftColor:t.caretColor},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:t.selectionBackColor},"& .cm-activeLine":{"background-color":t.activeLineBackColor},"& .cm-gutters":{"background-color":n.backgroundColor,color:n.color,font:n.font,"user-select":"none"},"& .cm-lineNumbers ":{width:"30px"},'& .cm-foldGutter span[title="Fold line"] ':{"padding-bottom":"8px"},"& .cm-gutterElement":{display:"flex","align-items":"center","justify-content":"flex-end"},"& .cm-activeLineGutter":{"background-color":t.activeLineBackColor},"& .cm-tooltip":{border:"none"}})}function c(t){var n,i,t,e,n=t.rules,i=t.editorContentStyle,t=t.editorGuttersStyle,e=[s];return i&&t&&(e=e.concat([f(i,t),a(i)])),e=n?e.concat(h(n)):e}Object.defineProperty(n,"__esModule",{value:!0}),n.themeExtension=n.createThemeExtension=n.themeCompartment=n.createSyntaxHighlightingTheme=void 0,e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=i("./dist/plugins/formulaPanel/editor/common/const.js"),o=i("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),u=e.View.EditorView,s=u.theme({"&":{height:"100%"},"&.cm-editor.cm-focused":{outline:"none"},"& .cm-line":{"line-height":1.35}}),n.createSyntaxHighlightingTheme=h,n.themeCompartment=new e.State.Compartment,n.createThemeExtension=c,n.themeExtension=n.themeCompartment.of(c(r.defaultTheme))},"./dist/plugins/formulaPanel/editor/featureProvider/toggleAbsoluteRelativeReferences.js":function(t,n,i){var u,e,p,r,o;function k(t,n,i,e,r,o){var t=(0,p.parseToExpressionTree)(t,n);return t.isFullColumn||t.isFullRow?(0,u.lmt)(t,i,e,!0,!0):t.hmt()?(0,u.dmt)(t,i,e):(0,u.lmt)(t,i,e,r,o),(0,p.unparseToText)(t,n)}function g(t,n,i){return(0,e.includeToken)(t,n,i)||(0,e.isInToken)(t,n,!0,!0)||(0,e.isInToken)(t,i,!0,!0)}Object.defineProperty(n,"__esModule",{value:!0}),n.toggleAbsoluteRelativeReferencesCommand=void 0,u=i("FormulaTextBox"),e=i("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),p=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),r=i("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),n.toggleAbsoluteRelativeReferencesCommand=o=function(s){var t,a,n,i,h,f,i,c,l,v,d,y,m,e,t;return!!s.state.field(r.isFormulaField)&&(a=s.state,n=(0,p.getTokensByState)(a),i=a.selection.main,h=i.from,f=i.to,i=a.field(r.activeCellField),c=i.row,l=i.col,v=!1,d=0,y=h,m=f,(e=n.filter(function(t){return g(t,h,f)&&(0,p.isValidReferenceToken)(t,a)})).forEach(function(t){var n,i,e,r,o,o,u,n=t.text.indexOf(":"),i=-1!==n,e=!i||h<=t.index+n,r=!i||f>t.index+n,o=k(t.text,a,c,l,e,r);o&&(s.dispatch({changes:{from:t.index+d,to:t.endIndex+1+d,insert:o}}),d+=o.length-t.text.length,o=t.index,u=t.endIndex+1,!i||e&&r||(e?u=t.index+n:r&&(o=t.index+n+1)),y=Math.min(y,o),m=Math.max(m,u),s.dispatch({selection:{anchor:y,head:m+d}}),v=!0)}),v)}},"./dist/plugins/formulaPanel/editor/formulaEditor-action.js":function(t,r,n){var o,u,s,i,e,a,h,f,c,l,v,d,y,m,n,p;function k(t,n){return{canUndo:n=void 0===n?!1:n,execute:t}}function g(n,t){return k(function(t){return n(t.li.getView())},t=void 0===t?!1:t)}function w(t){var n=o.mt.Qf(),i=!n,n=n;t.register(y,r.Commands[y],27),t.register(f,r.Commands[f],32,i,!0,!1,n),t.register(c,r.Commands[c],27),t.register(l,r.Commands[l],115),t.register(v,r.Commands[v],70,!1,!0,!0),t.register(d,r.Commands[d],83,i,!1,!1,n)}Object.defineProperty(r,"__esModule",{value:!0}),r.registerDefaultCommands=r.Commands=r.executeCommitContextToCellCommand=void 0,o=n("Core"),u=n("FormulaTextBox"),s=n("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),i=n("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),e=n("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),a=n("./dist/plugins/formulaPanel/editor/featureProvider/toggleAbsoluteRelativeReferences.js"),h=n("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),f="showHints",c="closeHints",l="toggleAbsoluteRelativeReferences",v="formatDocument",d="commitContentToActiveCell",y="exitEdit",r.executeCommitContextToCellCommand=m=function(t,n,i,e,r){var e,n;void 0===r&&(r=o.SheetArea.viewport),e=0<e.length?e:null,n={cmd:"editCell",sheetName:t.name(),row:n,col:i,sheetArea:r,newValue:e},t.Qy().execute(n)},n=k(function(t){var n,i,i,t,e,n=(0,s.Kde)(t.Vv);return!!n&&(i=u.Ode.Ede(),(0,h.isFormulaEditorReferencedRangesAcrossSheetContext)(i)?i.Rde(n):(i=t.text(),t=n.getActiveRowIndex(),e=n.getActiveColumnIndex(),(0,r.executeCommitContextToCellCommand)(n,t,e,i)),!0)}),p=k(function(t){var n,i,n=t.workbook();return!(!t.Qde()||!n||((i=t.li.getView()).contentDOM.blur(),(0,h.closeFormulaReferencedRanges)(i.state),n.focus(!1),n.focus(),t.Xde(),0))}),r.Commands={},r.Commands[f]=g(e.triggerParameterHintsCommand),r.Commands[c]=g(e.closeParameterHintsCommand),r.Commands[v]=g(i.formatDocumentCommand),r.Commands[l]=g(a.toggleAbsoluteRelativeReferencesCommand),r.Commands[d]=n,r.Commands[y]=p,r.registerDefaultCommands=w},"./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js":function(t,n,i){var e,r,s,o,i,u;function a(t){t.Dn.kde()}function h(t){var t=t.Nde;return!(!(0,o.isFormulaEditorReferencedRangesContext)(t)||!t.zQt.hasFocus)}function f(t,n,i){var e,r,r,o,o,u,e="";if(t)if(r=(r=t.parent)&&r.options,(o=t.getFormulaInformation(n,i,3))&&o.hasFormula){if(e="="+o.formulaWithCulture,o.isDynamicArray)return"";o.isArrayFormula&&(e="{"+e+"}")}else o=t.getActualStyle(n,i),e="string"==typeof(u=t.getValue(n,i))&&(o.quotePrefix||1<u.length&&"="===u[0]&&r&&r.allowUserEditFormula&&!r.allowInvalidFormula)?"'"+u:s.mt.mi(o,u,t,{sheet:t,row:n,col:i,sheetArea:3})||"";return e}Object.defineProperty(n,"__esModule",{value:!0}),n.getEditText=n.paintFormulaReferencedRanges=void 0,e=i("Common"),r=i("./dist/plugins/formulaPanel/editor/editor.ns.js"),s=i("Core"),o=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),n.paintFormulaReferencedRanges=a,i=new e.Common.ResourceManager(r.SR,"formulaEditor"),u=i.getResource.bind(i),s.Worksheet.ch("formulaEditor",{preProcessKeyDown:function(t){h(this)&&(t.r=!0)},processCompositionStart:function(t){h(this)&&(t.r=!0)}}),n.getEditText=f,s.Workbook.ch("formulaEditor",{onCultureChanged:function(){u()}})},"./dist/plugins/formulaPanel/editor/formulaEditor.js":function(t,e,n){var r,u,o,s,a,h,f,c,l,i,v,d,y,m,p,k,g;function w(t,n){"string"==typeof t&&(t=document.getElementById(t));var i=this;i.Wc=t,i.li=new o.FormulaEditorCore(t,k),i.li.initTheme(),i.Qy=new r.Commands.CommandManager(i),i.tve=i.tve.bind(i),i.tpe=i.tpe.bind(i),i.eve=i.eve.bind(i),i.$ve=i.$ve.bind(i),i.ave=i.ave.bind(i),i.rve=i.rve.bind(i),i.Pve=i.Pve.bind(i),i.rme=i.rme.bind(i),i.Wve=i.Wve.bind(i),i.lme=i.lme.bind(i),i.hme=i.hme.bind(i),i.LEt=y(s.DEFAULT_FORMULA_EDITOR_OPTIONS,i.hme),i.Zp(n),i.sme(),t.addEventListener("keydown",i.tve),(0,a.registerDefaultCommands)(i.Qy),(0,u.GC$)(t).data(e.CONST_FORMULA_EDITOR,i)}function b(t,n,i){return!!M(t,n,i)||!!x(t,n,i)}function M(t,n,i){return t.options.isProtected&&!1!==t.l0(n,i,"locked")}function x(t,n,i){var e,t,e=t.getCellType(n,i);return!(!e||(t={sheet:t,sheetName:t.name(),sheetArea:u.SheetArea.viewport,row:n,col:i},!(t=e.lfe(t,v)).readonly))}Object.defineProperty(e,"__esModule",{value:!0}),e.FormulaEditor=e.CONST_FORMULA_EDITOR=void 0,r=n("Common"),u=n("Core"),o=n("./dist/plugins/formulaPanel/editor/formulaEditorCore.js"),s=n("./dist/plugins/formulaPanel/editor/common/const.js"),a=n("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),h=n("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesExtension.js"),f=n("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),c=n("./dist/plugins/formulaPanel/editor/common/spreadUtil.js"),l=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),i=n("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/structReferences.js"),e.CONST_FORMULA_EDITOR="formula-editor",v=void 0,d=null,y=u.mt.b0,m=u.GC$.extend,p=u.GC$.each,k=[h.formulaReferencedRangesExtension],Object.defineProperty(w.prototype,"options",{get:function(){return this.LEt},set:function(t){if(t&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(this.LEt[n]=t[n])},enumerable:!1,configurable:!0}),w.prototype.text=function(t){if(0===arguments.length)return this.li.getText();this.li.setText(t+"")},w.prototype.workbook=function(){return this.Vv},w.prototype.attach=function(t){var n=this;n.Vv!==t&&(n.detach(),n.Vv=t,n._6(),n.Vv.D3(u.Events.EnterCellInternal,n.tpe),n.Vv.D3(u.Events.CellChanged,n.eve),n.Vv.D3(u.Events.RangeChangedInternal,n.$ve),n.Vv.D3(u.Events.RangeFiltered,n.lme),n.Vv.D3(u.Events.RangeFilterCleared,n.lme),n.Vv.D3(u.Events.ActiveSheetChangingInternal,n.ave),n.Vv.D3(u.Events.ActiveSheetChangedInternal,n.rve),n.Vv.D3(u.Events.SheetOptionsChangedInternal,n.Pve),n.Vv.D3(u.Events.WorkbookOptionsChangedInternal,n.rme),n.Vv.D3(u.Events.CustomNameChangedInternal,n.Wve))},w.prototype.detach=function(){var t=this,n=t.Vv;n&&(n._3(u.Events.EnterCellInternal,t.tpe),n._3(u.Events.CellChanged,t.eve),n._3(u.Events.RangeChangedInternal,t.$ve),n._3(u.Events.RangeFiltered,t.lme),n._3(u.Events.RangeFilterCleared,t.lme),n._3(u.Events.ActiveSheetChangingInternal,t.ave),n._3(u.Events.ActiveSheetChangedInternal,t.rve),n._3(u.Events.SheetOptionsChangedInternal,t.Pve),n._3(u.Events.WorkbookOptionsChangedInternal,t.rme),n._3(u.Events.CustomNameChangedInternal,t.Wve),t.Vv=v,t._6())},w.prototype.format=function(){this.li.format()},w.prototype.commandManager=function(){return this.Qy},w.prototype.destroy=function(){var t=this;t.detach(),t.li.destroy(),t.Wc.removeEventListener("keydown",t.tve),(0,u.GC$)(t.Wc).data(e.CONST_FORMULA_EDITOR,d)},w.prototype.refresh=function(){this.li.initTheme()},w.prototype.getActiveCellInfo=function(){var t,n,t,i,t=this.li.getActiveCellInfo(),n=t.row,t=t.col,i;return{sheet:this.li.getCalcSource().Mf,row:n,col:t}},w.prototype.isFormattedFormula=function(){return this.li.isFormattedFormula()},w.prototype.Qde=function(){return this.li.getView().hasFocus},w.prototype.Xde=function(){var t,n,i,t,e,n,t=this.getActiveCellInfo(),n=t.sheet,i=t.row,t=t.col;n&&(e=this.li,n=(0,f.getEditText)(n,i,t),(0,l.isSameFormula)(e.getView().state,e.getText(),n)||e.setText(n),e.format())},w.prototype.Zp=function(t){var i,t,i=this.LEt,t=t||{};t=m(!0,{},s.DEFAULT_FORMULA_EDITOR_OPTIONS,t),p(t,function(t,n){i.hasOwnProperty(t)&&(i[t]=n)}),this.li.setOptions(i)},w.prototype.sme=function(){var t=this;t.li.setProvider({getStructReferences:function(){return(0,i.getStructReferencesByWorkbook)(t.Vv)},getFunctions:function(){return(0,c.getFunctionsByWorkbook)(t.Vv)}})},w.prototype.tve=function(t){this.uve(t)},w.prototype.tpe=function(){var t=this;t.$me()?t.epe():(t.Xde(),t.Ove())},w.prototype.eve=function(t,n){var i=this.getActiveCellInfo(),e=i.sheet,r=i.row,i=i.col;e===n.sheet&&r===n.row&&i===n.col&&this.Xde()},w.prototype.$ve=function(t,n){var i,e,r,i;n&&(e=(i=this.getActiveCellInfo()).sheet,r=i.row,i=i.col,e===n.sheet)&&new u.Range(n.row,n.col,n.rowCount,n.colCount).contains(r,i)&&this.Xde()},w.prototype.ave=function(t,n){(0,h.lve)(t,n)},w.prototype.rve=function(t,n){var i;(0,h.cve)(t,n)||this._6()},w.prototype.Pve=function(t,n){var i;"isProtected"===n.propertyName&&this.Ove()},w.prototype.rme=function(t,n){var i;"allowDynamicArray"===n.propertyName&&this.li.rebuildFormula()},w.prototype.Wve=function(){this.hve()},w.prototype.lme=function(t,n){var i,i,n,i=null==(i=this.Vv)?void 0:i.getSheetTab(n.sheetName),n=this.li.getCalcSource().Mf;i&&i.Mf===n&&this.Xde()},w.prototype.hme=function(t,n,i){var e;n!==i&&this.li.setOptions(this.LEt)},w.prototype._6=function(){var t=this;t.ive(),t.nve(),t.hve(),t.epe()},w.prototype.ive=function(){var t,t,t=(null==(t=this.Vv)?void 0:t.getCalcService())||s.defaultCalcService;this.li.setCalcService(t)},w.prototype.nve=function(){var t=(0,c.Kde)(this.Vv);t?this.li.setCalcSource(t.Uw()):this.li.setCalcSource(s.defaultCalcSource),this.qme()},w.prototype.hve=function(){var t,n,n,t=[],n=this.Vv;n&&(t.push.apply(t,n.getCustomNames()),n=(0,c.Kde)(n))&&t.push.apply(t,n.getCustomNames()),this.li.setCustomNames(t)},w.prototype.epe=function(){var t,n,t=this,n=t.Jme();t.li.setActiveCellInfo(n),t.Xde(),t.Ove(),t.li.clearHistory(),t.qme()},w.prototype.Ove=function(){var t=(0,c.Kde)(this.Vv);t?this.li.setReadOnly(b(t,t.getActiveRowIndex(),t.getActiveColumnIndex())):this.li.setReadOnly(!1)},w.prototype.$me=function(){var t,n,t=this.li.getActiveCellInfo(),n=this.Jme();return t.row!==n.row||t.col!==n.col},w.prototype.Jme=function(){var t,n,i,t=(0,c.Kde)(this.Vv);return t?{row:n=t.getActiveRowIndex(),col:i=t.getActiveColumnIndex()}:s.DEFAULT_ACTIVE_CELL_INFO},w.prototype.qme=function(){this.options.onActiveCellChanged&&this.options.onActiveCellChanged()},w.prototype.uve=function(t){var n,i,e,r,o,n=this,i=n.Qy.getShortcutKey(t.keyCode,t.ctrlKey,t.shiftKey,t.altKey,t.metaKey),e=n.Qy.getCommands(i);if(e)for(r=0;r<e.length;r++)if(o=e[r].execute(n,{}))return o.ignoreCancelDefault||u.mt.vi(t),!0},e.FormulaEditor=w},"./dist/plugins/formulaPanel/editor/formulaEditorCore.js":function(B,t,n){var i,e,r,o,u,s,a,h,f,c,l,v,d,y,m,p,k,g,w,b,M,x,S,C,_,F,N,U,H,z,W,V,$,q,j,P,G,J,K,O,E,A,D,R,I,T,Q,n,i,X,Z,Y;function tt(){return[e.basicSetup,Z,o.customFields,p.readOnlyExtension,y.themeExtension,f.foldExtension,c.indentExtension,u.syntaxHighlightingField,s.autoCompletionExtensions,a.hoverTooltipExtension,h.signatureTooltipsExtensions,v.doubleClickSelectRangeExtension,d.linterExtension]}function L(t,n){this.Kme=n,this.zQt=new Q({state:this.Qme(""),parent:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.FormulaEditorCore=void 0,i=n("Core"),e=n("./dist/plugins/formulaPanel/editor/codemirror/index.js"),r=n("./dist/plugins/formulaPanel/editor/interface.js"),o=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),u=n("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),s=n("./dist/plugins/formulaPanel/editor/featureProvider/completion.js"),a=n("./dist/plugins/formulaPanel/editor/featureProvider/hoverTooltips.js"),h=n("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),f=n("./dist/plugins/formulaPanel/editor/featureProvider/folding.js"),c=n("./dist/plugins/formulaPanel/editor/featureProvider/indent.js"),l=n("./dist/plugins/formulaPanel/editor/featureProvider/tab.js"),v=n("./dist/plugins/formulaPanel/editor/featureProvider/dbClickRangeSelector.js"),d=n("./dist/plugins/formulaPanel/editor/featureProvider/lint.js"),y=n("./dist/plugins/formulaPanel/editor/featureProvider/theme.js"),m=n("./dist/plugins/formulaPanel/editor/featureProvider/formatter.js"),p=n("./dist/plugins/formulaPanel/editor/featureProvider/readOnly.js"),k=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),g="gc-formula-editor-token-const-string",w="gc-formula-editor-token-const-number",b="gc-formula-editor-token-const-boolean",M="gc-formula-editor-token-const-error",x="gc-formula-editor-token-operator-prefix",S="gc-formula-editor-token-operator-infix",C="gc-formula-editor-token-operator-postfix",_="gc-formula-editor-token-function",F="gc-formula-editor-token-name",N="gc-formula-editor-token-reference-1",U="gc-formula-editor-token-reference-2",H="gc-formula-editor-token-reference-3",z="gc-formula-editor-token-reference-4",W="gc-formula-editor-token-reference-5",V="gc-formula-editor-token-reference-6",$="gc-formula-editor-token-reference-7",q="gc-formula-editor-token-argument-separator",j="gc-formula-editor-content",P="gc-formula-editor-gutters",G="gc-formula-editor-caret",J="gc-formula-editor-active-line",K="gc-formula-editor-selection",O="gc-formula-editor-tooltip-autocompletion-function",E="gc-formula-editor-tooltip-autocompletion-function-active-item",A="gc-formula-editor-tooltip-autocompletion-function-icon",D="gc-formula-editor-tooltip-autocompletion-function-name",R="gc-formula-editor-tooltip-autocompletion-function-description",I="gc-formula-editor-tooltip-error-message",T=i.I.fl,Q=e.View.EditorView,n=e.View.keymap,i=e.Commands.indentWithTab,X=e.Autocomplete.acceptCompletion,Z=n.of([{key:"Tab",run:X},{key:"Tab",run:l.insertTab},i]),L.prototype.getView=function(){return this.zQt},L.prototype.getText=function(){return this.zQt.state.doc.toJSON().join("\n")},L.prototype.setText=function(t){this.zQt.dispatch({changes:{from:0,to:this.zQt.state.doc.length,insert:t}})},L.prototype.getFunctions=function(){return(0,k.getFunctionsByState)(this.zQt.state)},L.prototype.getCustomNames=function(){return this.zQt.state.field(o.customNamesField)},L.prototype.setCustomNames=function(t){this.zQt.dispatch({effects:o.setCustomNamesField.of(t)})},L.prototype.getOptions=function(){return this.zQt.state.field(o.optionsField)},L.prototype.setOptions=function(t){this.zQt.dispatch({effects:o.setOptionsField.of(t)})},L.prototype.getReadOnly=function(){return this.zQt.state.readOnly},L.prototype.setReadOnly=function(t){t!==this.getReadOnly()&&(0,p.reconfigureReadOnly)(this.zQt,t)},L.prototype.getTheme=function(){return this.zQt.state.field(o.themeField)},L.prototype.setTheme=function(t){this.zQt.dispatch({effects:o.setThemeField.of(t)}),this.zQt.dispatch({effects:y.themeCompartment.reconfigure((0,y.createThemeExtension)(t))})},L.prototype.getCalcSource=function(){return this.zQt.state.field(o.calcSourceField)},L.prototype.setCalcSource=function(t){this.zQt.dispatch({effects:o.setCalcSourceField.of(t)})},L.prototype.getCalcService=function(){return this.zQt.state.field(o.calcServiceField)},L.prototype.setCalcService=function(t){this.zQt.dispatch({effects:o.setCalcServiceField.of(t)})},L.prototype.getActiveCellInfo=function(){return this.zQt.state.field(o.activeCellField)},L.prototype.setActiveCellInfo=function(t){this.zQt.dispatch({effects:o.setActiveCellField.of(t)})},L.prototype.getProvider=function(){return this.zQt.state.field(o.providerField)},L.prototype.setProvider=function(t){this.zQt.dispatch({effects:o.setProviderField.of(t)})},L.prototype.format=function(){(0,m.formatDocumentCommand)(this.zQt)},L.prototype.hasFocus=function(){return this.zQt.hasFocus},L.prototype.destroy=function(){this.zQt.destroy()},L.prototype.rebuildFormula=function(){this.zQt.dispatch({effects:o.rebuildFormulaEffect.of(!0)})},L.prototype.clearHistory=function(){var t,n,i,e,r,o,u,s,a,h,n,t=this,n=t.getText(),i=t.getTheme(),e=t.getOptions(),r=t.getCalcService(),o=t.getCalcSource(),u=t.getCustomNames(),s=t.getActiveCellInfo(),a=t.getProvider(),h=t.getReadOnly(),n=t.Qme(n);t.zQt.setState(n),t.setTheme(i),t.setOptions(e),t.setCalcService(r),t.setCalcSource(o),t.setActiveCellInfo(s),t.setCustomNames(u),t.setProvider(a),t.setReadOnly(h)},L.prototype.initTheme=function(){var t,n,i,t=[{token:r.SyntaxHighlightingTokenType.stringConst,color:T(g).color},{token:r.SyntaxHighlightingTokenType.numberConst,color:T(w).color},{token:r.SyntaxHighlightingTokenType.booleanConst,color:T(b).color},{token:r.SyntaxHighlightingTokenType.errorConst,color:T(M).color},{token:r.SyntaxHighlightingTokenType.operatorPrefix,color:T(x).color},{token:r.SyntaxHighlightingTokenType.operatorInfix,color:T(S).color},{token:r.SyntaxHighlightingTokenType.operatorPostfix,color:T(C).color},{token:r.SyntaxHighlightingTokenType.function,color:T(_).color},{token:r.SyntaxHighlightingTokenType.name,color:T(F).color},{token:r.SyntaxHighlightingTokenType.argumentSeparator,color:T(q).color},{token:r.SyntaxHighlightingTokenType.reference,color:[T(N).color,T(U).color,T(H).color,T(z).color,T(W).color,T(V).color,T($).color]}],n={backgroundColor:T(j).backgroundColor,font:T(j).font,color:T(j).color,caretColor:T(G).color,selectionBackColor:T(K).backgroundColor,activeLineBackColor:T(J).backgroundColor,autocompletionStyle:{backgroundColor:T(O).backgroundColor,font:T(O).font,color:T(O).color,border:T(O).border,activeItem:{backgroundColor:T(E).backgroundColor,color:T(E).color},function_icon:{color:T(A).color,font:T(A).font},function_name:{color:T(D).color,font:T(D).font},function_description:{color:T(R).color,font:T(R).font}},errorStyle:{backgroundColor:T(I).backgroundColor,font:T(I).font,color:T(I).color}},i={backgroundColor:T(P).backgroundColor,font:T(P).font,color:T(P).color};this.setTheme({rules:t,editorContentStyle:n,editorGuttersStyle:i})},L.prototype.isFormattedFormula=function(){return this.zQt.state.field(o.isFormattedFormulaField)},L.prototype.Qme=function(t){var n=tt().concat(this.Kme);return e.State.EditorState.create({extensions:n,doc:t})},t.FormulaEditorCore=L},"./dist/plugins/formulaPanel/editor/interface.js":function(t,n){var i,e,r,r;Object.defineProperty(n,"__esModule",{value:!0}),n.TokenType=n.SyntaxHighlightingTokenType=void 0,(r=i=n.SyntaxHighlightingTokenType||(n.SyntaxHighlightingTokenType={}))[r.subExpression=0]="subExpression",r[r.function=1]="function",r[r.argumentSeparator=2]="argumentSeparator",r[r.operatorPrefix=3]="operatorPrefix",r[r.operatorInfix=4]="operatorInfix",r[r.operatorPostfix=5]="operatorPostfix",r[r.stringConst=6]="stringConst",r[r.errorConst=7]="errorConst",r[r.numberConst=8]="numberConst",r[r.booleanConst=9]="booleanConst",r[r.name=10]="name",r[r.reference=11]="reference",r[r.whitespace=12]="whitespace",r[r.unknown=13]="unknown",(r=e=n.TokenType||(n.TokenType={}))[r.ErrorConst=0]="ErrorConst",r[r.LogicalConst=1]="LogicalConst",r[r.NumberConst=2]="NumberConst",r[r.StringConst=3]="StringConst",r[r.ArrayConstStart=4]="ArrayConstStart",r[r.ArrayConstEnd=5]="ArrayConstEnd",r[r.ArrayConstRowSeparator=6]="ArrayConstRowSeparator",r[r.ArrayConstItemSeparator=7]="ArrayConstItemSeparator",r[r.OperatorPrefix=8]="OperatorPrefix",r[r.OperatorInfix=9]="OperatorInfix",r[r.OperatorPostfix=10]="OperatorPostfix",r[r.FunctionName=11]="FunctionName",r[r.FunctionCallStart=12]="FunctionCallStart",r[r.FunctionCallEnd=13]="FunctionCallEnd",r[r.FunctionArgumentSeparator=14]="FunctionArgumentSeparator",r[r.SubExpressionStart=15]="SubExpressionStart",r[r.SubExpressionEnd=16]="SubExpressionEnd",r[r.CellReference=17]="CellReference",r[r.Name=18]="Name",r[r.FormulaStart=19]="FormulaStart",r[r.Whitespace=20]="Whitespace",r[r.Unknown=21]="Unknown"},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js":function(t,c,n){var i,l,e,r,o,v,u,s,d,a,h,f,y,m;function p(t){this.cmt=!0,this.rl=!1,this.Xvt=l.SelectionUnit.cell,this.Ivt=!1,this.xmt=!0,this.qMi=!1,this.XD=!1,this.umt=-1,this.zQt=t}function k(t){this.fve=t}function g(t){var n,i,i,n=(0,v.getActiveSheetByState)(t);n&&(b(i=e.Ode.Ede())&&(i.Rde(n),n=(0,v.getActiveSheetByState)(t)),w(i=n.Nde))&&(i.dispose(),n.Nde=f,M(n.parent,!1))}function w(t){return t instanceof y}function b(t){return t instanceof m}function M(t,n){var i=function(t){t&&(t.rt.X6=n)};t.sheets.forEach(i),t.mp.forEach(function(t){i(t.Mf)})}function x(t,n){t.parent.e3(t,n=void 0===n?!0:n)}Object.defineProperty(c,"__esModule",{value:!0}),c.setWorkbookFocusStatus=c.isFormulaEditorReferencedRangesAcrossSheetContext=c.isFormulaEditorReferencedRangesContext=c.closeFormulaReferencedRanges=c.FormulaEditorReferencedRangesAcrossSheetContext=c.FormulaEditorReferencedRangesContext=c.appendingRangeAnnotation=void 0,i=n("Common"),l=n("Core"),e=n("FormulaTextBox"),r=n("./dist/plugins/formulaPanel/editor/codemirror/index.js"),o=n("./dist/plugins/formulaPanel/editor/common/calcUtil.js"),v=n("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),u=n("./dist/plugins/formulaPanel/editor/common/util.js"),s=n("./dist/plugins/formulaPanel/editor/featureProvider/customField.js"),d=n("./dist/plugins/formulaPanel/editor/featureProvider/signatureTooltips.js"),a=n("./dist/plugins/formulaPanel/editor/featureProvider/syntaxHighlighting.js"),h=n("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),f=void 0,c.appendingRangeAnnotation=r.State.Annotation.define(),p.prototype.smt=function(){var t,n,i,e,r,t;if(!this.isFormula())return[];for(t=this.zQt.state,n=(0,v.getTokensByState)(t),(0,a.markReferenceTokenColorIndex)(n,t),i=[],e=0;e<n.length;e++)r=n[e],((0,o.isReferenceToken)(r)||(0,o.isNameToken)(r)&&(0,o.hasReferenceRanges)(r))&&i.push({index:i.length,textOffset:r.index,text:r.text,ranges:r.ranges,allowDrag:r.canDrag,sheetArea:l.SheetArea.viewport,tag:{colorIndex:r.colorIndex}});return(t=this.Fvt)&&i.push({textOffset:-1,text:"",ranges:[t],index:i.length,allowDrag:!1,isPivotClickCell:!0,tag:{colorIndex:0}}),i},p.prototype.pmt=function(t){var n,n,t,n=(0,v.getReferenceTokenColors)(this.zQt.state),t=this.smt()[t];return n[(null==(n=null==t?void 0:t.tag)?void 0:n.colorIndex)||0]},p.prototype.ymt=function(t){var n=this.zQt.state.selection.main.head;return t.textOffset<=n&&t.textOffset+t.text.length>=n},p.prototype.bmt=function(t){var n,i;return!!this.XD&&(n=this.zQt.state.selection.main.head,i=this.umt,t.textOffset>=i)&&t.textOffset+t.text.length<=n},p.prototype.Qvt=function(){return l.SheetArea.viewport},p.prototype.Dvt=function(){var t,t,t=this.zQt.state;return!t.readOnly&&(!(!this.XD&&!(0,l.Df)(this.text()))||!!this.isFormula()&&!!(t=(0,o.getTokenByPos)((0,v.getTokensByState)(t),(0,v.getSelection)(t).from-1))&&((0,o.isFormulaStartToken)(t)||(0,o.isFunctionCallStartToken)(t)||(0,o.isSubExpressionStartToken)(t)||(0,o.isFunctionArgumentSeparator)(t)||(0,o.isLeftParenthesesToken)(t)||(0,o.isInfixOperatorToken)(t)||(0,o.isPrefixOperatorToken)(t)||(0,o.isWhitespaceToken)(t)))},p.prototype.text=function(){return(0,v.getTextByState)(this.zQt.state)},p.prototype.caret=function(){return this.zQt.state.selection.main.head},p.prototype.close=function(){},p.prototype.mmt=function(){},p.prototype.Lde=function(t,n){var i,e,t,r,t,o;n&&(i=this.zQt,t=(e=this.smt())[t])&&(t=(r=t.textOffset)+t.text.length,o=r+n.length,i.dispatch({changes:{from:r,to:t,insert:n},selection:{anchor:o,head:o},annotations:d.notTriggerSignatureTooltip.of(!0)}))},p.prototype.Gvt=function(t,n,i,e,r){var r,o,u,s,a,h,h,f;if(void 0===r&&(r=l.SheetArea.viewport),t){if(u=(o=(r=this).zQt).state,!r.XD){if(!r.Dvt())return;r.XD=!(n=!1),r.umt=(0,v.getSelection)(u).from}s=r.umt,a=(0,v.getSelection)(u).to,h=(0,v.getTokensByState)(u),h=(0,v.getValidReferenceTokenByPos)(h,a,u),i?(f=s+t.length,o.dispatch({changes:{from:s,to:a,insert:t},selection:{anchor:f,head:f},annotations:[c.appendingRangeAnnotation.of(!0),d.notTriggerSignatureTooltip.of(!0)]})):n?h&&h.index>=s&&a>=h.index&&(f=h.index+t.length,o.dispatch({changes:{from:h.index,to:a,insert:t},selection:{anchor:f,head:f},annotations:[c.appendingRangeAnnotation.of(!0),d.notTriggerSignatureTooltip.of(!0)]})):(f=a+(t=s<a?r.fgt()+t:t).length,o.dispatch({changes:{from:a,to:a,insert:t},selection:{anchor:f,head:f},annotations:[c.appendingRangeAnnotation.of(!0),d.notTriggerSignatureTooltip.of(!0)]}))}},p.prototype.qD=function(){var t=this;t.XD&&(t.XD=!1,t.umt=-1)},p.prototype.onRangeMoved=function(){},p.prototype.onRangeResized=function(){},p.prototype.onRangeAppend=function(){},p.prototype.fgt=function(){var t=i.Common.CultureManager.Fe().NumberFormat;return t&&t.listSeparator||u.COMMA},p.prototype.dve=function(){return this.zQt.state.field(s.calcSourceField).Mf},p.prototype.vve=function(){return this.zQt.state.field(s.activeCellField)},p.prototype.isFormula=function(){return this.zQt.state.field(s.isFormulaField)},p.prototype.Ak=function(t){t&&(this.Dmt=[t])},p.prototype.Hce=function(){this.Dmt=f},p.prototype.Ymt=function(){return this.Dmt},p.prototype.dispose=function(){this.zQt=f},p.prototype.mve=function(){var t=this.zQt;t&&(g(t.state),t.hasFocus&&t.contentDOM.blur(),this.dispose())},y=p,c.FormulaEditorReferencedRangesContext=y,Object.defineProperty(k.prototype,"Ivt",{get:function(){return this.fve.Ivt},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"Mf",{get:function(){return this.fve.dve()},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"_text",{get:function(){return this.fve.text()},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"bZ",{get:function(){return this.fve.vve().row},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"mvt",{get:function(){return this.fve.vve().col},enumerable:!1,configurable:!0}),k.prototype.Rde=function(t){var n,i,e,r,o,n=!1,i=this.Mf,e=this.bZ,r=this.mvt,o=this._text;return i!==t&&(x(i),n=!0),(0,h.executeCommitContextToCellCommand)(i,e,r,o),this.d5(),n},k.prototype.d5=function(){this.fve=f,e.Ode.DJ=f},m=k,c.FormulaEditorReferencedRangesAcrossSheetContext=m,c.closeFormulaReferencedRanges=g,c.isFormulaEditorReferencedRangesContext=w,c.isFormulaEditorReferencedRangesAcrossSheetContext=b,c.setWorkbookFocusStatus=M},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesExtension.js":function(t,n,i){var o,e,u,s,a,h,i,e;function f(t,n,i){var e=i.parent;t&&t.zQt===n||(i.Nde=new a.FormulaEditorReferencedRangesContext(n),(0,a.setWorkbookFocusStatus)(e,i.Nde.Dvt()))}function c(t,n,i){var i;(0,a.isFormulaEditorReferencedRangesContext)(t)&&(i=i.parent,r(t,n,i)?(0,a.closeFormulaReferencedRanges)(n.state):document.activeElement!==n.contentDOM&&setTimeout(function(){n.focus()},10))}function r(t,n,i){var e=document.activeElement;return e!==n.contentDOM&&!(e.hasAttribute("data-gc-formula-editor-additional-element")||t.Dvt()&&i&&i.Ti&&i.Ti.contains(e))}function l(t,n){var n,i;v(t.keyCode)&&(i=(n=(0,u.getActiveSheetByState)(n.state))&&n.Nde,(0,a.isFormulaEditorReferencedRangesContext)(i))&&n.rt.yk(t)}function v(t){return 16===t||17===t||18===t}function d(t,n){var i,e,r,i=n.oldSheet,e=n.newSheet;i&&e&&i!==e&&(r=i.Nde,(0,a.isFormulaEditorReferencedRangesContext)(r))&&(r.Dvt()||o.Ode.DJ)&&(n.needTriggerSheetChange=!1,e.Nde=r,i.Nde=h)}function y(t,n){var i,n,i,i,i=n.oldSheet,n=n.newSheet;if(n&&!n.xT&&i!==n&&(i=n.Nde,(0,a.isFormulaEditorReferencedRangesContext)(i))&&(i.Dvt()||o.Ode.DJ))return i.dve()!==n?o.Ode.DJ=new a.FormulaEditorReferencedRangesAcrossSheetContext(i):(i=o.Ode.DJ,(0,a.isFormulaEditorReferencedRangesAcrossSheetContext)(i)&&(i.d5(),o.Ode.DJ=h)),(0,s.paintFormulaReferencedRanges)(n),!0}Object.defineProperty(n,"__esModule",{value:!0}),n.cve=n.lve=n.isMetaKeyForAppendingRange=n.formulaReferencedRangesExtension=void 0,o=i("FormulaTextBox"),e=i("./dist/plugins/formulaPanel/editor/codemirror/index.js"),u=i("./dist/plugins/formulaPanel/editor/common/codeMirrorUtil.js"),s=i("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),a=i("./dist/plugins/formulaPanel/editor/spreadFeatureProvider/formulaReferencedRangesContext.js"),h=void 0,i=e.View.EditorView.updateListener.of(function(t){var n,i,e,r,n=(0,u.getActiveSheetByState)(t.state);n&&(i=n.parent,e=n.Nde,r=o.Ode.Ede(),!e&&(0,a.isFormulaEditorReferencedRangesAcrossSheetContext)(r)&&(e=r.fve),t.focusChanged?((t.view.hasFocus?f:c)(e,t.view,n),(0,s.paintFormulaReferencedRanges)(n)):(t.selectionSet||t.docChanged)&&e&&(t.transactions.some(function(t){return!t.annotation(a.appendingRangeAnnotation)})&&e.qD(),(0,a.setWorkbookFocusStatus)(i,e.Dvt()),(0,s.paintFormulaReferencedRanges)(n)))}),e=e.View.ViewPlugin.define(function(){return null},{eventHandlers:{keydown:l,keyup:l}}),n.formulaReferencedRangesExtension=[i,e],n.isMetaKeyForAppendingRange=v,n.lve=d,n.cve=y},"./dist/plugins/formulaPanel/editor/spreadFeatureProvider/structReferences.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getStructReferencesByWorkbook=void 0;var u=i("CalcEngine");function e(t){return t?r(t).concat(s(t)):[]}function r(t){var i=[];return t.sheets.forEach(function(t){var n;(t.tables&&t.tables.all()||[]).forEach(function(t){i.push({name:t.name(),description:(0,u.sR)().Fbx_TableName_Description+t.name(),getColumns:function(){return o(t)}})})}),i}function o(t){for(var i,n,e,r,o,i=[],n=0,e="";null!==e;)e=t.getColumnName(n),n++,null!==e&&i.push({name:e,description:""});return r=(0,u.sR)().d2t,o=(0,u.getMapping)()&&(0,u.getMapping)().tableFunctionsMapping,Object.keys(r).forEach(function(t){var t=r[t],n=t.name,t=t.description,n=o&&o[n]||n;i.push({name:n,description:t})}),i}function s(t){var n=[];return t.mp.forEach(function(t){n.push({name:t.name(),description:(0,u.sR)().Fbx_TableSheetName_Description+t.name(),getColumns:function(){return a(t)}})}),n}function a(t){for(var n,i,e,n=[],i=t.getColumnCount(),e=0;e<i;e++)n.push({name:t.getColumnName(e),description:""});return n}n.getStructReferencesByWorkbook=e},"./dist/plugins/formulaPanel/formulaPanel.entry.js":function(t,n,i){var e,r,o,u,s,a,h,f,c,e=this&&this.__createBinding||(Object.create?function(t,n,i,e){void 0===e&&(e=i);var r=Object.getOwnPropertyDescriptor(n,i);r&&("get"in r?n.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,e,r)}:function(t,n,i,e){t[e=void 0===e?i:e]=n[i]}),r=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.findControl=n.pve=n.Commands=n.FormulaEditor=void 0,o=i("Core"),i("./dist/plugins/formulaPanel/editor/formulaEditor-spreadjs.js"),i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),u=i("./dist/plugins/formulaPanel/editor/formulaEditor.js"),s=i("./dist/plugins/formulaPanel/editor/featureProvider/lint.js"),a=i("./dist/plugins/formulaPanel/editor/common/formatter.js"),h=i("./dist/plugins/formulaPanel/editor/formulaEditor.js"),Object.defineProperty(n,"FormulaEditor",{enumerable:!0,get:function(){return h.FormulaEditor}}),f=i("./dist/plugins/formulaPanel/editor/formulaEditor-action.js"),Object.defineProperty(n,"Commands",{enumerable:!0,get:function(){return f.Commands}}),n.pve={gve:s.getDiagnostic,I5:a.format},r(i("./dist/plugins/formulaPanel/editor/editor.ns.js"),n),n.findControl=c=function(t){return"string"==typeof t&&(t=document.getElementById(t)),(0,o.GC$)(t).data(u.CONST_FORMULA_EDITOR)}},Common:function(t){t.exports=n.Spread},CalcEngine:function(t){t.exports=n.Spread.CalcEngine},Core:function(t){t.exports=n.Spread.Sheets},SheetsCalc:function(t){t.exports=n.Spread.Sheets.CalcEngine},FormulaTextBox:function(t){t.exports=n.Spread.Sheets.FormulaTextBox}},e={},t=r("./dist/plugins/formulaPanel/formulaPanel.entry.js"),(((n=void 0===n?{}:n).Spread=n.Spread||{}).Sheets=n.Spread.Sheets||{}).FormulaPanel=t}()});