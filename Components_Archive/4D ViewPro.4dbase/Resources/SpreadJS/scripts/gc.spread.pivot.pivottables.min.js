/*!
 * 
 * SpreadJS Library 16.2.6
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 *
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity/spread-sheets")):t(GC)}(function(e){function n(t){var i,i,i=o[t];return void 0!==i||(i=o[t]={exports:{}},r[t].call(i.exports,i,i.exports,n)),i.exports}var r,o,t;r={"./dist/plugins/pivot/pivot-all-entry.js":function(t,i,n){(e=e||{}).Pivot=n("./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js"),e.Spread=e.Spread||{},e.Spread.Pivot=n("./dist/plugins/pivot/pivot-table-entry.js"),t.exports=e.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(t,i,n){"use strict";var e,r,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),r(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i)},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(t,i){"use strict";var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b;Object.defineProperty(i,"__esModule",{value:!0}),i.top10CompareTypeExcel=i.dateCompareTypeExcel=i.valueCompareTypeExcel=i.captionCompareTypeExcel=i.overlapCheck=i.PivotAreaReference=i.PivotPanelLayoutType=i.PivotPanelSection=i.SerializeIndex=i.DisplayFields=i.CalcItemAggregation=i.SubtotalsPosition=i.GrandTotalPosition=i.PivotAreaAxisType=i.PivotAreaType=i.PivotTableLayoutType=i.PivotPanelDirectionEnum=i.PivotChartFieldType=i.PivotTableFieldType=void 0,(b=n=i.PivotTableFieldType||(i.PivotTableFieldType={}))[b.filterField=0]="filterField",b[b.rowField=1]="rowField",b[b.columnField=2]="columnField",b[b.valueField=3]="valueField",(b=e=i.PivotChartFieldType||(i.PivotChartFieldType={}))[b.filterField=0]="filterField",b[b.axisField=1]="axisField",b[b.legendField=2]="legendField",b[b.valueField=3]="valueField",(b=r=i.PivotPanelDirectionEnum||(i.PivotPanelDirectionEnum={}))[b.fieldAndAreaStacked=0]="fieldAndAreaStacked",b[b.fieldAndAreaBySide=1]="fieldAndAreaBySide",b[b.fieldOnly=2]="fieldOnly",b[b.areaOnlyGrid=3]="areaOnlyGrid",b[b.areaOnlyTable=4]="areaOnlyTable",(b=o=i.PivotTableLayoutType||(i.PivotTableLayoutType={}))[b.compact=0]="compact",b[b.outline=1]="outline",b[b.tabular=2]="tabular",(b=a=i.PivotAreaType||(i.PivotAreaType={}))[b.all=0]="all",b[b.button=1]="button",b[b.data=2]="data",b[b.none=3]="none",b[b.normal=4]="normal",b[b.corner=5]="corner",b[b.topEnd=6]="topEnd",b[b.topRight=7]="topRight",(b=s=i.PivotAreaAxisType||(i.PivotAreaAxisType={}))[b.row=0]="row",b[b.col=1]="col",(b=c=i.GrandTotalPosition||(i.GrandTotalPosition={}))[b.none=0]="none",b[b.row=1]="row",b[b.col=2]="col",b[b.both=3]="both",(b=u=i.SubtotalsPosition||(i.SubtotalsPosition={}))[b.none=0]="none",b[b.top=1]="top",b[b.bottom=2]="bottom",(b=l=i.CalcItemAggregation||(i.CalcItemAggregation={}))[b.include=0]="include",b[b.exclude=1]="exclude",(b=f=i.DisplayFields||(i.DisplayFields={}))[b.downThenOver=0]="downThenOver",b[b.overThenDown=1]="overThenDown",(b=h=i.SerializeIndex||(i.SerializeIndex={}))[b.fields=1]="fields",b[b.options=2]="options",b[b.filter=4]="filter",b[b.sort=8]="sort",b[b.layout=16]="layout",b[b.showValueAs=32]="showValueAs",b[b.group=64]="group",b[b.styles=128]="styles",b[b.collapse=256]="collapse",b[b.theme=512]="theme",b[b.position=1024]="position",b[b.showNoData=2048]="showNoData",(b=v=i.PivotPanelSection||(i.PivotPanelSection={}))[b.fields=1]="fields",b[b.area=2]="area",b[b.viewList=4]="viewList",(b=d=i.PivotPanelLayoutType||(i.PivotPanelLayoutType={}))[b.stack=0]="stack",b[b.flow=1]="flow",(b=p=i.PivotAreaReference||(i.PivotAreaReference={}))[b.cellReference=0]="cellReference",b[b.getPivotData=1]="getPivotData",(b=m=i.overlapCheck||(i.overlapCheck={}))[b.pt=1]="pt",b[b.value=2]="value",b[b.table=4]="table",i.captionCompareTypeExcel={captionEqual:0,captionNotEqual:1,captionBeginsWith:2,captionNotBeginsWith:3,captionEndsWith:4,captionNotEndsWith:5,captionContains:6,captionNotContains:7,captionGreaterThan:8,captionGreaterThanOrEqual:9,captionLessThan:10,captionLessThanOrEqual:11,captionBetween:12,captionNotBetween:13},i.valueCompareTypeExcel={valueEqual:0,valueNotEqual:1,valueGreaterThan:2,valueGreaterThanOrEqual:3,valueLessThan:4,valueLessThanOrEqual:5,valueBetween:6,valueNotBetween:7},i.dateCompareTypeExcel={dateEqual:0,dateNotEqual:1,dateOlderThan:2,dateOlderThanOrEqual:3,dateNewerThan:4,dateNewerThanOrEqual:5,dateBetween:6,dateNotBetween:7,tomorrow:10,today:8,yesterday:9,nextWeek:17,thisWeek:15,lastWeek:16,nextMonth:14,thisMonth:12,lastMonth:13,nextQuarter:18,thisQuarter:19,lastQuarter:20,nextYear:21,thisYear:22,lastYear:23,yearToDate:40,Q1:24,Q2:25,Q3:26,Q4:27,M1:28,M2:29,M3:30,M4:31,M5:32,M6:33,M7:34,M8:35,M9:36,M10:37,M11:38,M12:39},i.top10CompareTypeExcel={count:0,percent:1,sum:2}},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(L,w,t){"use strict";var u,E,B,x,g,D,i,c,n,y,b,l,o,m,t,C,n,N,f,I,k,R,G,A,d,T,V,M,U,S,h,j,Q,O,W,z,Z,Y,H,J,q,K,p,v,t;function P(t,n,i){var e,t,e=-1,t=B([],t,!0);return i&&t.splice(i.valuePositionIndex,0,i),(0,x.o)(t,function(t,i){if(-1===e&&t.Zc===n)return e=i,!0}),e}function X(t,n){var e;return(0,x.o)(t,function(t,i){if(t.Zc===n)return e=t,!0}),e}function $(t,n){var e;return(0,x.o)(t,function(t,i){if(t.a===n)return e=t,!0}),e}function e(){this.Pq={}}function r(t,i,n){var e=this;t&&t.textItem&&this.updateLabelTextItem(t.textItem,n.allowMultipleFiltersPerField),t&&t.condition&&this.updateLabelCondition(t.condition,n.allowMultipleFiltersPerField),i&&this.updateValueCondition(i),e.selectMultipleItems=n||{allowMultipleFiltersPerField:!0},e.u=!1}function a(t,i,n,e){var r=this;r.a=i,k(n)?r.Zc=i:r.Zc=n,r.l=t.p(i),r.bbt=e,r.g(t)}function tt(t,i,n,e,r,o,a,s,c,u){var l,f,o,h,v,d,p;return void 0===c&&(c=!1),e&&e.valueFilter&&(l=e.valueFilter),f=1===o||2===o,o=2===o,e&&e.C(c)?(v=void 0,p=d=!1,m(a.A)||k(s)||!k(a.N)||(d=!0,p=a.T instanceof Date),{isDim:f,isHeader:o,sourceName:i,displayName:t,items:(v=d?(p?et:nt)(e,a,s,c):it(e,a,c)).rs,filterItems:v.ds,index:n,isALL:!1,valueFilter:l,sortInfo:r,isShowSubtotalTop:u}):{isDim:f,isHeader:o,sourceName:i,displayName:t,items:h,filterItems:null,index:n,isALL:!0,valueFilter:l,sortInfo:r,isShowSubtotalTop:u}}function it(n,t,e){var r,o,i,a,s,r=[],o=[],i=t.getFieldsItemList(),a=t.M(),s=!m(a);return(0,x.o)(i,function(t){var i=s?a[t]:t;(n.isMatchedLabelItem(t,e)?r:o).push(i)}),{rs:r,ds:o}}function nt(n,e,t,r){var i,o,t,a,s,c,i=[],o=[],t=t.D,a=e.getFieldsItemList(),s={};for(c in(0,x.o)(t,function(t){var i=e.S(t);r||n.evaluateLabelCondition(t+"")?s[i]=!0:!0!==s[i]&&(s[i]=!1)}),(0,x.o)(a,function(t){n.isInLabelFilterItem(t+"")&&s[t]||(s[t]=!1)}),s)(s.hasOwnProperty(c)&&s[c]?i:o).push(c);return{rs:i,ds:o}}function et(n,e,t,r){var i,o,a,s,c,u,l,f,i=[],o=[],a=t.D,s=e.getFieldsItemList(),c=t.k,u=t.P,l={};for(f in(0,x.o)(s,function(t){l[t]=[]}),(0,x.o)(a,function(t){var i=e.S(t);(r||n.evaluateLabelCondition(t+""))&&(l[i]=(0,x.F)(l[i],c[u[t]]))}),(0,x.o)(s,function(t){n.isInLabelFilterItem(t+"")||(l[t].length=0)}),l)l.hasOwnProperty(f)&&(0<l[f].length?i:o).push(l[f]);return{rs:i,ds:o}}function rt(t){var i,t,i={filterType:1};return i.isBottom=-1===t.type?1:0,i.percent=1===t.compareType?1:0,t=t.expected?1:0,k(t)||(i.value=t,i.filterValue=t),i}function ot(t,i){var n,e,r,o,a;if(void 0===i&&(i=!1),!k(t.compareType))return n={filterType:4,filter1:{}},o=r=void 0,6===(e=t.compareType)?(r=5,o=3,n.and=!0):o=r=!i||4!==e&&2!==e?e:a=4===e?2:4,n.filter1.operator=r,t.item1&&!k(t.item1.expected)&&(n.filter1.value=t.item1.expected),t.item2&&!k(t.item2.expected)&&(n.filter2={},n.filter2.operator=o,n.filter2.value=t.item2.expected),n}function at(t){var i,n,e;if(k(t.value1)?k(t.item1)||(i=t.item1.expected):i=t.value1,k(t.value2)?k(t.item2)||(n=t.item2.expected):n=t.value2,n)return 12===t.compareType?{filterType:4,filter1:{operator:3,value:i},filter2:{operator:5,value:n}}:13===t.compareType?{filterType:4,filter1:{operator:4,value:i},filter2:{operator:2,value:n}}:void 0;switch(e=-1,t.compareType){case 0:return{filterType:3,filter:[i]};case 1:e=1;break;case 2:i+="*";break;case 3:e=1,i+="*";break;case 4:i="*"+i;break;case 5:e=1,i="*"+i;break;case 6:i="*"+i+"*";break;case 7:e=1,i="*"+i+"*";break;case 8:e=2;break;case 9:e=5;break;case 10:e=4;break;case 11:e=3}return{filterType:4,filter1:{operator:e,value:i}}}function st(t){var i,n,e,r,o,a,s,c,a,s,a,i=new Date,n=i.getDay(),e=i.getDate(),r=new Date(i),o=new Date(i);switch(t){case 11:r.setDate(e-6);break;case 9:r.setDate(e-1);break;case 8:break;case 10:r.setDate(e+1);break;case 16:r.setDate(e-n-7),o.setDate(e-n-1);break;case 15:r.setDate(e-n),o.setDate(e-n+6);break;case 17:r.setDate(e-n+7),o.setDate(e-n+13);break;case 13:r.setDate(1),r.setMonth(r.getMonth()-1),o.setDate(0);break;case 12:r.setDate(1),o.setMonth(o.getMonth()+1),o.setDate(0);break;case 14:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+2),o.setDate(0);break;case 18:s=3+(a=r.getMonth()-r.getMonth()%3+1+3)+3,r.setDate(1),r.setMonth(a),o.setMonth(s),o.setDate(0);break;case 19:a=(c=r.getMonth()-r.getMonth()%3+1)+3,r.setDate(1),r.setMonth(c),o.setMonth(a),o.setDate(0);break;case 20:s=r.getMonth()-r.getMonth()%3+1-3,a=c+3-3,r.setDate(1),r.setMonth(s),o.setMonth(a),o.setDate(0);break;case 21:r.setDate(1),r.setMonth(1),r.setFullYear(r.getFullYear()+1),o.setFullYear(o.getFullYear()+2),o.setMonth(0),o.setDate(0);break;case 22:r.setDate(1),r.setMonth(1),o.setFullYear(o.getFullYear()+1),o.setMonth(0),o.setDate(0);break;case 23:r.setDate(1),r.setMonth(1),r.setMonth(r.getFullYear()-1),o.setMonth(0),o.setDate(0);break;case 40:r.setMonth(0,1),r.setHours(0,0,0,0),o.setHours(23,59,59,999)}return r.setHours(0),r.setMinutes(0),r.setSeconds(0),o.setHours(23),o.setMinutes(59),o.setSeconds(59),{from:l.o0(r),to:l.o0(o)}}function ct(t,i){var n,e,r,n=k(t.compareType)?t.operator:t.compareType;if(8<=n&&n<=23||40===n)e={filterType:2,type:i},(r=st(n)).from&&r.to&&(e.value=r.from,e.maxValue=r.to);else if(24<=n&&n<=39)e={filterType:2,type:i};else if(0<=n&&n<=7)return ot(t,!0);return e}function ut(t,i){var n=t.conType;return 3===n?rt(t):2===n?ot(t):0===n?at(t):1===n?ct(t,i):void 0}function lt(t,o){var i,n,a,c,i={n_:"autoFilter",ref:"A1"},a=[];return t&&(t.forEach(function(t){var i,n,e,t,r;t&&(e={},t=ut(n=(i=t.conditions)[0],o),k(t)||(1===(r=t.filterType)?e.top10=t:2===r?e.dynamicFilter=t:4===r?e.customFilters=t:3===r&&(e.filters=t)),a.push(e))}),c=[],a.forEach(function(t){var i,n,e,r,o,o,e,a,r,o,s,i={n_:"filterColumn",colId:0};k(t.hiddenButton)||(i.hiddenButton=t.hiddenButton?1:0),(t.colorFilter||t.top10||t.filters||t.dynamicFilter||t.customFilters)&&(i.c_=[],n=void 0,k(t.top10)?k(t.dynamicFilter)?k(t.customFilters)?k(t.filters)||(n={n_:"filters"},(o=t.filters).blank&&(n.blank=1),k(o.dateGroupItem)&&k(o.filter)||(s=n.c_=[]),o.filter&&o.filter.forEach(function(t){D.StringEx.Xi(t)||s.push({n_:"filter",val:h(t)})}),o.dateGroupItem&&o.dateGroupItem.forEach(function(t){var i={n_:"dateGroupItem"};0<t.year&&(i.year=t.year),0<=t.month&&t.month<12&&(i.month=t.month),0<t.day&&t.day<32&&(i.day=t.day),t.hour<24&&(i.hour=t.hour),t.minute<60&&(i.minute=t.minute),t.second<60&&(i.second=t.second),i.dateTimeGrouping=t.day,s.push(i)}),i.c_.push(n)):(o=t.customFilters,k(o.filter1)&&k(o.filter2)||(n={n_:"customFilters"},o.and&&(n.and=1),e=void 0,k(o.filter1)&&k(o.filter2)||(e=n.c_=[]),k(o.filter1)||(a={n_:"customFilter"},"none"!==(r=y.PivotComparisonOperators[o.filter1.operator])&&(a.operator=r),a.val=o.filter1.value+"",e.push(a)),k(o.filter2)||(a={n_:"customFilter"},"none"!==(r=y.PivotComparisonOperators[o.filter2.operator])&&(a.operator=r),a.val=o.filter2.value+"",e.push(a)),i.c_.push(n))):(r=t.dynamicFilter,k(r.type)||(n={n_:"dynamicFilter"},(o=r.type)&&(n.type=o),k(r.value)||(n.val=r.value),k(r.maxValue)||(n.maxVal=r.maxValue),i.c_.push(n))):(n={n_:"top10"},(e=t.top10).isBottom&&(n.top="0"),e.percent&&(n.percent="1"),isNaN(e.value)||(n.val=e.value+""),isNaN(e.filterVal)||(n.filterVal=e.filterVal+""),i.c_.push(n))),c.push(i)}),i.c_=c),i}function F(t,i,n,e){var r,t,r=this;r.Zc=t,r.L=i,r.Ti=n,r.Qy=e,r.B=[],r.R=[],r.G=[],r.Q=[],r.z=[],r.Z={},r.nrt={},r.Y=[],r.H={allowMultipleFiltersPerField:!0},r.K=new K,r.X={},t=r.Ti&&r.Ti.getPivotCacheByName(i),r.si=t&&t.getAllFieldsNames(),F.et(r,"init")}function ft(t){switch(t){case"average":return x.SubtotalType.average;case"count":return x.SubtotalType.count;case"countNums":return x.SubtotalType.countNums;case"max":return x.SubtotalType.max;case"min":return x.SubtotalType.min;case"product":return x.SubtotalType.product;case"stdDev":return x.SubtotalType.stdDev;case"stdDevp":return x.SubtotalType.stdDevp;case"var":return x.SubtotalType.varr;case"varp":return x.SubtotalType.varp;default:return x.SubtotalType.sum}}function ht(t){switch(t){case x.SubtotalType.average:return"average";case x.SubtotalType.count:return"count";case x.SubtotalType.countNums:return"countNums";case x.SubtotalType.max:return"max";case x.SubtotalType.min:return"min";case x.SubtotalType.product:return"product";case x.SubtotalType.stdDev:return"stdDev";case x.SubtotalType.stdDevp:return"stdDevp";case x.SubtotalType.varr:return"var";case x.SubtotalType.varp:return"varp";default:return"sum"}}function vt(t){return-1<t.indexOf("caption")&&!k(g.captionCompareTypeExcel[t])?{conType:0,compareType:g.captionCompareTypeExcel[t]}:-1<t.indexOf("value")&&!k(g.valueCompareTypeExcel[t])?{conType:2,compareType:g.valueCompareTypeExcel[t]}:k(g.dateCompareTypeExcel[t])?k(g.top10CompareTypeExcel[t])?void 0:{conType:3,compareType:g.top10CompareTypeExcel[t]}:{conType:1,compareType:g.dateCompareTypeExcel[t]}}function dt(t){return!t||" "===t}function pt(t,i){return!k(i.Z[t])&&3!==i.Z[t]}function mt(t,i){var n,e,e,e,e,t,t,n={filter:[]};return n.blank=t.blank,(e=t.c_)[0]?(e=S(e[0].val),s(i.conType,0,e,n.blank)):(n.dateGroupItem=[],(e=[].concat(t.dateGroupItem))[0]?(t=e[0],(e={}).day=T(t.day,1),e.hour=T(t.hour,0),e.minute=T(t.minute,0),e.month=T(t.month,0),e.second=T(t.second,0),e.year=T(t.year,0),t=new Date(e.year,0<e.month?e.month-1:e.month,e.day,e.hour,e.minute,e.second),s(i.conType,0,t,!n.blank)):void 0)}function bt(t,i){var n,e,e,t,t,n={},e=t.and;return dt(e)||(n.and="1"===e),0<(e=t.c_).length&&((t=n.filter1={}).operator=e[0].operator,t.value=e[0].val),1<e.length&&((t=n.filter2={}).operator=e[1].operator,t.value=e[1].val),yt(n,i)}function gt(t,i){var n,e,t,n={};return n.type=Z[t.type],e=t.val,t=t.maxVal,dt(e)||(n.value=e),dt(t)||(n.maxValue=t),Ct(n,i)}function wt(t,i){var n={};return n.value=V(t.val,NaN),n.percent=d(t.percent,!1),n.top=d(t.top,!0),Nt(n,i)}function s(t,i,n,e,r,o,a,s,c,u){var l={};return l.conType=t,k(i)||(l.compareType=i),k(n)||(l.expected=n),k(e)||(l.ignoreBlank=e),k(r)||(l.type=r),k(o)||(l.isPercent=o),k(a)||(l.item1=a),k(s)||(l.item2=s),k(c)||(l.ranges=c),k(u)||(l.expectTypeId=u),2===t&&(l.ignoreCase=!0),l}function yt(t,r){function i(t){var i,t,n,e,t=t.value,n=t.indexOf("*"),e=t.lastIndexOf("*");return-1!==n?i=n===t.length-1&&0!==n?s(r.conType,r.compareType,t.substring(0,t.length-1)):0===n&&n===e?s(r.conType,r.compareType,t.substring(1)):(-1!==n&&-1!==e&&(t=t.substr(1,t.length-2)),s(r.conType,r.compareType,t)):k(r)||(i=s(r.conType,r.compareType,t)),i}var n;return t.filter1&&(n=i(t.filter1)),n=t.filter2?s(r.conType,r.compareType,o,o,o,o,n,i(t.filter2)):s(r.conType,r.compareType,o,o,o,o,n,o)}function Ct(t,i){var n,e,e;return n=1===i.conType?s(1,i.compareType,o):n}function Nt(t,i){var n=t.top?1:-1;return s(3,i.compareType,t.value,o,n,t.percent)}function _(t,i,n){for(var e,r,o,e=0;e<i.length;e++)(o=(r=i[e]).nrt)&&n(o)&&t.setSortInfo(r.Zc,A)}function It(a,s,c,u){for(var l,l,l,t,i,t=function(t){var t,i,n,i,i,e,r,n,i,o,t=a[t];return t.rpi&&(n=(i=t.rpi).sortType,i=i.pivotArea,i=u?c.excelPivotAreaSJSToSheetPivotArea(i):c.excelPivotAreaToSheetPivotArea(i),e=s.getFieldInfoByName(null==(l=null==(l=null==(l=i.references)?void 0:l[0])?void 0:l.items)?void 0:l[0]))?(r=2===s.Z[t.Zc],n={sortType:n,sortValueFieldName:e.Zc},1<i.references.length&&(i=i.references.slice(1),o=(r?s.B:s.R).map(function(t){return t.Zc}),i.sort(function(t,i){return o.indexOf(t.fieldName)-o.indexOf(i.fieldName)}),n.sortByPivotReferences=i.map(function(t){return{fieldName:s.X[t.fieldName],items:t.items}})),n.sortByHeader=r,n.cacheName=e.a,n.sortValueSubtotalText=x.SubtotalType[e.Ar],t.setSortInfo(n),void(s.nrt[t.Zc]=n)):"continue"},i=0;i<a.length;i++)t(i)}function At(t,i){var n,t,n={references:[{fieldName:C().Values,items:[t.sortValueFieldName]}]};return t.sortByPivotReferences&&0<t.sortByPivotReferences.length&&(t=t.sortByPivotReferences.map(function(t){return{fieldName:i.getFieldNameBySourceName(t.fieldName),items:t.items}}),n.references=n.references.concat(t)),n}function Tt(t,i){for(var n,e,n=t.sortByPivotReferences,e=0;e<n.length;e++)if(n[e].fieldName!==i[e])return}function Mt(t){return t&&(t.sumSubtotal=A,t.avgSubtotal=A,t.maxSubtotal=A,t.minSubtotal=A,t.varSubtotal=A,t.varPSubtotal=A,t.countSubtotal=A,t.countASubtotal=A,t.stdDevSubtotal=A,t.stdDevPSubtotal=A,t.productSubtotal=A),t}u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},E=this&&this.__rest||function(t,i){var n,e,r,n={};for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.indexOf(e)<0&&(n[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,e=Object.getOwnPropertySymbols(t);r<e.length;r++)i.indexOf(e[r])<0&&Object.prototype.propertyIsEnumerable.call(t,e[r])&&(n[e[r]]=t[e[r]]);return n},B=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(w,"__esModule",{value:!0}),w.PivotFieldsModel=w.getPivotDateExConditionRange=w.getCellValuePivotFilter=w.toPivotViewQueryField=w.PivotViewField=w.PivotViewFilter=w.PivotViewFilterManager=w.in=w.Caption_Compare_Type_Excel=w.throwError=void 0,x=t("Pivot"),g=t("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),D=t("Core"),i=t("Common"),c=t("./dist/plugins/pivot/pivot-table/pivot-table.js"),n=t("./dist/plugins/pivot/pivot.ns.js"),y=t("./dist/plugins/pivot/pivot-util.js"),b=i.Common.kh,l=i.Common.ct,o=null,m=D.GC$.isEmptyObject,t=new i.Common.ResourceManager(n.SR,"PivotTables"),C=t.getResource.bind(t),n=i.Common.ct,N=n.o0,f=n.Y0,I=null,k=i.Common.lt.ht,R=Math.min,G=Math.max,A=void 0,d=D.NodeHelper.ur,T=D.NodeHelper.sr,V=D.NodeHelper.ar,M=D.Util.io,U=D.Util.pr,S=D.mt.n1,h=D.mt.vo,j=D.mt.xr,Q=D.mt.f1,O=D.mt.xr,W=D.mt.go,w.throwError=z=function(t){throw new Error(t)},Z={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},Y=function(t){var i,n,n,e,r,o,i,e=I,r=t.autoFilter&&t.autoFilter.filterItemMap&&t.autoFilter.filterItemMap[0]&&t.autoFilter.filterItemMap[0].conditions&&t.autoFilter.filterItemMap[0].conditions[0];if(r){switch(r.conType){case 0:r.item1||r.item2?(o=(i=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],i=i[1]):o=r.expected,e={conType:x.PivotConditionType.caption,operator:r.compareType,val:[o,i]};break;case 1:i=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[1],!(o=n[0])||o instanceof Date||(o=f(o)),!i||i instanceof Date||(i=f(i)),e={conType:x.PivotConditionType.date,val:[o,i],operator:r.compareType,isWholeDay:r.isWholeDay},r.compareType===x.PivotDateFilterOperator.dateToDate&&(e.isParallel=r.isParallel,e.isDynamicEndDate=r.isDynamicEndDate,e.by=r.by);break;case 3:e={conType:x.PivotConditionType.top10,val:r.expected,type:r.compareType,operator:r.type};break;case 2:o=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],i=n[1],e={conType:x.PivotConditionType.value,val:r.expected?[r.expected]:[o,i],operator:r.compareType}}return e}},H=function(t,i){var n,n,n,t,e,t,r,o,a,s,t,c,u,l,t=j(t,"autoFilter");if(t){switch(r=void 0,(t=(e=W(t,"filterColumn"))[0])&&(o=O(t,"filters"),a=O(t,"customFilters"),s=O(t,"dynamicFilter"),t=O(t,"top10"),o?r=mt(o,i):a?r=bt(a,i):s?r=gt(s,i):t&&(r=wt(t,i))),c=I,l=u=void 0,i.conType){case 0:r.item1||r.item2?(u=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],l=n[1]):u=r.expected,c={conType:x.PivotConditionType.caption,operator:r.compareType,val:[u,l]};break;case 1:l=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[1],!(u=n[0])||u instanceof Date||(u=f(u)),!l||l instanceof Date||(l=f(l)),c={conType:x.PivotConditionType.date,val:[u,l],operator:r.compareType,isWholeDay:r.isWholeDay},r.compareType===x.PivotDateFilterOperator.dateToDate&&(c.isParallel=r.isParallel,c.isDynamicEndDate=r.isDynamicEndDate,c.by=r.by);break;case 3:c={conType:x.PivotConditionType.top10,val:r.expected,type:r.compareType,operator:r.type};break;case 2:u=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],l=n[1],c={conType:x.PivotConditionType.value,val:r.expected?[r.expected]:[u,l],operator:r.compareType}}return c}},J=function(t){var i,n,e,n,e,n,e,n,e,n,i=I;switch(t.conType){case x.PivotConditionType.caption:e=(n=t.val)[0],n=n[1],i=new x.PivotFilterCaptionCondition(t.operator,e,n);break;case x.PivotConditionType.date:n=(e=t.val)[0],e=e[1],i=t.operator===x.PivotDateFilterOperator.dateToDate?new x.PivotFilterDateCondition(t.operator,t.isWholeDay,n,e,t.isDynamicEndDate,t.isParallel,t.by):new x.PivotFilterDateCondition(t.operator,t.isWholeDay,n,e);break;case x.PivotConditionType.top10:i=new x.PivotFilterTop10Condition(t.operator,t.type,t.val);break;case x.PivotConditionType.value:e=(n=t.val)[0],n=n[1],i=new x.PivotFilterValueCondition(t.operator,e,n)}return i},q=["difference","index","normal","percent","percentDiff","percentOfCol","percentOfRow","percentOfTotal","runTotal"],w.Caption_Compare_Type_Excel=[["captionEqual","captionNotEqual","captionBeginsWith","captionNotBeginsWith","captionEndsWith","captionNotEndsWith","captionContains","captionNotContains","captionGreaterThan","captionGreaterThanOrEqual","captionLessThan","captionLessThanOrEqual","captionBetween","captionNotBetween"],["dateEqual","dateNotEqual","dateOlderThan","dateOlderThanOrEqual","dateNewerThan","dateNewerThanOrEqual","dateBetween","dateNotBetween","today","yesterday","tomorrow",A,"thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","yearToDate"],["valueEqual","valueNotEqual","valueGreaterThan","valueGreaterThanOrEqual","valueLessThan","valueLessThanOrEqual","valueBetween","valueNotBetwee"],["count","percent","sum"]],w.in=P,e.prototype.add=function(t,i){!this.get(t)&&i&&(this.Pq[t]=i)},e.prototype.get=function(t){return this.Pq[t]},e.prototype.set=function(t,i,n){var e=this.get(t);!k(n)&&k(i)?(k(e)&&(e={}),1===n?e.labelFilter=I:2===n?e.valueFilter=I:this.remove(t)):e=i,e&&k(e.labelFilter)&&k(e.valueFilter)&&this.remove(t)},e.prototype.isFilter=function(t){var t=this.get(t);return!!t&&(t.C()||t.on())},e.prototype.remove=function(t){this.get(t)&&delete this.Pq[t]},e.prototype.dispose=function(){for(var t,i,n,e,t=0,i=Object.keys(this.Pq);t<i.length;t++)n=i[t],(e=this.Pq[n]).L0()},K=e,w.PivotViewFilterManager=K,r.prototype.C=function(t){var i,n=this.labelFilter;if(n){if(n.textItem&&!n.textItem.isAll)return!0;if(!t&&n.condition)return!0}return!1},r.prototype.getSlicerItemInfo=function(){var t,i,n,e,r,t=this.selectMultipleItems,i=this.labelFilter,n=!1,e="";return i&&i.textItem&&i.textItem.list&&(1===(r=i.textItem.list.length)?e=i.textItem.list[0]:1<r&&(n=!0)),{selectMultipleItems:t.allowMultipleFiltersPerField,hasMoreThanOneSelect:n,text:e}},r.prototype.on=function(){return!!this.valueFilter},r.prototype.evaluateLabelCondition=function(t){var i,n,e,i=this;return!i.labelFilter||!i.labelFilter.condition||(e=t,(n=i.labelFilter.condition).sn===x.PivotConditionType.date&&(e=(0,x.parseStringToDate)(t)||t),i.labelFilter.condition.evaluate(e))},r.prototype.isInLabelFilterItem=function(t){var i=this;return!i.labelFilter||!i.labelFilter.textItem||-1<i.labelFilter.textItem.list.indexOf(t)},r.prototype.updateLabelCondition=function(t,i){var n=this;k(n.labelFilter)&&(n.labelFilter={}),k(t)?n.labelFilter.condition=I:n.labelFilter.condition=J(t),i||(n.labelFilter.textItem=I),n.u=!0},r.prototype.updateLabelTextItem=function(t,i){var n=this;k(n.labelFilter)&&(n.labelFilter={}),k(t)||(n.labelFilter.textItem=t),i||(n.labelFilter.condition=I),n.u=!0},r.prototype.updateValueCondition=function(t){var i=this;k(i.valueFilter)&&(i.valueFilter={}),i.valueFilter.condition=J(t.condition),i.valueFilter.conditionByName=t.conditionByName},r.prototype.isMatchedLabelItem=function(t,i){return(i||this.evaluateLabelCondition(t+""))&&this.isInLabelFilterItem(t)},r.prototype.L0=function(){var t=this;t.labelFilter=I,t.valueFilter=I,t.selectMultipleItems=I},p=r,w.PivotViewFilter=p,a.prototype.ln=function(t){this.g(t)},a.prototype.g=function(t){var i,n,e,e,i=this,n=i.a,e=t.fn(n);i.DV=e.startValue,i.mn=e.endValue,i.lp=t.kn(n),i.ie=t.Le(n),e=t.tr(n),i.W5=t.hr(n),i._items=i.br(t.yr(n),e)},a.prototype.br=function(t,i){for(var n,e,r,o,a,s,n,e=[],r=this.ie,a=0;a<t.length;a++)s=a,o=!1,r&&0<r.length&&(s=r[t[a]]),i&&i[t[a]]&&(o=!0),e.push({indexValue:s,value:t[a],calculatedMember:o});return e},a.prototype.getSubTotalType=function(){return this.Ar},a.prototype.setSubTotalType=function(t){this.Ar!==t&&(this.Ar=t)},a.prototype.getSortInfo=function(){return this.nrt},a.prototype.setSortInfo=function(t){this.nrt=t,this.kr=t&&t.sortType},a.prototype.toPivotViewSubTotalFields=function(){var t,i,n,t=I;return this.Or&&(i=this.a,n=E(this.Or,[]),t=u({subtotalType:this.Ar,cacheName:i,fieldName:this.Zc},n)),{subTotalType:this.Ar,cacheName:this.a,valueFieldName:this.Zc,index:this.lp,showDataAs:t}},a.prototype.toPivotViewQueryField=function(t,i,n,e,r){return tt(this.Zc,this.a,this.lp,t,this.nrt,i,n,e,r,this.Spi)},a.prototype.Br=function(t){},a.prototype.do=function(t){switch(t){case g.PivotTableFieldType.rowField:return"axisRow";case g.PivotTableFieldType.columnField:return"axisCol";case g.PivotTableFieldType.filterField:return"axisPage";case g.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.ea=function(t){for(var i,n,e,r,i,n=this._items,e=0;e<n.length;e++)if((r=n[e])&&r.indexValue===t)return r},a.prototype.es=function(t){for(var i,n,e,r,i,n=this._items,e=0;e<n.length;e++)if((r=n[e])&&r.value===t)return r},a.prototype.cs=function(t,i){for(var n,e,r,o,n,e=i||this._items,r=0;r<e.length;r++)if((o=e[r])&&o.value===t)return r},a.prototype.gs=function(t,i,n,e){for(var r,o,a,s,c,u,l,f,f,h,v,r=this,o=[],a=!1,s=t.length,c=[],u=0;u<s;u++)f=(l=t[u]).indexValue,k(f)||(f=r.ea(f),k(f))||(k(l.childItems)||(f.childItems=l.childItems),k(l.expanded)||(f.expanded=l.expanded),k(l.drillAcross)||(f.drillAcross=l.drillAcross),k(l.calculatedMember)||(f.calculatedMember=l.calculatedMember),!0===l.hidden?a=!0:o.push(f.value),k(l.missing)||(f.missing=l.missing),k(l.caption)||(f.caption=l.caption),k(l.character)||(f.character=l.character),!0===l.collapse&&n.setCollapse(i,f.value,!0),k(l.type)||(f.type=l.type),c.push(f));r._items=c,a&&(h=n.getFilterInfo(r.a),k(h)&&(h=new p(I,I,n.H),n.K.add(r.a,h)),h.updateLabelTextItem(v={isAll:!1,list:o},n.H.allowMultipleFiltersPerField),n.K.set(r.a,h))},a.prototype.Bs=function(t,i,n,e){for(var r,o,a,s,c,u,l,f,f,h,v,r=this,o=[],a=!1,s=+t.count,c=[],u=0;u<s;u++)l=t.c_[u],f=T(l.x),k(f)||(f=r.ea(f),k(f))||(k(l.c)||(f.childItems=d(l.c)),k(l.d)||(f.expanded=d(l.d)),k(l.e)||(f.drillAcross=d(l.e)),k(l.f)||(f.calculatedMember=d(l.f)),!0===d(l.h)?a=!0:o.push(f.value),k(l.m)||(f.missing=d(l.m)),k(l.n)||(f.caption=l.n),k(l.s)||(f.character=d(l.s)),!1===d(l.sd)&&n.setCollapse(i,f.value,!0),k(l.t)||(f.type=l.t),c.push(f));r._items=c,a&&(h=n.getFilterInfo(r.a),k(h)&&(h=new p(I,I,n.H),n.K.add(r.a,h)),h.updateLabelTextItem(v={isAll:!1,list:o},n.H.allowMultipleFiltersPerField),n.K.set(r.a,h))},a.prototype.fromJson=function(t,i){var n,e,r,o,o,a,s,c,n=this;n.cft=Mt(t),k(t.name)||(n.Zc=t.name),r=(e=i.Ti.getPivotCacheByName(i.L)).getField(n.a),k(t.items)||(o=r&&2===r.W5&&!k(r.Rs),n.gs(t.items,n.Zc,i,o)),k(t.sortType)||(o=t.sortType,a={},s=t.autoSortScope,c=void 0,"ascending"===o?c=x.SortType.asc:"descending"===o&&(c=x.SortType.desc),s?n.rpi={sortType:c,pivotArea:s}:(a.sortType=c,n.nrt=a,n.kr=a.sortType)),k(t.fld)||(n.lp=t.fld),k(t.baseField)||(n.baseField=t.baseField),k(t.measureFilter)||(n.nc=t.measureFilter),k(t.numberFormat)||(n.bbt=t.numberFormat),k(t.showAll)||(n.rc=t.showAll,i.ac[r.Zc]=n.rc)},a.prototype.yh=function(t,i,n){var e,r,o,a,s,r,s,c,u,r,c,r,u,s,e=this;e.sc=Mt(i),k(i.name)||(e.Zc=M(S(i.name))),r=O(i,"items")||[],s=(a=(o=n.Ti.getPivotCacheByName(n.L)).getField(e.a))&&2===a.W5&&!k(a.Rs),e.Bs(r,e.Zc,n,s),k(i.sortType)||(r=i.sortType,s={},c=j(i,"autoSortScope"),u=void 0,"ascending"===r?u=x.SortType.asc:"descending"===r&&(u=x.SortType.desc),c?(r=W(c,"pivotArea"))&&0<r.length&&(e.rpi={sortType:u,pivotArea:r[0]}):(s.sortType=u,e.nrt=s,e.kr=s.sortType)),k(i.fld)||(e.lp=+i.fld),k(i.baseField)||(e.baseField=T(i.baseField)),k(i.measureFilter)||(e.nc=d(i.measureFilter)),c=d(i.showAll,!0),e.rc=n.ac[a.Zc]=c,(s=(u=(r=O(i,"extLst"))&&O(r,"ext"))&&O(u,"pivotField"))&&s.fillDownLabels&&(t.options.fillDownLabels=d(s.fillDownLabels))},a.prototype.cc=function(t,i,n,e,r,o,a){var s,c,u,l,f,h,v,s,c=a||this._items,u=[],l=0;for(e&&r&&c&&c[0]&&c[0].value!=="<"+(0,y.formatDateToString)(r)&&(u.push({indexValue:0}),l=1),f=0;f<c.length;f++)h=c[f],v={},k(h)||(k(h.childItems)||(v.childItems=h.childItems),k(h.expanded)||(v.expanded=h.expanded),k(h.drillAcross)||(v.drillAcross=h.drillAcross),k(h.calculatedMember)||(v.calculatedMember=h.calculatedMember),!0===n[h.value]&&(v.hidden=!0),k(h.missing)||(v.missing=h.missing),k(h.caption)||(v.caption=h.caption),k(h.character)||(v.character=h.character),i&&!0===i[h.value]&&(v.collapse=!0),k(h.type)||(v.type=h.type),k(h.indexValue)||(v.indexValue=e?h.indexValue+l:h.indexValue),u.push(v));return e&&o&&c&&c[c.length-1]&&c[c.length-1].value!==">"+(0,y.formatDateToString)(o)&&u.push({indexValue:u.length}),t&&u.push({type:"default"}),u},a.prototype.mc=function(t,i,n,e,r,o,a){var s,c,u,l,f,h,v,s,c=a||this._items,u=[],l=0;for(e&&r&&c&&c[0]&&c[0].value!=="<"+(0,y.formatDateToString)(r)&&(u.push({n_:"item",x:0}),l=1),f=0;f<c.length;f++)h=c[f],v={n_:"item"},k(h)||(h.childItems&&(v.c="1"),!1===h.expanded&&(v.d="0"),!1===h.drillAcross&&(v.e="0"),h.calculatedMember&&(v.f="1"),!0===n[h.value]&&(v.h="1"),h.missing&&(v.m="1"),k(h.caption)||(v.n=h.caption),h.character&&(v.s="1"),i&&!0===i[h.value]&&(v.sd="0"),k(h.type)||(v.t=h.type),k(h.indexValue)||(v.x=e?h.indexValue+l:h.indexValue),u.push(v));return e&&o&&c&&c[c.length-1]&&c[c.length-1].value!==">"+(0,y.formatDateToString)(o)&&u.push({n_:"item",x:u.length}),t&&u.push({n_:"item",t:"default"}),u},a.prototype.tl=function(t){var i,t,n,e,r,o,a,s,c,i,t=t.bl(this.a),n=t&&t.sf();if(n)for(s in e=[],r=t.sh,o=t.getFieldsItemList(),a=0,n)n.hasOwnProperty(s)&&(e[c=n[s]]={indexValue:a,value:o[s],calculatedMember:!!r[o[s]]},a+=1);return e},a.prototype.toJson=function(t){var i,n,e,r,e,e,e,e,e,o,e,a,s,c,u,r,i=this,n=i.cft||{},e=t.layoutType(),r=t.dh;switch(e){case g.PivotTableLayoutType.outline:n.compact=!1,delete n.outline;break;case g.PivotTableLayoutType.tabular:n.compact=!1,n.outline=!1;break;case g.PivotTableLayoutType.compact:delete n.outline,delete n.compact}if(e=t.dh,n.axis=i.do(e.Z[i.Zc]),k(t.options.subTotalsPosition)||(n.defaultSubtotal=t.options.subTotalsPosition!==g.SubtotalsPosition.none&&A),n.insertBlankRow=t.options.insertBlankLineAfterEachItem,k(i.nc)||(n.measureFilter=i.nc),0<=e.Q.indexOf(i)?n.name=i.a:k(i.Zc)||(n.name=i.Zc),k(i.kr)||(e=void 0,i.kr===x.SortType.asc?e="ascending":i.kr===x.SortType.desc&&(e="descending"),n.sortType=e),(e=i.nrt)&&e.sortValueFieldName&&(e=At(e,r),n.autoSortScope=t.sheetPivotAreaToExcelPivotArea(e)),n.subtotalTop=!1!==i.Spi&&A,k(i.lp)||(n.fld=i.lp),k(i.bbt)||(n.numberFormat=i.bbt),n.showAll=t.showNoData(i.a),o=(e=r.getLabelFilterInfo(i.a))&&e.textItem&&e.textItem.list,!k(i._items)&&(pt(i.Zc,r)||o)&&0<i._items.length){if(e=r.dv&&r.dv[i.Zc],a={},o&&0<o.length){for(s=0;s<i._items.length;s++)a[i._items[s].value]=!0;for(s=0;s<o.length;s++)a[o[s]]=!1}(c=r.bl(i.a))&&(u=2===c.W5&&!k(c.Rs),r=i.tl(r),n.items=i.cc(t.options.subTotalsPosition!==g.SubtotalsPosition.none,e,a,u,c.T,c.gd,r))}return n},a.prototype.wh=function(t){var i,n,e,r,e,e,o,a,e,o,s,e,c,u,o,l,f,e,o,l,f,e,i=this,n=i.sc||{n_:"pivotField"},e=t.layoutType(),r=t.dh;switch(e){case g.PivotTableLayoutType.outline:n.compact="0",delete n.outline;break;case g.PivotTableLayoutType.tabular:n.compact="0",n.outline="0";break;case g.PivotTableLayoutType.compact:delete n.outline,delete n.compact}if(0<=r.Q.indexOf(i)?n.name=h(U(i.a)):k(i.Zc)||(n.name=h(U(i.Zc))),e=t.dh,n.axis=i.do(e.Z[i.Zc]),k(t.options.subTotalsPosition)||(n.defaultSubtotal=t.options.subTotalsPosition===g.SubtotalsPosition.none?"0":A),t.options.insertBlankLineAfterEachItem&&(n.insertBlankRow="1"),i.nc&&(n.measureFilter="1"),!1===i.Spi?n.subtotalTop="0":delete n.subtotalTop,k(i.bbt)||(o=(e=D.ExtendedNumberFormatHelper.getFormatId(i.bbt)).id,(a=e.isBuiltIn)?n.numFmtId=o:((e={}).numberFormat=new D.ExcelNumerFormat(o,i.bbt),n.numFmtId=e.numberFormat.numberFormatId)),!1===t.showNoData(i.a)&&(n.showAll="0"),s=(o=r.getLabelFilterInfo(i.a))&&o.textItem&&o.textItem.list,!k(i._items)&&(pt(i.Zc,r)||s)&&0<i._items.length){if(e=r.dv&&r.dv[i.Zc],c={},s&&0<s.length){for(u=0;u<i._items.length;u++)c[i._items[u].value]=!0;for(u=0;u<s.length;u++)c[s[u]]=!1}(o=r.bl(i.a))&&(l=2===o.W5&&!k(o.Rs),f=i.tl(r),e=i.mc(t.options.subTotalsPosition!==g.SubtotalsPosition.none,e,c,l,o.T,o.gd,f),n.c_=[{n_:"items",count:e.length+"",c_:e}])}return k(i.nrt)||(l=void 0,(o=i.nrt).sortType===x.SortType.asc?l="ascending":o.sortType===x.SortType.desc&&(l="descending"),n.sortType=l,o.sortValueFieldName&&(f=At(o,r),e={n_:"autoSortScope",c_:[t.sheetPivotAreaToSJSPivotArea(f)]},n.c_.push(e))),!0===t.options.fillDownLabels&&(n.c_=n.c_||[],n.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[63,1],c_:[{n_:"pivotField",fillDownLabels:"1"}]}]})),n},a.prototype.eG=function(){var t=this;t.nrt=I,t._items=I,t.ie=I,t.bbt=I,t.Or=I,t.cft=I,t.sc=I,t.rc=I},v=a,w.PivotViewField=v,w.toPivotViewQueryField=tt,w.getCellValuePivotFilter=ot,w.getPivotDateExConditionRange=st,F.prototype.a1=function(t,i){var n,e,n,t,n=this,e=n.ac;return k(e)&&(n.ac={},e=n.ac),t=(n=n.bl(t))&&(n.y1||n.Zc),k(i)?e[t]||!1:!i!=!e[t]?(e[t]=!!i,!0):void 0},F.prototype.x1=function(t,i,n,e){var r=this,o=r.L,a=this.Ti,s;try{s=a.getPivotCacheByName(o).updateCalcItem(t,i,n,e,r.P1())}catch(t){(0,w.throwError)(C().PivotTableErrorFormula)}return s&&(r.q1=!0),s},F.prototype.up=function(t){var i,n=this.L,e;return this.Ti.getPivotCacheByName(n).getCalcItems(t)},F.prototype.Rp=function(t,i){var n,e,r,e,i,n=this,e=n.L,r,e=this.Ti.getPivotCacheByName(e).removeCalcItem(t,i),i=n.Up(t)[0];return i&&e&&(n.sm(t,!0),i.ln(n),n.q1=!0),e},F.prototype.Db=function(t,i,n){for(var e,r,o,a,s,c,u,l,u,f,e=this,r,a=0,s=e.Up(t);a<s.length;a++)if(c=s[a],e.Z[c.Zc]!==g.PivotTableFieldType.valueField){o=c;break}if(k(o)||!e.lg(o.Zc,i))return!1;u=e.L,u=(l=this.Ti).getPivotCacheByName(u);try{f=u.addCalcItem(t,i,n,e.P1())}catch(t){(0,w.throwError)(C().PivotTableErrorFormula)}return!1!==f&&(e.q1=!0,e.sm(t),o)&&o.ln(e),f},F.prototype.P1=function(){for(var t,i,n,e,r,o,t=this,i,n=[],e=0,r=t.nw(g.PivotTableFieldType.rowField).concat(t.nw(g.PivotTableFieldType.columnField));e<r.length;e++)o=r[e],n.push(o.a);return n},F.prototype.lw=function(t){var i,n,e,n,i,n=this.L,e,n=this.Ti.getPivotCacheByName(n);if(!k(n))return k(t)?n.aggregateCalcItem():n.aggregateCalcItem(t===g.CalcItemAggregation.include)},F.prototype.tr=function(t){for(var i,n,e,r,o,a,s,c,u,i,n=this.L,e,r,o,a={},s=0,c=this.Ti.getPivotCacheByName(n).getField(t).ty;s<c.length;s++)a[u=c[s]]=!0;return a},F.prototype.sm=function(t,i){var n,t,e,n=this,t=n.sy(t);t&&(e=t.textGroup&&t.textGroup.fieldName,n.cy(e,null,!0),i&&n.modifyGroupInfoByCalcItem(t),n.dy(t))},F.prototype.modifyGroupInfoByCalcItem=function(t){var i,n,e,r,o,e,a,s,n,c,u,l,f,h,v,d,p,m,b,i,n=t.originFieldName,e=this.L,r,o,e=this.Ti.getPivotCacheByName(e).getField(n);if(e&&(a=e.M()||{},n=(s=t.textGroup&&t.textGroup.groupItems)&&Object.keys(s),!(k(n)||n.length<1))){for(u=0,l=n;u<l.length;u++){for(c=s[f=l[u]],h=0;h<c.length;)k(a[c[h]])?c.splice(h,1):h++;0===c.length&&delete s[f]}if(0===Object.keys(s).length){for(v={},p=0,m=d=Object.keys(a);p<m.length;p++)v[b=m[p]]=b;t.textGroup.groupItems=v}}},F.prototype.lg=function(t,i){var n=this;return n.checkGroup(t)&&n.checkSubTotal()&&n.checkField(t)&&n.checkFieldItem(t,i)},F.prototype.checkField=function(t){var i,n,t,e,r,o,a,s,c,i=this,n;if(i.Z[t]===g.PivotTableFieldType.filterField)return!1;if(e={},(t=i.nw(g.PivotTableFieldType.valueField))&&1<t.length)for(r=0,o=t;r<o.length;r++)e[(a=o[r]).a]?(0,w.throwError)(C().PivotTableCalcItemHasMultipleDataField):e[a.a]=!0;for(s=0,c=t;s<c.length;s++)a=c[s],1<i.Up(a.a).length&&(0,w.throwError)(C().PivotTableCalcItemHasTowCacheField);return!0},F.prototype.checkSubTotal=function(t){var i,n,n,t,i=this,n=i.nw(g.PivotTableFieldType.valueField);if(n&&n.length)switch(n=n[0],t=k(t=t)?i.xy(n.Zc):t){case x.SubtotalType.average:case x.SubtotalType.stdDev:case x.SubtotalType.stdDevp:case x.SubtotalType.varr:case x.SubtotalType.varp:(0,w.throwError)(C().PivotTableSubtotalType)}return!0},F.prototype.checkFieldItem=function(t,i){var n,t,n,e,n,r,t,n,n=this,t=n.getFieldInfoByName(t);return!k(t)&&(n=n.L,t=(r=(n=(e=this.Ti).getPivotCacheByName(n).getField(t.a)).getFieldsItemList()).indexOf(i),n=n.up(),0<=t&&n.indexOf(i)<0&&(0,w.throwError)(C().PivotTableHasSameItemName),!0)},F.prototype.checkGroup=function(t){for(var i,n,e,r,o,e,a,i=this,n,r=0,o=i.ky();r<o.length;r++)e=o[r],e=i.rC(e.name),k(e)||k(e.dateGroups)&&k(e.numberGroup)||(0,w.throwError)(C().PivotTableHasNumberOrDateGroup);return(a=i.FC(t)).cC()&&(0,w.throwError)(C().PivotTableHasNumberOrDateGroup),!0},F.prototype.cC=function(t){var i,t,i,t=this.bl(t);if(t)return!!t.y1},F.prototype.NA=function(t){var i,n,e,r,i,n=this.L,e,r;return this.Ti.getPivotCacheByName(n).getField(t).hasCalcItem()},F.prototype.DA=function(){var t,i,n,i,e,r,o,t=this,i=t.L,n,i=this.Ti.getPivotCacheByName(i).getHeaderList();if(i&&i.length)for(e=0,r=i;e<r.length;e++)if(o=r[e],t.NA(o.name))return!0;return!1},F.prototype.Up=function(t){for(var i,n,e,r,o,a,i,n=[],e,r=0,o=this.nw();r<o.length;r++)(a=o[r]).a===t&&n.push(a);return n},F.prototype.LN=function(){var t=this,i;return t.Ti.getPivotCacheByName(t.L).getDataRefer()},F.prototype.ky=function(){var t,t,i,t=this,t=t.Ti.getPivotCacheByName(t.L),i=[];return i=t?t.getHeaderList():i},F.prototype.y2=function(t,i,n){var e,r,o,e,r=this.Y,o=r.indexOf(t);-1<o&&r.splice(o,1),i&&(k(n)?r.push(t):r.splice(n,0,t))},F.prototype.setSigmaValuePosition=function(t,i){var n,e,r,e,n=this,e=n.getSigmaValuePosition(),r=e.positionType,e=e.positionIndex;k(t)||t!==x.DataPosition.row&&t!==x.DataPosition.col||(n.x2=t),!k(i)&&0<=i&&(n.P2=i),n.DT({position:r,valuesIndex:e,type:"updateValuePosition"})},F.prototype.getSigmaValuePosition=function(){var t,i,n,t=this,i=1<t.Q.length,n=t.P2;return{positionType:t.x2,positionIndex:n,display:i}},F.prototype.xy=function(t,i){var n,e,r,o,a,n=this,e=n.getFieldInfoByName(t);if(e){if(r=e.getSubTotalType(),1===arguments.length)return r;if(r!==i){for(o in n.DA()&&!k(i)&&n.checkSubTotal(i),e.setSubTotalType(i),n.nrt)!n.nrt.hasOwnProperty(o)||k(n.nrt[o])||(a=n.nrt[o]).cacheName!==e.a&&a.sortValueFieldName!==e.Zc||(a.sortValueSubtotalText=x.SubtotalType[i]);n.q1=!0,this.DT({fieldName:t,subtotalType:r,type:"subTotalType"})}}},F.prototype.VT=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,i=this;if(!k(t)){for(n=t.fieldsInfo,e=0;e<=3;e++)i.RM(e);for(i.setSigmaValuePosition(t.valueInfo.positionType,t.valueInfo.positionIndex),r=0;r<4;r++)for(o=n[r],a=0;a<o.length;a++)c=(s=o[a]).sourceName,u=s.displayName,l=s.subtotal,i.addFieldByName(c,u,r,l);for(e=0;e<4;e++)for(o=n[e],a=0;a<o.length;a++)c=(s=o[a]).sourceName,f=s.valueFilter,h=s.labelFilter,v=s.sortInfo,!h||k(h.condition)&&k(h.textItem)||i.setLabelFilterInfo(c,h),f&&!k(f.condition)&&i.setValueFilterInfo(c,f),k(v)||i.setSortInfo(c,v)}},F.prototype.UM=function(){for(var t,i,n,e,r,o,a,s,c,t=this,i=[],n=t.getSigmaValuePosition(),e=0;e<4;e++){for(r=t.nw(e),o=[],a=0;a<r.length;a++)(c={sourceName:(s=r[a]).a,displayName:s.Zc}).subtotal=s.Ar,c.labelFilter=t.getLabelFilterInfo(s.Zc),c.valueFilter=t.getValueFilterInfo(s.Zc),c.sortInfo=s.nrt,o.push(c);i[e]=o}return{fieldsInfo:i,valueInfo:n}},F.prototype.KM=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,i=this,e=i.tx,o=e.sx,a={},s=[],c=!0,u={},f={},h=i.Ti.getPivotCacheByName(i.L);if(!k(e)){if((0,x.o)(t,function(t){n=i.FC(t.fieldName),k(n)||(f[t.fieldName]=n.W5,u[t.fieldName]=k(n.y1)?n.D:n.cx,a[t.fieldName]=t.fieldItem)}),k(a))r=!0;else{for(v=0,d=e.tx;v<d.length;v++){for(m in c=!0,l=(p=d[v]).path,a)if(b(a,m)&&u[m][l[o[m]]]!==a[m]){c=!1;break}c&&(s=s.concat(p.indexes))}r=!1}return h.dx(s,r)}},F.prototype.FC=function(t){var i=this,t=i.getFieldInfoByName(t);if(!k(t))return i.bl(t.a)},F.prototype.kx=function(t){var i,n,e,r,t,i=this,n=i.L,e=i.Ti.getPivotCacheByName(n),r=i.Zc,t={cmd:"updatePivotCache",sheetName:t.name(),cmdOption:{pivotCacheName:n,pivotCache:e,ptName:r}};i.Qy.execute(t),i.Pq=A,F.et(i,"updatePivotCache")},F.prototype.LS=function(){var t=this;t.ok(),t.q1=!0,t.q3()},F.prototype.ok=function(){for(var t,i,n,e,r,o,t=this,i=t.nw(),n=i.length,e=t.L,r=t.Ti.getPivotCacheByName(e),o=0;o<n;o++)r.zRt(i[o].a)?i[o].ln(t):(t.CF(i[o].Zc),t.IF(i[o].Zc))},F.prototype.IF=function(t){var i,n,e,i,n=this.Pq;if(n&&0<n.length)for(e=n.length-1;0<=e;e--)n[e].Zc===t&&n.splice(e,1)},F.prototype.getName=function(){return this.Zc},F.prototype.getAllFieldNameList=function(){var t=this.Ti.getPivotCacheByName(this.L);return t?t.getAllFieldsNames():[]},F.prototype.getAllFieldNameListWithoutCalcField=function(t){var i,n,e,r,o,i=this.Ti.getPivotCacheByName(this.L),n=[];if(i)for(r in e=i.Pq)e.hasOwnProperty(r)&&(o=e[r],!k(o.D5)||t&&(2!==o.W5||!k(o.y1)&&o.y1!==o.Zc)||n.push(r));return n},F.prototype.clone=function(){var t,i,n,e,r,o,a,t=this,i=new F(t.Zc,t.L,t.Ti,t.Qy),n=(0,y.RF)(t.B),e=(0,y.RF)(t.R),r=(0,y.RF)(t.G),o=(0,y.RF)(t.Q),a=(0,y.RF)(t.Z);return i.B=n||[],i.R=e||[],i.G=r||[],i.Q=o||[],i.Z=a||[],i.z=[].concat(t.z),i.x2=t.x2,i.P2=t.P2,i},F.prototype.getAllFieldInfo=function(){var n,t,e,n=this,t=n.getAllFieldNameList(),e=[];return(0,x.o)(t,function(t){var i=n.v_(t);e.push(i?{fieldName:i.Zc,sourceName:t,isFilter:n.K.isFilter(i.a),isDims:!0}:{fieldName:t,sourceName:t,isFilter:n.K.isFilter(t),isDims:!1})}),e},F.prototype.getFieldInfoByName=function(t){var i=this,n=i.Z[t],i=i.nw(n);return i?X(i,t):I},F.prototype.DB=function(t){var i,n,e,r,i,n=this.Pq;if(n)for(e=n.length,r=0;r<e;r++)if(t===n[r].Zc)return n[r]},F.prototype.v_=function(t){var i,n=this.nw();return n?$(n,t):I},F.prototype.addPivotView=function(t){this.z.push(t),this.q3()},F.prototype.removePivotView=function(t){for(var i,n,i=0;i<this.z.length;i++)if((n=this.z[i])===t)return void this.z.splice(i,1);0===this.z.length&&this.dispose()},F.prototype.q3=function(t,i,n,e){for(var r,o,a,r=0;r<this.z.length;r++)a=(o=this.z[r])instanceof c.PivotTable,t&&a||a&&0<o.Xst||o.paint(t,i,n,e)},F.prototype.sR=function(){for(var t,i,t=0;t<this.z.length;t++)(i=this.z[t])instanceof c.PivotTable&&i.adjustRange()},F.prototype.OR=function(t,i){var n,t,n,t=this.Ti.getPivotCacheByName(this.L).zRt(t);return i=k(t)?i:t.Zc},F.prototype.FG=function(t,i,n){var e,t,e,t=this.Ti.getPivotCacheByName(this.L).zRt(t);return k(n)&&(n=t.W5===x.PivotDataType.number?x.SubtotalType.sum:x.SubtotalType.count),k(t)||(i=t.Zc),C()["SubtotalType_Prefix_"+n]+i},F.prototype.PV=function(t){var i,n,i,n;return this.Ti.getPivotCacheByName(this.L).zRt(t).W5===x.PivotDataType.number?x.SubtotalType.sum:x.SubtotalType.count},F.prototype.getSortInfo=function(t){return this.nrt[t]},F.prototype.setSortInfo=function(t,i){var e,n,r,o,a,s,c,u,l,f,h,v,d,d,v,p,m,b,g,w,e=this,n=(0,y.RF)(e.nrt[t]),r=e.getFieldInfoByName(t);if(i&&i.sortValueFieldName&&(o=e.getFieldInfoByName(i.sortValueFieldName),!k(o))){if(i.sortByPivotReferences){if(a=i.sortByPivotReferences,(c=2===(s=e.Z[t]))||(u=1===s)){if(l=c?e.B.map(function(t){return t.Zc}):e.R.map(function(t){return t.Zc}),f=c?e.B.map(function(t){return t.a}):e.R.map(function(t){return t.a}),a.length>l.length)return;for(h=0;h<l.length&&h<a.length;h++){if(d=(v=a[h]).fieldName,!v||k(v)||k(v.items)||0===v.items.length||l[h]!==d&&-1===f.indexOf(d))return;if(d=e.FC(d)||e.bl(d),v=v.items,p=d.DH(),1!==v.length)return;for(m=0,b=v;m<b.length;m++)if(g=b[m],-1===p.indexOf(g))return}}i.sortByPivotReferences=a.map(function(t){var i,n,i=t.fieldName,n=e.X[i];return{fieldName:n=n||-1===e.si.indexOf(i)?n:i,items:t.items}}),i.sortByHeader=c}i.cacheName=o&&o.a,i.sortValueSubtotalText=x.SubtotalType[o.Ar]}k(r)||(e.nrt[t]=i,r.setSortInfo(i),(w=this.Ti.getPivotCacheByName(this.L)).setSortInfo(r.a,!0),this.q1=!0,e.DT({type:"setSortInfo",fieldName:t,sortInfo:n}))},F.prototype.clearSortInfo=function(t){var i,n,e,r,i=this,n=i.getFieldInfoByName(t);k(n)||(e=(0,y.RF)(i.nrt[t]),delete i.nrt[t],n.setSortInfo(I),(r=this.Ti.getPivotCacheByName(this.L)).setSortInfo(n.a,!1),this.q1=!0,i.DT({type:"setSortInfo",fieldName:t,sortInfo:e}))},F.prototype.setCollapse=function(t,i,n){var e,r,e=this.dv;(e=e||(this.dv={}))[t]||(e[t]={}),r=e[t][i],e[t][i]=n,this.DT({fieldName:t,item:i,isCollapse:r,type:"setCollapse"})},F.prototype.getCollapse=function(t,i){var n=this.dv;return n&&n[t]?n[t][i]:I},F.prototype.addField=function(t,i,n){var e,r,o,a;(3<i||i<0)&&(0,w.throwError)("wrong area code"),r=(e=this).nw(i),e.FV(t.Zc)&&i!==g.PivotTableFieldType.valueField||(k(n)?n=r.length:(o=this.getSigmaValuePosition(),a={1:x.DataPosition.row,2:x.DataPosition.col},o.display&&a[i]===o.positionType&&(n<=o.positionIndex?e.setSigmaValuePosition(o.positionType,o.positionIndex+1):n--)),e.sz(r,t,i,n),e.Z[t.Zc]=i,e.X[t.Zc]=t.a,0!==i&&(e.q1=!0))},F.prototype.dz=function(t){var i,n,e,r,o,i=2,n=this;if(!k(t)){for(e=t.substr(t.length-1,1),r="_",isNaN(+e)&&(r=""),o=t;n.Z[t]&&!(100<i);)t=o+r+i,i++;return t}},F.prototype.getFilterInfo=function(t){return this.K.get(t)},F.prototype.isFilter=function(t){return this.K.isFilter(t)},F.prototype.changeFieldName=function(t,i){var n,e,r,t,n=this,e=t.Zc,r=n.Z[t.Zc];return!(k(i)||""===i||!i||(n.Z[e]===g.PivotTableFieldType.valueField&&(n.changeValueFilterName(e,i),n.changeFieldsValueSortInfo(e,i)),n.changeValueArray(e,i),e&&i&&0<i.length&&(n.nrt[e]&&(n.nrt[i]=n.nrt[e],delete n.nrt[e]),t.Zc=i,delete n.Z[e],n.Z[t.Zc]=r,t=n.X[e],delete n.X[e],n.X[i]=t),n.DT({fieldName:i,oldFieldName:e,type:"changeFieldName"}),0))},F.prototype.changeValueArray=function(n,e){var t,r=this.Y;(0,x.o)(r,function(t,i){t===n&&(r[i]=e)})},F.prototype.changeValueFilterName=function(i,n){for(var t,e,r,t=this,r=0;r<4;r++)(e=t.nw(r)).forEach(function(t){t._filterInfo&&t._filterInfo.valueFilter&&t._filterInfo.valueFilter.conditionByName===i&&(t._filterInfo.valueFilter.conditionByName=n)})},F.prototype.changeFieldsValueSortInfo=function(i,n){for(var t,e,r,t=this,r=1;r<3;r++)(e=t.nw(r)).forEach(function(t){t.nrt&&t.nrt.sortValueFieldName&&t.nrt.sortValueFieldName===i&&(t.nrt.sortValueFieldName=n)})},F.prototype.isFieldExist=function(t){return!k(this.Z[t])},F.prototype.isFieldActualExist=function(t){var i,n,i=this,n=i.getAllFieldNameList();return i.si||(i.si=n),-1<i.si.indexOf(t)||-1<n.indexOf(t)&&(i.si=n,!0)},F.prototype.rBt=function(t){var i=this.getFieldInfoByName(t);return this.hr(i?i.a:t)},F.prototype.hr=function(t){var t=this.bl(t);return t&&t.W5},F.prototype.Kz=function(t){var t,i,t=this.getFieldInfoByName(t),i;return this.bl(t.a).DH()},F.prototype.refreshShowDataAs=function(t,i,n){for(var e,r,o,a,s,e,r,o=0,a=this.z;o<a.length;o++)(s=a[o])instanceof c.PivotTable&&s.sq(t,i,n)},F.prototype.changeFieldArea=function(t,i,n){var e,r,o,a,a,s,c,s,u,c,s,l,l,f,h,v,s,d,c,h,p,e=this,r=e.Z[t],o=e.getFieldInfoByName(t);if(k(o))return!1;(a=e.FC(t))&&!k(a.D5)&&i!==g.PivotTableFieldType.valueField||r<0||k(r)||e.FV(t)&&i!==g.PivotTableFieldType.valueField||(a.hasCalcItem()&&i===g.PivotTableFieldType.filterField&&(0,w.throwError)(C().PivotTableMoveCalcItemFieldToReport),a=i!==r,i in g.PivotTableFieldType&&a&&(c=-1!==(s=[g.PivotTableFieldType.rowField,g.PivotTableFieldType.columnField]).indexOf(i),s=-1!==s.indexOf(r),c)&&s&&(a=!1),c=P(u=e.nw(r),t),(s=e.getSigmaValuePosition()).display&&s.positionType===i-1&&s.positionIndex===c&&c===n&&r===i?e.setSigmaValuePosition(s.positionType,s.positionIndex+1):(o&&e.refreshShowDataAs(t,!1,i),i===g.PivotTableFieldType.valueField&&r!==g.PivotTableFieldType.valueField&&(l=e.dz(e.FG(o.a,t)),e.changeFieldName(o,l),t=l,e.xy(o.Zc,e.PV(o.a))),i!==g.PivotTableFieldType.valueField&&r===g.PivotTableFieldType.valueField&&(e.clearValueFilterOfValueField(o.Zc),e.xy(o.Zc,I)),l=e.Z[t],f=o.nrt,o=e.CF(t),h=(s=e.getSigmaValuePosition()).display,v=s.positionType,s=s.positionIndex,i===r&&c<n&&(d=R(c,n),c=G(c,n),h)&&v===i-1&&s<=d&&c<s&&n--,i!==g.PivotTableFieldType.valueField&&r===g.PivotTableFieldType.valueField&&(o.Zc=o.a),e.addField(o,i,n),f&&l!==i&&f.sortByPivotReferences&&e.setSortInfo(t,A),l!==g.PivotTableFieldType.rowField&&l!==g.PivotTableFieldType.columnField||(h=l===g.PivotTableFieldType.columnField?e.B:e.R,p=(l===g.PivotTableFieldType.rowField?e.B:e.R).map(function(t){return e.X[t.Zc]}),_(e,h,function(t){var i,n;if(t.sortByPivotReferences)for(i=t.sortByPivotReferences,n=0;n<i.length;n++)if(i[n].fieldName!==p[n])return 1})),e.q1=a,i===g.PivotTableFieldType.filterField&&e.sR()))},F.prototype.removeFieldOrSigmaByName=function(i){var t,n,e,r,o,a,t=this;return i===C().sigmaValue?(e=t.B.concat(t.R),_(t,e,function(t){return!k(t.sortValueFieldName)}),t.RM(g.PivotTableFieldType.valueField),C().sigmaValue):((n=t.getFieldInfoByName(i))&&(t.refreshShowDataAs(i,!0),r=n.a,3===(o=t.Z[i])?(e=t.B.concat(t.R),_(t,e,function(t){return t.cacheName===r||t.sortValueFieldName===i||t.sortValueFieldName===r})):1!==o&&2!==o||((a=n.getSortInfo())&&delete t.nrt[n.Zc],_(t,e=1===o?t.R:t.B,function(t){var t;return null!=(t=t.sortByPivotReferences)&&t.some(function(t){return t.fieldName===r})}))),t.CF(i))},F.prototype.CF=function(t){var i,n,e,r,o,a,i=this,n=i.Z[t],e,r=P(i.nw(n),t);if(!(k(n)||r<0))return o=i.getSigmaValuePosition(),a={1:x.DataPosition.row,2:x.DataPosition.col},o.display&&o.positionType===a[n]&&o.positionIndex>r&&i.setSigmaValuePosition(o.positionType,o.positionIndex-1),i.MK(t)},F.prototype.MK=function(t){var i=this,n=i.Z[t],e,r=P(i.nw(n),t);return delete i.Z[t],i.q1=!0,i.OK(n,r)},F.prototype.C$=function(t){var n=this,i=n.nw(g.PivotTableFieldType.valueField);(0,x.o)(i,function(i){i.Or&&i.Or.baseFieldName===t&&((0,x.o)(n.z,function(t){0===t.T$&&(0,y.R$)(t,i.Zc,i.Or.showDataAs)}),delete i.Or)})},F.prototype.clearValueFilterOfValueField=function(t){for(var i,n,e,r,i=this,e=g.PivotTableFieldType.rowField;e<=g.PivotTableFieldType.columnField;e++)for(r=(n=i.nw(e)).length-1;0<=r;r--)k(n[r]._filterInfo)||k(n[r]._filterInfo.valueFilter)||n[r]._filterInfo.valueFilter.conditionByName!==t||i.clearFilterInfo(n[r].Zc,2);i.q1=!0},F.prototype.RM=function(t){var i,n,e,i=this,n=i.nw(t);if(!k(n)&&0<n.length){for(e=n.length-1;0<=e;e--)i.refreshShowDataAs(n[e].Zc,!0),i.CF(n[e].Zc);i.q1=!0}},F.prototype.sz=function(t,i,n,e){var r,o,r=this;k(e)?t.push(i):(o=t.length,e=R(o,e),e=G(0,e),t.splice(e,0,i)),n===g.PivotTableFieldType.valueField&&(k(r.x2)&&(r.x2=x.DataPosition.col),k(r.P2))&&(r.P2=0),r.DT({fieldName:i.Zc,area:n,index:e,type:"removeField"})},F.prototype.OK=function(t,i){var n,e,e,r,o,a,n=this,e=n.nw(t);if(!(k(i)||i<0||i>=e.length))return e=e.splice(i,1)[0],k(e)||(o=r=void 0,(a=e._filterInfo)&&(a.labelFilter&&(r=a.labelFilter.condition?a.labelFilter.condition.toJSON():{textItem:u({},a.labelFilter.textItem)}),o=a.valueFilter?{conditionByName:a.valueFilter.conditionByName,condition:a.valueFilter.condition.toJSON()}:I),n.DT({fieldName:e.Zc,sourceName:e.a,labelFilter:r,valueFilter:o,sortInfo:(0,y.RF)(e.nrt),subtotalType:e.Ar,valueFilterIndex:this.Y.indexOf(e.Zc),area:t,index:i,type:"addField"})),e},F.prototype.fit=function(t){var i=this,n;i.Ti.getPivotCacheByName(i.L).removeCalcField(t),i.q1=!0},F.prototype.nw=function(t){var i=this;switch(t){case 0:return i.G;case 1:return i.B;case 2:return i.R;case 3:return i.Q;default:return[].concat(this.B,this.R,this.G,this.Q)}},F.prototype.getLabelQueryField=function(){var o,t,a,s,c,o=this,t=o.bit(),a=o.getAllFieldNameList(),s=[],c=o.Ti.getPivotCacheByName(o.L);return(0,x.o)(t,function(t){var i,n,e,r,i=c.zRt(t.a),n=k(i.y1)?void 0:c.zRt(i.y1),e=o.getFilterInfo(t.a);e&&e.u&&(o.q1=!0,e.u=!1),-1!==(r=a.indexOf(t.a))&&a.splice(r,1),s.push(t.toPivotViewQueryField(e,o.Z[t.Zc],i,n))}),(0,x.o)(a,function(t){var i,n,e,i=o.getFilterInfo(t);i&&i.labelFilter&&(n=c.zRt(t),e=k(n.y1)?void 0:c.zRt(n.y1),s.push(tt(t,t,-1,i,A,-1,n,e)))}),s},F.prototype.Get=function(){var i={};return(0,x.o)(this.B,function(t){var t=t.Zc;i[t]=1}),(0,x.o)(this.R,function(t){var t=t.Zc;i[t]=2}),i},F.prototype.getSubtotalQueryField=function(){var t,i,n,t=this.rot(),i=[],n={};return(0,x.o)(t,function(t){i.push(t.toPivotViewSubTotalFields()),n[t.Zc]=t.getSubTotalType()}),{valueFieldsSubtotalMap:n,queryFields:i}},F.prototype.getSortMap=function(t){var f=this,h={},v={};return(0,x.o)(t,function(t){var i,t,n,e,r,o,a,s,c,u,l,i=t.sourceName,t=t.sortInfo,n={};if(!k(t))if(e=t.customSortCallback||t.customSortInfo){if(o=(r=f.bl(i)).W5,a=r.DH(),s=r.M(),(c=e(a.concat(),{sortType:x.SortType.custom,isDate:o===x.PivotDataType.date}))&&0<c.length){for(u=0,l=c.length;u<l;u++)n[s[c[u]]]=u;h[i]=n}}else v[i]=t.sortType}),{customSortMap:h,normalSortMap:v}},F.prototype.bit=function(){return[].concat(this.B,this.R,this.G)},F.prototype.rot=function(){return this.Q},F.prototype.kn=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).lp},F.prototype.p=function(t){var t=this.Ti.getPivotCacheByName(this.L).zRt(t);return t.l||t.lp},F.prototype.fn=function(t){var t=this.Ti.getPivotCacheByName(this.L).zRt(t);return k(t)?{}:{startValue:t.T,endValue:t.gd}},F.prototype.yr=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).getFieldsItemList()},F.prototype.Le=function(t){var i,n,i=this.bl(t),n=i.P;return!k(n)&&0!==Object.keys(n).length||this.Ti.getPivotCacheByName(this.L).dot([t]),i.P},F.prototype.bl=function(t){var i=this.Ti.getPivotCacheByName(this.L);return i&&i.zRt(t)},F.prototype.sat=function(t){var i,n,e,r,o,a,s,c,u,c,i=this,n=i.ac,e={};if(!k(t)&&0!==t.length&&!k(n))for(r=i.Ti.getPivotCacheByName(this.L),o=0,a=t;o<a.length;o++)(n[c=(s=a[o]).sourceName]||(c=(u=r.getField(c)).y1,!k(c)&&n[c]))&&(e[s.displayName]=!0);return e},F.prototype.xpi=function(t){var i,n,e,r,o,i={};if(!k(t)&&0!==t.length)for(n=0,e=t;n<e.length;n++)i[o=(r=e[n]).displayName]=!!r.isShowSubtotalTop;return i},F.prototype.queryItem=function(){var t,i,n,e,n,r,o,a,s,a,c,u,l,u,f,h,u,l,t=this,i=t.getLabelQueryField(),n=t.getSubtotalQueryField(),e=n.valueFieldsSubtotalMap,n=n.queryFields,r=t.sat(i),o=t.xpi(i),a=t.getSortMap(i),s=a.customSortMap,a=a.normalSortMap,c=t.L,u=t.Ti,l=t.getSigmaValuePosition();return(t.q1||k(t.tx))&&(t.tx=u.queryItem(c,i,n,l),t.q1=!1,F.et(t,"rebuild",{})),f=(u=t.lat(i)).list,h=u.header,u=u.rowHeader,l={valuePositionInfo:l,subTotalsPosition:t.Dpi,valueFieldLength:n.length},t.tx&&t.tx.out(t.Ti.cut[c],f,h,u,i,l,t.alt(),e,t.Y,this.toShowDataAsContextList(n),s,a,r,o)},F.prototype.getLabelSortMap=function(){return this.getSortMap(this.getLabelQueryField())},F.prototype.toShowDataAsContextList=function(t){var l,f,h,l=this,f=[],h=this.Ti.getPivotCacheByName(this.L);return(0,x.o)(t,function(t){var t,i,n,e,r,o,a,t,s,c,u,c;if(t.showDataAs){if(i=(t=t.showDataAs).showDataAs,n=t.cacheName,e=t.baseFieldItemType,r=t.baseFieldName,o=t.baseFieldItem,a=t.fieldName,t=t.subtotalType,s=void 0,r&&o){if(c=l.getFieldInfoByName(r),k(c))return;s=(c=(u=h.zRt(c.a)).M())?c[o]:o}f.push({showDataAs:i,cacheName:n,fieldName:a,baseFieldName:r,baseFieldItemType:e,baseFieldItem:o,subtotalType:t,baseFieldItemShared:s})}}),f},F.prototype.alt=function(){var t,i,n,e,r,e,o,a,s,c,t=this,i={};for(n in t.dv)if(t.dv.hasOwnProperty(n)&&(e=t.Ti.getPivotCacheByName(t.L),!k(e))&&(r=t.getFieldInfoByName(n),!k(r))&&(e=e.zRt(r.a),!k(e)))if(o=e.M(),a=t.dv[n],s=void 0,k(o))i[n]=u({},a);else{for(c in a)a.hasOwnProperty(c)&&((s=s||{})[o[c]]=a[c]);i[n]=s}return i},F.prototype.lat=function(t){var e=[],r=[],o=[];return(0,x.o)(t,function(t){var i=t.displayName,n=t.isDim,t=t.isHeader;n&&(e.push(i),t||o.push(i)),t&&r.push(i)}),{list:e,header:r,rowHeader:o}},F.prototype.spt=function(t,i){var n,e,r,n,e,r=this.Ti.getPivotCacheByName(this.L);return i?0<(0,x.amt)([r.pVt(t),r.bVt(i)]).length:0<r.pVt(t).length},F.prototype.wVt=function(t){var i=t.cmdOption.pivotName,i=this.yVt(i);if(k(i)||k(i.Ti))return!1;t.sheetName=i.Ti.name(),this.Qy.execute(t)},F.prototype.yVt=function(t){for(var i,n,e,r,i,n=0,e=this.z;n<e.length;n++)if((r=e[n]).Zc===t&&r instanceof c.PivotTable)return r;return I},F.prototype.CVt=function(){for(var t,i,t=this.z,i=0;i<t.length;i++)if(t[i]instanceof c.PivotTable)return{sheet:t[i].Ti,ptName:t[i].Zc}},F.prototype.IVt=function(){var t,i,n,e,r,o,a,t=this,i=t.getAllFieldInfo().slice(0),n=t.nw(0).slice(0),e,r,o,a;return{allField:i,rowField:t.nw(1).slice(0),colField:t.nw(2).slice(0),valueField:t.nw(3).slice(0),filterField:n,valuePosition:t.getSigmaValuePosition()}},F.prototype.adjustHasCalcItem=function(t,i,n){var e,r,o,r,a,s,c,u,e=this,r=e.L,o,r=this.Ti.getPivotCacheByName(r).getField(t);if(e.DA()){if(i===g.PivotTableFieldType.filterField)r.hasCalcItem()&&(0,w.throwError)(C().PivotTableMoveCalcItemFieldToReport);else for(s=0,c=a=e.nw();s<c.length;s++)(u=c[s]).a===t&&(e.Z[u.Zc]===g.PivotTableFieldType.valueField&&(0,w.throwError)(C().PivotTableCalcItemHasMultipleDataField),(0,w.throwError)(C().PivotTableCalcItemHasTowCacheField));if(i===g.PivotTableFieldType.valueField)return e.checkSubTotal(n)}return!0},F.prototype.addFieldByName=function(t,i,n,e,r,o){var a,s,c,u,l,c,o,i,f,a=this;for((3<n||n<0)&&(0,w.throwError)("wrong area code"),c=a.bl(t),u=g.PivotTableFieldType.columnField;u>=g.PivotTableFieldType.filterField;u--)if(l=$(s=a.nw(u),t),!k(l)&&n!==g.PivotTableFieldType.valueField)return void a.changeFieldArea(l.Zc,n,r);if(a.adjustHasCalcItem(t,n,e),!k(c)&&i!==C().sigmaValue)return c=new v(a,t,i,o),n!==g.PivotTableFieldType.valueField&&(a.Dpi===g.SubtotalsPosition.top?c.Spi=!0:a.Dpi===g.SubtotalsPosition.bottom?c.Spi=!1:delete c.Spi),n===g.PivotTableFieldType.valueField&&(!k(i)&&k(a.Z[i])||(o=a.FG(t,i,e),i=a.dz(o),a.changeFieldName(c,i)),k(e)?c.setSubTotalType(a.PV(t)):c.setSubTotalType(e)),r<a.nw(n).length&&(n===g.PivotTableFieldType.rowField||n===g.PivotTableFieldType.columnField)&&_(a,f=n===g.PivotTableFieldType.columnField?a.B:a.R,function(t){return!k(t.sortByPivotReferences)&&0<t.sortByPivotReferences.length}),a.addField(c,n,r),n===g.PivotTableFieldType.filterField&&a.sR(),c},F.prototype.AVt=function(t,i,n,e,r,o){var a,s,s,o,i,a=this,s=a.bl(t);k(s)||i===C().sigmaValue||(s=new v(a,t,i,o),n!==g.PivotTableFieldType.valueField&&(a.Dpi===g.SubtotalsPosition.top?s.Spi=!0:a.Dpi===g.SubtotalsPosition.bottom?s.Spi=!1:delete s.Spi),!k(i)&&k(a.Z[i])||(o=a.FG(t,i,e),i=a.dz(o),a.changeFieldName(s,i)),k(e)?s.setSubTotalType(a.PV(t)):s.setSubTotalType(e),a.addField(s,n,r))},F.prototype.AP=function(t){var i,n,e,n,r,e,n,o,a,s,c,u,l,f,n,h,h,l;switch(k(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),i=t.type){case"updateValuePosition":n=t.position,e=t.valuesIndex,this.setSigmaValuePosition(n,e);break;case"subTotalType":this.xy(t.fieldName,t.subtotalType);break;case"setSortInfo":k(t.sortInfo)?this.clearSortInfo(t.fieldName):this.setSortInfo(t.fieldName,t.sortInfo);break;case"setCollapse":this.setCollapse(t.fieldName,t.item,t.isCollapse);break;case"changeFieldName":(n=this.getFieldInfoByName(t.fieldName))&&(this.changeFieldName(n,t.oldFieldName),this.q1=!0);break;case"removeField":(r=this.OK(t.area,t.index))&&(delete this.Z[t.fieldName],this.q1=!0);break;case"addField":e=t.fieldName,n=t.sourceName,o=t.labelFilter,a=t.valueFilter,s=t.sortInfo,c=t.subtotalType,u=t.area,l=t.index,f=t.valueFilterIndex,n=new v(this,n,e),h=this.nw(u),this.sz(h,n,u,l),this.Z[e]=u,this.xy(e,c),this.Z[n.Zc]=u,k(o)||this.setLabelFilterInfo(e,o),k(a)||this.setValueFilterInfo(e,a,f),k(s)||this.setSortInfo(t.fieldName,t.sortInfo),0!==u&&(this.q1=!0);break;case"setLabelFilter":k(t.filterInfo)?this.clearFilterInfo(t.sourceName,1):this.setLabelFilterInfo(t.sourceName,t.filterInfo);break;case"setValueFilter":k(t.filterInfo)?this.clearFilterInfo(t.sourceName,2):this.setValueFilterInfo(t.sourceName,t.filterInfo,t.index);break;case"group":h=t.oldGroupInfo,l=t.groupSourceFieldName,h?this.dy(h):this.cy(l);break;case"ungroup":this.dy(t.groupInfo);break;case"addValueFilter":k(t.filter)?this.clearFilterInfo(t.fieldName,2):this.setValueFilterInfo(t.fieldName,t.filter,t.index)}},F.prototype.DT=function(t){var i,i,n,e,r,i=this.CVt(),i=i&&i.sheet;i&&(n=i.getParent(),(0,x.o)(this.z,function(t){if(t instanceof c.PivotTable)return e=t,!0}),k(n.NVt)&&e&&e.getRange&&(n.NVt={range:e&&e.getRange()}),(r=i.Ut).TVt(this,t))},F.prototype.getLabelFilterInfo=function(t){var t,t,i,n,t=this.K.get(t);if(!k(t)&&(t=t.labelFilter,!k(t)))return{condition:i=t&&t.condition?t.condition.toJSON():i,textItem:n=t&&t.textItem?t.textItem:n}},F.prototype.setLabelFilterInfo=function(t,i){var n,e,r,o,n=this,e=n.K;!k(i)&&Object.keys(i).length<1||((r=n.getFilterInfo(t))&&r.labelFilter&&(o={},r.labelFilter.condition&&(o.condition=r.labelFilter.condition.toJSON()),r.labelFilter.textItem)&&(o.textItem=u({},r.labelFilter.textItem)),k(i)?(r&&r.labelFilter&&r.labelFilter.condition&&1===r.labelFilter.condition.sn&&n.MVt(t,I),e.set(t,I,1)):(r||(r=new p(i,I,n.H),n.K.add(t,r)),i.condition?(1===i.condition.conType&&n.MVt(t,i),r.updateLabelCondition(i.condition,n.H.allowMultipleFiltersPerField)):r.labelFilter&&(r.labelFilter.condition&&1===r.labelFilter.condition.sn&&n.MVt(t,I),delete r.labelFilter.condition),i.textItem?r.updateLabelTextItem(i.textItem,n.H.allowMultipleFiltersPerField):r.labelFilter&&delete r.labelFilter.textItem,n.K.get(t).on()&&!n.H.allowMultipleFiltersPerField&&e.set(t,I,2)),n.q1=!0,this.DT({type:"setLabelFilter",sourceName:t,filterInfo:o}),F.et(n,"setSlicerFilter",{sourceName:t,textItem:i&&i.textItem,condition:i&&i.condition,oldTextItem:o&&o.textItem,oldCondition:o&&o.condition}))},F.prototype.MVt=function(t,i){var n,e,r,o,a,s,c,n=this,e=n.Ti.getPivotCacheByName(n.L);if(!k(e)&&(r=e.xVt(t),!k(r))&&0<r.length)for(o=0,a=r.length;o<a;o++)s=n.getFieldInfoByName(r[o].Zc),k(s)||((c=n.K.get(s.a))||(c=new p(i,I,n.H),n.K.add(s.a,c)),c.updateLabelCondition(i&&i.condition,n.H.allowMultipleFiltersPerField))},F.prototype.getValueFilterInfo=function(t){var i,n,t,t=this.K.get(t);if(t&&t.valueFilter&&t.valueFilter.condition)return{condition:i=t.valueFilter.condition.toJSON(),conditionByName:n=t.valueFilter.conditionByName}},F.prototype.getSourceNameByFieldName=function(t){if(t)return this.X[t]},F.prototype.getFieldNameBySourceName=function(t){var t;if(t)return(t=this.v_(t))&&t.Zc},F.prototype.setValueFilterInfo=function(t,i,n){var e,r,o,a,i,e=this,r=e.K,o=r.get(t);!k(i)&&Object.keys(i).length<1||(k(n)&&(n=-1===this.Y.indexOf(t)?I:this.Y.indexOf(t)),o&&o.valueFilter&&(a={conditionByName:o.valueFilter.conditionByName,condition:o.valueFilter.condition.toJSON()}),k(i)?(r.set(t,I,2),e.y2(t,!1)):(o?o.updateValueCondition(i):(o=new p(I,i,e.H),r.add(t,o)),o.valueFilter.conditionBySourceName=this.getFieldInfoByName(i.conditionByName).a,e.y2(t,!0,n),o.C()&&!e.H.allowMultipleFiltersPerField&&r.set(t,I,1)),(i=X(this.Pq||this.nw(),t))&&(i.nc=!0),this.q1=!0,this.DT({type:"setValueFilter",sourceName:t,index:n,filterInfo:a}))},F.prototype.clearFilterInfo=function(t,i){var n=this,e=n.v_(t);n.getFilterInfo(t)&&(1===i?n.setLabelFilterInfo(t,I):2===i?n.setValueFilterInfo(t,I,I):(n.setValueFilterInfo(t,I,I),n.setLabelFilterInfo(t,I)),e&&(e.nc=!1),n.q1=!0)},F.prototype.DVt=function(t){this.H.allowMultipleFiltersPerField=t},F.prototype.refresh=function(t){this.q3(t)},F.prototype.fromJson=function(t,i){var n,e,r,o,e,a,s,s,n=this,e=n.Ti,r=(n.cft=t).fields;for(n.Pq=[],o=null,(e=e.getPivotCacheByCacheId(+t.cacheId))&&(n.L=e.Zc,o=e.getAllFieldsNames()),o||(o=[],r.forEach(function(t){o.push(t.name)})),n.ac={},!t.multipleFieldFilters&&t.multipleFieldFilters!==A||(n.H.allowMultipleFiltersPerField=!0),n.Z={},n.X={},n.B=[],n.R=[],n.G=[],n.Q=[],a=0;a<o.length;a++)r[a]&&!k(o[a])&&((s=new v(n,o[a],r[a]&&r[a].name)).fromJson(r[a],n),k(r[a].subtotalTop)?s.Spi=!0:s.Spi=r[a].subtotalTop,r[a].name=s.Zc,n.X[s.Zc]=s.a,n.Pq.push(s),s=s.getSortInfo())&&(n.nrt[r[a].name]=s);n.SVt(t,i),It(n.Pq,n,i,!1),k(t.pivotFilters)||n.kVt(t.pivotFilters)},F.prototype.yh=function(t,i){var n,e,r,o,r,a,s,c,c,e,r,n=this,e=n.Ti;for(n.sc=t,n.ac={},o=(r=O(t,"pivotFields"))&&r.c_,n.Pq=[],r=e.getPivotCacheByCacheId(+t.cacheId),n.L=r.Zc,a=r.getAllFieldsNames(),d(t.multipleFieldFilters,!0)&&(n.H.allowMultipleFiltersPerField=!0),s=0;s<a.length;s++)(c=new v(n,a[s],o[s]&&o[s].name)).yh(i,o[s],n),k(o[s].subtotalTop)?c.Spi=!0:c.Spi=d(o[s].subtotalTop),o[s].name=M(S(c.Zc)),n.X[c.Zc]=c.a,n.Pq.push(c),(c=c.getSortInfo())&&(n.nrt[o[s].name]=c);n.jVt(t,i),It(n.Pq,n,i,!0),(e=t.lossless&&t.lossless.losslessPivotFilters)&&n.kVt(e),r=O(t,"filters"),k(r)||n.OVt(r)},F.prototype.kVt=function(t){for(var i,n,e,r,o,o,a,e,s,s,i=this,n=0;n<t.length;n++)e=t[n],(r=i.Pq&&i.Pq[e.fld])&&(o=e.iMeasureFld||0,o=i.Q&&i.Q[o],a=e.conType,e=Y(e),s=o&&o.Zc,k(e)&&k(s)||(s={condition:e,conditionByName:o&&o.Zc},0===a||1===a?i.setLabelFilterInfo(r.a,s):2!==a&&3!==a||i.setValueFilterInfo(r.a,s)))},F.prototype.OVt=function(t){var i,n,e,r,o,a,a,s,r,c,c,r,i=this;if(!k(t))for(n=t.c_,e=0;e<n.length;e++)r=n[e],(o=i.Pq&&i.Pq[T(r.fld)])&&(a=T(r.iMeasureFld)||0,a=i.Q&&i.Q[a],s=void 0,k(r.type)||(s=vt(r.type)),r=H(r,s),c=a&&a.Zc,k(r)&&k(c)||(c={condition:r,conditionByName:a&&a.Zc},0===(r=s.conType)||1===r?i.setLabelFilterInfo(o.a,c):2!==r&&3!==r||i.setValueFilterInfo(o.a,c)))},F.prototype.SVt=function(t,i){var n,e,r,o,a,s,c,u,u,l,f,h,v,d,p,n=this,e={columnFields:g.PivotTableFieldType.columnField,rowFields:g.PivotTableFieldType.rowField};for(r in e)if(e.hasOwnProperty(r))for(o=t[r],a=0;a<o.length;a++)-2!==o[a]?(s=n.Pq[o[a]])&&n.addField(s,e[r]):(n.x2="columnFields"===r?x.DataPosition.col:x.DataPosition.row,n.P2=a);for(c=t.pageFields,a=0;a<c.length;a++)u=c[a],u=n.Pq[u.fld],n.addField(u,g.PivotTableFieldType.filterField);for(l=t.dataFields,f=n.Ti.getPivotCacheByName(n.L).getAllFieldsNames(),a=0;a<l.length;a++)h=l[a],n.AVt(f[h.fld],h.name,g.PivotTableFieldType.valueField,ft(h.subtotal),A,h.numberFormat),h.showDataAs&&(p={showDataAs:d=x.PivotShowDataAs[h.showDataAs]},(v=void 0,y.applyShowDataAsStyle)(i,h.name,d),k(h.baseField)||(v=n.v_(f[h.baseField]),k(v))||(p.baseFieldName=v.Zc),k(h.baseItem)||(1048828===h.baseItem?p.baseFieldItemType=x.PivotShowDataAsBaseItemType.previous:1048829===h.baseItem?p.baseFieldItemType=x.PivotShowDataAsBaseItemType.next:!k(h.baseItem)&&v&&v._items&&(p.baseFieldItemType=x.PivotShowDataAsBaseItemType.item,p.baseFieldItem=v._items[h.baseItem]&&v._items[h.baseItem].value)),n.getFieldInfoByName(h.name).Or=p)},F.prototype.jVt=function(t,s){var c,i,n,e,r,o,a,a,u,l,f,f,u,h,v,d,p,m,b,c=this,i={colFields:g.PivotTableFieldType.columnField,rowFields:g.PivotTableFieldType.rowField};for(n in i)if(i.hasOwnProperty(n)&&(e=O(t,n)))for(r=e.c_,o=0;o<r.length;o++)-2!==(a=T(r[o].x))?(a=c.Pq[a],c.addField(a,i[n])):(c.x2="colFields"===n?x.DataPosition.col:x.DataPosition.row,c.P2=o);if(u=O(t,"pageFields"))for(l=u.c_,o=0;o<l.length;o++)f=l[o],f=c.Pq[T(f.fld)],c.addField(f,g.PivotTableFieldType.filterField);if(u=O(t,"dataFields"))for(h=c.Ti.getPivotCacheByName(c.L).getAllFieldsNames(),d=function(t){var i,n,e,r,o,e,a,e,i=M(S(t.name));c.AVt(h[T(t.fld)],i,g.PivotTableFieldType.valueField,ft(t.subtotal),A,t.numberFormat),n=t.showDataAs,(e=O(t,"extLst"))&&(r=e.c_).forEach(function(t){var t=O(t,"dataField");t&&(n=t.pivotShowAs)}),k(n)||(a={showDataAs:e=x.PivotShowDataAs[n]},(o=void 0,y.applyShowDataAsStyle)(s,i,e),o=T(t.baseField),k(o)||(o=c.v_(h[o]),k(o))||(a.baseFieldName=o.Zc),e=T(t.baseItem),k(e)||(1048828===e?a.baseFieldItemType=x.PivotShowDataAsBaseItemType.previous:1048829===e?a.baseFieldItemType=x.PivotShowDataAsBaseItemType.next:!k(e)&&o&&o._items&&(a.baseFieldItemType=x.PivotShowDataAsBaseItemType.item,a.baseFieldItem=o._items[e]&&o._items[e].value)),c.getFieldInfoByName(i).Or=a)},p=0,m=v=u.c_;p<m.length;p++)d(b=m[p])},F.prototype.PVt=function(){var n,e,t,r,n=this,e=n.Pq,t=n.getAllFieldNameList();k(e)&&(e=n.Pq=[]),r={},(0,x.o)(e,function(t){r[t.Zc]=t}),(0,x.o)(t,function(t){var i=n.v_(t);k(i)&&(i=new v(n,t,t,r[t]&&r[t].bbt)),e[i.lp]=i})},F.prototype.toJson=function(t,i){var n,e,r,o,n=this;if(k(n.L)||(e=n.Ti.getPivotCacheByName(n.L))&&(i.cacheId=e.FVt+""),r=n.Pq,i.fields=[],r)for(o=0;o<r.length;o++)i.fields.push(r[o].toJson(t));n.toPivotFiltersOOModel(t,i),n._Vt(t,i)},F.prototype.toPivotLabelFiltersOOModel=function(t,i,n,e){var r,o,a,n,e,i,r,s,e,o=[],a={};a.fld=n,a.id=++e,a.evalOrder=-1,n=i.condition,k(n)||(e=n.LVt,i=n.getConditionType(),a.operator=e,r=n.eX,s=n.iX,1===(a.conType=i)&&(r=r&&N(r),s=s&&N(s),n.LVt===x.PivotDateFilterOperator.dateToDate)&&(a.isParallel=n.EVt,a.isDynamicEndDate=n.BVt,a.by=n.Rs),e={compareType:e,conType:i,item1:{expected:a.stringValue1=r},item2:{expected:a.stringValue2=s},ignoreCase:!(a.iMeasureFld=0)},n.LVt!==x.PivotDateFilterOperator.dateToDate&&n.LVt!==x.PivotDateFilterOperator.last7Days||(e.isParallel=n.EVt,e.isDynamicEndDate=n.BVt,e.by=n.Rs),r={conditions:[e]}),k(r)||(o.push(r),a.autoFilter={filterItemMap:o},t.push(a))},F.prototype.toPivotValueFiltersOOModel=function(t,i,n,e){var r,e,o,a,n,e,i,r,r=this,o=[],a={};a.fld=n,a.id=++e,a.evalOrder=-1,n=i.condition,e=i.conditionByName,a.iMeasureFld=r.RVt(e)||0,i=n.getConditionType(),r=n.LVt,a.operator=r,e=3===(a.conType=i)?(a.operator=n.uit,{conditions:[{conType:i,expected:n.GVt,type:n.LVt,compareType:n.uit}]}):{conditions:[{compareType:r,conType:i,item1:{expected:n.eX},item2:{expected:n.iX}}]},k(e)||(o.push(e),a.autoFilter={filterItemMap:o},t.push(a))},F.prototype.toPivotFiltersOOModel=function(t,i){var n,e,r,o,a,s,s,c,s,n=this,e=n.Pq,r=[],o=1;if(e)for(a=0;a<e.length;a++)s=e[a],c=(s=n.K.get(s.a))&&s.labelFilter,s=s&&s.valueFilter,k(c)&&k(s)||(k(c)||n.toPivotLabelFiltersOOModel(r,c,a,1),k(s))||n.toPivotValueFiltersOOModel(r,s,a,1);0<r.length?i.pivotFilters=r:delete i.pivotFilters},F.prototype._Vt=function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,n=this,e={R:"columnFields",B:"rowFields"};for(r in e)if(e.hasOwnProperty(r))for(o=n[r],i[e[r]]=[],a=0;a<o.length;a++)i[e[r]].push(o[a].lp);for(n.Q&&1<n.Q.length&&(n.x2===x.DataPosition.row?i.rowFields.splice(n.P2,0,-2):n.x2===x.DataPosition.col&&i.columnFields.splice(n.P2,0,-2)),s=n.G,c=i.pageFields=[],a=0;a<s.length;a++)u=s[a].toJson(t),c.push(u);for(l=n.Q,f=i.dataFields=[],a=0;a<l.length;a++)if(h=l[a],(v={}).name=h.Zc,v.subtotal=ht(h.Ar),v.numberFormat=h.bbt,f.push(v),d=l[a].lp,i.fields&&i.fields[d]&&(i.fields[v.fld=d].dataField=!0),(p=h.Or)&&(p.showDataAs&&(v.showDataAs=x.PivotShowDataAs[p.showDataAs]),p.baseFieldName)&&(m=n.getFieldInfoByName(p.baseFieldName),v.baseField=m.lp,b=p.baseFieldItemType,!k(b)))if(b===x.PivotShowDataAsBaseItemType.previous)v.baseItem=1048828;else if(b===x.PivotShowDataAsBaseItemType.next)v.baseItem=1048829;else if(b===x.PivotShowDataAsBaseItemType.item)for(g=m.tl(n)||m._items,w=0;w<g.length;w++)if(p.baseFieldItem===g[w].value){v.baseItem=w;break}},F.prototype.wh=function(t,i){var n,e,r,o,a,n=this;if(k(n.L)||(e=n.Ti.getPivotCacheByName(n.L))&&(i.cacheId=e.FVt+""),o=[],r=n.Pq)for(a=0;a<r.length;a++)o.push(r[a].wh(t));i.c_.push({n_:"pivotFields",count:o.length+"",c_:o}),n.VVt(t,i),n.UVt(t,i)},F.prototype.VVt=function(t,i){var n,e,r,o,a,s,c,c,u,c,l,f,h,v,d,p,m,u,b,g,u,n=this,e=n.Pq,r=[],o=[],a=1;if(e)for(s=0;s<e.length;s++)c=e[s],u=(c=n.K.get(c.a))&&c.labelFilter,c=c&&c.valueFilter,h=f=l=void 0,k(u)&&k(c)||(k(u)||(d=void 0,(v={n_:"filter",fld:s+"",evalOrder:"-1"}).id=""+ ++a,p=u.condition,k(p)||(m=p.getConditionType(),l=p.LVt,1===m&&l===x.PivotDateFilterOperator.dateToDate||1===m&&l===x.PivotDateFilterOperator.last7Days?n.toPivotLabelFiltersOOModel(o,u,s,a):((h=w.Caption_Compare_Type_Excel[m]&&w.Caption_Compare_Type_Excel[m][l])!==A&&(v.type=h),u=p.eX,b=p.iX,1===m&&(u=u&&N(u),b=b&&N(b)),v.stringValue1=u,v.stringValue2=b,v.iMeasureFld="0",d={conditions:[g={compareType:l,conType:m,item1:{expected:u},item2:{expected:b},ignoreCase:!0}]})),k(d))||(v.c_=[lt([d],h)],r.push(v)),k(c))||(d=void 0,(v={n_:"filter",fld:s+"",evalOrder:"-1"}).id=""+ ++a,p=c.condition,u=c.conditionByName,v.iMeasureFld=""+(n.RVt(u)||0),m=p.getConditionType(),l=p.LVt,d=3===m?(l=p.uit,{conditions:[{conType:m,expected:p.GVt,type:p.LVt,compareType:p.uit}]}):{conditions:[{compareType:l,conType:m,item1:{expected:p.eX},item2:{expected:p.iX}}]},(h=w.Caption_Compare_Type_Excel[m]&&w.Caption_Compare_Type_Excel[m][l])!==A&&(v.type=h),k(d))||41===l||42===l||(v.c_||(v.c_=[]),v.c_.push(lt([d],h)),r.push(v));0<r.length?i.c_.push({n_:"filters",count:r.length+"",c_:r}):Q(i.c_,{},"filters"),0<o.length&&(i.lossless||(i.lossless={}),i.lossless.losslessPivotFilters=o)},F.prototype.UVt=function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,c,m,b,g,w,y,C,w,y,N,w,I,A,T,M,S,n=this,e={R:"columnFields",B:"rowFields"},r={};for(o in e)if(e.hasOwnProperty(o))for(a=n[o],r[e[o]]=[],s=0;s<a.length;s++)r[e[o]].push(a[s].lp);for(c=r.rowFields,u=r.columnFields,n.Q&&1<n.Q.length&&(n.x2===x.DataPosition.row?c.splice(n.P2,0,-2):n.x2===x.DataPosition.col&&u.splice(n.P2,0,-2)),0<c.length&&(l=[],c.forEach(function(t){l.push({n_:"field",x:t})}),i.c_.push({n_:"rowFields",count:l.length+"",c_:l})),0<u.length&&(f=[],u.forEach(function(t){f.push({n_:"field",x:t})}),i.c_.push({n_:"colFields",count:f.length+"",c_:f})),h=n.G,v=[],s=0;s<h.length;s++)v.push({n_:"pageField",fld:h[s].lp});for(0<v.length&&i.c_.push({n_:"pageFields",count:v.length+"",c_:v}),d=n.Q,p=[],m=(c=j(i,"pivotFields"))&&c.c_,s=0;s<d.length;s++)if(b=d[s],(g={n_:"dataField"}).name=b.Zc,g.subtotal=ht(b.Ar),k(b.bbt)||(y=(w=D.ExtendedNumberFormatHelper.getFormatId(b.bbt)).id,(C=w.isBuiltIn)?g.numFmtId=y:((w={}).numberFormat=new D.ExcelNumerFormat(y,b.bbt),g.numFmtId=w.numberFormat.numberFormatId)),p.push(g),y=d[s].lp,m&&m[y]&&(g.fld=""+y,m[y].dataField="1"),(N=b.Or)&&(w=void 0,N.showDataAs&&(w=x.PivotShowDataAs[N.showDataAs]),(I=-1===q.indexOf(w))?g.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[28,1],c_:[{n_:"dataField",pivotShowAs:w}]}]}]:g.showDataAs=w,N.baseFieldName)&&(A=n.getFieldInfoByName(N.baseFieldName),g.baseField=A.lp,T=N.baseFieldItemType,!k(T)))if(T===x.PivotShowDataAsBaseItemType.previous)g.baseItem="1048828";else if(T===x.PivotShowDataAsBaseItemType.next)g.baseItem="1048829";else if(T===x.PivotShowDataAsBaseItemType.item)for(M=A.tl(n)||A._items,S=0;S<M.length;S++)if(N.baseFieldItem===M[S].value){g.baseItem=""+S;break}0<p.length&&i.c_.push({n_:"dataFields",count:p.length+"",c_:p})},F.prototype.RVt=function(t){for(var i,n,i=this.Q,n=0;n<i.length;n++)if(t===i[n].Zc)return n},F.prototype.dy=function(t){var i,n,e,r,i,o,r,i=this,n=i.L,e=this.Ti,r=e.cut[i.L].Pq;return i.DA()&&(t.dateGroups||t.numberGroup)&&(0,w.throwError)(C().PivotTableHasNumberOrDateGroup),i=t.textGroup?(o=t.textGroup.fieldName,(0,x.o)(Object.keys(r),function(t){if(t===o)return C().PivotTableErrorMessage_DuplicatedFieldName}),o):t.originFieldName,(r=this.sy(t.originFieldName))&&this.cy(t.originFieldName,!0),e.addGroup(n,t)?(this.DT({oldGroupInfo:r,groupSourceFieldName:i,type:"group"}),this.q1=!0):C().PivotTableErrorMessage_InvalidGroup},F.prototype.QVt=function(t,i){var n,e=this.L,r;this.Ti.getPivotCacheByName(e).addCalcField(t,i)},F.prototype.WVt=function(){for(var t,i,n,e,r,o,a,t=this,i=t.L,n,e=this.Ti.getCalcFields(i),r=[],o=0;o<e.length;o++)a=t.v_(e[o].Zc),r.push(a?{fieldName:a.Zc,formula:e[o].D5}:{fieldName:e[o].Zc,formula:e[o].D5});return r},F.prototype.FV=function(t){var i,n,e,r,o,a,i=this,n=i.L,e=this.Ti,r=i.getFieldInfoByName(t)&&i.getFieldInfoByName(t).a||t,o=e.getCalcFields(n);if(!k(r))for(a=0;a<o.length;a++)if(o[a].Zc===r)return!0;return!1},F.prototype.zVt=function(t,i,n){var e,r,o,a,r,e=this;return!(k(n)||(r=n.textGroup,o=n.numberGroup,a=n.dateGroups,!(r&&r.fieldName===t||o&&n.originFieldName===t||a&&(r=e.Ti.getPivotCacheByName(e.L).zRt(t))&&r.y1===i)))},F.prototype.cy=function(i,t,n){var e,r,o,a,s,c,u,l,f,f,h,v,d,f,p,e=this,r=e.Ti.getPivotCacheByName(e.L),o=e.v_(i),a=r.getField(i),s=r.ZVt;for(u in s)if(b(s,u)&&(l=s[u],e.zVt(i,u,l))){c=(0,y.RF)(l);break}if(!k(a)&&((f=(f=e.getFilterInfo(i))&&f.labelFilter)&&f.textItem&&(k(f.condition)&&k(f.conditionByName)?f=A:f.textItem=A,e.setLabelFilterInfo(i,f)),h=r.YVt(a.Zc),!n)&&h&&0<h.length)for(v=0;v<h.length;v++)e.HVt(h[v]);o&&((d=o.nrt)&&delete e.nrt[o.Zc],1!==(f=e.Z[o.Zc])&&2!==f||_(e,p=1===f?e.R:e.B,function(t){var t;return null!=(t=t.sortByPivotReferences)&&t.some(function(t){return t.fieldName===i})})),e.q1=!0,n||F.et(e,"updatePivotCache"),t||this.DT({groupInfo:c,type:"ungroup",pivotTable:e})},F.prototype.JVt=function(){for(var t,i,n,e,r,o,t=this,i=t.nw(),n=t.Ti.getPivotCacheByName(t.L),e=0,r=i;e<r.length;e++)o=r[e],k(n.getField(o.a))&&t.removeFieldOrSigmaByName(o.Zc);t.q1=!0},F.prototype.rC=function(t){var i,n,e,r,o,a,i=this,n,e=i.Ti.getPivotCacheByName(i.L).ZVt;for(o in e)if(b(e,o)&&(a=e[o],i.zVt(t,o,a))){r=(0,y.RF)(a);break}return r},F.prototype.HVt=function(t){for(var i,n,e,r,i=this,e=g.PivotTableFieldType.valueField;e>=g.PivotTableFieldType.filterField;e--)for(r=(n=i.nw(e)).length-1;0<=r;r--)n[r].a===t&&(e===g.PivotTableFieldType.valueField&&i.clearValueFilterOfValueField(n[r].Zc),i.removeFieldOrSigmaByName(n[r].Zc))},F.prototype.qVt=function(t){var i,n,e,i,i,i=this,n,e,i=this.Ti.getPivotCacheByName(this.L).Pq[t].W5===x.PivotDataType.number?(i=i.FG(t),this.addFieldByName(t,i,g.PivotTableFieldType.valueField,x.SubtotalType.sum)):this.addFieldByName(t,t,g.PivotTableFieldType.rowField,I);return i},F.prototype.KVt=function(n){var e,t,i,r,e=this,t=this;if(t.Z[n]===g.PivotTableFieldType.valueField)for(r=0;r<4;r++)(i=t.nw(r)).forEach(function(t){var i;t._filterInfo&&t._filterInfo.valueFilter&&t._filterInfo.valueFilter.conditionByName===n&&(i=t._filterInfo.valueFilter.toJSON(),t._filterInfo.valueFilter=I,e.DT({fieldName:t.Zc,filter:i,type:"addValueFilter"}))})},F.prototype.sy=function(t){var i,n,e,r,o,a,i=this,n,e=i.Ti.getPivotCacheByName(i.L).ZVt;for(o in e)if(b(e,o)&&((a=e[o]).textGroup&&a.originFieldName===t||k(a.textGroup)&&a.originFieldName===t)){r=(0,y.RF)(a);break}return r},F.prototype.XVt=function(t,i){var n,e,n=this,e;return n.Ti.getPivotCacheByName(n.L).$Vt(t,i)},F.prototype.tQt=function(t){var i,n,i=this,n;return i.Ti.getPivotCacheByName(i.L).tQt(t)},F.prototype.iQt=function(t){var i,n,i=this,n;return i.Ti.getPivotCacheByName(i.L).nQt(t)},F.prototype.eQt=function(){var t,i,t=this,i;return t.Ti.getPivotCacheByName(t.L).eQt()},F.prototype.rQt=function(){var t,i,t=this,i;return t.Ti.getPivotCacheByName(t.L).rQt()},F.prototype.dispose=function(){var t,i,n,e,r,t=this;if(t.nrt=I,t.dv=I,t.Pq=I,t.cft=I,t.sc=I,t.Y=I,t.H=I,t.Z=I,t.Ti=I,t.Qy=I,!k(t.z)){for(i=0,n=t.z;i<n.length;i++)(e=n[i])&&e.dispose();t.z=I}for(k(t.tx)||t.tx.L0(),k(t.copyFieldsModel)||t.copyFieldsModel.dispose(),r=0;r<t.B.length;r++)t.B[r].eG();for(r=0;r<t.R.length;r++)t.R[r].eG();for(r=0;r<t.G.length;r++)t.G[r].eG();for(r=0;r<t.Q.length;r++)t.Q[r].eG();t.K.dispose(),t.K=I,t.H=I,t.ac=I},w.PivotFieldsModel=t=F,(0,D.$e)(t)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(t,i){"use strict";var n;function r(t,i,n){var e=this;e.Zc=t,e.dh=i instanceof r?i.dh:i,e.Ti=n}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotView=void 0,r.prototype.getName=function(){return this.Zc},r.prototype.paint=function(){this.GY.render()},r.prototype.dispose=function(){var t=this;t.dh=null,t.GY&&t.GY.dispose()},i.PivotView=r},"./dist/plugins/pivot/pivot-definition.js":function(){},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js":function(L,r,t){"use strict";var i,g,n,w,f,h,m,c,e,o,u,t,b,a,s,v,E,B,R,d,G,t,l,n,y,p,C,N,V,U,I,t,A,Q,W,T,M,S,x,D,k;function j(t,i){var n,e,r;if((0,f.ht)(t.P))for(t.k={},t.P={},t.D=[],n=i.oQt,e=t.lp,r=0;r<n.length;r++)n[r][e]=t.aQt(n[r][e],r,!1);t.sQt||t.uQt()}function z(t){return t.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function Z(t,i){return(i=void 0===i?!1:i)?+t.state.pivotCacheId:+t.data.tabular.pivotCacheId}function Y(t,n){var e=[];return g.GC$.each(t,function(t,i){var i,i,i=i.slicerCacheDefinition||i.timelineCacheDefinition;i&&i.pivotTables&&-1!==n.indexOf(i.name)&&(i=i.pivotTables.pivotTable,g.GC$.each(i,function(t,i){var i=+i.tabId;-1===e.indexOf(i)&&e.push(i)}))}),e}function H(n,t){var e=[];return g.GC$.each(t,function(t,i){-1!==n.indexOf(+i.sheetId)&&e.push(i.name)}),e}function J(t,n,e){var r=[];return t&&0<t.length&&g.GC$.each(t,function(t,i){var i,i;i.Type===e&&(i=g.Util.vr(i.Target),i=n[i])&&g.GC$.each(i.c_,function(t,i){-1===r.indexOf(i.cache)&&r.push(i.cache)})}),r}function q(t,i,n,e){var r,o,a,i,o,t,s,r=i.slicers,o=i.slicerCaches,a=i.timelines,i=i.timelineCaches;if(r&&0!==r.length)return H(s=Y(o,t=J(o=t&&t[n],r,g.RelationshipConstants.yc).concat(J(o,a,g.RelationshipConstants.Nc))).concat(Y(i,t)),e)}function K(t,i){var n,e,t,r,o,a,s,r,i;if(!(0,f.ht)(t.filter1)||!(0,f.ht)(t.filter2))return n={},t.and&&(n.and="1"),e=t.filter1,t=t.filter2,a=!(0,f.ht)(e),s=!(0,f.ht)(t),a&&(r="none"!==(r=i[e.operator])?{operator:r,val:e.value}:{val:e.value}),s&&(o="none"!==(i=i[e.operator])?{operator:i,val:t.value}:{val:t.value}),a&&s?n.customFilter=[r,o]:a?n.customFilter=r:s&&(n.customFilter=o),n}function X(t){var i,n,e,t,i=t.getConditionType(),n=t.LVt,e=t.eX,t=t.iX;return 1===i&&(e=e&&l(e),t=t&&l(t)),{compareType:n,conType:i,item1:{expected:e},item2:{expected:t},ignoreCase:!0}}function $(t,i){var n,e,r,r,n=(0,f.ht)(t.compareType)?t.LVt:t.compareType;if(8<=n&&n<=23||40===n)e={filterType:2,type:i},(r=(0,h.getPivotDateExConditionRange)(n)).from&&r.to&&(e.value=r.from,e.maxValue=r.to);else if(24<=n&&n<=39)e={filterType:2,type:i};else if(0<=n&&n<=7)return r=X(t),(0,h.getCellValuePivotFilter)(r);return e}function O(t){this.vpt=t,this.cQt=[],this.lQt=[]}function P(t,i,n,e){var t,i,t=x.call(this,t,i,n,e)||this;return t.slicerCacheType=y.pivotTimeline,t.selectionLevel=p.months,t.level=p.months,(i=t).bounds=i.buildBounds(),i.selection=m.keyword_undefined,t}function F(t,i,n,e){var t=D.call(this,t,i,n,e)||this;return t.slicerCacheType=y.pivotSlicer,t.fQt=g.SortState.ascending,t.hQt=!0,t.vQt=!0,t.dQt=!0,t.fQt=g.SortState.ascending,t.items=t.initItems(),t}function _(t,i,n,e){var e=k.call(this,e,n)||this;return e.Ti=t,e.pivotCache=i,e.pivotTables=[],e}function tt(t,i){var n,e,r,o,a,s,n=g.util.xr(t.workbook,g.XFileConstants.Au);for((0,f.ht)(n)&&(n={n_:g.XFileConstants.Au,c_:[]},t.workbook.c_.push(n)),e=[],r=0,o=i;r<o.length;r++)a=o[r],e.push({n_:"x14:slicerCache","r:id":a});(s=n.c_).unshift({n_:"ext",r_:[54,55],c_:[{n_:"x14:slicerCaches",c_:e}]})}function it(t,i){var n,e,r,o,a,s,n=g.util.xr(t.workbook,g.XFileConstants.Au);for((0,f.ht)(n)&&(n={n_:g.XFileConstants.Au,c_:[]},t.workbook.c_.push(n)),e=[],r=0,o=i;r<o.length;r++)a=o[r],e.push({n_:"x15:timelineCacheRef","r:id":a});(s=n.c_).push({n_:"ext",r_:[56,32],c_:[{n_:"x15:timelineCacheRefs",c_:e}]})}function nt(t){var i,n,i,n;g.util.xr(t.workbook,g.XFileConstants.Au).c_.push({n_:"ext",r_:[57,58],c_:[{n_:"x14:workbookPr",c_:[{}]}]},{n_:"ext",r_:[59,32],c_:[{n_:"x15:workbookPr",chartTrackingRefBase:"1"}]})}function et(t,i){var n,e,r,o,a,s,c,u,l,l,n=t.timelineCaches,e=0;for(n?e=Object.keys(n).length:n=t.timelineCaches={},r=[],o=t.workbook.rels,a=0,s=i;a<s.length;a++)(c=s[a]).slicerCacheType===w.SlicerCacheType.pivotTimeline&&(u=e+=1,l=v(o),o.c_.push({n_:"Relationship",Id:l="rId"+l,Type:g.RelationshipConstants.kc,Target:E("timelineCaches/timelineCache"+u)}),n[g.XFileConstants.pu+u]={timelineCacheDefinition:c.wh()},r.push(l));it(t,r)}function rt(t,i,n,e){for(var r,o,a,s,c,u,l,f,h,v,d,p,r=t.timelines,o=Object.keys(r).length,a=0,s=n;a<s.length;a++)if(0<(u=(c=s[a]).slicers.all().filter(function(t){return"timeline"===t.ma})).length)for(l=r[g.XFileConstants.gu+(o+=1)]={timelines:{r_:[60,14,30,43],timeline:[]}},t.drawings||(t.drawings={}),f=0,h=u;f<h.length;f++)v=h[f],p=(d=R(t,B(t,c.name()))).c_,v.wh(l.timelines.timeline,p,e),v.style().wh(!0,!1,e);w.adi(t,i,w.SlicerCacheType.pivotTimeline),ot(n,t)}function ot(t,i){for(var i,n,e,r,o,a,s,c,u,l,f,h,i=i.styles,n=new g.SimpleSharedStrings,e=new g.SimpleSharedStrings,r=new g.SharedDxfs(n,e),o=[],a=0,s=t;a<s.length;a++)for(l=0,f=u=(c=s[a]).slicers.all().filter(function(t){return"timeline"===t.ma});l<f.length;l++)(h=f[l]).style().wh(!1,!0,m.keyword_undefined,{x15dxfsRecords:r,timelineStyleNodes:o});i.extLst||(i.extLst={}),g.GC$.extend(i.extLst,{x15dxfsRecords:r.iv(),timelineSharedColors:n.wh(),timelineCommonSharedStrings:e.wh(),timelineStyleNodes:o})}i=this&&this.__extends||(S=function(t,i){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(r,"__esModule",{value:!0}),r.PivotSlicerCacheManager=r.PivotTimelineSlicerCache=r.PivotItemSlicerCache=void 0,g=t("Core"),n=t("Common"),w=t("Slicers"),f=t("Pivot"),h=t("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),m=t("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=t("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),e=t("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),o=t("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),u=t("./dist/plugins/pivot/pivot-util.js"),t=new n.Common.ResourceManager(f.SR,"PivotEngine"),b=t.getResource.bind(t),a="Slicer_",s="NativeTimeline_",v=g.Util.wr,E=g.Util.Mr,B=g.Util.ho,R=g.Util.Er,d=g.mt.vo,G=g.mt.n1,t=n.Common.ct,l=t.o0,w&&(n=w.SlicerCacheBase,y=w.SlicerCacheType,p=w.TimelineLevel,C=w.appendNameMapWithMode,N=w.loadSheetSlicers,V=w.SLICER_DRAWING_PATH,U=w.TIMELINE_DRAWING_PATH,I=w.decodeSlicerName,i(_,k=n),_.prototype.pQt=function(t){for(var i,n,i=-1,n=0;n<this.pivotTables.length;n++)this.pivotTables[n].name()===t.name()&&(i=n);return i},_.prototype.mQt=function(){return this.Ti.mQt()},_.prototype.afterSetFilter=function(){var t=this;k.prototype.afterSetFilter.call(this),0===t.pivotTables.length&&t.refreshSlicers()},_.prototype.bQt=function(i,t){var n,e;return void 0===i&&(i=!1),void 0===t&&(t=!0),(n=this).gQt&&0<Object.keys(n.gQt).length&&(e=n.Ti.mQt(),g.GC$.each(n.gQt,function(t){var t=e.wQt(t);if(!t)return!1;i=!0,n.pivotTables.push(t)})),t&&(n.gQt=m.keyword_null),i&&n.updateCache(),!0},_.prototype.isConnectedPivotTable=function(t){for(var i=0;i<this.pivotTables.length;i++)if(this.pivotTables[i].name()===t)return!0;return!1},_.prototype.connect=function(t,i){var n,e,r,n=this,e;t.dh.Ti.getPivotCacheByName(t.dh.L).yQt!==n.pivotCache.yQt||-1!==n.pQt(t)||((r=n.Ti.getExistedSlicerCache(t,n.sourceName,n.slicerCacheType))?n.Ti.CQt(n,r):n.pivotTables.push(t),i)||n.setSingleFilter(t)},_.prototype.disconnect=function(t){var i,t,i;t.dh.Ti.getPivotCacheByName(t.dh.L).yQt===this.pivotCache.yQt&&-1!==(t=this.pQt(t))&&this.pivotTables.splice(t,1)},_.prototype.onWorkSheetDisposing=function(t){var i,n,e,i=this;for(k.prototype.onWorkSheetDisposing.call(this,t),n=i.pivotTables.length-1;-1<n;n--)(e=i.pivotTables[n]).Ti&&e.Ti.name()!==t||i.pivotTables.splice(n,1)},_.prototype.clearSelfFilter=function(){},_.prototype.clearFilter=function(){var t,i,n,e,t=this;if(t.canUpdate()&&!t.filterCleared()){for(t.clearSelfFilter(),t.beforeSetFilter(),i=0;i<this.pivotTables.length;i++)(e=(n=this.pivotTables[i]).dh).wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:t.sourceName,pivotName:n.name(),commandName:"ClearFilter",clearType:1,labelType:t.slicerCacheType===y.pivotSlicer?1:2}});t.afterSetFilter()}},_.prototype.setFilter=function(){},_.prototype.setSingleFilter=function(t){},_.prototype.toJSON=function(){var t,n,i,t=this,n=t.Ti.mQt(),i=t.pivotTables.map(function(t){var i=t.Ti;return{tabId:n.getSheetIndex(i.name())+1,name:t.Zc}});return{name:t.name,sourceName:t.sourceName,pivotCacheId:t.pivotCache.yQt,pivotTables:i}},_.prototype.wh=function(t,i,n){for(var e,r,o,a,s,c,u,l,e=this,r={r_:e.slicerCacheType===y.pivotSlicer?[42,14,30,43]:[60,32,14],name:d(e.name),sourceName:d(e.sourceName),pivotTables:{pivotTable:[]}},o=e.Ti.mQt(),a=r.pivotTables.pivotTable,s=e.pivotTables,c=0;c<s.length;c++)l=(u=s[c]).Ti,a.push({tabId:o.getSheetIndex(l.name())+1+"",name:d(u.Zc)});return r},_.prototype.fromJSON=function(t){var n,e,n=this;k.prototype.fromJSON.call(this,t),n.pivotTables=[],e=n.Ti.mQt(),(0,f.o)(t.pivotTables,function(t){var i=e.wQt(t.name);i?n.pivotTables.push(i):(n.gQt||(n.gQt={}),n.gQt[t.name]=!0)})},_.prototype.preFromSJSFormat=function(t){var e,r,t,t,e=this;e.disposeAllSlicers(),e.IQt=[],e.pivotTables=[],e.name=I(t.name),e.sourceName=I(t.sourceName),r=e.Ti.mQt(),t=t.pivotTables&&t.pivotTables.pivotTable,t=Array.isArray(t)?t:[t],g.GC$.each(t,function(t,i){var i,n,i=G(i.name),n=r.wQt(i);n?e.pivotTables.push(n):(e.gQt||(e.gQt={}),e.gQt[i]=!0)})},_.prototype.yh=function(t,i,n){},_.prototype.dispose=function(){var t=this;k.prototype.dispose.call(this),t.Ti=m.keyword_null,t.pivotCache=m.keyword_null,t.pivotTables=m.keyword_null},i(F,D=t=_),F.prototype.filterCleared=function(){for(var t,i,t=this,i=0;i<t.items.length;i++)if(!1===t.items[i].selected)return!1;return!0},F.prototype.add=function(t,i){var n,i,n=this,i=new e.PivotTableItemSlicer(i,t,n);return n.IQt.push(i),i},F.prototype.sortState=function(t){var i=this;if(0===arguments.length)return i.fQt;(0,f.ht)(t)||t===i.fQt||(i.fQt=t,i.refreshSlicers())},F.prototype.showNoDataItems=function(t){var i=this;if(0===arguments.length)return i.hQt;(t=!!t)!==i.hQt&&(i.hQt=t,i.refreshSlicers())},F.prototype.showNoDataItemsInLast=function(t){var i=this;if(0===arguments.length)return i.vQt;(t=!!t)!==i.vQt&&(i.vQt=t,i.refreshSlicers())},F.prototype.visuallyNoDataItems=function(t){var i=this;if(0===arguments.length)return i.dQt;(t=!!t)!==i.dQt&&(i.dQt=t,i.refreshSlicers())},F.prototype.initItems=function(){var t,i,n,e,r,o,a,t=this.pivotCache.getField(this.sourceName);for(e in j(t,this.pivotCache),i=[],n=t.DH(),t.sQt)t.sQt.hasOwnProperty(e)&&(r=t.sQt[e],a=n[o=parseInt(e,10)],0!==t.W5||isNaN(+a)||(a=+a),i[r]={text:a,selected:!0,noData:!0});return i},F.prototype.buildItems=function(t){var i,t,n,e,r,o,a,s,e,c,u,l,f,h,v,d,p,i=this;if(0===i.pivotTables.length)return this.items||this.initItems();for(h in t=(t||i.pivotTables[0]).dh,n=i.sourceName,r=(e=i.pivotCache).getField(n),o=b().blank,a=r.sf(),j(r,e),s=i.TQt(i.MQt()).NQt,u=(c=(e=t.getFilterInfo(n))&&e.labelFilter&&e.labelFilter.textItem)||{isAll:!0,list:m.keyword_undefined},l=[],f=r.DH(),a)a.hasOwnProperty(h)&&(v=a[h],p=f[d=parseInt(h,10)],0!==r.W5||isNaN(+p)||(p=+p),l[v]={text:p,selected:u.isAll||!!u.list&&-1!==u.list.indexOf(p),noData:s[d]===m.keyword_undefined||p===o});return l},F.prototype.TQt=function(t){var i=this,n;return i.Ti.mQt().fMt.TQt(i.pivotCache.getName(),t,i.sourceName)},F.prototype.MQt=function(){var a,s,t,c,u,l,a=this,s=a.pivotTables[0].dh,t=s.bit(),c=s.getAllFieldNameList(),u=[],l=s.Ti.getPivotCacheByName(s.L);return c.splice(c.indexOf(a.sourceName),1),(0,f.o)(t,function(t){var i,n,e,r,o,o,r,t,i,i=l.zRt(t.a),n,e=!(0,f.ht)(i.y1)?l.zRt(i.y1):void 0;i.Zc!==a.sourceName&&((r=s.getFilterInfo(t.a))&&r.u&&(s.q1=!0,r.u=!1),-1!==(o=c.indexOf(t.a))&&c.splice(o,1),r=(o=t.toPivotViewQueryField(r,s.Z[t.Zc],i,e,!0)).items,t=o.sourceName,i=o.isALL,u.push({items:r,sourceName:t,isALL:i}))}),(0,f.o)(c,function(t){var i,n,e,i,n,e,i=s.getFilterInfo(t);i&&i.labelFilter&&i.labelFilter.textItem&&!1===i.labelFilter.textItem.isAll&&(n=l.zRt(t),e=(0,f.ht)(n.y1)?void 0:l.zRt(n.y1),n=(i=(0,h.toPivotViewQueryField)(t,t,-1,i,m.keyword_undefined,-1,n,e)).items,e=i.isALL,u.push({items:n,sourceName:t,isALL:e}))}),u},F.prototype.updateItems=function(t){this.items=this.buildItems(t)},F.prototype.updateCache=function(t){var i,n,e,r,i=this;if(i.canUpdate()){if(i.updateItems(t),t)for(n=0,e=i.pivotTables;n<e.length;n++)(r=e[n])!==t&&i.setSingleFilter(r,t);i.refreshSlicers()}},F.prototype.clearSelfFilter=function(){var t,i,t,i=this.items;(0,f.o)(i,function(t){t.selected=!0})},F.prototype.setSingleFilter=function(t,i){var n,e,r,e,n=this;n.canUpdate()&&(e=n.items,r=[],(0,f.o)(e,function(t){r.push({status:t.selected,value:t.text})}),e=t.dh,n.suspendUpdate(),e.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:n.sourceName,pivotName:t.name(),slicerCacheName:n.name,dataOfListBox:r}}),n.resumeUpdate())},F.prototype.setFilter=function(t){var i,n,e,r,o,i=this;if(i.canUpdate()&&(t||!i.filterCleared())){for(t=t||i.items,n=[],(0,f.o)(t,function(t){n.push({status:t.selected,value:t.text})}),i.beforeSetFilter(),e=0;e<i.pivotTables.length;e++)(o=(r=i.pivotTables[e]).dh).wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:i.sourceName,pivotName:r.name(),slicerCacheName:i.name,dataOfListBox:n}});i.afterSetFilter()}},F.prototype.toJSON=function(){var t,i,n,e,r,t=this,i=D.prototype.toJSON.call(this),n=t.pivotCache.getField(t.sourceName);return n&&(r=n.getFieldsItemList(),e=t.items.map(function(t){return{x:r.indexOf(t.text),s:t.selected,nd:t.noData}})),{name:i.name,sourceName:i.sourceName,pivotCacheId:i.pivotCacheId,pivotTables:i.pivotTables,items:e,sortOrder:t.fQt===g.SortState.descending?g.SortState.descending:g.SortState.ascending,showNoDataItems:t.hQt,showNoDataItemsInLast:t.vQt,visuallyNoDataItems:t.dQt}},F.prototype.wh=function(t,i,n){var e,r,t,i,o,a,s,c,u,e=this,r=e.items,t=D.prototype.wh.call(this,t,i,n);if(t.data={tabular:{pivotCacheId:e.pivotCache.yQt+"",items:{count:r.length,i:[]}}},e.fQt===g.SortState.descending&&(t.data.tabular.sortOrder="descending"),!1===e.dQt?t.data.tabular.crossFilter="none":!1===e.vQt&&(t.data.tabular.crossFilter="showItemsWithNoData"),!1===e.hQt&&(t.extLst={ext:[{r_:[33,44],slicerCacheHideItemsWithNoData:{}}]}),i=e.pivotCache.getField(e.sourceName))for(o=i.getFieldsItemList(),a=t.data.tabular.items.i,s=0;s<r.length;s++)c=r[s],u={x:o.indexOf(c.text)},c.selected&&(u.s="1"),c.noData&&(u.nd="1"),a.push(u);return t},F.prototype.fromJSON=function(t){var i,n,e,i=this;D.prototype.fromJSON.call(this,t),j(n=this.pivotCache.getField(this.sourceName),i.pivotCache),t.items?(e=n.DH(),i.items=t.items.map(function(t){var i;return{text:e[+t.x],selected:!!t.s,noData:!!t.nd}})):i.items=i.buildItems(),(0,f.ht)(t.sortOrder)||(i.fQt=t.sortOrder),(0,f.ht)(t.showNoDataItems)||(i.hQt=t.showNoDataItems),(0,f.ht)(t.showNoDataItemsInLast)||(i.vQt=t.showNoDataItemsInLast),(0,f.ht)(t.visuallyNoDataItems)||(i.dQt=t.visuallyNoDataItems)},F.prototype.preFromSJSFormat=function(t){var i,n,e,n,e,i=this;D.prototype.preFromSJSFormat.call(this,t),n=t.extLst&&t.extLst.ext,(0,f.ht)(n)||(e=!1,Array.isArray(n)?e=0<n.filter(function(t){return t.slicerCacheHideItemsWithNoData}).length:n.slicerCacheHideItemsWithNoData&&(e=!0),e&&(i.hQt=!1)),n=t.data.tabular,(0,f.ht)(n.sortOrder)||(i.fQt="descending"===n.sortOrder?g.SortState.descending:g.SortState.ascending),"none"===(e=n.crossFilter)?i.dQt=!1:"showItemsWithNoData"===e&&(i.vQt=!1)},F.prototype.yh=function(t,i,n){},F.prototype.dispose=function(){var t=this;D.prototype.dispose.call(this),t.items=m.keyword_null},A=F,Q=[f.PivotDateFilterOperator.equalsTo,f.PivotDateFilterOperator.Between,f.PivotDateFilterOperator.tomorrow,f.PivotDateFilterOperator.today,f.PivotDateFilterOperator.yesterday,f.PivotDateFilterOperator.nextWeek,f.PivotDateFilterOperator.thisWeek,f.PivotDateFilterOperator.lastWeek,f.PivotDateFilterOperator.nextMonth,f.PivotDateFilterOperator.thisMonth,f.PivotDateFilterOperator.lastMonth,f.PivotDateFilterOperator.nextQuarter,f.PivotDateFilterOperator.thisQuarter,f.PivotDateFilterOperator.lastQuarter,f.PivotDateFilterOperator.nextYear,f.PivotDateFilterOperator.thisYear,f.PivotDateFilterOperator.lastYear,f.PivotDateFilterOperator.yearToDate,f.PivotDateFilterOperator.dateToDate],W=[f.PivotDateFilterOperator.before,f.PivotDateFilterOperator.beforeEqualsTo,f.PivotDateFilterOperator.after,f.PivotDateFilterOperator.afterEqualsTo,f.PivotDateFilterOperator.Between,f.PivotDateFilterOperator.notBetween],i(P,x=t),Object.defineProperty(P.prototype,"canShowRange",{get:function(){return(0,f.ht)(this.filterType)||this.isValidFilterType},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"isValidFilterType",{get:function(){var t=this.filterType,i=this.getFilterCondition();return-1!==Q.indexOf(t)&&(t!==f.PivotDateFilterOperator.dateToDate||!i.EVt)},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"filterType",{get:function(){var t,t,t=this;return 0===t.pivotTables.length&&t.selection?f.PivotDateFilterOperator.Between:(t=t.getFilterCondition())&&t.LVt},enumerable:!1,configurable:!0}),P.prototype.getFilterCondition=function(t){var i,t,i,i=this;return 0!==i.pivotTables.length&&(i=(t=(t||i.pivotTables[0]).dh.getFilterInfo(i.sourceName))&&t.labelFilter&&t.labelFilter.condition&&t.labelFilter.condition)&&i.sn===f.PivotConditionType.date?i:m.keyword_undefined},P.prototype.filterCleared=function(){var t=this;return!(!(0,f.ht)(t.filterType)&&!t.isValidFilterType||t.selection&&(t.selection.startDate!==t.bounds.startDate||t.selection.endDate!==t.bounds.endDate))},P.prototype.buildBounds=function(){var t=this.pivotCache.getField(this.sourceName);return{startDate:t.T,endDate:t.gd}},P.prototype.buildSelections=function(t){var i,n,e,i,r,o,a,s,i=this;if(!i.isValidFilterType)return m.keyword_undefined;if(0===i.pivotTables.length)return this.selection||this.bounds||this.buildBounds();if(!(n=i.getFilterCondition(t)))return m.keyword_undefined;switch(e=n.xQt,i=new Date,r=(0,f.DQt)(i),o=(0,f.DQt)(i),a=(0,f.SQt)(e,n.eX),s=(0,c.getQuarter)(r),n.LVt){case f.PivotDateFilterOperator.equalsTo:r=new Date(a),o=new Date(a);break;case f.PivotDateFilterOperator.dateToDate:case f.PivotDateFilterOperator.Between:r=new Date(a),o=new Date((0,f.SQt)(e,n.iX));break;case f.PivotDateFilterOperator.tomorrow:r.setDate(r.getDate()+1),o.setDate(o.getDate()+1);break;case f.PivotDateFilterOperator.today:break;case f.PivotDateFilterOperator.yesterday:r.setDate(r.getDate()-1),o.setDate(o.getDate()-1);break;case f.PivotDateFilterOperator.nextWeek:r.setDate(r.getDate()-r.getDay()+7),o.setDate(o.getDate()-o.getDay()+14);break;case f.PivotDateFilterOperator.thisWeek:r.setDate(r.getDate()-r.getDay()),o.setDate(o.getDate()-o.getDay()+6);break;case f.PivotDateFilterOperator.lastWeek:r.setDate(r.getDate()-r.getDay()-7),o.setDate(o.getDate()-o.getDay());break;case f.PivotDateFilterOperator.nextMonth:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.thisMonth:r.setDate(1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.lastMonth:r.setDate(1),r.setMonth(r.getMonth()-1),o.setMonth(o.getMonth()-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.nextQuarter:r.setDate(1),r.setMonth(3*s),o.setMonth(3*(s+1)-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.thisQuarter:r.setDate(1),r.setMonth(3*(s-1)),o.setMonth(3*s-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.lastQuarter:r.setDate(1),r.setMonth(3*(s-2)),o.setMonth(3*(s-1)-1),o.setDate((0,c.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.nextYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()+1),o.setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.thisYear:r.setDate(1),r.setMonth(0),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.lastYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()-1),o.setFullYear(o.getFullYear()-1),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.yearToDate:r.setDate(1),r.setMonth(0)}return{startDate:r,endDate:o}},P.prototype.updateCache=function(t){var i,n,e,r,i=this;if(0!==i.pivotTables.length){if(i.bounds=i.buildBounds(),i.selection=i.buildSelections(t),t)for(n=0,e=i.pivotTables;n<e.length;n++)(r=e[n])!==t&&i.setSingleFilter(r,t);i.refreshSlicers()}},P.prototype.clearSelfFilter=function(){this.selection=m.keyword_null},P.prototype.setSingleFilter=function(t,i){var n,e,i,r,i,r,i,n=this;n.canUpdate()&&(e=t.dh,i?(i=i.labelFilter(n.sourceName),(r=t.labelFilter(n.sourceName)||{}).condition=null==i?void 0:i.condition,r.condition||r.textItem||r.conditionByName||(r=m.keyword_null),n.suspendUpdate(),e.wVt({cmd:"doPivotTableFilter",sheetName:"",cmdOption:{labelFilter:r,fieldName:n.sourceName,pivotName:t.name(),slicerCacheName:n.name}}),n.resumeUpdate()):n.filterCleared()||(r=(i=n.selection).startDate,i=i.endDate,n.suspendUpdate(),e.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:n.sourceName,pivotName:t.name(),slicerCacheName:n.name,command:"6",isWholeDay:!0,value1:r,value2:i}}),n.resumeUpdate()))},P.prototype.setFilter=function(t){var i,t,n,e,r,o,a,i=this;if(i.canUpdate()&&(t||!i.filterCleared())){for(t&&(i.selection=t),n=(t=i.selection).startDate,e=t.endDate,i.beforeSetFilter(),r=0;r<i.pivotTables.length;r++)(a=(o=i.pivotTables[r]).dh).wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:i.sourceName,pivotName:o.name(),slicerCacheName:i.name,command:"6",isWholeDay:!0,value1:n,value2:e}});i.afterSetFilter()}},P.prototype.add=function(t,i){var n,i,n=this,i=new o.PivotTableTimelineSlicer(i,t,n);return n.IQt.push(i),i},P.prototype.toJSON=function(){var t,i,t,i=this,t=x.prototype.toJSON.call(this);return{name:t.name,sourceName:t.sourceName,pivotCacheId:t.pivotCacheId,pivotTables:t.pivotTables,selectionStartDate:i.selection&&i.selection.startDate.toString(),selectionEndDate:i.selection&&i.selection.endDate.toString(),boundsStartDate:i.bounds.startDate.toString(),boundsEndDate:i.bounds.endDate.toString(),filterType:i.filterType,filterCondition:null==(t=i.getFilterCondition())?void 0:t.toJSON()}},P.prototype.wh=function(t,i,n){var e,t,i,n,r,o,a,s,c,o,i,n,c,o,i,e,e=this,t=x.prototype.wh.call(this,t,i,n),i=e.selection,n=e.bounds,r=e.filterType,o=(0,f.ht)(r),a=h.Caption_Compare_Type_Excel[1][r],s=e.isValidFilterType,c=t.state={minimalRefreshVersion:"6",lastRefreshVersion:"6",pivotCacheId:e.pivotCache.yQt+""};return o||s||(c.singleRangeFilterState="0"),c.filterType=o||!a?"unknown":a,s&&i&&(c.selection={startDate:(0,f.kQt)(i.startDate),endDate:(0,f.kQt)(i.endDate)}),n&&(o=new Date("1900/01/01"),i=new Date("1900/01/01"),o.setFullYear(n.startDate.getFullYear()),i.setFullYear(n.endDate.getFullYear()+1),c.bounds={startDate:(0,f.kQt)(o),endDate:(0,f.kQt)(i)}),(n=e.getFilterCondition())&&(c=$(n,a),o=-1!==W.indexOf(r),i="0",c&&!(0,f.ht)(c.isWholeDay)&&(i=c.isWholeDay?"1":"0"),e={useWholeDay:i=o?"1":i,fld:"1",id:"1",autoFilter:{ref:"A1",filterColumn:{r_:[43],colId:"0"}}},s&&c?(2===c.filterType&&(e.autoFilter.filterColumn.dynamicFilter=(0,u.writePivotDynamicFilter)(c)),t.timelinePivotFilter=e):o&&(e.autoFilter.filterColumn.customFilters=K(c,u.PivotComparisonOperators),t.timelinePivotFilter=e)),t},P.prototype.fromJSON=function(t){var i=this;x.prototype.fromJSON.call(this,t),t.selectionStartDate&&t.selectionEndDate&&(i.selection={startDate:new Date(t.selectionStartDate),endDate:new Date(t.selectionEndDate)}),i.bounds={startDate:new Date(t.boundsStartDate),endDate:new Date(t.boundsEndDate)}},P.prototype.preFromSJSFormat=function(t){var i,t,n,t,i=this;x.prototype.preFromSJSFormat.call(this,t),(t=t.state)&&(n=t.selection,t=t.bounds,n&&n.startDate&&n.endDate&&(i.selection={startDate:new Date(n.startDate),endDate:new Date(n.endDate)}),t)&&t.startDate&&t.endDate&&(i.bounds={startDate:new Date(t.startDate),endDate:new Date(t.endDate)})},P.prototype.yh=function(t,i,n){},P.prototype.dispose=function(){x.prototype.dispose.call(this)},T=P,O.prototype.jQt=function(t){var i,n,e,r,o,i=this,n=i.vpt;if(i.get(t)||n.getCustomName(t))return!1;for(e=n.sheets,r=0;r<e.length;r++)if((o=e[r]).getCustomName(t))return!1;return!0},O.prototype.OQt=function(t,i){var n,e,r,n=this,e=t+z(i);if(n.jQt(e))return e;for(r=1;!n.jQt(e+r);)r+=1;return e+r},O.prototype.mQt=function(){return this.vpt},O.prototype.PQt=function(i,n,e){var r=[];return(0,f.o)(this.cQt,function(t){t.pivotCache.getName()!==i||n&&t.slicerCacheType!==n||e&&t.sourceName!==e||r.push(t)}),r},O.prototype.getPTConnectedSlicers=function(n){var e=[];return(0,f.o)(this.cQt,function(t){for(var i=0;i<t.pivotTables.length;i++)t.pivotTables[i]===n&&(e=e.concat(t.IQt))}),e},O.prototype.getExistedSlicerCache=function(n,e,r){var o=m.keyword_null;return(0,f.o)(this.cQt,function(t){if(t.sourceName===e&&t.slicerCacheType===r)for(var i=0;i<t.pivotTables.length;i++)if(t.pivotTables[i]===n)return o=t,!0}),o},O.prototype.CQt=function(i,t){var n=this;i.pivotTables=i.pivotTables.concat(t.pivotTables),(0,f.o)(t.IQt,function(t){i.IQt.push(t),t.FQt=i}),t.pivotTables=[],t.IQt=[],n.remove(t.name),i.setFilter()},O.prototype.get=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t)return e;return m.keyword_undefined},O.prototype.add=function(t,i,n){var e,r,r,e;return void 0===n&&(n=y.pivotSlicer),e=this,r=t.dh.L,(r=t.dh.Ti.getPivotCacheByName(r))&&(e=e.getExistedSlicerCache(t,i,n)||e._Qt(r.yQt,i,n))?(e.connect(t,!0),1===e.pivotTables.length&&e.updateCache(),e):m.keyword_undefined},O.prototype._Qt=function(t,i,n){var e,t,n;return void 0===n&&(n=y.pivotSlicer),(t=(e=this).mQt().fMt.getPivotCacheByPivotCacheId(+t))&&t.getField(i)?(n=n===y.pivotSlicer?new A(e,t,i,e.OQt(a,i)):new T(e,t,i,e.OQt(s,i)),e.cQt.push(n),n):m.keyword_undefined},O.prototype.remove=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t){e.dispose(),i.cQt.splice(n,1);break}},O.prototype.getSlicer=function(i){var t,n,t;return(0,f.o)(this.cQt,function(t){var t=t.get(i);if(t)return n=t,!0}),n},O.prototype.getAllSlicers=function(i){var t,n,t,n=[];return(0,f.o)(this.cQt,function(t){(0,f.o)(t.IQt,function(t){!(0,f.ht)(i)&&t.sheet().name()!==i||n.push(t)})}),n},O.prototype.removeSlicer=function(n){var e,r,e=this;return(0,f.o)(e.cQt,function(t){var i=t.get(n);if(i)return(r={}).slicerJSON=i.toJSON(),t.remove(n),0===t.IQt.length&&(r.cacheJSON=t.toJSON(),e.remove(t.name)),!0}),r},O.prototype.undoAddingPivotTable=function(t){for(var i,n,e,r,o,i=this,n=i.cQt,e=0;e<n.length;e++)-1!==(o=(r=n[e]).pivotTables.indexOf(t))&&(i.lQt.push({cacheName:r.name,ptName:t.name()}),r.pivotTables.splice(o,1))},O.prototype.undoRemovingPivotTable=function(t){for(var i,n,e,r,o,o,i=this,n=i.lQt,e=t.name(),r=n.length-1;-1<r;r--)(o=n[r]).ptName===e&&(-1===(o=i.get(o.cacheName)).pivotTables.indexOf(t)&&o.pivotTables.push(t),n.splice(r,1))},O.prototype.onWorksheetDisposing=function(t){for(var i,n,e,r,i=this,n=i.cQt,e=n.length-1;-1<e;e--)(r=n[e]).onWorkSheetDisposing(t),0===r.IQt.length&&i.remove(r.name)},O.prototype.updateSlicerCaches=function(t,i){for(var n,e,r,o,n=this,e=n.cQt,r=0;r<e.length;r++)-1===(o=e[r]).pivotCache.getAllFieldsNames().indexOf(o.sourceName)?n.remove(o.name):t&&!o.isConnectedPivotTable(t.name())||o.updateCache(i?t:m.keyword_undefined)},O.prototype.LQt=function(i,n){var e,r;void 0===i&&(i=!1),void 0===n&&(n=!0),r=[],(0,f.o)((e=this).cQt,function(t){t.bQt(i,n)||r.push(t.name)}),r.forEach(function(t){e.remove(t)})},O.prototype.toJSON=function(){var t,i,t,i=[];return(0,f.o)(this.cQt,function(t){i.push(t.toJSON())}),i},O.prototype.fromJSON=function(t){var n=this;0<t.length&&((0,f.o)(this.cQt,function(t){t.dispose()}),n.cQt=[],n.lQt=[],(0,f.o)(t,function(t){var i,i,i=(0,f.ht)(t.boundsStartDate)?y.pivotSlicer:y.pivotTimeline,i=n._Qt(t.pivotCacheId,t.sourceName,i);i&&i.fromJSON(t)}))},O.prototype.preFromSJSFormat=function(t,i,n){var e,r,r,o,r,n,a,s,c,u,l,f,h,v,t,d,p,m,b,e=this;if(e.cQt.forEach(function(t){t.dispose()}),e.cQt=[],r=t.slicerCaches,g.GC$.each(r,function(t,i){var i,n,n,i=i.slicerCacheDefinition;i.pivotTables&&(n=Z(i),n=e._Qt(n,i.sourceName,y.pivotSlicer))&&n.preFromSJSFormat(i)}),r=t.timelineCaches,g.GC$.each(r,function(t,i){var i,n,n,i=i.timelineCacheDefinition,n=Z(i,!0),n=e._Qt(n,i.sourceName,y.pivotTimeline);n&&n.preFromSJSFormat(i)}),!(o=n&&!1===n.includeStyles)&&(n=(r=t.styles).extLst,a=g.NodeHelper.cr(r.tableStyles&&r.tableStyles.c_),n)&&(s=n.x15dxfsRecords,c=n.timelineStylesNode,u=n.timelineStyleNodes,l=n.timelineSharedColors,f=n.timelineCommonSharedStrings,c||u))for(t=v=h=void 0,c?(h=!0,v=g.NodeHelper.cr(c.timelineStyle),t=c.kSt&&c.kSt.defaultTimelineStyle||"TimeSlicerStyleLight1"):(h=!1,v=u,t="TimeSlicerStyleLight1",l=new g.SimpleSharedStrings(l),f=new g.SimpleSharedStrings(f)),d=i.styleManager,(p=new g.SharedDxfs(l,f)).rv(s),d.addDefaultStyleName("defaultTimelineStyle",t),m=function(t){var t,i,t,n,e,r,t=v[t];if(!t)return"continue";i=h?t.kSt&&t.kSt.name:t.name,t=h?g.NodeHelper.lr(t,"timelineStyleElements.timelineStyleElement"):t.styleElements,n=void 0,a&&(n=(e=a.filter(function(t){return t.name===i})[0])&&g.NodeHelper.lr(e,"c_")),(r=new w.TimelineStyle).yh(i,d,p,t,n)},b=0;b<v.length;b++)m(b)},O.prototype.yh=function(t,i,n,e){var r,o,a,s,c,u,l,f,h,v,d,p,m,b,r=this,o=!!e,a=n&&n.sheets,s=t.slicers,c=t.timelines,u=t.drawings,l=t.styleManager,f=C(n,a,u,V,e),h=C(n,a,u,U,e);if(o)N(r,f,s,e.name(),u,t,l,i),N(r,h,c,e.name(),u,t,l,i,!0);else{for(v=0,d=Object.keys(f);v<d.length;v++)p=d[v],N(r,f,s,p,u,t,l,i);for(m=0,b=Object.keys(h);m<b.length;m++)p=b[m],N(r,h,c,p,u,t,l,i,!0)}},O.prototype.dispose=function(){(0,f.o)(this.cQt,function(t){t.dispose()}),this.lQt=m.keyword_null,this.cQt=m.keyword_null,this.vpt=m.keyword_null},M=O,g.Workbook.ch("SlicerCaches",{init:function(){var t;this.EQt=new M(this)},dispose:function(){var t=this;t.EQt&&(t.EQt.dispose(),t.EQt=m.keyword_undefined)},preFromJson:function(t,i,n){var e=this;e.EQt.dispose(),e.EQt=new M(e),t.slicerCaches&&0!==t.slicerCaches.length&&e.EQt.fromJSON(t.slicerCaches)},fromJson:function(t,i,n){var e=this;t.slicerCaches&&0!==t.slicerCaches.length&&(e.EQt.LQt(!1),e.EQt.updateSlicerCaches())},preFromSJSFormat:function(t,i,n){var e=this;e.EQt.dispose(),e.EQt=new r.PivotSlicerCacheManager(e),(t.slicerCaches&&0<Object.keys(t.slicerCaches).length||t.timelineCaches&&0<Object.keys(t.timelineCaches).length)&&e.EQt.preFromSJSFormat(t,i,n)},yh:function(t,i,n){var e,r,o,a,s,c,r,o,e=this;(t.slicerCaches&&0<Object.keys(t.slicerCaches).length||t.timelineCaches&&0<Object.keys(t.timelineCaches).length)&&(g.Util.wo(n,e.v2)?(o=(r=e.getActiveSheet()).name(),a=r.Uw(),r=q(s=i.sheetRelsMap,i,o,c=g.mt.xr(t.workbook,"sheets").c_),g.GC$.each(r,function(t,i){a.addReferenceSheetName(i)})):((o=e.EQt).LQt(!1),o.yh(i,n,t),o.updateSlicerCaches()))},toJson:function(t,i){var n,e,n,e=this.EQt.toJSON();e&&0<e.length&&(t.slicerCaches=e)},wh:function(t,i,n){var e,i,r,o,a,s,c,u,e=this,i=i.styleManager,r=e.EQt;if(r&&!(o=n&&!1===n.includeStyles)&&(s=a=!1,c=r.cQt)&&0<c.length){for(u=0;u<c.length&&(c[u].slicerCacheType===y.pivotSlicer&&(a=!0),c[u].slicerCacheType===y.pivotTimeline&&(s=!0),!a||!s);u++);a&&w.fdi(t,c,tt),s&&et(t,c),a&&(t.slicers||(t.slicers={}),w.cdi(t,c,e.sheets,i,"pivot",y.pivotSlicer)),s&&(t.timelines||(t.timelines={}),rt(t,c,e.sheets,i)),(a||s)&&nt(t)}}}),g.Worksheet.ch("SlicerCaches",{yh:function(t,i,n){var e,e,e=this.parent;n&&g.Util.wo(n,e.v2)&&((e=e.EQt).LQt(!1,!1),e.yh(i,n,t,this),e.updateSlicerCaches())},refSheetLazyLoaded:function(t){var i;(0<this.pivotTables.all().length||0<this.slicers.all().length)&&((i=this.parent.EQt).LQt(!1),i.updateSlicerCaches())},dispose:function(t){!1!==t.clearCache&&this.parent&&this.parent.EQt.onWorksheetDisposing(this.name())}}),g.GC$.extend(g.Workbook.prototype,{getSameSourcePivotTablesBySlicer:function(t){var i,t,n,e,r,o,a,s,c,u,u,u,i=this,t=t.FQt,n=i.EQt.PQt(t.pivotCache.getName(),t.slicerCacheType,t.sourceName),e=t.pivotCache.Zc,r={},o=[],a="__NO__CACHE__";for((0,f.o)(n,function(t){0<t.pivotTables.length&&(r[t.name]=t.pivotTables.map(function(t){return{ptName:t.name(),sheetName:t.getHost().name()}}),o=o.concat(t.pivotTables.map(function(t){return t.dh.getName()})))}),s=0,c=Object.keys(i.BQt);s<c.length;s++)u=c[s],-1===o.indexOf(u)&&(u=i.BQt[u]).L===e&&(r[a]||(r[a]=[]),u=(0,m.getPivotTableByFieldsModel)(u),r[a].push({ptName:u.name(),sheetName:u.getHost().name()}));return r},getSameSourceSlicersByPivotTable:function(t){var i,t,i,n,i=this,t=t.dh.Ti.getPivotCacheByName(t.dh.L),i=i.EQt.PQt(t.getName()),n={};return(0,f.o)(i,function(t){0<t.IQt.length&&(n[t.name]=t.IQt.slice())}),n}}),r.PivotItemSlicerCache=A,r.PivotTimelineSlicerCache=T,r.PivotSlicerCacheManager=M)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js":function(t,h,i){"use strict";var n,e,f,r,o,a,v,s,c,u,l,d;function p(t,i){for(var n,e,r,o,a,n=t.sheets,e=0;e<n.length;e++)if(r=n[e].slicers&&n[e].slicers.all())for(o=0;o<r.length;o++)if(w(a=r[o])&&a.GQt.RQt===i)return{sheetIndex:e,slicer:a};return h.keyword_null}function m(t,i){return t.EQt.getSlicer(i)}function b(t){for(var i,n,i=0;i<t.z.length;i++)if((n=t.z[i])instanceof c.PivotTable)return n;return h.keyword_null}function g(t,i){var t,n,t=b(t);t&&t.Ti&&t.Ti.parent&&(n=t.Ti.parent).EQt.updateSlicerCaches(t,i)}function w(t){return t&&(t.ma===v.SlicerType.pivotTable||t.ma===v.SlicerType.pivotTimeline)}function y(t,i){var i=i.BQt[t];return i?b(i):h.keyword_null}function C(t,i,n){var t=d.call(this,t,i,n)||this;return t.captionName(t.sourceName()),t}n=this&&this.__extends||(l=function(t,i){return(l=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}l(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(h,"__esModule",{value:!0}),h.VQt=h.getPivotTableByPTName=h.getPivotTableByFieldsModel=h.NAME=h.keyword_undefined=h.keyword_null=void 0,e=i("Core"),f=i("Pivot"),r=i("Shapes"),o=i("Shapes"),a=i("Slicers"),v=i("Slicers"),s=i("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),c=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),h.keyword_null=null,h.keyword_undefined=void 0,h.NAME="name",h.getPivotTableByFieldsModel=b,h.getPivotTableByPTName=y,a&&o&&(r.ShapeBase.ch("PivotSlicer",{fireEvents:function(n){var e,r,o,a,t,e=n.sheet,r=n.sheetName,o=n.propertyName,a=n.shape,t=e.slicers.all();(0,f.o)(t,function(t){if(w(t)){var i=t.GQt;if(i&&i.RQt===a&&i.RQt[o])return n.stopThisFire=!0,t.ki({sheet:e,sheetName:r,slicer:t,propertyName:o}),!0}})},ShapeCopingOrCutting:function(t){var i,n,e,i,i,n,i=t.sheet,n=t.shape,e,i=p(i&&i.parent,n);i&&(n={slicerJSON:(i=i.slicer).toJSON(),slicerName:i.name(),sourceName:i.sourceName(),slicerCacheName:i.FQt.name,shapeName:n.name(),cacheJSON:h.keyword_null},t.isCutting&&(n.cacheJSON=i.FQt.toJSON()),t.drawingData=n)},FormControlShapePasting:function(t){var i,n,e,r,o,a,s,c,u,l,o,a,s,r,f,l,a,i=t.sheet,n=t.fromSheetName,e=t.toSheetName,r=t.name,o=t.drawingData,a=t.isCutting,s=i.parent.getSheetFromName(n);o&&s&&s.slicers&&(c=o.slicerJSON,u=o.slicerName,l=o.slicerCacheName,o=o.cacheJSON,c.type!==v.SlicerType.pivotTable&&c.type!==v.SlicerType.pivotTimeline||(a||(u=s.slicers.G1i(r)),!(s=(a=i.parent.EQt).get(l))&&o&&(r=c.type===v.SlicerType.pivotTable?v.SlicerCacheType.pivotSlicer:v.SlicerCacheType.pivotTimeline,(s=a._Qt(o.pivotCacheId,o.sourceName,r)).fromJSON(o)),f=s.add(i,u),i.slicers.WB(f),v.SlicerBaseProperties.forEach(function(t){var t=t[0];"name"!==t&&c[t]!==h.keyword_undefined&&f[t](c[t])}),w(f)&&(f.ma===v.SlicerType.pivotTable?v.ItemSlicerProperties.forEach(function(t){var t=t[0];c[t]!==h.keyword_undefined&&f[t](c[t])}):["level","showHorizontalScrollbar","showSelectionLabel","showTimeLevel","scrollPosition"].forEach(function(t){c[t]!==h.keyword_undefined&&f[t](c[t])})),f.style().fromJSON(c.style),f.init(),l=f.GQt.RQt,n!==e&&(l.Mf=i,a=l.name(),i.eeV(a)||l.name(a&&i.eeV(a)||i.eeV("FormControl ",!0))),t.shape=l))},ShapeRemoving:function(t){var i,n,e,r,e,i,n,i,e,i=t.sheet,n=t.shape,e=t.isGroup,r=t.ignoreModel;e||(i=p(e=i.parent,n))&&(n=i.slicer,i=i.sheetIndex,e=e.sheets[i],n.GQt.UQt=!0,e.slicers.DK(n.name(),r),t.cancelEvent=!0)}}),e.Worksheet.ch("PivotSlicer",{slicerAdding:function(t){var i,n,e,r,o,a,s,c,u,o,c,i,i,i=this;if((t.type===v.SlicerType.pivotTable||t.type===v.SlicerType.pivotTimeline)&&(n=i.parent&&i.parent.EQt)){if(e=t.type===v.SlicerType.pivotTable?v.SlicerCacheType.pivotSlicer:v.SlicerCacheType.pivotTimeline,r=t.slicerName,o=t.targetName,a=t.itemName,s=t.sheet,c=t.slicerCacheName)u=n.get(c);else{if(!(c=i.parent.wQt(o)))return;if(!(o=(i=c.dh).getSourceNameByFieldName(a))){if(-1===i.getAllFieldNameList().indexOf(a))return;o=a}u=n.add(c,o,e)}(i=u.add(s,r)).init(),t.slicer=i}},slicerRemoved:function(t){var i,t,n,i,i=this.parent,t=t.slicer.name(),n=m(i,t);if(n){if(n.isSelected(!1),i=i.EQt.removeSlicer(t),n.GQt){if(n.GQt.UQt)return;n.GQt.UQt=!0}this.Ut.n1i(self,"undoRemove",i)}},slicerRenamed:function(t){var i=t.newName,t=t.slicer;w(t)&&t.name(i)},getAllSlicers:function(t){var i,o,a,s,i,o=t.slicers,a=t.targetName,s=t.itemName;e.GC$.each(this.slicers.z1i,function(t,i){var n,e,r;if(w(i))if(a){if((n=i.getAllConnectedPivotTables())&&0<n.length)for(e=0;e<n.length;e++)if((r=n[e]).name()===a&&(!s||r.getField(i.sourceName()).fieldName===s)){o.push(i);break}}else o.push(i)})},slicerFromJson:function(t){var i,n,e,r,o,t,a,s,c,t,u,t,l,u,i=t.slicerJSON,n=t.cacheJSON;if((i.type===v.SlicerType.pivotTable||i.type===v.SlicerType.pivotTimeline)&&this.parent&&(e=i.pivotName,r=i.sourceName,o=i.slicerCacheName,t=t.sheetName,a=this.parent)&&(s=a.getSheetFromName(t))){if((0,f.ht)(e)){if(!o)return;n&&(t=a.EQt,u=i.type===v.SlicerType.pivotTable?v.SlicerCacheType.pivotSlicer:v.SlicerCacheType.pivotTimeline,(c=t._Qt(n.pivotCacheId,n.sourceName,u)).fromJSON(n)),c=a.EQt.get(o)}else{if(!(t=this.parent.wQt(e)))return;if(-1===(l=t.dh).getAllFieldNameList().indexOf(r))return;c=a.EQt.add(t,r),v.ItemSlicerCacheProperties.forEach(function(t){(0,f.ht)(i[t])||(c["_"+t]=i[t])})}c&&((u=(u=c.get(i.name))||c.add(s,i.name)).init(),u.fromJSON(i),this.slicers.WB(u))}}}),s.PivotFieldsModel.ch("PivotSlicer",{setSlicerFilter:function(t){var i=t.textItem,n=t.oldTextItem,e=t.condition,t=t.oldCondition;(i||n)&&(i&&!n||!i&&n||i.list&&0<i.list.filter(function(t){return-1===n.list.indexOf(t)}).length||n.list&&0<n.list.filter(function(t){return-1===i.list.indexOf(t)}).length)&&g(this,!0),(e||t)&&g(this,!0)},updatePivotCache:function(t){g(this)},rebuild:function(){g(this)}}),e.GC$.extend(c.PivotTable.prototype,{getAllSlicers:function(){return this.Ti.parent.EQt.getPTConnectedSlicers(this)},connectSlicer:function(t){var t=m(this.Ti.parent,t);t&&t.connectPivotTable(this.name())},disconnectSlicer:function(t){var t=m(this.Ti.parent,t);t&&t.disconnectPivotTable(this.name())},isConnectedSlicer:function(t){var t=m(this.Ti.parent,t);if(t)return-1!==t.getConnectedPivotTableNameList().indexOf(this.name())}}),d=v.SlicerBase,n(C,d),C.prototype.sheet=function(){return this.Mf},C.prototype.connectPivotTable=function(t){var i,n,e,r,o;if(!(0,f.ht)(t)&&(n=(i=this).Mf&&i.Mf.parent&&i.Mf.parent.sheets)&&0<n.length)for(e=0;e<n.length;e++)if(o=(r=n[e]).pivotTables.get(t))return void i.FQt.connect(o)},C.prototype.disconnectPivotTable=function(t){var i,t,i=this;i.isConnectedPivotTable(t)&&(t=y(t,i.Mf.parent))&&i.FQt.disconnect(t)},C.prototype.isConnectedPivotTable=function(t){if(t)return this.FQt.isConnectedPivotTable(t)},C.prototype.getAllPivotTables=function(){var t;return this.FQt.pivotTables},C.prototype.getAllConnectedPivotTables=function(){var t;return this.FQt.pivotTables},C.prototype.getConnectedPivotTableNameList=function(){return this.getAllConnectedPivotTables().map(function(t){return t.name()})},h.VQt=C)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js":function(t,i,n){"use strict";var e,o,a,s,r,c,u,l,f,h,v,d,p,m,b,g,w;function y(t,i,n){var t,e,t=w.call(this,t,i,n)||this;return t.ma=f.pivotTable,t.RN=l.light1(),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicer=void 0,o=n("Core"),a=n("Slicers"),s=n("Shapes"),r=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js"),u=o.mt.vo,a&&s&&(l=a.SlicerStyles,f=a.SlicerType,h=a.defSlicerProperty,v=a.ItemSlicerProperties,d=a.SlicerChangeType,p=a.afterPropertyChanged,m=a.encodeSlicerName,w=r.VQt,e(y,w),y.prototype.getItems=function(){return this.FQt.items},y.prototype.getOptionsSet=function(){var t=this;return{nameInFormula:t.nameInFormula(),sourceName:t.sourceName(),name:t.name(),captionName:t.captionName(),showNoDataItems:t.showNoDataItems(),showNoDataItemsInLast:t.showNoDataItemsInLast(),visuallyNoDataItems:t.visuallyNoDataItems(),showHeader:t.showHeader(),sortState:t.sortState(),columnCount:t.columnCount(),multiSelect:t.multiSelect(),itemHeight:t.itemHeight(),filterCleared:t.filterCleared(),isLocked:t.isLocked()}},y.prototype.QQt=function(){var t;this.FQt.updateItems()},y.prototype.setFilterWithItems=function(t){var i;this.FQt.setFilter(t)},y.prototype.sortState=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.sortState();t!==(n=i.FQt.sortState())&&(i.FQt.sortState(t),p.call(i,"sortState",n))},y.prototype.showNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItems();(t=!!t)!==(n=i.FQt.showNoDataItems())&&(i.FQt.showNoDataItems(t),p.call(i,"showNoDataItems",n))},y.prototype.showNoDataItemsInLast=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItemsInLast();(t=!!t)!==(n=i.FQt.showNoDataItemsInLast())&&(i.FQt.showNoDataItemsInLast(t),p.call(i,"showNoDataItemsInLast",n))},y.prototype.visuallyNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.visuallyNoDataItems();(t=!!t)!==(n=i.FQt.visuallyNoDataItems())&&(i.FQt.visuallyNoDataItems(t),p.call(i,"visuallyNoDataItems",n))},y.prototype.initSlicerUI=function(){var n=this;n.GQt=new c.PivotTableItemSlicerViewModel(n.Mf,n.getOptionsSet.bind(n),n.getItems.bind(n)),n.GQt.setStyle(n.RN),n.GQt.bind("valueChanged",function(t){n.setFilterWithItems(t)}),n.GQt.bind("clearFilter",function(){n.clearFilter()}),n.GQt.bind("propertyChanged",function(t){var i=t.propName,t=t.value;n[i]&&n[i](t)})},y.prototype.fromJSON=function(i){var n;i&&(w.prototype.fromJSON.call(this,i),n=this,v.forEach(function(t){var t=t[0];i[t]!==r.keyword_undefined&&n[t](i[t])}))},y.prototype.yh=function(t,i,n,e){var i;t&&(w.prototype.yh.call(this,t,i,n,e),i=this,t.rowHeight!==r.keyword_undefined&&i.itemHeight(o.ExcelHelper.emuToPixles(+t.rowHeight)-4),t.lossless&&t.lossless.multiSelect!==r.keyword_undefined&&i.multiSelect(t.lossless.multiSelect),t.columnCount!==r.keyword_undefined)&&i.columnCount(+t.columnCount)},y.prototype.toJSON=function(t){var i,n,i=this,n=w.prototype.toJSON.call(this,t);return v.forEach(function(t){var t=t[0];n[t]=i[t]()}),n},y.prototype.wh=function(t,i,n){var e,r,t,e=this,r={name:m(e.name()),cache:u(e.FQt.name),caption:u(e.captionName()),columnCount:e.columnCount(),style:u(e.RN.name()),rowHeight:o.ExcelHelper.pixelToEMU(e.itemHeight()+4),lossless:{multiSelect:e.multiSelect()}};e.showHeader()||(r.showCaption=s.SJS_False),e.disableResizingAndMoving()&&(r.lockedPosition=s.SJS_True),t.push(r),t={twoCellAnchor:a.getSlicerDrawing(e)},i.push(t)},b=y,v.forEach(function(t){b.prototype[t[0]]=h(t[0],t[1],t[2],t[3])}),i.PivotTableItemSlicer=b)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js":function(t,i,n){"use strict";var e,r,n,c,u,o,r,a,s,l;function f(t,i,n){return l.call(this,t,i,n)||this}e=this&&this.__extends||(s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicerViewModel=void 0,r=n("Shapes"),n=n("Slicers"),r&&n&&n.SlicerViewModelBase&&(c=n.getSlicerSizePosInfo,u=n.ItemSlicerFormControl,o=n.SlicerChangeType,r=n.SlicerViewModelBase,e(f,l=r),f.prototype.WQt=function(){var e,t,i,n,r,o,a,s,r,i,e=this,t=this,i=t.Mf;i.shapes&&(n=t.updateOptionsCallback(),o=(r=c(i,!0)).left,a=r.top,s=r.width,r=r.height,(i=i.shapes.addFormControl(n.name,u,o,a,s,r)).allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!0),i.drawingType="Slicer",t.zQt=i.GtV,t.RQt=i,t.refreshFormControl(),t.zQt.addEventListener("valueChanged",function(t,i){var n=e.updateValuesCallback();n.forEach(function(t){return t.selected=-1!==i.indexOf(t.text)}),e.ki("valueChanged",n)}),t.zQt.addEventListener("clearFilter",function(t,i){e.ki("clearFilter",{})}),t.zQt.addEventListener("propertyChanged",function(t,i){e.ki("propertyChanged",i)}))},f.prototype.refreshFormControl=function(){var t,i;l.prototype.refreshFormControl.call(this),(i=(t=this).zQt).setItems(t.updateValuesCallback())},i.PivotTableItemSlicerViewModel=f)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js":function(t,i,n){"use strict";var e,r,o,a,n,r,s,c,u,l,f,h,v,d;function p(t,i,n){var t=d.call(this,t,i)||this;return t.onChange=n,t}e=this&&this.__extends||(v=function(t,i){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTimelineDropdown=void 0,r=n("Common"),o=n("Core"),a=n("Slicers"),n=n("./dist/plugins/pivot/pivot.ns.js"),r=new r.Common.ResourceManager(n.SR,"PivotTables"),s=r.getResource.bind(r),c="gc-timeline-level-dropdown",u="gc-timeline-level-block",l="gc-timeline-level-text",f="gc-timeline-selected-level",a&&(d=o.zc,e(p,d),p.prototype.init=function(t,i,n){d.prototype.Hc.call(this);var t=this.initHTMLStr(t);this.open(i,n,t)},p.prototype.initHTMLStr=function(t){for(var i,n,e,i="",n=["",s().TIME_LEVEL_YEARS,s().TIME_LEVEL_QUARTERS,s().TIME_LEVEL_MONTHS,s().TIME_LEVEL_DAYS],e=1;e<=4;e++)i+=this.ZQt(n[e],t===e,e);return i},p.prototype.ZQt=function(t,i,n){var i=i?"\u221a":"";return' <div class="'.concat(u,'" level="').concat(n,'">\n                        <div class="').concat(f,'">\n                            ').concat(i,'\n                        </div>\n                        <div class="').concat(l,'">\n                            ').concat(t,"\n                        </div>\n                    </div>")},p.prototype.WX=function(t,i){var n,e,n=this.Xc(),e=(0,o.GC$)(".".concat(c));return(e=0===e.length?(0,o.GC$)(o.mt.En("div")):e).css(["left","top"],[t,i]),e.addClass(c),e.appendTo(n),e},p.prototype.open=function(t,i,n){var e;this.WX(t,i).html(n),this.$c()},p.prototype.aY=function(){var i=this;(0,o.GC$)("."+u).bind("click",function(t){var t,t,t=t.target;t.className!==f&&t.className!==l||(t=t.parentElement),(t=parseInt(t.getAttribute("level"),10))&&(i.onChange(t),i.close())})},p.prototype.$c=function(){d.prototype.$c.call(this),this.aY()},p.prototype.KX=function(){(0,o.GC$)("."+u).unbind("click")},p.prototype.close=function(){this.KX(),d.prototype.close.call(this)},i.PivotTimelineDropdown=p)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js":function(L,t,i){"use strict";var A,n,l,r,e,T,f,i,h,o,n,a,v,s,M,c,u,d,E,B,R,p,m,G,g,S,b,x,D,w,y,k,C,V,i;function N(){var t=o.Fe(o.culture()).DateTimeFormat;return t&&t.abbreviatedMonthNames||[]}function I(){this.YQt=10.25,this.HQt=30.75,this.JQt=0,this.qQt=!1,this.KQt=-1,this.ywt=-1,this.lit=-1,this.aCi=-1,this.XQt=!1,this.$Qt=!1,this.needDrawDragRect=!1,this.sCi=!1,this.tWt={containerSize:{w:300,h:100},selection:T.keyword_null,bounds:T.keyword_null,scrollPosition:T.keyword_null,offset:{top:0,left:0},level:T.keyword_null,selectionLevel:T.keyword_null,canShowRange:!0,filterCleared:!0,showScrollbar:!0,showHeader:!0,showSelectionLabel:!0,showLevel:!0,onSelectionChanged:function(){},onItemClick:function(){},getStyle:function(t){return T.keyword_null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},onScrollPositionChanged:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}}},this.initScrollbar()}function j(t){return Math.floor((t.getMonth()+3)/3)}function O(t){return P(t.getFullYear(),t.getMonth())}function P(t,i){var t=new Date(t,i);return t.setMonth(t.getMonth()+1),t.setDate(1),t.setDate(t.getDate()-1),t.getDate()}function F(t,i,n){var e,r,o,a;i&&(t.save(),t.fillStyle=p,e=i.x,r=i.y,o=i.width,a=i.height,t.beginPath(),t.moveTo(e+5,r),t.lineTo(e+o-(n?0:5),r),t.quadraticCurveTo(e+o,r,e+o,r+(n?0:5)),t.lineTo(e+o,r+a-(n?0:5)),t.quadraticCurveTo(e+o,r+a,e+o-(n?0:5),r+a),t.lineTo(e+(n?5:0),r+a),t.quadraticCurveTo(e,r+a,e,r+a-(n?5:0)),t.lineTo(e,r+(n?5:0)),t.quadraticCurveTo(e,r,e+(n?5:0),r),t.closePath(),t.fill(),t.fillStyle=m,t.fillRect(i.x+2,i.y+4.5,2,2),t.fillRect(i.x+2,i.y+8,2,2),t.fillRect(i.x+2,i.y+11.5,2,2),t.restore())}function U(t){if(t&&"string"==typeof t){var t=t.toUpperCase();if(t===f.WHITE||"#FFF"===t||"#FFFFFF"===t||"RGB(255, 255, 255)"===t)return 1}}function _(t,i,n){var t=new Date(t.toDateString());return i&&(n?(t.setMonth(0),t.setDate(1)):(t.setMonth(11),t.setDate(31))),t.getTime()}Object.defineProperty(t,"__esModule",{value:!0}),t.getMonthLength=t.getLastDateOfMonth=t.getQuarter=t.PivotTimelineList=t.getMonthMap=void 0,A=i("Core"),n=i("Common"),l=i("Pivot"),r=i("Slicers"),e=i("Shapes"),T=i("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),f=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),i=i("./dist/plugins/pivot/pivot.ns.js"),h=n.Common.ft,o=n.Common.CultureManager,n=new n.Common.ResourceManager(i.SR,"PivotTables"),a=n.getResource.bind(n),t.getMonthMap=N,v=A.mt.yt,s="M",M="rgba(0, 0, 0, 0.15)",c="rgb(243, 243, 243)",u=1,d=18,E=19,B=75,R=6,p="#9c9c9c",m="#dddddd",G=5,(i=g=g||{})[i.item=0]="item",i[i.scrollBar=1]="scrollBar",i[i.leftScrollButton=2]="leftScrollButton",i[i.rightScrollButton=3]="rightScrollButton",i[i.leftDragButton=4]="leftDragButton",i[i.rightDragButton=5]="rightDragButton",r&&e&&(S=e.drawRoundedRect,b=r.TimelineLevel,x=r.appendBackColorStyle,D=r.Border_Names,w=r.fillText,y=r.getEllipsisText,k=r.paintBorder,C=r.SlicerScrollBar,Object.defineProperty(I.prototype,"props",{get:function(){return this.tWt},set:function(t){this.tWt=t},enumerable:!1,configurable:!0}),I.prototype.initScrollbar=function(){var e,t,i,e=this,t=new C,i=t.props;i.direction="horizontal",i.showButton=!1,i.sliderColor=f.WHITE,i.renderTrack=!1,i.syncSliderHeightWithPageStep=!0,i.refresh=this.refresh.bind(this),i.getPointerRelativeControl=function(t){var t=e.getPointerRelativeControl(t),i,n;return{x:t.x-19,y:t.y-75}},i.setCursor=this.setCursor.bind(this),i.onScroll=this.onScrollBarChange.bind(this),i.finishScroll=this.onScrollBarChanged.bind(this),this.iWt=t},I.prototype.onScrollBarChange=function(){var t,i,t,i=this.iWt.props.value;this.JQt=i},I.prototype.onScrollBarChanged=function(){var t,i,n,e,t=this,n=this._items[0],e=this.iWt.props.value,i=new Date(n.toString());if(0!==e)switch(t.level){case b.years:i.setFullYear(i.getFullYear()+e);break;case b.quarters:i.setMonth(i.getMonth()+3*e);break;case b.months:i.setMonth(i.getMonth()+e);break;case b.days:i.setDate(i.getDate()+e)}t.tWt.onScrollPositionChanged(i),t.setCursor("default")},I.prototype.update=function(){var t=this;try{t.buildItems()}catch(t){return}t.setStartPosition()},I.prototype.setStartPosition=function(){var t,i,n,t=this.scrollPosition;if(t){if(!this._items)try{this.buildItems()}catch(t){return}for(i=this._items,n=0;i[n]<t&&n<i.length;)n++;this.JQt=Math.min(n,this.maxScrollCount)}else this.JQt=0;this.refresh()},I.prototype.onLevelChanged=function(){var t;this.updateScrollPosition()},I.prototype.updateScrollPosition=function(t){var i,n,e,r,t,i=this;if(t=t||i.selection,!(0,l.ht)(t)){for(n=t.startDate,e=this._items,r=0;e[r]<n&&r<e.length;)r++;t=Math.round(r-i.onePageCanDisplayItemsCount/2),i.tWt.onScrollPositionChanged(e[t]||e[0])}},I.prototype.nCi=function(t){var i,n,i=this,n;return t.isRight?i.eWt:i.nWt},I.prototype.B1i=function(t){var i,n,e,i=this,n=i.itemWidth+1,e=i.itemHeight;return{rect:new A.Rect((t-i.JQt)*n,50+(i.showHeader?0:15),n,e),index:t,displayIndex:t-i.JQt}},I.prototype.F1i=function(t){var i,n,e,r,o,a,s,c,i=this,n=i.iWt,e=n.scrollBtnLen,r=n.height,o=i.SCROLLBAR_Y_VALUE,a=i.SCROLLBAR_WIDTH,s=n.scrollSliderOffset,c=n.scrollSliderLen;switch(t.type){case 1:return new A.Rect(0,o,a+2*i.SCROLLBAR_X_VALUE,r);case 2:return new A.Rect(0,o,e,r);case 3:return new A.Rect(e+a,o,e,r);case 4:return new A.Rect(e,o,a,r);case 5:return new A.Rect(e+s,o,c,r);case 6:return new A.Rect(e,o,s,r);case 7:return new A.Rect(e+s+c,o,c,r)}},I.prototype.render=function(t){var i=this;t.save(),i.nWt=T.keyword_null,i.eWt=T.keyword_null,i.renderItems(t),i.renderLeftScrollButton(t),i.renderRightScrollButton(t),i.updateScrollbarProps(),i.renderScrollbar(t),i.needDrawDragRect&&(F(t,i.nWt,!0),F(t,i.eWt,!1)),t.restore()},I.prototype.updateScrollbarProps=function(){var t,i,t=this.SCROLLBAR_WIDTH,i=this.iWt.props;i.containerSize={w:t,h:19},i.max=this.maxScrollCount,i.value=this.JQt,i.pageStep=this.onePageCanDisplayItemsCount,this.iWt.props=i},I.prototype.renderScrollbar=function(t){var i,n,i=this,n=i.SCROLLBAR_X_VALUE;t.save(),t.translate(n,i.SCROLLBAR_Y_VALUE),i.showScrollBar&&i.tWt.canShowRange&&i.renderScrollbarTrack(t,i.width-40),i.needShowScrollbar&&i.iWt.render(t),t.restore()},I.prototype.renderLeftScrollButton=function(t){this.renderScrollBtn(t,this.rWt===g.leftScrollButton,!0)},I.prototype.renderRightScrollButton=function(t){this.renderScrollBtn(t,this.rWt===g.rightScrollButton,!1)},I.prototype.renderScrollBtn=function(i,t,n){var e,r,e,t,o,a,s,e=this,r=n?e.leftBtnRect:e.rightBtnRect,e=t?c:f.WHITE,t=t?"rgb(135, 135, 135)":"rgb(196, 196, 196)",o="rgb(120, 119, 117)",a=3,s=function(){i.save(),i.translate(r.x,r.y),i.translate((r.w-2*a)/2,(r.h-a)/2),i.beginPath();var t=n?-90:90;t&&(i.translate(a,a/2),i.rotate(t/180*Math.PI),i.translate(-a,-a/2)),i.moveTo(0,a),i.lineTo(a,0),i.lineTo(2*a,a),i.strokeStyle=o,i.lineWidth=2,i.stroke(),i.restore()};i.save(),i.beginPath(),i.rect(r.x,r.y,r.w,r.h),i.fillStyle=e,i.fill(),i.strokeStyle=t,i.stroke(),s(),i.restore()},I.prototype.renderScrollbarTrack=function(t,i){var n,e,r,o,a,s,r,c,u,s,s,l,n=this,o=9,a="E6E6E6",s=n.getStyle("selectedTimeBlockStyle"),r=_(n.bounds.startDate,!0,!0),c,u=_(n.bounds.endDate,!0,!1)-r,s=s&&s.backColor();s&&!U(s)&&("string"==typeof s?a=h.YGt(n.getThemeColor(s),.5):"object"==typeof s&&s.stops&&0<s.stops.length&&s.stops[0].color&&(a=h.YGt(n.getThemeColor(s.stops[0].color),.5))),r=n.selection?(e=i*(((s=_(n.selection.startDate))-r)/u),i*(((l=_(n.selection.endDate))-s)/u)):(e=0,i),t.save(),t.fillStyle=a,t.fillRect(e,5,r,9),t.restore()},I.prototype.renderItems=function(t){var i,n,e,r,o,a,s,c,u,l,f,u,i=this;for(i.level!==i.oWt&&(i.buildItems(),i.JQt=0,i.iWt.value=0),i.buildItemWidth(t),n=i.JQt,e=i._items,a=o=r=!1,s=0;s+n<e.length&&(c=e[s+n],t.beginPath(),l=(u=i.isSelectedItem(c,o,a)).selected,o=!(!(f=u.isLeft)||o)||o,a=!(!(u=u.isRight)||a)||a,!i.renderItem(t,c,s,i.aWt(c,0===s),l,r&&l,f,u));s++)r=l},I.prototype.buildItemWidth=function(t){var i,n,n,e,r,r,r,r,i=this,n=new Date("2000-11-11"),n=i.sWt(n),e=i.getWholeStyle(),r=i.getStyle("periodLabel1Style");t.save(),r=r&&r.font()||e&&e.font()||f.TIMELINE_DEFAULT_FONT,t.font=v(r),i.YQt=t.measureText(s).width,r=(r=i.getStyle("periodLabel2Style"))&&r.font()||e&&e.font()||f.TIMELINE_DEFAULT_FONT,t.font=v(r),i.HQt=t.measureText(n).width,t.restore()},I.prototype.buildItems=function(){var t,i,n,i,e,r,o,t=this,i=t.bounds,n=i.startDate,i=i.endDate,e=t.level,r=n.getFullYear(),o=i.getFullYear();switch(e){case b.years:t.buildYearsItems(r,o);break;case b.quarters:t.buildQuartersItems(r,o);break;case b.months:t.buildMonthsItems(r,o);break;case b.days:t.buildDaysItems(r,o)}t.oWt=t.level},I.prototype.buildYearsItems=function(t,i){for(var n,e,n=[],e=t;e<=i;e++)n.push(new Date(e,0));this._items=n},I.prototype.buildQuartersItems=function(t,i){for(var n,e,r,n=[],e=t;e<=i;e++)for(r=0;r<4;r++)n.push(new Date(e,3*r));this._items=n},I.prototype.buildMonthsItems=function(t,i){for(var n,e,r,n=[],e=t;e<=i;e++)for(r=0;r<12;r++)n.push(new Date(e,r));this._items=n},I.prototype.buildDaysItems=function(t,i){for(var n,e,r,o,a,n=[],e=t;e<=i;e++)for(r=0;r<12;r++)for(o=P(e,r),a=1;a<=o;a++)n.push(new Date(e,r,a));this._items=n},I.prototype.aWt=function(t,i){var n,e;switch(this.level){case b.years:return T.keyword_null;case b.quarters:case b.months:return 0===t.getMonth()||i?t.getFullYear()+"":T.keyword_null;case b.days:return 1===t.getDate()||i?"".concat(N()[t.getMonth()].toUpperCase()," ").concat(t.getFullYear()):T.keyword_null;default:return T.keyword_null}},I.prototype.sWt=function(t){var i,n,i,n="";switch(this.level){case b.years:n=t.getFullYear()+"";break;case b.quarters:n=a().QUARTER_MAP[j(t)];break;case b.months:n=N()[t.getMonth()].toUpperCase();break;case b.days:n=t.getDate()+""}return n},I.prototype.isSelectedItem=function(t,i,n){var e,r,o,a,s,c,r,u,e=this,r=e.selection,o=!1,a=!1,s=!1;return e.tWt.canShowRange&&((0,l.ht)(r)?o=!0:(c=r.startDate,r=r.endDate,u=e.uWt(t),e.selectionLevel<=e.level?t<=r&&c<=t&&(o=!0,a=!i&&t<=c,s=!n&&r<=u):u<c||r<t||(o=!0,a=!i&&t<=c,s=!n&&r<=u))),{selected:o,isLeft:a,isRight:s}},I.prototype.isHoveredItem=function(t){return this.KQt===t},I.prototype.renderItem=function(t,i,n,e,r,o,a,s){var c,u,l,f,h,v,d,f,f,p,m,r,b,g,w,y,C,y,y,C,p,N,I,I,c=this,u=c.itemWidth-1,l=c.itemHeight,f=c.showScrollBar,h,v=n*(u+1)+(f?0:22),d=50+(c.showHeader?0:15);if(v>c.width+19)return!0;if(!f){if((f=c.width+19-3)<v)return!0;f<v+u&&(u=f-v)}for(f=c.getStyle("selectedTimeBlockStyle"),p=c.getStyle("unselectedTimeBlockStyle"),m=r?f:p,r=c.getWholeStyle(),b=new A.Rect(v,d,u,l),g=0,w=u,c.selectionLevel&&c.selectionLevel>c.level&&(a||s)?(C=(y=c.cWt(i,a,s)).leftPoint,y=y.rightPoint,y=new A.Rect(v+(g=u*C),d,w=u*(y-C)||2,l),x(t,v,d,u,l,p,r,c.getThemeColor.bind(c)),S(b,0,t),x(t,y.x,y.y,y.width,y.height,f,r,c.getThemeColor.bind(c)),S(y,0,t)):(x(t,v,d,u,l,m,r,c.getThemeColor.bind(c)),S(b,0,t)),a&&(c.nWt=new A.Rect(v+g-6,d,6,l)),s&&(c.eWt=new A.Rect(v+g+w,d,6,l)),c.isHoveredItem(n+c.JQt)&&(t.save(),t.fillStyle=M,S(b,0,t),t.restore()),C=c.getStyle("selectedTimeBlockSpaceStyle"),o&&C&&C.backColor()&&(p=new A.Rect(v-1,d,1,l),t.save(),x(t,p.x,p.y,p.width,p.height,C,T.keyword_null,c.getThemeColor.bind(c)),S(p,0,t),t.restore()),e&&c.paintLabelText1(t,e,v,d-35),c.paintLabelText2(t,i,v,d-20,u,l),0===b.x&&(b.x+=.5,b.width-=.1),0===b.y&&(b.y+=.5,b.height-=.1),N=0;N<4;N++)I=D[N],(I=m&&m[I]())&&k(t,N,b,I,c.getThemeColor.bind(c),0)},I.prototype.uWt=function(t){var i,t,i=new Date(t.toString()),t=864e5;switch(this.level){case b.years:i.setFullYear(i.getFullYear()+1);break;case b.quarters:i.setMonth(i.getMonth()+3);break;case b.months:i.setMonth(i.getMonth()+1);break;case b.days:i.setDate(i.getDate()+1)}return new Date(i.getTime()-t)},I.prototype.cWt=function(t,i,n){var e,r,o,a,e,s,r,e=this,r=e.selection,o=0,a=1;return r&&(e=e.uWt(t),s=r.startDate,r=r.endDate,o=i?+((s.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):0,a=n?+((r.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):1),{leftPoint:o,rightPoint:a}},I.prototype.paintLabelText1=function(t,i,n,e){var r,o,a,s,c,a,r=this,o=r.itemWidth-1;t.save(),a=r.getStyle("periodLabel1Style"),s=r.getWholeStyle(),c=r.getThemeColor(a&&a.foreColor()||s&&s.foreColor()||f.BLACK),a=a&&a.font()||s&&s.font()||f.TIMELINE_DEFAULT_FONT,t.font=v(a),w(t,y(t,i,2*o),n,e,c,r.YQt,o),t.restore()},I.prototype.paintLabelText2=function(t,i,n,e,r,o){var a,s,c,u,s,c,a=this,s=a.getStyle("periodLabel2Style"),c=a.getWholeStyle(),u=s&&s.foreColor()||c&&c.foreColor()||f.BLACK,s=v(s&&s.font()||c&&c.font()||f.TIMELINE_DEFAULT_FONT);t.save(),t.font=v(s),c=a.sWt(i),w(t,y(t,c,r),n,e,a.getThemeColor(u),o,r),t.restore()},I.prototype.hitTest=function(t,i){var n,e,r,o,a,s,c,u,o,l,f,h,v,d,p,m,b,n=this,e=this.width,r=n.showScrollBar,o=n.showHeader,a=n.leftBtnRect,s=n.rightBtnRect,c=r?t:t+19+3,u=o?i:i+15,o=function(){return 0<=t&&t<=e-(r?0:7)&&50<=i&&i<50+n.itemHeight},l=function(){return c>=a.x&&c<=a.x+a.w&&u>=a.y&&u<=a.y+a.h},f=function(){return c>=s.x&&c<=s.x+s.w&&u>=s.y&&u<=s.y+s.h},h=function(){return n.needShowScrollbar&&t>=n.scrollButtonSize&&t<=n.width-n.scrollButtonSize&&u>=a.y&&u<=a.y+a.h},v=function(){var t=n.nWt;return t&&c>=t.x&&c<=t.x+t.width&&u>=t.y&&u<=t.y+t.height},d=function(){var t=n.eWt;return t&&c>=t.x&&c<=t.x+t.width&&u>=t.y&&u<=t.y+t.height},b=n.getClickItemIndex(t,i);return v()?(p=g.leftDragButton,m=b):d()?(p=g.rightDragButton,m=b):o()?-1!==b&&(p=g.item,m=b):h()?p=g.scrollBar:l()?p=g.leftScrollButton:f()&&(p=g.rightScrollButton),{target:p,data:m}},I.prototype.onMouseDown=function(t){var i,n,n,e,n,n,i=this,n=i.getPointerRelativeControl(t),n=i.hitTest(n.x,n.y),e=n.target,n=n.data;return e===g.leftDragButton||e===g.rightDragButton?(i.lWt=e,i.sCi=!0,i.qQt=!0):e===g.item?(t.shiftKey?(i.ywt=Math.max(i.lit,i.ywt,n),i.lit=Math.min(i.lit,i.ywt,n),i.aCi=n):(i.aCi=-1,i.lit=n,i.ywt=n),i.sCi=!0,i.$Qt=!0,i.qQt=!0,i.changeSelection(),!0):e===g.scrollBar?(i.iWt.onMouseDown(t),i.qQt=!0):e===g.leftScrollButton||e===g.rightScrollButton?(n=(i.rWt=e)===g.leftScrollButton?-1:1,i.scroll(n),i.startScrollInterval(n),!0):void 0},I.prototype.isInBounding=function(t,i){var n,e,n=this.width,e=this.height;return 0<=t&&t<=n&&0<=i&&i<=e},I.prototype.onMouseMove=function(t){var i,t,n,e,n,r,i=this;return i.iWt.onMouseMove(t),t=i.getPointerRelativeControl(t),e=(n=i.hitTest(t.x,t.y)).target,n=n.data,(r=i.lWt)?i.onDragButtonChanging(r,n,t.x):e===g.item?(i.$Qt?i.ywt!==n&&(-1===i.aCi||-1!==i.aCi&&i.aCi!==n)&&(i.XQt=!0,i.ywt=n,i.aCi=-1,i.changeSelection()):i.KQt=n,i.setCursor("default")):(e===g.leftScrollButton||e===g.rightScrollButton?i.setCursor("default"):e!==g.leftDragButton&&e!==g.rightDragButton||i.setCursor("ew-resize"),i.KQt=-1),i.refresh(),!0},I.prototype.onDragButtonChanging=function(t,i,n){var e,r,r,o,t,a,s,t;(0,l.ht)(i)||-1===i||(r=((r=(e=this).fWt(i)).from+r.to)/2,t===g.leftDragButton?(o=r+e.itemWidth,t=i+1,n<=r?t=i:o<=n&&(t=i+2),e._items[t]&&e._items[t].toLocaleDateString()!==e.selection.startDate.toLocaleDateString()&&e._items[t]<=e.selection.endDate&&(a=new Date(e._items[t].toString()),s=e.selection.endDate,e.selection={startDate:a,endDate:s})):(o=r-e.itemWidth,t=i-1,r<=n?t=i:n<=o&&(t=i-2),e._items[t]&&e._items[t]>=e.selection.startDate&&(a=e.selection.startDate,s=new Date(e._items[t].toString()),e.selection=e.hWt(a,s))))},I.prototype.fWt=function(t){var i=this;return{from:(t-=i.JQt)*i.itemWidth,to:(t+1)*i.itemWidth}},I.prototype.onWindowMouseMove=function(t){var i,t,n,n,n,i=this,t=i.getPointerRelativeControl(t),n=i.itemsAreaWidth-1+i.props.offset.left,n=i.hitTest(n,t.y).target;if(i.sCi){if(n===g.item)i.stopScrollInterval();else{if(void 0!==i.vWt)return;t.x<0?i.startScrollInterval(-1):t.x>i.width&&i.startScrollInterval(1)}i.refresh()}n=i.isInBounding(t.x,t.y),i.needDrawDragRect!==n&&(i.needDrawDragRect=n,i.sCi||i.refresh())},I.prototype.startScrollInterval=function(t){var i,n,e,i=this,n=100,e=function(){i.scroll(t),i.refresh(),i.vWt=window.setTimeout(e,n)};this.vWt=window.setTimeout(e,600)},I.prototype.stopScrollInterval=function(){return void 0!==this.vWt&&(window.clearTimeout(this.vWt),!(this.vWt=void 0))},I.prototype.scroll=function(t){this.scrollTo(this.JQt+t)},I.prototype.scrollTo=function(t){var i,n,i=0,n=this.maxScrollCount;t=Math.min(t,n),t=Math.max(t,0),this.JQt=t},I.prototype.onMouseUp=function(t){var i,t,n,i=this;return i.iWt.onMouseUp(t),t=i.getPointerRelativeControl(t),(n=i.hitTest(t.x,t.y).target)!==g.item&&(this.KQt=-1,this.refresh()),!!i.qQt&&!(i.qQt=!1)},I.prototype.onWindowMouseUp=function(t){var i,t,t,n,t,e,r,e,i=this;i.iWt.onWindowMouseUp(t),t=i.getPointerRelativeControl(t),n=(t=i.hitTest(t.x,t.y)).target,t=t.data,i.lWt?(r=(e=i.selection).startDate,e=e.endDate,i.props.onSelectionChanged({startDate:r,endDate:e})):i.sCi&&(n===g.item&&i.XQt&&(i.XQt=!1,i.ywt=t),i.endSelectOperation()),this.stopScrollInterval()&&this.onScrollBarChanged(),this.clearState()},I.prototype.hWt=function(t,i){var n,e,e=this;if(t&&i){switch(i<t&&(t=(n=[i,t])[0],i=n[1]),e.level){case r.TimelineLevel.years:i.setMonth(11);break;case r.TimelineLevel.quarters:i.setMonth(i.getMonth()+2)}e.level!==r.TimelineLevel.days&&i.setDate(O(i))}return{startDate:t,endDate:i}},I.prototype.changeSelection=function(){var t,i,n,t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.selection=t.hWt(i,n)},I.prototype.endSelectOperation=function(){var t,i,n,t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.props.onSelectionChanged(t.hWt(i,n))},I.prototype.onWindowKeyUp=function(t){},I.prototype.onWindowMouseWheel=function(t){this.iWt.onWindowMouseWheel(t)},I.prototype.clearState=function(){var t,i,t=this,i=!1;t.qQt&&(i=!(t.qQt=!1)),t.sCi&&(t.KQt=-1,t.$Qt=!1,-1===t.aCi&&(t.ywt=-1),i=!(t.sCi=!1)),t.lWt=T.keyword_null,t.rWt=T.keyword_null,t.stopScrollInterval(),i&&t.refresh()},Object.defineProperty(I.prototype,"width",{get:function(){return this.tWt.containerSize.w-(this.showScrollBar?0:44)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"height",{get:function(){return this.tWt.containerSize.h},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"scrollPosition",{get:function(){return this.tWt.scrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"showScrollBar",{get:function(){return this.tWt.showScrollbar},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"showHeader",{get:function(){return this.tWt.showHeader},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"level",{get:function(){return this.tWt.level},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"bounds",{get:function(){return this.tWt.bounds},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"selection",{get:function(){return this.tWt.selection},set:function(t){this.tWt.selection=t},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"selectionLevel",{get:function(){return this.tWt.selectionLevel},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"itemWidth",{get:function(){return Math.max(2*this.HQt,40)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"itemHeight",{get:function(){return 18},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"needShowScrollbar",{get:function(){return this.showScrollBar&&this.itemLength>this.onePageCanEntirelyDisplayItemsCount},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"scrollButtonSize",{get:function(){return 25},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"canShowItemsLength",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"itemsAreaWidth",{get:function(){return Math.min(this.itemLength,this.canShowItemsLength)*this.itemWidth},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"itemLength",{get:function(){if(this._items)return this._items.length;try{return this.buildItems(),this._items.length}catch(t){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.itemLength-this.onePageCanEntirelyDisplayItemsCount)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"onePageCanDisplayItemsCount",{get:function(){return Math.ceil(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"onePageCanEntirelyDisplayItemsCount",{get:function(){return Math.floor(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"leftBtnRect",{get:function(){return{x:0,y:76-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:19,h:17}},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"rightBtnRect",{get:function(){return{x:this.width-19+(this.showScrollBar?0:38),y:76-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:19,h:17}},enumerable:!1,configurable:!0}),I.prototype.setCursor=function(t){this.props.setCursor(t)},I.prototype.getStyle=function(t){return this.props.getStyle(t)},I.prototype.getWholeStyle=function(){return this.props.getStyle("wholeSlicerStyle")},I.prototype.getThemeColor=function(t){return this.props.getThemeColor(t)},I.prototype.getPointerRelativeControl=function(t){var t=this.props.getPointerRelativeControl(t);return t.x+=this.props.offset.left,t.y+=this.props.offset.top,t},I.prototype.getClickItemIndex=function(t,i){var n,t,n=this.itemWidth,t=Math.floor(t/n)+this.JQt;return t>=this.itemLength?-1:t},I.prototype.refresh=function(){this.props.refresh()},I.prototype.dispose=function(){this.iWt.dispose(),this._items=T.keyword_null,this.tWt=T.keyword_null},Object.defineProperty(I.prototype,"SCROLLBAR_X_VALUE",{get:function(){return 20},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"SCROLLBAR_Y_VALUE",{get:function(){return 75+(this.showScrollBar?0:15)+(this.showHeader?0:15)},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"SCROLLBAR_WIDTH",{get:function(){return this.width-2*this.SCROLLBAR_X_VALUE},enumerable:!1,configurable:!0}),t.PivotTimelineList=I),t.getQuarter=j,t.getLastDateOfMonth=O,t.getMonthLength=P},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js":function(t,i,n){"use strict";var e,o,a,s,r,c,n,u,l,f,h,v,n,d,p,m,b,g,w;function y(t){return 1<=t&&t<=4}function C(t){return t instanceof Date&&!isNaN(t.getTime())}function N(t,i,n){var e,r,i,e=this;if(e[t]){if(r=void 0,C(i)?r=i:"string"==typeof i&&C(new Date(i))&&(r=new Date(i)),(0,o.ht)(r))return;e[t](r),e.refresh()}(i=e.sheet())&&(i.Ut.n1i(e,t,n),e.ki({sheet:i,sheetName:i.name(),slicer:e,propertyName:t}))}function I(t,i,n){var t,e,t=w.call(this,t,i,n)||this;return t.ma=f.pivotTimeline,t.RN=h.light1(),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTimelineSlicer=void 0,o=n("Pivot"),a=n("Slicers"),s=n("Shapes"),r=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js"),n=n("Core"),u=n.mt.vo,l=n.Util.gr,a&&s&&(f=a.SlicerType,h=a.TimelineStyles,v=a.defSlicerProperty,n=a.onPropertyChanged,d=a.SlicerChangeType,p=a.encodeSlicerName,m=[["level",a.TimelineLevel.months,n,y],["showHorizontalScrollbar",!0,n],["showSelectionLabel",!0,n],["showTimeLevel",!0,n],["scrollPosition",r.keyword_undefined,N]],w=r.VQt,e(I,w),I.prototype.filterType=function(){return this.FQt.filterType},I.prototype.condition=function(){return this.FQt.getFilterCondition()},I.prototype.canShowRange=function(){return this.FQt.canShowRange},I.prototype.selection=function(){return this.FQt.selection},I.prototype.bounds=function(){var t=this.FQt.bounds;return{startDate:new Date(t.startDate.toString()),endDate:new Date(t.endDate.toString())}},I.prototype.selectionLevel=function(){return this.FQt.selectionLevel},I.prototype.getOptionsSet=function(){var t=this;return{nameInFormula:t.nameInFormula(),sourceName:t.sourceName(),name:t.name(),captionName:t.captionName(),showHeader:t.showHeader(),showHorizontalScrollbar:t.showHorizontalScrollbar(),showTimeLevel:t.showTimeLevel(),showSelectionLabel:t.showSelectionLabel(),isLocked:t.isLocked()}},I.prototype.getValuesSet=function(){var t=this;return{filterCleared:t.filterCleared(),canShowRange:t.canShowRange(),selection:t.selection(),bounds:t.bounds(),level:t.level(),selectionLevel:t.selectionLevel(),scrollPosition:t.scrollPosition(),filterType:t.filterType(),condition:t.condition()}},I.prototype.initSlicerUI=function(){var n=this;n.GQt=new c.PivotTableTimelineSlicerViewModel(n.Mf,n.getOptionsSet.bind(n),n.getValuesSet.bind(n)),n.GQt.setStyle(n.RN),n.GQt.bind("valueChanged",function(t){n.FQt.selectionLevel=n.level(),n.setFilterWithSelection(t)}),n.GQt.bind("clearFilter",function(){n.clearFilter()}),n.GQt.bind("propertyChanged",function(t){var i=t.propName,t=t.value;n[i]&&n[i](t)})},I.prototype.setFilterWithSelection=function(t){var i;this.FQt.setFilter(t)},I.prototype.fromJSON=function(i){var n;i&&(w.prototype.fromJSON.call(this,i),n=this,m.forEach(function(t){var t=t[0];i[t]!==r.keyword_undefined&&("scrollPosition"===t?n.scrollPosition(new Date(i[t])):n[t](i[t]))}))},I.prototype.yh=function(t,i,n,e){var i,e,t;t&&(w.prototype.yh.call(this,t,i,n,e),i=this,t.showHeader!==r.keyword_undefined&&i.showHeader("1"===t.showCaption),t.level!==r.keyword_undefined&&i.level(+t.level+1),t.showHorizontalScrollbar!==r.keyword_undefined&&i.showHorizontalScrollbar("1"===t.showHorizontalScrollbar),t.showSelectionLabel!==r.keyword_undefined&&i.showSelectionLabel("1"===t.showSelectionLabel),t.showTimeLevel!==r.keyword_undefined&&i.showTimeLevel("1"===t.showTimeLevel),t.scrollPosition!==r.keyword_undefined&&i.scrollPosition(new Date(t.scrollPosition)),e=t.style||n.getDefaultStyleName("defaultTimelineStyle"))&&(a.isBuildInTimelineStyle(e)?i.style(h[e.substring("TimeSlicerStyle".length).toLowerCase()]()):(t=n.getTimelineStyle(e))&&i.style(t))},I.prototype.toJSON=function(t){var i,n,i=this,n=w.prototype.toJSON.call(this,t);return m.forEach(function(t){var t=t[0];n[t]=i[t]()}),n.selectionLevel=i.selectionLevel(),n},I.prototype.wh=function(t,i,n){var e,r,t,e=this,r={name:p(e.name()),cache:u(e.FQt.name),caption:u(e.captionName()),style:u(e.RN.name()),level:e.level()-1,selectionLevel:e.selectionLevel()-1,scrollPosition:(0,o.kQt)(e.scrollPosition())};e.showHeader()||(r.showHeader=s.SJS_False),e.disableResizingAndMoving()&&(r.lockedPosition=s.SJS_True),e.showSelectionLabel()||(r.showSelectionLabel=s.SJS_False),e.showTimeLevel()||(r.showTimeLevel=s.SJS_False),e.showHorizontalScrollbar()||(r.showHorizontalScrollbar=s.SJS_False),t.push(r),t={twoCellAnchor:a.getSlicerDrawing(e)},i.push(t)},b=I,m.forEach(function(t){b.prototype[t[0]]=v(t[0],t[1],t[2],t[3])}),i.PivotTableTimelineSlicer=b)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js":function(t,i,n){"use strict";var e,r,o,a,c,u,l,s,n,f,h,v;function d(t,i,n){return v.call(this,t,i,n)||this}e=this&&this.__extends||(h=function(t,i){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}h(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTimelineSlicerViewModel=void 0,r=n("Shapes"),o=n("Slicers"),a=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),u="pivotTimeline",r&&o&&(r.registerCustomFormControl(u,c.PivotTableTimelineView),l=o.getSlicerSizePosInfo,s=o.SlicerChangeType,n=o.SlicerViewModelBase,e(d,v=n),d.prototype.scrollPosition=function(t){return a.keyword_null},d.prototype.WQt=function(){var n,t,i,e,r,o,a,s,r,i,n=this,t=this,i=t.Mf;i.shapes&&(this.zQt=new c.PivotTableTimelineView,e=t.updateOptionsCallback(),o=(r=l(i,!1)).left,a=r.top,s=r.width,r=r.height,(i=i.shapes.addFormControl(e.name,u,o,a,s,r)).allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!0),i.drawingType="Timeline",t.zQt=i.GtV,t.RQt=i,t.refreshFormControl(),t.zQt.addEventListener("valueChanged",function(t,i){n.ki("valueChanged",i)}),t.zQt.addEventListener("clearFilter",function(t,i){n.ki("clearFilter",{})}),t.zQt.addEventListener("propertyChanged",function(t,i){n.ki("propertyChanged",i)}))},d.prototype.refreshFormControl=function(){var t,i;v.prototype.refreshFormControl.call(this),(i=(t=this).zQt).setValue(t.updateValuesCallback()),i.update()},i.PivotTableTimelineSlicerViewModel=d)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js":function(t,v,i){"use strict";var n,d,e,r,p,w,o,c,y,i,i,C,N,e,a,u,s,m,b,l,I,A,f,h;function g(){return null!==h&&h.apply(this,arguments)||this}function T(t,i){var n,e,r,e,o,a,r,s,c,u,l,f,n,h,v,h,v,d,p,t,i,o,a,r,f,n,m,e,c,b,g;if(!(0,w.ht)(t))return n=(0,y.getMonthMap)(),(0,w.ht)(i)?"".concat(n[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear()):(r=(e=C.Fe(C.culture())).TimelineDateOrder,e=e.TimelineDateSuffix,o=r.indexOf(1),a=r.indexOf(2),r=r.indexOf(3),s=t.getFullYear(),c=i.getFullYear(),u=t.getMonth(),l=i.getMonth(),f=n[u],n=n[l],h=(0,y.getQuarter)(t),v=(0,y.getQuarter)(i),h=N().QUARTER_MAP[h],v=N().QUARTER_MAP[v],d=t.getDate(),p=i.getDate(),t=1===t.getDate()&&i.getDate()===(0,y.getLastDateOfMonth)(i),i=o<a,o=a<r,a=s+e.year,r=c+e.year,f=f+e.month,n=n+e.month,m=d+e.date,e=p+e.date,s===c?t?0===u&&11===l?s:-1!==I.indexOf(u)&&-1!==A.indexOf(l)?l-u==2?i?"".concat(a," ").concat(h):"".concat(h," ").concat(a):i?"".concat(a," ").concat(h," - ").concat(v):"".concat(h," - ").concat(v," ").concat(a):u===l?i?"".concat(a," ").concat(n):"".concat(n," ").concat(a):i?"".concat(a," ").concat(f," - ").concat(n):"".concat(f," - ").concat(n," ").concat(r):u===l?(c=void 0,c=d===p?o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "):o?"".concat(f," ").concat(m," - ").concat(e):"".concat(m," - ").concat(e," ").concat(f," "),i?"".concat(a," ").concat(c):"".concat(c," ").concat(a)):(b=o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "),g=o?"".concat(n," ").concat(e):"".concat(e," ").concat(n," "),i?"".concat(a," ").concat(b," - ").concat(g):"".concat(b," - ").concat(g,", ").concat(r)):t?0===u&&11===l?"".concat(a," - ").concat(r):-1!==I.indexOf(u)&&-1!==A.indexOf(l)?i?"".concat(a," ").concat(h," - ").concat(r," ").concat(v):"".concat(h," ").concat(a," - ").concat(v," ").concat(r):i?"".concat(a," ").concat(f," - ").concat(r," ").concat(n):"".concat(f," ").concat(a," - ").concat(n," ").concat(r):(b=o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "),g=o?"".concat(n," ").concat(e):"".concat(e," ").concat(n," "),i?"".concat(a," ").concat(b," - ").concat(r," ").concat(g):"".concat(b,", ").concat(a," - ").concat(g,", ").concat(r)))}function M(t,i,n){if((0,w.ht)(t)&&i===w.PivotDateFilterOperator.Between||(0,w.ht)(i))return N().ALL_PERIODS;if(t&&t.startDate&&t.endDate&&t.endDate<t.startDate)return N().INVALID_DATE_SELECTION;switch(i){case w.PivotDateFilterOperator.equalsTo:case w.PivotDateFilterOperator.today:case w.PivotDateFilterOperator.yesterday:case w.PivotDateFilterOperator.tomorrow:return T(t.startDate);case w.PivotDateFilterOperator.Between:case w.PivotDateFilterOperator.nextWeek:case w.PivotDateFilterOperator.thisWeek:case w.PivotDateFilterOperator.lastWeek:case w.PivotDateFilterOperator.nextMonth:case w.PivotDateFilterOperator.thisMonth:case w.PivotDateFilterOperator.lastMonth:case w.PivotDateFilterOperator.nextQuarter:case w.PivotDateFilterOperator.thisQuarter:case w.PivotDateFilterOperator.lastQuarter:case w.PivotDateFilterOperator.nextYear:case w.PivotDateFilterOperator.thisYear:case w.PivotDateFilterOperator.lastYear:case w.PivotDateFilterOperator.yearToDate:return T(t.startDate,t.endDate)}var e=N().TIMELINE_PLACE_HOLDER;switch(i){case w.PivotDateFilterOperator.notEqualsTo:return N().DateNotEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.before:return N().DateOlderThan.replace(e,T(n.eX));case w.PivotDateFilterOperator.beforeEqualsTo:return N().DateOlderThanOrEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.after:return N().DateNewerThan.replace(e,T(n.eX));case w.PivotDateFilterOperator.afterEqualsTo:return N().DateNewerThanOrEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.notBetween:return N().DateNotEqual.replace(e,T(n.eX,n.value2));case w.PivotDateFilterOperator.Q1:return N().AllDatesIn_Quarter1;case w.PivotDateFilterOperator.Q2:return N().AllDatesIn_Quarter2;case w.PivotDateFilterOperator.Q3:return N().AllDatesIn_Quarter3;case w.PivotDateFilterOperator.Q4:return N().AllDatesIn_Quarter4;case w.PivotDateFilterOperator.M1:return N().AllDatesIn_January;case w.PivotDateFilterOperator.M2:return N().AllDatesIn_February;case w.PivotDateFilterOperator.M3:return N().AllDatesIn_March;case w.PivotDateFilterOperator.M4:return N().AllDatesIn_April;case w.PivotDateFilterOperator.M5:return N().AllDatesIn_May;case w.PivotDateFilterOperator.M6:return N().AllDatesIn_June;case w.PivotDateFilterOperator.M7:return N().AllDatesIn_July;case w.PivotDateFilterOperator.M8:return N().AllDatesIn_August;case w.PivotDateFilterOperator.M9:return N().AllDatesIn_September;case w.PivotDateFilterOperator.M10:return N().AllDatesIn_October;case w.PivotDateFilterOperator.M11:return N().AllDatesIn_November;case w.PivotDateFilterOperator.M12:return N().AllDatesIn_December;case w.PivotDateFilterOperator.dateToDate:if(!n.EVt)return T(t.startDate,t.endDate);if(n.Rs===w.PivotAdvancedDateFilterBy.year)return N().PivotPanel_ValueFilterOrLabel_ParallelYearToDate;if(n.Rs===w.PivotAdvancedDateFilterBy.quarter)return N().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate;if(n.Rs===w.PivotAdvancedDateFilterBy.month)return N().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate}return o.keyword_null}n=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(v,"__esModule",{value:!0}),v.PivotTableTimelineView=v.WHITE=v.BLACK=v.TIMELINE_DEFAULT_FONT=v.SELECTION_LABEL_FONT=void 0,d=i("Core"),e=i("Common"),r=i("Shapes"),p=i("Slicers"),w=i("Pivot"),o=i("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),c=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js"),y=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),i=i("./dist/plugins/pivot/pivot.ns.js"),i=new e.Common.ResourceManager(i.SR,"PivotTables"),C=e.Common.CultureManager,N=i.getResource.bind(i),v.SELECTION_LABEL_FONT="normal 10pt calibri",v.TIMELINE_DEFAULT_FONT="normal 9pt calibri",v.BLACK="black",v.WHITE="white",p&&r&&(e=p.SlicerViewBase,a=p.SlicerChangeType,u=p.SlicerUIType,s=p.paintBorder,m=p.fillText,b=p.getEllipsisText,n(g,h=e),g.prototype.init=function(t){h.prototype.init.call(this,t),this.y4={canShowRange:o.keyword_null,selection:o.keyword_null,bounds:o.keyword_null,level:o.keyword_null,selectionLevel:o.keyword_null,filterCleared:o.keyword_null,scrollPosition:o.keyword_null,filterType:o.keyword_null,condition:o.keyword_null},this.LEt={},this.initList(),this.initClearFilterButton()},g.prototype.initList=function(){var t,i,n,t=this,i=new y.PivotTimelineList,n=i.props;n.offset={top:-45,left:-10},n.bounds=t.y4.bounds,i.props=n,i.props.onSelectionChanged=t.onSelectionChanged.bind(t),i.props.getPointerRelativeControl=t.getPointerRelativeControl.bind(t),i.props.refresh=t.refresh.bind(t),i.props.getStyle=t.getStyle.bind(t),i.props.getThemeColor=t.getThemeColor.bind(t),i.props.setCursor=t.setCursor.bind(t),i.props.onScrollPositionChanged=t.onScrollPositionChanged.bind(t),t.wY=i,this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},g.prototype.initDropDown=function(){var t,i,n,n,e,r,o,a,s,r,o,a,t=this,i=t.sheet,n=t.onLevelChanged.bind(t),n=new c.PivotTimelineDropdown(i.parent&&i.parent.j2(),d.mt.gi(i.parent.Ti),n),e=t.dWt,r=t.shape,o=r.startRow(),a=r.startColumn(),s=r.startRowOffset(),r=r.startColumnOffset(),o=i.getCellRect(o,a),a=i.zoom();n.init(t.y4.level,o.x+(r+e.x)*a,o.y+(s+e.y+20)*a)},g.prototype.filterCleared=function(){return this.y4.filterCleared},g.prototype.triggerEvent=function(t,i){this.fireEvent(t,i)},g.prototype.onSelectionChanged=function(t){this.triggerEvent("valueChanged",t)},g.prototype.onLevelChanged=function(t){this.triggerEvent("propertyChanged",{propName:"level",value:t}),this.wY.onLevelChanged()},g.prototype.onScrollPositionChanged=function(t){this.triggerEvent("propertyChanged",{propName:"scrollPosition",value:t})},g.prototype.setStyle=function(t){this.RN=t},g.prototype.getStyle=function(t){return this.RN[t]()},g.prototype.update=function(){var t,i,n,e,r,o,a,s,c,n,u,l,u,t=this,i=t.wY.props,n=t.y4,e=n.bounds,r=n.selection,o=n.selectionLevel,a=n.level,s=n.scrollPosition,c=n.canShowRange,n=n.filterCleared,u=t.options,l=u.showHeader,u=u.showHorizontalScrollbar;i.bounds=e,i.selection=r,i.level=a,i.selectionLevel=o,i.showHeader=l,i.showScrollbar=u,i.scrollPosition=s,i.canShowRange=c,i.filterCleared=n,t.wY.update()},g.prototype.render=function(t,i){var i,n,e,r,i,o,a,i=h.prototype.render.call(this,t,i);if(i&&(n=i.left,e=i.top,r=i.w,i=i.h,!(r<0)))return a=(o=this).LEt.showHeader,t.save(),t.rect(n+8,e+(a?37:5),r+4,i),t.clip(),o.LEt.showSelectionLabel&&o.paintSelectionLabel(t,n+10,e+(a?30:5),r-70,30),o.LEt.showTimeLevel&&o.paintLevel(t,n,e-(a?0:25),r,i),o.paintList(t,n,e,r,i),t.restore(),{left:n,top:e,w:r,h:i}},g.prototype.paintHeader=function(t,i,n,e,r){var o,e,r,e,o=this;h.prototype.paintHeader.call(this,t,i,n,e,r),o.width<=20||(r=(e=o.getWholeStyle())&&e.borderTop(),e=new d.Rect(i+10,n,o.width-20,Math.min(o.height,25)),s(t,2,e,r,this.getThemeColor.bind(this)))},g.prototype.paintSelectionLabel=function(t,i,n,e,r){var o,a,s,c,u,s,a,l,f,o,o=this,a=o.y4,s=a.filterType,c,u,s=M(a.selection,s,a.condition),a=o.getWholeStyle(),l=o.getStyle("selectionLabelStyle"),f=l&&l.font()||a&&a.font()||v.SELECTION_LABEL_FONT,o=o.getThemeColor(l&&l.foreColor()||a&&a.foreColor()||v.BLACK);t.save(),t.font=f,t.fillStyle=o,m(t,b(t,s,e),i,n,o,r,e),t.restore()},g.prototype.eCi=function(){var t,i,n,e,r,o,a,s,c,u,l,t,i=0,n=0,e=this.LEt,r=e.showHeader,o=e.showSelectionLabel,a=e.showTimeLevel,s,c,u=-10,l=-45;return r?n+=25:l+=25,e.showHorizontalScrollbar||(u-=23),o||a||(n-=20,l+=20),{x:0,y:n,listLeft:u,listTop:l}},g.prototype.paintList=function(t,i,n,e,r){var o,a,s,c,o=this;t.save(),s=-e/2+(a=o.eCi()).x,c=-r/2+a.y,o.wY.props.offset.left=a.listLeft,o.wY.props.offset.top=a.listTop,t.rect(s,c,e,r),t.clip(),t.beginPath(),t.translate(s,c),o.pWt(e,r),o.wY.render(t),t.restore()},g.prototype.paintLevel=function(t,i,n,e,r){var o,a,e,n,s,c,u,l,f,l,h,u,a,f,u,o=this,a=o.y4.level;if(a){switch(e=i+(e<70?10:e-60),n=n+30,s=60,c=30,u=o.getWholeStyle(),f=(l=o.getStyle("timeLevelStyle"))&&l.font()||u&&u.font()||v.TIMELINE_DEFAULT_FONT,l=o.getThemeColor(l&&l.foreColor()||u&&u.foreColor()||v.BLACK),h="",a){case p.TimelineLevel.years:h=N().TIME_LEVEL_YEARS;break;case p.TimelineLevel.quarters:h=N().TIME_LEVEL_QUARTERS;break;case p.TimelineLevel.months:h=N().TIME_LEVEL_MONTHS;break;case p.TimelineLevel.days:h=N().TIME_LEVEL_DAYS}t.save(),t.font=d.mt.yt(f),t.fillStyle=l,u=b(t,h,60),a=Math.ceil(t.measureText(u).width)+5,m(t,u,(e+=60-a)-5,n,l,30,a),t.restore(),t.save(),f=e+a,u=n+10,t.beginPath(),t.fillStyle="#b2b2b2",t.moveTo(f,u),t.lineTo(f+10,u),t.lineTo(f+5,u+10),t.lineTo(f,u),t.closePath(),t.fill(),t.restore(),o.dWt=new d.Rect(e-i,o.LEt.showHeader?30:5,a+10,30)}},g.prototype.pWt=function(t,i){var n,e,n,e;this.wY.props.containerSize={w:t,h:i}},g.prototype.setValue=function(t){this.y4=t,this.refresh()},g.prototype.onWindowMouseMove=function(t){h.prototype.onWindowMouseMove.call(this,t),this.wY.onWindowMouseMove(t)},g.prototype.onWindowMouseUp=function(t){this.wY.onWindowMouseUp(t)},g.prototype.onWindowKeyUp=function(t){this.wY.onWindowKeyUp(t)},g.prototype.onLevelDropDownClicked=function(t,i){var n=this;return!!n.mWt(t,i)&&(n.initDropDown(),!0)},g.prototype.doMouseDown=function(t){var i,n,i=this,n=i.getPointerRelativeControl(t);return!(!i.LEt.showTimeLevel||!i.onLevelDropDownClicked(n.x,n.y))||this.wY.onMouseDown(t)},g.prototype.doMouseMove=function(t){var i,t,i=this;i.wY.onMouseMove(t),h.prototype.doMouseMove.call(this,t),t=i.getPointerRelativeControl(t),i.mWt(t.x,t.y)&&i.setCursor("default")},g.prototype.doMouseUp=function(t){this.wY.onMouseUp(t),h.prototype.doMouseUp.call(this,t)},g.prototype.onWindowMouseWheel=function(t){this.wY.onWindowMouseWheel(t)},g.prototype.mWt=function(t,i){var n=this.dWt;return!!n&&t>=n.x&&t<=n.x+n.width&&i>=n.y&&i<=n.y+n.height-10},g.prototype.bWt=function(){var t;return{top:-5,left:31-this.width}},g.prototype.gWt=function(t,i){var n,e,r,o,e,a,e,s,c,s,n=this,e=h.prototype.gWt.call(this,t,i);if(e.rect)return e.rect;switch(r=n.options,a=(e=n.eCi()).listLeft,e=e.listTop,t){case u.scrollBar:o={rect:n.wY.F1i(i)};break;case u.item:s=i.index,c=i.displayIndex,s=s,(0,w.ht)(c)||(s=c+n.wY.JQt),o=n.wY.B1i(s);break;case u.timeLevel:o={rect:n.dWt};break;case u.dragBar:o={rect:n.wY.nCi(i)},r.showHorizontalScrollbar||(o.rect.x-=19)}return r.showHeader||(t===u.timeLevel&&r.showTimeLevel?o.rect.y+=5:o.rect.y-=15),o&&t!==u.timeLevel&&(o.rect.x-=a,o.rect.y-=e),o},g.prototype.dispose=function(){this.wY.dispose(),this.wY=o.keyword_null,this.wWt=o.keyword_null,this.RN=o.keyword_null,this.dWt=o.keyword_null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),h.prototype.dispose.call(this)},v.PivotTableTimelineView=g),I=[0,3,6,9],A=[2,5,8,11]},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(L,t,i){"use strict";var E,e,l,B,c,n,R,f,h,G,V,r,i,U,o,a,Q,s,W,v,i,d,p,m,b,z,g,w,y,C,N,I,A,Z,T,M,S,x,D,k,j,u,Y,H,J,O,P,q,K,X,n,$;function F(t,i,n){void 0===n&&(n=l.PivotPanelLayoutType.stack);var e=this;e.yWt=i.Zc,e.Ti=t,e.uit=0,e.CWt=n,e.Qy=i.Qy,e.IWt=i,e.AWt=!1,e.NWt=[],e.TWt=0,e.Hc()}function _(t,i,n){var t=$.call(this,t,i)||this;return t.uit=0,t.T$=1,t.MWt(n),t.GY=new q(n,t),t.xWt={showFields:!0,showArea:!0,showViewList:!0},t.dh&&(t.Qy=t.dh.Qy,t.z=i,t.dh.addPivotView(t)),t.paint(),t}E=this&&this.__extends||(X=function(t,i){return(X=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}X(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.PivotPanel=t.panelOperation=void 0,l=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),B=i("./dist/plugins/pivot/pivot-core/pivot-view.js"),c=i("Pivot"),n=i("Common"),R=i("./dist/plugins/pivot/pivot.ns.js"),f=i("Core"),h=i("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),G=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),V=i("./dist/plugins/pivot/pivot-util.js"),r=n.Common.zf.j0,i=window,U=document,o=i.jQuery,a="pivotPanel",Q="string",s=null,W=void 0,v=n.Common.lt.ht,i=new n.Common.ResourceManager(R.SR,"PivotTables"),d=i.getResource.bind(i),p=".pivot-panel",b="gc-panel-all-field-item",z="gc-panel-all-field-item-filtered",g=(m="gc-panel-area-item")+"-content",w="gc-panel-defer-layout-right-button",y="gc-panel-bottomBorderStyle",C="gc-panel-topBorderStyle",N="gc-panel-defer-layout-input",I="gc-panel-area-item-icon",A="data-index",Z="gc-panel-all-field-filter",T="Pivot-Field-Filter",M="gc-panel-all-field-checkbox",S="gc-panel-all-field",x="gc-panel-collapse",D="gc-panel-selected-view",k="gc-panel-add",j="gc-panel-apply",u="gc-panel-withoutViewList",Y="containViewList",H="containFields",J="containArea",O="gc-panel-views",(n=P=t.panelOperation||(t.panelOperation={}))[n.addField=0]="addField",n[n.removeField=1]="removeField",n[n.updateFieldArea=2]="updateFieldArea",n[n.updateValuePosition=3]="updateValuePosition",F.prototype.Hc=function(){this.Fz()},F.prototype.dispose=function(){var t=this;t.IWt=s,t.Qy=s,t.NWt=s,t.DWt=s,t.Ti.innerHTML="",t.Ti=W,t.SWt()},F.prototype.Fz=function(){var c,e,t,a,s,u,c=this,e="."+c.yWt,t=c.Ti;this.IWt.dh&&((0,f.GC$)(c.Ti,t).bind("dragover"+p+e,function(t){t.preventDefault()}).bind("dragleave"+p+e,function(){a&&(s=a)}),(0,f.GC$)("."+m,t).bind("dragstart"+p+e,function(){a=a||(0,f.GC$)(this),(0,f.GC$)(document).bind("dragover"+p+e,function(t){t.preventDefault()}).bind("drop"+p+e,function(t){var i,t,i,n;t.preventDefault(),i=t.clientX,t=t.clientY,!a||i>c.Ti.offsetLeft&&i<c.Ti.offsetLeft+c.Ti.offsetWidth&&t>c.Ti.offsetTop&&t<c.Ti.offsetTop+c.Ti.offsetHeight||v(s)||(i=c.IWt.z.Zc,(n=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh).wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:s.attr("data-name"),pivotName:i,isSusPaint:c.AWt}})),(0,f.GC$)(document).unbind("dragover"+p+e),(0,f.GC$)(document).unbind("drop"+p+e),a=null})}),(0,f.GC$)("."+g,t).bind("dragover"+p+e,function(t){var i,t,n,i=t.target;i.classList.contains(m)?(t=t.offsetY,n=i.parentElement,(0,f.GC$)(n.children).removeClass(y),(0,f.GC$)(n.children).removeClass(C),t<i.offsetHeight&&i.classList.add(C)):i.classList.contains(g)&&i.lastElementChild&&i.lastElementChild.classList.add(y)}).bind("dragleave"+p+e,function(){(0,f.GC$)("."+m).removeClass(y).removeClass(C)}).bind("drop"+p+e,function(t){var i,n,e,r,t,t,o,r;t.stopPropagation(),(t=t.toElement||t.relatedTarget||t.target).classList.contains("gc-panel-area-item-label")&&(t=t.parentElement),a&&(e=a.attr("data-sourceName")||a.attr("data-name"),r=(0,f.GC$)(a).attr("data-area"),n=t&&parseInt((0,f.GC$)(t).attr("data-area"),10),i=parseInt((0,f.GC$)(t).attr(A),10),0===t.childElementCount?i=0:t.classList.contains("gc-panel-area-item-content")&&(t=t.lastElementChild,i=parseInt((0,f.GC$)(t).attr(A),10),i++),v(r)?(c.AWt&&(t=P.addField,c.NWt.push({name:e,toArea:n,index:i,type:t})),u=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,o=c.IWt.z.Zc,u.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:e,targetArea:n,targetIndex:i,pivotName:o,isSusPaint:c.AWt}})):v(n)||(r=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,o=c.IWt.z.Zc,r.wVt({cmd:"moveField",sheetName:"",cmdOption:{fieldName:e,targetArea:n,targetIndex:i,pivotName:o,isSusPaint:c.AWt}})),s=a=null)}),(0,f.GC$)("."+b,t).bind("dragstart"+p+e,function(){a=a||(0,f.GC$)(this)}),(0,f.GC$)("."+S,t).bind("dragenter"+p+e,function(t){t.stopPropagation(),a&&(s=a)}).bind("drop"+p+e,function(){var t,i;v(s)||(c.AWt&&c.NWt.push({name:s.attr("data-name"),type:P.removeField}),t=c.IWt.z.Zc,(i=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh).wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:s.attr("data-name"),pivotName:t,fieldsModel:i,isSusPaint:c.AWt}})),s=a=null}),(0,f.GC$)("."+N,t).bind("click"+p+e,function(t){c.AWt=t.target.checked;var t=(0,f.GC$)("."+w);c.AWt?c.IWt.dh&&(c.IWt.dh.copyFieldsModel=c.IWt.dh.clone()):(c.IWt.dh.copyFieldsModel=void 0,c.IWt.refresh(c.AWt)),t&&t.prop("disabled",!c.AWt)}),(0,f.GC$)("."+w,t).bind("click"+p+e,function(){var t,i,n;c.AWt&&(t=c.IWt.dh.copyFieldsModel.UM(),i=c.IWt.z.Zc,(n=c.IWt.dh).wVt({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:i,fieldsInfo:t}})),c.IWt.refresh(!1)}),(0,f.GC$)("."+I,t).bind("click"+e,function(t){var i,n,e,i,r,t,o,a,s;(0,f.GC$)(this).hasClass(T)||(n=(i=(0,f.GC$)(t.target).parent()).attr("data-name"),e=+i.attr("data-area"),i=+i.attr(A),r=c.updateOptionForDropDown(n,e,i),t={x:t.clientX,y:t.clientY},o=c.IWt.z.Zc,a=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,(s=new h.PivotDropDown(document.body,a,o,n,e,i,c.AWt)).rQ(t,r))}),(0,f.GC$)("."+b,t).bind("contextmenu"+e,function(t){var i,n,t,e,r,o,i,n=(0,f.GC$)(this).attr("data-name"),t={x:t.clientX,y:t.clientY},e=c.IWt.z.Zc,r=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,o;return new h.PivotCacheFieldsDropdownDialog(document.body,r,e,n,null,null,c.AWt).rQ(t),!1}),(0,f.GC$)("."+M,t).bind("click"+e,function(t){var i,t,n,e,r,t,i,t=(0,f.GC$)(t.target).parent().attr("data-sourceName"),n=this.checked,e=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,r,t={fieldName:t,checked:n,pivotName:c.IWt.z.Zc,isSusPaint:c.AWt};e.wVt({cmd:"changePanelFieldStatus",sheetName:c.IWt.Zc,cmdOption:t})}),(0,f.GC$)("."+T,t).bind("click"+e,function(t){var i,n,t,e,r,o,o,a,i,n=(0,f.GC$)(t.target).parent().attr("data-name"),t={x:t.pageX,y:t.pageY},e=c.AWt?c.IWt.dh.copyFieldsModel:c.IWt.dh,r=c.IWt.z.Zc,o=c.IWt.z;o instanceof G.PivotTable&&(o=o.layoutType()===l.PivotTableLayoutType.compact,e.wVt({cmd:"CreatePivotFilterDialog",sheetName:c.IWt.Zc,cmdOption:a={position:t,fieldName:n,fieldsModel:e,isCompact:o,pivotName:r}}))}),(0,f.GC$)("."+x,t).bind("click"+e,function(t){var i,t,n,e,r,o,o,i=c.IWt.dh,t={x:t.pageX,y:t.pageY},n=c.IWt.z,e=c.IWt.z.Zc,r=100,o=(0,f.GC$)("."+O);o&&0<o.length&&200<o.width()&&300<(r=o.width()-100)&&(r=300),n&&(o={position:t,pivotName:e,views:n.views,width:r},i.wVt({cmd:"CreatePivotViewsListDialog",cmdOption:o}))}),(0,f.GC$)("."+k,t).bind("click"+e,function(t){var i,n,e,r,i,i=(0,f.GC$)("#"+D).val();(0,V.kWt)(i)&&(i=d().DefaultPivotTableViewName),n=c.IWt.z,e=c.IWt.dh,r=c.IWt.z.Zc,n&&(i={name:i,pivotName:r,views:n.views},e.wVt({cmd:"AddPivotView",cmdOption:i}),(0,f.GC$)("#"+D).val(""))}),(0,f.GC$)("."+j,t).bind("click"+e,function(t){var i,n,e,r,i,i=(0,f.GC$)("#"+D).val(),n=c.IWt.dh,e=c.IWt.z,r=c.IWt.z.Zc;e&&(i={name:i,pivotName:r,views:e.views},n.wVt({cmd:"ApplyPivotView",cmdOption:i}))}),(0,f.GC$)("."+S,t).bind("scroll.pivotPanel"+p+e,function(){c.TWt=this.scrollTop}))},F.prototype.updateOptionForDropDown=function(t,i,n){var e,r,o,a,e,s,a,e=this.AWt?this.IWt.dh.copyFieldsModel:this.IWt.dh,r={1:c.DataPosition.row,2:c.DataPosition.col},o={isSigma:!1,isAlone:!1,location:1,area:i},a=e.getSigmaValuePosition(),e=e.nw(i),s=0;return a.display&&a.positionType===r[i]&&(s=1),t===d().sigmaValue&&(o.isSigma=!0),1===(a=e.length+s)&&(o.isAlone=!0),0===n?o.location=1:n<a-1?o.location=2:n===a-1&&(o.location=3),o},F.prototype.SWt=function(){var t,i,t="."+this.yWt,i=this.Ti;(0,f.GC$)(document).unbind("dragover"+p+t),(0,f.GC$)(document).unbind("drop"+p+t),(0,f.GC$)("."+m,i).unbind("dragstart"+p+t),(0,f.GC$)("."+b,i).unbind("dragstart"+p+t),(0,f.GC$)(this.Ti,i).unbind("dragover"+p+t),(0,f.GC$)(this.Ti,i).unbind("dragleave"+p+t),(0,f.GC$)("."+g,i).unbind("dragleave"+p+t),(0,f.GC$)("."+g,i).unbind("dragover"+p+t),(0,f.GC$)("."+g,i).unbind("drop"+p+t),(0,f.GC$)("."+b,i).unbind("dragstart"+p+t),(0,f.GC$)("."+S,i).unbind("drop"+p+t),(0,f.GC$)("."+S,i).unbind("dragenter"+p+t),(0,f.GC$)("."+N,i).unbind("click"+p+t),(0,f.GC$)("."+w,i).unbind("click"+p+t),(0,f.GC$)("."+I,i).unbind("click."+t),(0,f.GC$)("."+b,i).unbind("contextmenu."+t),(0,f.GC$)("."+M,i).unbind("click."+t),(0,f.GC$)("."+T,i).unbind("click."+t),(0,f.GC$)("."+x,i).unbind("click."+t),(0,f.GC$)("."+k,i).unbind("click."+t),(0,f.GC$)("."+j,i).unbind("click."+t),(0,f.GC$)("."+S,i).unbind("scroll"+p+t)},F.prototype.Mrt=function(t){var i,n,e,r,o,t,t,a,s,i,o,n,e,r,s,i,i=t.allField,n=t.rowField,e=t.colField,r=t.valueField,o=t.filterField,t=t.valuePosition;r&&1<r.length&&t.positionType===c.DataPosition.row&&n.splice(t.positionIndex,0,{Zc:d().sigmaValue,lp:t.positionIndex}),r&&1<r.length&&t.positionType===c.DataPosition.col&&e.splice(t.positionIndex,0,{Zc:d().sigmaValue,lp:t.positionIndex}),a=l.PivotPanelLayoutType[(t=this).CWt].toLocaleLowerCase(),s=t.jWt(),i=t.OWt(i),o=t.PWt([o,n,e,r]),n=t.FWt(),e=t.IWt.xWt.showViewList?t._Wt():"",r=t.IWt.xWt.showFields?'\n                <div class="gc-panel-fields-section" '.concat(J,'="').concat(t.IWt.xWt.showArea,'">\n                    ').concat(s,"\n                    ").concat(i,"\n                </div>"):"",s=t.IWt.xWt.showArea?'\n                <div class="gc-panel-areas-section" '.concat(H,'="').concat(t.IWt.xWt.showFields,'">\n                    <span>').concat(d().PivotPanel_FieldAreaText,'</span>\n                    <div class = "gc-panel-field-area">\n                        ').concat(o,"\n                    </div>\n                    ").concat(n,"\n                </div>\n                "):"",t.Ti.innerHTML='\n                <div class="gc-panel gc-panel-'.concat(a,' gc-no-user-select">\n                    <div class=').concat(u," ").concat(Y,'="').concat(t.IWt.xWt.showViewList,'">\n                        <div class="gc-panel-header">\n                            <h2>').concat(d().PivotPanel_Title,"</h2>\n                        </div>\n                        ").concat(r,"\n                        ").concat(s,"\n                    </div>\n                    ").concat(e,"\n                </div>\n                "),(i=(0,f.GC$)("#"+S)[0])&&i.scrollTo({top:t.TWt})},F.prototype._Wt=function(){return'\n            <div class="'.concat(O,'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">').concat(d().Views,'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="').concat(x,'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="').concat(D,'"/>\n                    <input type="button" class="gc-panel-button ').concat(k,'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button ').concat(j,'" value="\u2714"/>\n                </div>\n            </div>\n            ')},F.prototype.jWt=function(){return"\n                <span>".concat(d().PivotPanel_ReportText,"</span>\n                ")},F.prototype.OWt=function(t){var i,n,e,r,o,a,s,r,i="";if(t)for(n=0,e=t;n<e.length;n++)o=(r=e[n]).fieldName,a=r.sourceName,s=r.isFilter,r=r.isDims,i+=this.LWt(o,a,s,r);return'\n                <div class="'.concat(S,'" id="').concat(S,'">\n                    <ul>\n                        ').concat(i,"\n                    </ul>\n                </div>\n                ")},F.prototype.LWt=function(t,i,n,e){return i=r(i),t=r(t),'\n        <li class="'.concat(b+(n?" "+z:""),'" title="').concat(t,'" data-name="').concat(t,'" data-sourceName="').concat(i,'" draggable="true">\n            <input type="checkbox" ').concat(e?"checked":"",' class = "').concat(M,' gc-panel-checkbox"/>\n            <span class="').concat(e?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked",'">').concat(i,'</span>\n            <span class="').concat(I+" "+T,'"></span>\n            <span class="').concat(n?Z:"",'"></span>\n        </li>')},F.prototype.render=function(t){this.SWt(),this.Mrt(t),this.Fz()},F.prototype.d5=function(){this.SWt(),this.Ti.innerHTML=""},F.prototype.PWt=function(t){for(var i,n,e,r,o,i="",n=this.CWt===l.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],e=0,r=n;e<r.length;e++)o=r[e],i+=this.EWt(o,t?t[o]:null);return i},F.prototype.BWt=function(t){var i,t,i,t=["Filters","Rows","Columns","Values"][t];return{title:d()["PivotPanel_"+t+"ItemsTitle"],rowItemClass:t}},F.prototype.EWt=function(t,i){var n,e,n,r,n=this.BWt(t),e=n.title,n=n.rowItemClass,r="";return i&&(r=this.RWt(i,t)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'.concat(n,'">\n            <div class="gc-panel-area-item-title">\n                <label class="').concat(I," gc-panel-area-item-").concat(n,'"></label>\n                <span>').concat(e,'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="').concat(t,'">\n                ').concat(r,"\n            </ul>\n        </section>")},F.prototype.RWt=function(t,n){var e,r,e=this,r="";return t.forEach(function(t,i){r+=e.GWt(t.Zc,n,i)}),r},F.prototype.GWt=function(t,i,n){return'\n        <li class="'.concat(m,'" data-name="').concat(r(t),'" data-area="').concat(i,'" data-index="').concat(n,'" draggable="true">\n            <span class="gc-panel-area-item-label">').concat(r(t),'</span>\n            <span class="').concat(I,'"></span>\n        </li>\n        ')},F.prototype.FWt=function(){var t=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '.concat(t.AWt?"checked":"",">\n                       <label>").concat(d().PivotPanel_DeferUpdateText,'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" ').concat(t.AWt?"":"disabled",">").concat(d().PivotPanel_Update,"</button>\n                </div>\n             ")},F.prototype.VWt=function(t){if(v(t))return this.CWt;this.CWt=t},q=F,$=B.PivotView,E(_,$),_.prototype.MWt=function(t){var i=this;t&&(o&&o(t).data(a,i),(0,f.GC$)(t).data(a,i))},_.prototype.UWt=function(){var t,t,t=this,t=t.GY&&t.GY.Ti;t&&(o&&o(t).data(a,s),(0,f.GC$)(t).data(a,s))},_.prototype.isPivotViewAttached=function(t){return this.z&&this.z===t},_.prototype.attach=function(t){this.detach(),t&&(this.dh=t.dh,this.Qy=this.dh.Qy,this.dh.addPivotView(this),this.z=t)},_.prototype.detach=function(){this.dh&&(this.dh.removePivotView(this),this.dh=null,this.z=null,this.paint())},_.prototype.sectionVisibility=function(t){var i,i;if(v(t))return i=0,this.xWt.showFields&&(i+=l.PivotPanelSection.fields),this.xWt.showArea&&(i+=l.PivotPanelSection.area),this.xWt.showViewList&&(i+=l.PivotPanelSection.viewList),i;i={showFields:!1,showArea:!1,showViewList:!1},t&l.PivotPanelSection.fields&&(i.showFields=!0),t&l.PivotPanelSection.area&&(i.showArea=!0),t&l.PivotPanelSection.viewList?((0,f.GC$)("."+u).attr("containViewList","true"),i.showViewList=!0):(0,f.GC$)("."+u).attr("containViewList","false"),this.xWt=i,this.refresh(!1)},_.prototype.panelLayout=function(t){var i=this.GY.VWt();if(v(t))return i;t===l.PivotPanelLayoutType.stack&&i===l.PivotPanelLayoutType.flow?(this.GY.VWt(l.PivotPanelLayoutType.stack),this.refresh(!1)):t===l.PivotPanelLayoutType.flow&&i===l.PivotPanelLayoutType.stack&&(this.GY.VWt(l.PivotPanelLayoutType.flow),this.refresh(!1))},_.prototype.type=function(t){if(0===arguments.length)return this.uit;this.uit=t},_.prototype.paint=function(t){var i,t,n,i=this,t=t?this.dh.copyFieldsModel:this.dh,n=i.z&&i.z.views.all();i.GY.render(t?e(e({},t.IVt()),{views:n}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:n})},_.prototype.refresh=function(t){var i=t?this.dh.copyFieldsModel:this.dh;i&&i.q3(t)},_.prototype.destroy=function(){var t=this;t.Qy=s,t.dh&&(t.dh.removePivotView(t),t.dh=s),t.UWt(),t.Ti=s,t.GY&&(t.GY.dispose(),t.GY=s)},_.prototype.dispose=function(){var t=this;t.destroy(),t.z=s},_.findControl=function(t){return typeof t==Q&&(t=U.getElementById(t)),(0,f.GC$)(t).data(a)},t.PivotPanel=_},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(t,i,n){"use strict";var e,r,o,a;function s(t){return 0===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}function c(t,i){return{position:e.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:i},imageType:e.ButtonImageType.custom,visibility:e.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:s(t),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}Object.defineProperty(i,"__esModule",{value:!0}),i.getFilterCellButtonInfo=i.getFilterButtonImageSrc=void 0,e=n("Core"),r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c",i.getFilterButtonImageSrc=s,a=o={noSortFilter:0,0:"noSortFilter",ascending:1,1:"ascending",descending:2,2:"descending",filter:3,3:"filter",filterAscend:4,4:"filterAscend",filterDescend:5,5:"filterDescend",sortAscending:6,6:"sortAscending",sortDescending:7,7:"sortDescending",checkAll:8,8:"checkAll",unCheckAll:9,9:"unCheckAll",isChecked:11,11:"isChecked",clearAble:12,12:"clearAble",clearUnable:13,13:"clearUnable",disableRightArrow:14,14:"disableRightArrow"},i.getFilterCellButtonInfo=c},"./dist/plugins/pivot/pivot-table-entry.js":function(t,i,n){"use strict";var e,r,o,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=void 0,r(n("./dist/plugins/pivot/pivot.ns.js"),i),r(n("./dist/plugins/pivot/pivot-table/pivot-table-spread.js"),i),n("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),r(n("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),i),r(n("./dist/plugins/pivot/pivot-table/pivot-table.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i),r(n("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),i),r(n("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),i),r(n("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js"),i),r(n("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i),r(n("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js"),i),r(n("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),i),o=n("Pivot"),Object.defineProperty(i,"SortType",{enumerable:!0,get:function(){return o.SortType}}),n("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(t,i,n){"use strict";var e,r,o,a,s,c;function u(t){this.dataTable=[],this.QWt=t,this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={}}function l(){this.HWt=[new s(0),new s(1),new s(2),new s(3),new s(4)]}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDataModel=void 0,e=n("Common"),r=n("Core"),o=n("Pivot"),a=e.Common.lt.ht,u.prototype.JWt=function(t,i){this.ZWt[t]=i},u.prototype.setStartInfo=function(t,i){this.DQ=t,this.jN=i},u.prototype.Kbt=function(t,i,n){var e;this.J_(t,i,!0).value=n},u.prototype.setColCount=function(t){this.Tx=t},u.prototype.setRowCount=function(t){this.Sx=t},u.prototype.getColInfoMap=function(){for(var t,i,n,e,r,t={},i=this.WWt,n=i.length,e=0;e<n;e++)i[e]&&(r=i[e].path,i[e].valueFieldName&&(""===r?r=i[e].valueFieldName||"":r+=o.Separator+i[e].valueFieldName||""),t[r]=e);return t},u.prototype.getRange=function(){return new r.Range(this.DQ,this.jN,this.Sx,this.Tx)},u.prototype.Sl=function(t,i){var t=this.J_(t,i);return t&&t.value},u.prototype.qWt=function(t,i,n){var e;this.J_(t,i,!0).style=n},u.prototype.ML=function(t,i){var t=this.J_(t,i);return t&&t.style},u.prototype.KWt=function(t,i,n){var e;this.J_(t,i,!0).fieldName=n},u.prototype.XWt=function(t,i){var t=this.J_(t,i);return t&&t.fieldName||t&&t.value},u.prototype.$Wt=function(t,i){var t=this.J_(t,i);return t&&t.nodeRefer},u.prototype.J_=function(t,i,n){var e,r,t,e,r=this.dataTable[t];if(!r){if(!n)return null;r=this.dataTable[t]=[]}if(!(t=r[i])){if(!n)return null;t=r[i]={}}return t},u.prototype.c5=function(){this.dataTable=[],this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={},delete this.Sx,delete this.Tx},u.prototype.kn=function(t){for(var i,n,e,i=this,n=i.ZWt,e=0;e<n.length;e++)if(i.ZWt[e]&&i.ZWt[e].fieldName===t)return e},u.prototype.tZt=function(t,i,n,e){var r,o,r=this.YWt;a(r[i])&&(r[i]={}),a(r[i][n])&&(r[i][n]={},r[i][n].ranges=[]),(o=r[i][n]).level===e&&o.ranges.includes(t)||(r[i][n].level=e,r[i][n].ranges.push(t))},s=u,l.prototype.getAllModel=function(){var t=this.HWt,i,n,e,r,o;return{pageModel:t[0],cornerModel:t[1],columnModel:t[2],rowModel:t[3],contentModel:t[4]}},l.prototype.getModel=function(t){return this.HWt[t]},l.prototype.c5=function(){var t=this.HWt,i=t[0],n=t[1],e=t[2],r=t[3],t=t[4];i.c5(),n.c5(),e.c5(),r.c5(),t.c5()},l.prototype.getWholeRange=function(){},l.prototype.iZt=function(){},i.PivotDataModel=l},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(O,t,i){"use strict";var n,T,P,F,v,_,w,E,B,R,G,p,V,t,b,A,U,d,Q,i,L,t,e,r,W,z,o,a,s,c,u,l,f,h,m,g,y,C,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ct,ut,lt,ft,ht,vt,dt,pt,mt,bt,gt,wt,yt,Ct,Nt,N,k,It,At,Tt,Mt,St,xt,Dt,kt,jt,Ot,Pt,Ft,_t,Lt,Et,Bt,Rt,Gt,Vt,Ut,Qt,Wt,zt,Zt,Yt,Ht,Jt,qt,Kt,Xt,$t,ti,ii,ni,ei,ri,oi,ai,si,ci,ui,li,fi,hi,vi,di,pi,mi,bi,gi,wi,yi,Ci,Ni,Ii;function Ai(t,i,n,e,r,o){var a,s,c,u,i,l,f,s,h,v,a,d,u,p,m,b,c=!1;return i?(u=i.a,a=t.getFilterInfo(u),s=i.nrt):(a=t.getFilterInfo(n),u=n),l=i=!1,a&&a.labelFilter&&(a.labelFilter.condition&&(i=!0),a.labelFilter.textItem)&&!a.labelFilter.textItem.isAll&&(l=!0),f=!!a&&a.on(),s=s?s.sortType:N,0===t.rBt(n)&&(c=!0),h=N,v=!1,a&&a.labelFilter&&a.labelFilter.textItem&&(h=a.labelFilter.textItem.list,v=a.labelFilter.textItem.isAll),a=t.bl(u).DH(),d=t.hr(u),p=(u=t.bl(u)).sf(),{fieldIsNumber:c,sortInfo:s,hasLabelCondition:i,hasValueCondition:f,fields:b=Ti(u,a,h,v,p,s,d,m=(t.z||[]).filter(function(t){return t.Zc===r})[0],n,o),isColOrRow:e,hasLabelManual:l}}function Ti(e,t,i,n,r,o,a,s,c,u){var l,f,h,v,o,d,f=[],h=[];if(r){for(v=0;v<t.length;v++)h[r[v]]=t[v];o===_.SortType.desc&&h.reverse()}return o=0===h.length?t:h,d=function(t){var i,i,i,n;if(!(e.nZt&&0<e.nZt.length)&&(0,_.ht)(e.y1)&&(i=3===u?{dataOnly:!0,references:[{fieldName:L().Values,items:[c]}]}:{labelOnly:!0,references:[{fieldName:c}]},i=(i=s.getStyle(i))&&i.formatter,a===_.PivotDataType.date&&(t=(0,_.parseStringToDate)(t),n=z.Fe().DateTimeFormat,i=i||n.shortDatePattern),i)){if("string"==typeof i)return new Q(i).format(t);if(i instanceof p.Formatter.FormatterBase)return i.format(t)}return t+""},!i||0===i.length||n?o.forEach(function(t){l={status:!0,value:t,text:d(t)},f.push(l)}):o.forEach(function(t){l={status:!0,value:t,text:d(t)},i.indexOf(t)<0&&(l.status=!1),f.push(l)}),f}function Mi(t,n){var e=0;return t.forEach(function(t,i){t.Zc===n&&(e=i)}),e}function M(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,e=t.colHeadFieldInfo,r=t.cornerFieldInfo,o=t.pageFieldInfo,a=t.rowInfos,s=t.colInfos,c=t.activeRowFieldInfo,u=t.activeColFieldInfo,l=t.area,f=t.value,h=t.menuArea,v=t.valueFieldName;switch(l){case 0:n=o&&o.fieldName;break;case 1:1===h?n=f:2===h&&r&&(n=r.fieldName)===L().sigmaValueTemp&&(n=L().sigmaValue);break;case 2:if(2===h&&e)(n=e.fieldName)===L().sigmaValueTemp&&(n=L().sigmaValue);else if(5===h)n=v||i&&i.Q[0].Zc;else if(n=u&&u.name||f,(0,_.ht)(n)){for(d=u;0<=d&&s[d]&&(0,_.ht)(s[d].itemName);)d-=1;n=s[d].fieldName}break;case 3:if(5===h)n=v||i&&i.Q[0].Zc;else if(n=c&&c.name||f,(0,_.ht)(n)){for(d=c.index;0<=d&&a[d]&&(0,_.ht)(a[d].itemName);)d-=1;n=a[d].fieldName}break;case 4:n=v}return n}function Si(t,i){var i;return i?(i=i.numberGroup,{isStartActive:(0,_.ht)(i.start),start:((0,_.ht)(i.start)?t:i).start,isEndActive:(0,_.ht)(i.end),end:((0,_.ht)(i.end)?t:i).end,by:(0,_.ht)(i.by)?10:i.by}):{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:10}}function xi(t,i){var n,e,r,o,a;if(i){for(e=[],r=0,o=n=i.dateGroups;r<o.length;r++)a=o[r],e.push(a.by);return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:e}}return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:[_.DateGroupType.months,_.DateGroupType.quarters,_.DateGroupType.years]}}function Di(t,i){return Xt.call(this,t,i)||this}function ki(t,i){return $t.call(this,t,i)||this}function ji(t,i){var t,n,t,e,r,t=t.getRange(),n=t.page,t=t.content,e=i.getActiveRowIndex(),r=i.getActiveColumnIndex();0!==t.colCount?t.contains(e,r)||i.setActiveCell(t.row,t.col):n&&!n.contains(e,r)&&i.setActiveCell(n.row,n.col)}function Oi(t,i){return ti.call(this,t,i)||this}function Pi(t,i){return ii.call(this,t,i)||this}function I(t,i){return ni.call(this,t,i)||this}function S(t,i){return ei.call(this,t,i)||this}function Fi(t,i){return ri.call(this,t,i)||this}function x(t,i){return oi.call(this,t,i)||this}function _i(t,i){return ai.call(this,t,i)||this}function Li(t){var i,t,n,e,r,o,a,s,c,u,c,s;if(4===t.menuArea){if(e=t.rowInfos,r=t.colInfos,o=e&&e.length,a=r&&r.length,s=0===o||e&&e.some(function(t){return t.isGrandTotal}),c=0===a||r&&r.some(function(t){return t.isGrandTotal}),t=t.valueFieldName,u=L(),s&&c||!t)throw new Error(u.Invalid_Field_Sort_By);return(c=s?(i=r[a-1].fieldName,e):(i=e[o-1].fieldName,r))&&0<c.length&&(-1!==(s=c.findIndex(function(t){return t.fieldName===u.sigmaValue}))&&(t=c[s].itemName,c.splice(s,1)),n=c.map(function(t){return{fieldName:t.fieldName,items:[t.itemName]}})),{fieldName:i,sortValueFieldName:t,sortByPivotReferences:n}}}function Ei(t,i){return si.call(this,t,i)||this}function Bi(t,i){return ci.call(this,t,i)||this}function Ri(t,i){return ui.call(this,t,i)||this}function Gi(t,i){return li.call(this,t,i)||this}function Vi(t){return(0,_.ht)(t)?N:t instanceof Date?t:W.yU(t)}function D(t,i){return fi.call(this,t,i)||this}function j(t,i){return hi.call(this,t,i)||this}function Ui(t,i){return vi.call(this,t,i)||this}function Qi(t,i){return di.call(this,t,i)||this}function Wi(t,i){return pi.call(this,t,i)||this}function zi(t,i,n){var e,r,i,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,e=i.tT,r=e.commandOptions.pivotTableCellInfo,i=i.Mf,o=e.selections[0],a=i.pivotTables.get(e.commandOptions.pivotTableName),s=a.eZt,c=!1,u=a.rZt.HWt[3],l=a.rZt.HWt[2],f=[],h=a.dh,v=u.zWt,d=l.WWt,p=[];switch(1<h.Q.length&&(g=h.x2,w=h.P2),a.suspendLayout(),r.area){case 3:if(y=h.B.length,0===g&&r.activeRowFieldInfo&&w<r.activeRowFieldInfo.index&&(y+=1),c=r.activeRowFieldInfo&&r.activeRowFieldInfo.index===y-1,(m=n?{row:u.DQ+s.row,col:o.col,rowCount:u.Sx,colCount:1}:o).row<u.DQ+s.row||m.row+m.rowCount>u.DQ+s.row+u.Sx||m.col<s.col||m.col+m.colCount>s.col+u.Tx)return;for(C=m.row;C<m.row+m.rowCount;C++)for(N=m.col;N<m.col+m.colCount&&(A=(I=a.getPivotInfoImp(C,N,!1,!1,!0)).rowInfos&&I.rowInfos[r.activeRowFieldInfo.index-(c?1:0)])&&((T=v[C-u.DQ-s.row]).collapseIndex!==k||!(A.isSubtotal&&a.options.subtotalsPosition!==F.SubtotalsPosition.top||A.isGrandTotal||A.isBlankRow))&&(A=I.rowInfos&&I.rowInfos[r.activeRowFieldInfo.index-(c?1:0)]).itemName;N++)if((M=a.collapse(A.fieldName,A.itemName))&&!t||!M&&t){S=A.fieldName+A.itemName,p.indexOf(S)<0&&(p.push(S),f.push({fieldName:A.fieldName,itemName:A.itemName,collapse:t}));break}break;case 2:if(r.colHeadFieldInfo){for(y=h.R.length,1===g&&(0===r.relativeRow&&w<r.relativeColumn||r.activeColFieldInfo&&w<r.activeColFieldInfo.index)&&(y+=1),c=r.relativeColumn===y-1,N=(b={row:r.relativeColumn+s.row+1,col:l.jN+s.col,rowCount:1,colCount:l.Tx}).col;N<b.col+b.colCount;N++)for(C=b.row;C<b.row+b.rowCount&&(x=a.getPivotInfoImp(C,N,!1,!1,!0),T=d[N-l.jN-s.col],D=x.colInfos&&x.colInfos[x.relativeRow-1-(c?1:0)])&&(T.collapseIndex!==k||!D.isSubtotal&&!D.isGrandTotal)&&(D=x.colInfos&&x.colInfos[x.relativeRow-1-(c?1:0)]).itemName;C++)if((M=a.collapse(D.fieldName,D.itemName))&&!t||!M&&t){S=D.fieldName+D.itemName,p.indexOf(S)<0&&(p.push(S),f.push({fieldName:D.fieldName,itemName:D.itemName,collapse:t}));break}}else{if(y=h.R.length,1===g&&r.activeColFieldInfo&&w<r.activeColFieldInfo.index&&(y+=1),c=r.activeColFieldInfo&&r.activeColFieldInfo.index===y-1,(b=n?{row:o.row,col:l.jN+s.col,rowCount:1,colCount:l.Tx}:o).col<l.jN+s.col||b.col+b.colCount>l.jN+s.col+l.Tx||b.row<=s.row||b.row+b.rowCount>s.row+l.Sx)return;for(N=b.col;N<b.col+b.colCount;N++)for(C=b.row;C<b.row+b.rowCount&&(x=a.getPivotInfoImp(C,N,!1,!1,!0),T=d[N-l.jN-s.col],D=x.colInfos[r.activeColFieldInfo&&r.activeColFieldInfo.index-(c?1:0)])&&(T.collapseIndex!==k||!D.isSubtotal&&!D.isGrandTotal)&&(D=x.colInfos[r.activeColFieldInfo.index-(c?1:0)]).itemName;C++)if((M=a.collapse(D.fieldName,D.itemName))&&!t||!M&&t){S=D.fieldName+D.itemName,p.indexOf(S)<0&&(p.push(S),f.push({fieldName:D.fieldName,itemName:D.itemName,collapse:t}));break}}break;case 1:if(1<o.colCount*o.rowCount)return;if(r.cornerFieldInfo)for(y=u.Tx,2===g&&w<r.relativeColumn&&(y+=1),c=r.relativeColumn===y-1,C=(m={row:u.DQ+s.row,col:o.col,rowCount:u.Sx,colCount:1}).row;C<m.row+m.rowCount;C++)for(N=m.col;N<m.col+m.colCount&&(I=a.getPivotInfoImp(C,N,!1,!1,!0),T=v[C-u.DQ-s.row],A=I.rowInfos[r.relativeColumn-(c?1:0)])&&(T.collapseIndex!==k||!(A.isSubtotal&&a.options.subtotalsPosition!==F.SubtotalsPosition.top||A.isGrandTotal||A.isBlankRow))&&(A=I.rowInfos[r.relativeColumn-(c?1:0)]).itemName;N++)if((M=a.collapse(A.fieldName,A.itemName))&&!t||!M&&t){S=A.fieldName+A.itemName,p.indexOf(S)<0&&(p.push(S),f.push({fieldName:A.fieldName,itemName:A.itemName,collapse:t}));break}}return a.resumeLayout(),f}function Zi(t,i){return mi.call(this,t,i)||this}function Yi(t,i){return bi.call(this,t,i)||this}function Hi(t,i){return gi.call(this,t,i)||this}function Ji(t,i){return wi.call(this,t,i)||this}function qi(t,i){return yi.call(this,t,i)||this}function Ki(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Xi(t){for(var i,n,e,r,o,o,i=0,n=0;n<t.sheets.length;n++)for(e=t.sheets[n].tables.all(),r=0;r<e.length;r++)(o=e[r].name())&&5<o.length&&"table"===o.substring(0,5).toLowerCase()&&Ki(o=o.substring(5,o.length))&&Number(o)>=i&&(i=Number(o));return"Table"+(i+1).toString()}function $i(t,i){return Ci.call(this,t,i)||this}function tn(t,i){return Ni.call(this,t,i)||this}function nn(t,i){return Ii.call(this,t,i)||this}function en(t,i){var n,e,n=t.split(A.nameSeparator);isNaN(parseInt(n[n.length-1],10))?t+=A.nameSeparator+"1":(e=n[n.length-1],n.splice(n.length-1,1,A.nameSeparator+(parseInt(e,10)+1)),t=n.join("")),i.save(t)||en(t,i)}function rn(t,i){return t.sheets?(0,P._f)(t,i.sheetName):t}n=this&&this.__extends||(Kt=function(t,i){return(Kt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Kt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),T=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),P=i("Core"),F=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),v=i("./dist/plugins/pivot/pivot-table-entry.js"),_=i("Pivot"),w=i("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),E=i("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),B=i("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),R=i("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),G=i("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),p=i("Common"),V=i("SheetsCalc"),t=i("./dist/plugins/pivot/pivot.ns.js"),b=i("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),A=i("./dist/plugins/pivot/pivot-util.js"),U=i("@grapecity/js-calc"),d=i("./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js"),Q=p.Formatter.GeneralFormatter,i=new p.Common.ResourceManager(t.SR,"PivotTables"),L=i.getResource.bind(i),t=P.Commands.ActionBase,e="PivotOutlineButtonToggle",r=P.Commands.zA,W=p.Common.ct,z=p.Common.CultureManager,o="moveField",a="removeField",s="AddField",c="fieldSet",u="CreatePivotFilterDialog",l="updateListBox",f="changePanelFieldStatus",h="filterFieldLabelValue",m="pivotSort",g="ClearCommand",y="updatePivotCache",C="createFilterSecondaryMenu",Z="createDialogForLabelFilter",Y="OpenPivotFilterDialogCmd",H="updateCondition",J="createDialogForValueFilter",q="updateValueCondition",K="createDialogForPivotSort",X="sortPivotField",$="sortPivotValueField",tt="TopTenCondition",it="dialogForDateFilter",nt="openValueFieldSettingDialogCmd",et="UpdatePivotValueFieldCmd",rt="UpdatePivotFieldCmd",ot="CreatePivotViewsListDialog",at="OpenPivotGroupDialog",st="OpenPivotShowValueAsDialog",ct="ApplyPivotView",ut="AddPivotView",lt="pivotRefresh",ft="pivotTableGroup",ht="pivotTableUnGroup",vt="pivotShowDetails",dt="pivotExpand",pt="pivotCollapse",mt="pivotExpandEntireField",bt="pivotCollapseEntireField",gt="removePivotGrandTotal",wt="updatePivotDefer",yt="doPivotTableFilter",Ct="selectWholePivotTable",Nt=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],N=null,k=void 0,It=function(t,i,n){var t,e,t=t.pivotTables.findPivotTable(i,n),e=N;return{pivotInfo:e=t?t.getPivotInfoImp(i,n,!1,!1,!0):e,pt:t}},At=function(t,i,n,e,r){for(var o,a,s,c,s,o=[],a=0;a<e.length;a++)s=e[a],c=void 0,3===r?c=new P.Range(s.row,s.col,s.rowCount,1):2===r&&(c=new P.Range(s.row,s.col,1,s.colCount)),(s=c&&t.pivotTables.getRangePivotAreas(c))&&s[i].map(function(t){var i;t.labelOnly&&t.references.forEach(function(t){if(t.fieldName===n)for(var i=0;i<t.items.length;i++)-1===o.indexOf(t.items[i])&&o.push(t.items[i])})});return o},n(Di,Xt=t),Di.prototype.execute=function(){var t,i,n,e,e,r,e,o,a,s,c,u,l,f,h,s,t=this,i=!1;if(t.canExecute()&&(n=t.Mf,e=t.tT,r=(e=It(n,e.row,e.col)).pivotInfo,e=e.pt,r)){o=r.activeRowFieldInfo,a=r.activeColFieldInfo,s=r.area,c=void 0,(u=n.Ut).startTransaction(),t.X5(n,!0);try{switch(s){case 2:c=r.colInfos[a&&a.index];break;case 3:c=r.rowInfos[o&&o.index]}l=c.fieldName,f=c.itemName,h=e.collapse(l,f),e.collapse(l,f,!h),n.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:f,newValue:!h,oldValue:h,pivotTableName:e.Zc}),i=!0}finally{t.q5(n,!0),s=P.Commands.TI(n.name()),t.tT[s]=u.endTransaction()}}return i},Di.prototype.undo=function(){var t,i,n,e,r,o,a,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,a=It(i,t.tT.row,t.tT.col).pt,i.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:o.fieldName,newValue:o.isCollapse,oldValue:!o.isCollapse,pivotTableName:a.Zc,item:o.item}),n=!0}finally{t.q5(i,!0)}}return n},Tt=Di,P.Commands[e]={canUndo:!0,execute:function(t,i,n){return P.Commands.zA(t,Tt,i,n)}},n(ki,$t=t),ki.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,r,u,l,f,h,v,d,p,m,b,g,w,y,C,h,t=this,i=!1;if(t.canExecute())if(e=(n=t.Mf).Ut,o=(r=t.tT.cmdOption).fieldName,a=r.targetArea,s=r.targetIndex,c=r.isSusPaint,r=r.pivotName,u=n.pivotTables&&n.pivotTables.get(r),l=c?u.dh.copyFieldsModel:u.dh,c)o===L().sigmaValue?(s=(s=-1<s?s:0)<=(f=l.nw(a)).length?s:f.length,l.setSigmaValuePosition(a-1,s)):l.changeFieldArea(o,a,s),l.q3(c);else if(e.startTransaction(),t.X5(n,!0),!(0,_.ht)(o))try{if(o===L().sigmaValue)f=l.nw(a),s=(s=-1<s?s:0)<=f.length?s:f.length,h=u.dataPosition(),l.setSigmaValuePosition(a-1,s),v=a-1,d=s,p=h.positionType,m=h.positionIndex,v===p&&d===m||(u.updateDataModel(),n.ki(P.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:v,newIndex:d,oldArea:p,oldIndex:m,pivotTableName:r}));else{if(f=b=void 0,b=l.getFieldInfoByName(o),(0,_.ht)(b))return!1;for(g=F.PivotTableFieldType.columnField;g>=F.PivotTableFieldType.filterField;g--){for(f=l.nw(g),w=!1,y=f.length-1;0<=y;y--)if(f[y].a===b.a){o=f[y].Zc,w=!0;break}if(w)break}C=u.getField(o),f=l.nw(a),v=a,p=C.pivotArea,m=C.pivotIndex,d=(d=-1<s?s:0)<=f.length?d:f.length,v===p&&m===d||(u.updateField(o,a,s),u.updateDataModel(),n.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o,newArea:v,newIndex:d,oldArea:p,oldIndex:m,pivotTableName:r}))}l.q3(c,null,!0),ji(u,n),i=!0}catch(t){n.jT(10,t.message)}finally{t.q5(n,!0),h=P.Commands.TI(n.name()),t.tT[h]=e.endTransaction()}return i},ki.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,l,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],o=i.pivotTables&&i.pivotTables.get(t.tT.cmdOption.pivotName),a=r.pivotTableChanges,s=void 0,i.Ut.undo(r),c=0;c<a.length&&("addField"!==(s=a[c].value).type&&"updateValuePosition"!==s.type);c++);u=o.getField(s.fieldName),"updateValuePosition"===s.type?(l=o.dataPosition(),i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",newArea:s.position,newIndex:s.valuesIndex,oldArea:l.positionType,oldIndex:l.positionIndex,pivotTableName:t.tT.cmdOption.pivotName})):i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,newArea:s.area,newIndex:s.index,oldArea:u.pivotArea,oldIndex:u.pivotIndex,pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Mt=ki,P.Commands[o]={canUndo:!0,execute:function(t,i,n){return r(t,Mt,i,n)}},n(Oi,ti=t),Oi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,n,f,h,v,d,p,m,n,t=this,i=!1;if(t.canExecute())if(n=t.tT,r=(e=t.Mf).Ut,o=n.cmdOption,(l=u=c=s=a=void 0,_.ht)(o)?(f=(n=n.commandOptions).pivotTableCellInfo,a=(u=e.pivotTables&&e.pivotTables.get(n.pivotTableName)).dh,s=M(f)):(s=o.fieldName,c=o.isSusPaint,u=e.pivotTables&&e.pivotTables.get(o.pivotName),a=c?u.dh.copyFieldsModel:u.dh),c){if(s===L().sigmaValue)for(v=(h=a.nw(F.PivotTableFieldType.valueField)).length-1;0<=v;v--)a.clearValueFilterOfValueField(h[v].Zc);d=a.Z[s],(l=a.removeFieldOrSigmaByName(s))instanceof b.PivotViewField&&(d===F.PivotTableFieldType.valueField?a.clearValueFilterOfValueField(s):a.y2(s,!1)),a.q3(c)}else{r.startTransaction(),t.X5(e,!0);try{if(p=[],s===L().sigmaValue){for(v=(h=a.nw(F.PivotTableFieldType.valueField)).length-1;0<=v;v--)a.clearValueFilterOfValueField(h[v].Zc);if((m=a.nw(F.PivotTableFieldType.valueField))&&0<m.length)for(v=0;v<m.length;v++)p.push(u.getField(m[v].Zc))}else p.push(u.getField(s));for(l=a.getFieldInfoByName(s),d=a.Z[s],l instanceof b.PivotViewField&&(d===F.PivotTableFieldType.valueField?a.clearValueFilterOfValueField(s):a.y2(s,!1)),a.removeFieldOrSigmaByName(s),v=0;v<p.length;v++)e.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s,oldArea:p[v].pivotArea,oldIndex:p[v].pivotIndex,newArea:N,newIndex:N,pivotTableName:u.Zc});a.q3(c,void 0,!1),ji(u,e),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Oi.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)s=o[a],i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,newArea:s.area,newIndex:s.index,oldIndex:N,oldArea:N,pivotTableName:(t.tT.cmdOption||t.tT.commandOptions).pivotName});n=!0}finally{t.q5(i,!0)}}return n},St=Oi,P.Commands[a]={canUndo:!0,execute:function(t,i,n){return r(t,St,i,n)}},n(Pi,ii=t),Pi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,e,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).commandOptions,(o=(r=t.Mf).Ut).startTransaction(),t.X5(r,!0);try{a=e.pivotTableCellInfo,s=r.pivotTables.get(e.pivotTableName),c=a.area,u=a.menuArea,1===(l=s.options.grandTotalPosition)||2===l?s.options.grandTotalPosition=0:3===l&&(3===c&&5===u?s.options.grandTotalPosition=1:2===c&&5===u&&(s.options.grandTotalPosition=2)),i=!0}finally{t.q5(r,!0),e=P.Commands.TI(r.name()),t.tT[e]=o.endTransaction()}}return i},Pi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},xt=Pi,P.Commands[gt]={canUndo:!0,execute:function(t,i,n){return r(t,xt,i,n)}},n(I,ni=t),I.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,h,v,d,p,m,b,g,w,y,C,N,I,h,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,r=n.commandOptions,(a=(o=t.Mf).Ut).startTransaction(),t.X5(o,!0),(f=l=u=c=s=void 0,_.ht)(e)?(h=r.pivotTableCellInfo,s=(f=o.pivotTables.get(r.pivotTableName)).dh,c=r.subTotalType,l=M(h,s)):(c=e.subtotalType,l=e.oldFieldName,s=(f=o.pivotTables.get(e.pivotName)).dh),h=s.getFieldInfoByName(l),v=s.xy(l),u=e&&e.fieldName||!(0,_.ht)(c)&&v!==c&&s.dz(s.FG(h.a,h.Zc,c))||l;try{(0,_.ht)(h)||(0,_.ht)(c)||(p=!(d=!0),v!==c&&(s.xy(l,c),p=!0),(0,_.ht)(l)||l===u||(m=s.getFieldInfoByName(l),d=s.changeFieldName(m,u)),d||(u=l,o.jT(10,L().PivotTableErrorMessage_EmptyFieldName)),p&&(f.updateDataModel(),o.ki(P.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:u,oldValue:v,newValue:c,pivotTableName:f.Zc}))),w=g=b=void 0,e?(b=e.showValueAsType,g=e.baseField,w=e.baseItem):r&&(b=r.showValueAsType),y=void 0,w?y=0===w.index?{showDataAs:b,baseFieldName:g,baseFieldItemType:2}:1===w.index?{showDataAs:b,baseFieldName:g,baseFieldItemType:1}:{showDataAs:b,baseFieldName:g,baseFieldItemType:0,baseFieldItem:w.value}:g?y={showDataAs:b,baseFieldName:g}:(0,_.ht)(b)||(y={showDataAs:b}),C=s.getFieldInfoByName(u).Or||{showDataAs:0},(N=y&&!this.oZt(y,C))&&(f.showDataAs(u,y),f.updateDataModel(),o.ki(P.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:u,oldValue:(0,A.RF)(C),newValue:(0,A.RF)(y),pivotTableName:f.Zc})),I=n.formatter,7===c&&(I=I||"0.0000000"),(0,_.ht)(f.showDataAs(u))||(b=f.showDataAs(u).showDataAs),(0,A.applyShowDataAsStyle)(f,u,b,I),s.q3(null,null,!0),i=!0}catch(t){o.jT(10,t.message)}finally{t.q5(o,!0),h=P.Commands.TI(o.name()),t.tT[h]=a.endTransaction()}}return i},I.prototype.oZt=function(t,i){var n=i.showDataAs,e=i.baseFieldName,r=i.baseFieldItem,i=i.baseFieldItemType;return t.showDataAs===n&&t.baseFieldName===e&&t.baseFieldItem===r&&t.baseFieldItemType===i},I.prototype.aZt=function(t){for(var i,n,e,i=0,n=Nt;i<n.length;i++)if(!(0,_.ht)(t[e=n[i]]))return!1;return!0},I.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),o=(r=t.tT[e]).pivotTableChanges,s=(a=t.tT.cmdOption||t.tT.commandOptions).pivotTableName||a.pivotName,u=(c=i.pivotTables&&i.pivotTables.get(s)).dh,f=l=void 0,h=0;h<o.length;h++)"showDataAs"===(v=o[h].value).type?l=v:"subTotalType"===v.type&&(f=v);i.Ut.undo(r),l&&(d=u.getFieldInfoByName(l.fieldName))&&(p=d.Or,i.ki(P.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:l.fieldName,oldValue:(0,A.RF)(p),newValue:(0,A.RF)(l.oldShowDataAs),pivotTableName:c.Zc})),f&&i.ki(P.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:f.fieldName,oldValue:u.xy(f.fieldName),newValue:f.subtotalType,pivotTableName:c.Zc}),n=!0}finally{t.q5(i,!0)}}return n},Dt=I,P.Commands[et]={canUndo:!0,execute:function(t,i,n){return r(t,Dt,i,n)}},n(S,ei=t),S.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,r,d,e,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,r=n.commandOptions,c=s=void 0,(a=(o=t.Mf).Ut).startTransaction(),t.X5(o,!0),c=((h=f=l=u=void 0,_.ht)(e)?(f=M(v=r.pivotTableCellInfo,u=(h=o.pivotTables.get(r.pivotTableName)).dh),s=r.showNoData,r):(f=e.oldFieldName,u=(h=o.pivotTables.get(e.pivotName)).dh,s=e.showNoData,e)).showSubtotalTop,r=u.getFieldInfoByName(f),l=e&&e.fieldName||u.dz(u.OR(r.a,r.Zc))||f;try{if(h&&h.suspendLayout(),d=n.formatter,h&&(h.showNoData(r.a,s),h.subtotalPosition(r.Zc,c?F.SubtotalsPosition.top:F.SubtotalsPosition.bottom),f!==l)&&h.updateFieldName(f,l),P.mt.St(d))try{(0,V.evaluateFormula)(o,d)}catch(t){if(!(t instanceof U.CalcError))return}this.sZt(h,l,null,d),h&&h.resumeLayout(),i=!0}finally{t.q5(o,!0),e=P.Commands.TI(o.name()),t.tT[e]=a.endTransaction()}}return i},S.prototype.uZt=function(t){return-1<[_.PivotShowDataAs.percentOfTotal,_.PivotShowDataAs.percentOfRow,_.PivotShowDataAs.percentOfCol,_.PivotShowDataAs.percent,_.PivotShowDataAs.percentOfParentRow,_.PivotShowDataAs.percentOfParentCol,_.PivotShowDataAs.percentOfParent,_.PivotShowDataAs.percentDiff,_.PivotShowDataAs.percentOfRunningTotal].indexOf(t)},S.prototype.sZt=function(t,i,n,e){var r,i={labelOnly:!0,references:[{fieldName:i}]},r=(0,A.RF)(t.getStyle(i));r=r||new P.Style,e?r.formatter=e:(delete r.formatter,(0,A.cZt)(r)&&(r=null)),t.setStyle(i,r)},S.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},kt=S,P.Commands[rt]={canUndo:!0,execute:function(t,i,n){return r(t,kt,i,n)}},n(Fi,ri=t),Fi.prototype.execute=function(){var t,i,n,e,r,o,a,n,s,c,u,l,f,f,f,t=this,i=!1,n=t.tT.cmdOption;if(t.canExecute())if(e=n.targetArea,r=n.fieldName,o=n.targetIndex,a=n.pivotName,n=n.isSusPaint,c=(s=t.Mf).Ut,u=s.pivotTables.get(a),l=n?u.dh.copyFieldsModel:u.dh,(0,_.ht)(o)&&(o=l.nw(e).length,(f=l.getSigmaValuePosition()).display)&&f.positionType===e-1&&o++,f=r,e===F.PivotTableFieldType.valueField&&(f=l.dz(l.FG(r))),n)l.addFieldByName(r,f,e,N,o),l.q3(n);else{c.startTransaction(),t.X5(s,!0);try{l.addFieldByName(r,f,e,N,o),u.updateDataModel(),s.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:r,newArea:e,newIndex:o,oldIndex:N,oldArea:N,pivotTableName:a}),l.q3(n,null,!0),ji(s.pivotTables.get(a),s),i=!0}catch(t){s.jT(10,t.message)}finally{t.q5(s,!0),f=P.Commands.TI(s.name()),t.tT[f]=c.endTransaction()}}return i},Fi.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"removeField"===(s=o[a].value).type&&i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:s.area,oldIndex:s.index,newArea:N,newIndex:N,pivotTableName:t.tT.cmdOption.pivotName});n=!0}finally{t.q5(i,!0)}}return n},jt=Fi,P.Commands[s]={canUndo:!0,execute:function(t,i,n){return r(t,jt,i,n)}},n(x,oi=t),x.prototype.getAllItemsList=function(t){var i,n,i=[],n;return t._items.forEach(function(t){i.push(t.value)}),i},x.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,b,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,s=a=o=r=void 0,(u=(c=t.Mf).Ut).startTransaction(),t.X5(c,!0);try{if((0,_.ht)(e)){if(d=t.tT.commandOptions,p=t.tT.selections,m=d.subType,a=c.pivotTables.get(d.pivotTableName),b=d.pivotTableCellInfo,g=a.dh,w=b.area,r=M(b),y=void 0,s=a.options.allowMultipleFiltersPerField&&a.labelFilter(r)||{},y=(0,_.ht)(s.textItem)?{isAll:!1}:s.textItem,C=At(c,d.pivotTableName,r,p,w),1===m)y.list=T([],C,!0);else if(2===m){for(N=(g.getLabelFilterInfo(r)&&g.getLabelFilterInfo(r).textItem&&g.getLabelFilterInfo(r).textItem.list||g.Kz(r)).slice(0),I=[],A=0;A<N.length;A++)-1===C.indexOf(N[A])&&I.push(N[A]);y.list=I}s.textItem=y}else r=e.fieldName,o=e.pivotName,a=c.pivotTables.get(o),l=e.dataOfListBox,s=a.options.allowMultipleFiltersPerField&&a.labelFilter(r)||{},f={list:[],isAll:!1},h=[],v=!0,l.forEach(function(t){t.status||(v=v&&t.status),t.status&&h.push(t.value)}),f.isAll=v,f.list=h,s.textItem=f;a.labelFilter(r,s),c.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:r,filterInfo:a.labelFilter(r),pivotTableName:o}),i=!0}finally{t.q5(c,!0),b=P.Commands.TI(c.name()),t.tT[b]=u.endTransaction()}}return i},x.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,A.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption&&t.tT.cmdOption.pivotName||t.tT.commandOptions.pivotTableName}),n=!0}finally{t.q5(i,!0)}}return n},Ot=x,P.Commands[h]={canUndo:!0,execute:function(t,i,n){return r(t,Ot,i,n)}},n(_i,ai=t),_i.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,p,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,u=c=a=o=r=void 0,(f=(l=t.Mf).Ut).startTransaction(),t.X5(l,!0),h=!1;try{if((0,_.ht)(e))o=(d=n.commandOptions).pivotTableName,a=l.pivotTables.get(d.pivotTableName),r=M(p=d.pivotTableCellInfo),s=d.subType,d.sortValueInfo?h=!0:(m=Li(p))&&(r=m.fieldName,c=m.sortValueFieldName,u=m.sortByPivotReferences);else switch(r=e.fieldName,o=e.pivotName,v=e.commandName,a=l.pivotTables.get(o),v){case"asc":s=_.SortType.asc;break;case"desc":s=_.SortType.desc;break;case"custom":s=_.SortType.custom;break;default:return}if(b=void 0,h){for(g=a.dh,w=(d=e||n.commandOptions).sortValueInfo.sortedFieldNames,y=[].concat(w),w.sort(function(t,i){var t=t.localeCompare(i);return s===_.SortType.desc?-1*t:t}),C=0;C<w.length-1;C++)g.changeFieldArea(w[C],3,C);a.refresh(),b={type:"sort",sortType:s,fieldName:L().Values,oldOrder:y,newOrder:w,pivotTableName:o}}else a.sort(r,{sortType:s,sortValueFieldName:c,sortByPivotReferences:u}),b={type:"sort",fieldName:r,sortType:s,sortInfo:a.sort(r),pivotTableName:o};b&&(l.ki(P.Events.PivotTableChanged,b),i=!0)}catch(t){l.jT(10,t.message)}finally{t.q5(l,!0),p=P.Commands.TI(l.name()),t.tT[p]=f.endTransaction()}}return i},_i.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,l,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),o=(r=t.tT[e]).pivotTableChanges[r.pivotTableChanges.length-1].value,i.Ut.undo(r),a=t.tT.cmdOption||t.tT.commandOptions,s=void 0,s=a.sortValueInfo?(u=(c=a.sortValueInfo).sortedFieldNames,{type:"sort",sortType:l=c.sortType,fieldName:L().Values,oldOrder:T([],u,!0),newOrder:T([],u,!0).reverse(),pivotTableName:a.pivotName||a.pivotTableName}):{type:"sort",fieldName:o.fieldName,sortType:o.sortInfo?o.sortInfo.sortType:N,sortInfo:o.sortInfo,pivotTableName:a.pivotName},i.ki(P.Events.PivotTableChanged,s),n=!0}finally{t.q5(i,!0)}}return n},Pt=_i,P.Commands[m]={canUndo:!0,execute:function(t,i,n){return r(t,Pt,i,n)}},n(Ei,si=t),Ei.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,f,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,c=s=a=o=r=void 0,(l=(u=t.Mf).Ut).startTransaction(),t.X5(u,!0);try{(0,_.ht)(e)?(f=t.tT.commandOptions,r=u.pivotTables.get(f.pivotTableName),o=M(h=f.pivotTableCellInfo),a=f.clearType):(o=e.fieldName,a=e.clearType,s=e.labelType||3,c=e.pivotName,r=u.pivotTables.get(c)),1===a?((v=r.labelFilter(o))&&(1===s?delete v.textItem:2===s?delete v.condition:v=N),r.labelFilter(o,v)):2===a?r.valueFilter(o,N):0===a&&(r.labelFilter(o,N),r.valueFilter(o,N)),u.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:o,pivotTableName:c,clearType:a}),i=!0}finally{t.q5(u,!0),f=P.Commands.TI(u.name()),t.tT[f]=l.endTransaction()}}return i},Ei.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"setLabelFilter"!==(s=o[a].value).type&&"setValueFilter"!==s.type||i.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:s.fieldName,filterInfo:(0,A.RF)(s.filterInfo),pivotTableName:(t.tT.cmdOption||t.tT.commandOptions).pivotName});n=!0}finally{t.q5(i,!0)}}return n},Ft=Ei,P.Commands[g]={canUndo:!0,execute:function(t,i,n){return r(t,Ft,i,n)}},n(Bi,ci=t),Bi.prototype.execute=function(){var t,i,n,e,r,o,a,n,s,c,u,l,f,h,l,t=this,i=!1;if(t.canExecute()){e=(n=t.tT.cmdOption).fieldName,r=n.selectValue,o=n.inputValue,a=n.inputValueEnd,n=n.pivotName,(c=(s=t.Mf).Ut).startTransaction(),t.X5(s,!0);try{l=(u=s.pivotTables.get(n)).dh.rBt(e),f=u.options.allowMultipleFiltersPerField&&u.labelFilter(e)||{},l===_.PivotDataType.number&&(o=(0,_.ht)(o)?o:parseInt(o,10),a=(0,_.ht)(a)?a:parseInt(a,10)),h={conType:_.PivotConditionType.caption,val:[o,a],operator:r},f.condition=h,u.labelFilter(e,f),s.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:u.labelFilter(e),pivotTableName:n}),i=!0}finally{t.q5(s,!0),l=P.Commands.TI(s.name()),t.tT[l]=c.endTransaction()}}return i},Bi.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,A.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},_t=Bi,P.Commands[H]={canUndo:!0,execute:function(t,i,n){return r(t,_t,i,n)}},n(Ri,ui=t),Ri.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.valueOfField,a=n.valueOfFieldValue,s=n.inputValue,c=n.inputValueEnd,u=n.fieldName,l=n.pivotName,f=e.pivotTables.get(l),h={},v=void 0,v={conType:_.PivotConditionType.value,val:[s,c],operator:+a},h.condition=v,h.conditionByName=o,f.valueFilter(u,h),e.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:u,filterInfo:f.valueFilter(u),pivotTableName:l}),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Ri.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(P.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,A.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Lt=Ri,P.Commands[q]={canUndo:!0,execute:function(t,i,n){return r(t,Lt,i,n)}},n(Gi,li=t),Gi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.fieldName,a=n.TopOrBottomValue,s=n.inputValue,c=n.pivotName,u=n.selectTypeValue,l=n.valueFieldName,f=e.pivotTables.get(c),h={},v=void 0,d=1,p=0,m=10,"Bottom"===a&&(d=-1),"Percent"===u?p=1:"Sum"===u&&(p=2),isNaN(+s)||(m=+s),v={conType:_.PivotConditionType.top10,val:m,type:p,operator:d},h.condition=v,h.conditionByName=l,f.valueFilter(o,h),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Gi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Et=Gi,P.Commands[tt]={canUndo:!0,execute:function(t,i,n){return r(t,Et,i,n)}},n(D,fi=t),D.prototype.canExecute=function(){for(var t,i,n,e,r,o,a,t=this,i=t.tT.cmdOption,n,e,r=t.Mf.pivotTables.get(i.pivotName).dh,a=0;a<r.z.length;a++)r.z[a]instanceof v.PivotPanel&&(o=r.z[a]);return!(o&&o.GY&&o.GY.AWt)},D.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,n,h,v,d,p,m,b,g,s,t=this,i=!1;if(t.canExecute()){if(n=t.tT.cmdOption,r=(e=t.Mf).Ut,o=n.fieldName,a=n.pivotName,s=n.host,c=n.command,u=n.isWholeDay,l=n.dateLabel,f=n.value1,n=n.value2,v=(h=e.pivotTables.get(a)).dh,d=h.options.allowMultipleFiltersPerField&&h.labelFilter(o)||{},p=void 0,m=+c.split("-")[0],isNaN(m))return;if(m<=_.PivotDateFilterOperator.notBetween&&l)new w.DateFilterDialog(s,l,v,o,a,m),i=!0;else try{if(r.startTransaction(),t.X5(e,!0),b=Vi(f),g=Vi(n),!(0,_.ht)(f)&&(0,_.ht)(b)||!(0,_.ht)(n)&&(0,_.ht)(g))throw new Error(L().DateFormatError);p=41==m?t.createParallelDateFilterCondition(c):{conType:_.PivotConditionType.date,val:[b,g],isWholeDay:u,operator:m},d.condition=p,h.labelFilter(o,d),i=!0}finally{t.q5(e,!0),s=P.Commands.TI(e.name()),t.tT[s]=r.endTransaction()}}return i},D.prototype.createParallelDateFilterCondition=function(t){var i,n,e,r,o,a,i;switch(+t.split("-")[1]){case 1:e=new Date,r=new Date,a=(o=e.getMonth())%3,e.setDate(1),e.setHours(0,0,0,0),e.setMonth(o-a),r.setHours(23,59,59),n={conType:_.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:_.PivotDateFilterOperator.dateToDate,isParallel:!1,by:_.PivotAdvancedDateFilterBy.quarter};break;case 2:e=new Date,r=new Date,e.setDate(1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:_.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:_.PivotDateFilterOperator.dateToDate,isParallel:!1,by:_.PivotAdvancedDateFilterBy.month};break;case 3:e=new Date,r=new Date,e.setMonth(0,1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:_.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:_.PivotDateFilterOperator.dateToDate,isParallel:!0,by:_.PivotAdvancedDateFilterBy.year};break;case 4:e=new Date,r=new Date,a=(o=e.getMonth())%3,e.setDate(1),e.setHours(0,0,0,0),e.setMonth(o-a),r.setHours(23,59,59),n={conType:_.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:_.PivotDateFilterOperator.dateToDate,isParallel:!0,by:_.PivotAdvancedDateFilterBy.quarter};break;case 5:e=new Date,r=new Date,e.setDate(1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:_.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:_.PivotDateFilterOperator.dateToDate,isParallel:!0,by:_.PivotAdvancedDateFilterBy.month}}return n},D.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Bt=D,P.Commands[it]={canUndo:!0,execute:function(t,i,n){return r(t,Bt,i,n)}},n(j,hi=t),j.prototype.canExecute=function(){return!0},j.prototype.execute=function(){var t,i,n,e,r,o,a,n,a,a,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,r=(e=t.Mf).Ut,o=n.fieldName,a=n.pivotName,n=n.labelFilter,a=e.pivotTables.get(a);try{r.startTransaction(),t.X5(e,!0),a.labelFilter(o,n),i=!0}finally{t.q5(e,!0),a=P.Commands.TI(e.name()),t.tT[a]=r.endTransaction()}}return i},j.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Rt=j,P.Commands[yt]={canUndo:!0,execute:function(t,i,n){return r(t,Rt,i,n)}},n(Ui,vi=t),Ui.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,k,j,O,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0),o=(r=t.tT).commandOptions,a=r.cmdOption;try{if(d=((m=p=d=v=h=f=l=u=c=s=void 0,_.ht)(a)?(s=(l=n.pivotTables.get(o.pivotTableName)).dh,g=(b=o.pivotTableCellInfo).activeRowFieldInfo,w=b.activeColFieldInfo,v=b.area,c=g&&g.name||w&&w.name,r):(c=a.fieldName,u=a.pivotName,f=a.dataType,l=n.pivotTables.get(u),a)).selections,c=(p=l.getField(c)).sourceName,m=p.fieldName,f===_.PivotDataType.number)h={originFieldName:c,numberGroup:{start:a.startingAtValue,end:a.endingAtValue,by:a.groupByValue}},l.group(h);else if(f===_.PivotDataType.date){if(h={originFieldName:c},0<(y=a.groupByValueArray).length)for(h.dateGroups=[],C=0;C<y.length;C++)N=y[C],h.dateGroups.push({start:new Date(a.startingAtValue),end:new Date(a.endingAtValue),by:N});l.group(h)}else if(I=c,T=A=void 0,M={},S=!!s.sy(c),D=x=void 0,D=At(n,l.name(),m,d,v),j=(k=l.getGroupInfo(c))&&k.textGroup&&k.textGroup.groupItems,(0,_.ht)(j))1<D.length&&(I=(A=c)+2,M[x=L().Group+1]=D,T={originFieldName:A,textGroup:{fieldName:I,groupItems:M}},l.group(T),S||(3===v?l.add(I,I,F.PivotTableFieldType.rowField,void 0,Mi(s.B,c)):2===v&&l.add(I,I,F.PivotTableFieldType.columnField,void 0,Mi(s.R,c))));else{for(C=0;C<D.length;C++)if(-1<(O=D[C]).indexOf("Group")&&j[O]&&1<j[O].length)return!1;j[x=L().Group+(Object.keys(j).length+1)]=D,l.group(k)}i=!0}catch(t){n.jT(10,t.message)}finally{t.q5(n,!0),o=P.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Ui.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Gt=Ui,P.Commands[ft]={canUndo:!0,execute:function(t,i,n){return r(t,Gt,i,n)}},n(Qi,di=t),Qi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{o=(r=t.tT).commandOptions,a=n.pivotTables.get(o.pivotTableName),c=M(s=o.pivotTableCellInfo),(u=a.getField(c))&&u.sourceName&&(a.ungroup(u.sourceName),i=!0)}finally{t.q5(n,!0),o=P.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Qi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Vt=Qi,P.Commands[ht]={canUndo:!0,execute:function(t,i,n){return r(t,Vt,i,n)}},n(Wi,pi=t),Wi.prototype.execute=function(){var t,i,n,e,r,o,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{(r=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName)).suspendLayout(),o=zi(!1,this,!1),(0,_.o)(o,function(t){var i=r.collapse(t.fieldName,t.itemName);r.collapse(t.fieldName,t.itemName,t.collapse),r.updateDataModel(),n.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:t.fieldName,item:t.itemName,newValue:t.collapse,oldValue:i,pivotTableName:r.Zc})}),r.resumeLayout(),i=!0}finally{t.q5(n,!0),o=P.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Wi.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(c=o[s].value).type&&(u=a.collapse(c.fieldName,c.item),i.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,item:c.item,newValue:u,oldValue:c.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Ut=Wi,P.Commands[dt]={canUndo:!0,execute:function(t,i,n){return r(t,Ut,i,n)}},n(Zi,mi=t),Zi.prototype.execute=function(){var t,i,n,e,r,o,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{(r=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName)).suspendLayout(),o=zi(!0,this,!1),(0,_.o)(o,function(t){var i=r.collapse(t.fieldName,t.itemName);r.collapse(t.fieldName,t.itemName,t.collapse),r.updateDataModel(),n.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:t.fieldName,item:t.itemName,newValue:t.collapse,oldValue:i,pivotTableName:r.Zc})}),r.resumeLayout(),i=!0}finally{t.q5(n,!0),o=P.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Zi.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(c=o[s].value).type&&(u=a.collapse(c.fieldName,c.item),i.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,item:c.item,newValue:u,oldValue:c.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Qt=Zi,P.Commands[pt]={canUndo:!0,execute:function(t,i,n){return r(t,Qt,i,n)}},n(Yi,bi=t),Yi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{(o=e.pivotTables.get(n.commandOptions.pivotTableName)).suspendLayout(),a=zi(!1,this,!0),(c=!1,_.o)(a,function(t){c=o.collapse(t.fieldName,t.itemName),o.collapse(t.fieldName,t.itemName,t.collapse),s=t.fieldName}),o.updateDataModel(),e.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:s,newValue:!1,oldValue:c,pivotTableName:o.Zc}),o.resumeLayout(),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Yi.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(c=o[s].value).type&&(u=a.collapse(c.fieldName,c.item),i.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,item:c.item,newValue:u,oldValue:c.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Wt=Yi,P.Commands[mt]={canUndo:!0,execute:function(t,i,n){return r(t,Wt,i,n)}},n(Hi,gi=t),Hi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{(o=e.pivotTables.get(n.commandOptions.pivotTableName)).suspendLayout(),a=zi(!0,this,!0),c=!0,(0,_.o)(a,function(t){c=o.collapse(t.fieldName,t.itemName),o.collapse(t.fieldName,t.itemName,t.collapse),s=t.fieldName}),o.updateDataModel(),e.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:s,newValue:!0,oldValue:c,pivotTableName:o.Zc}),o.resumeLayout(),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Hi.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,u,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(c=o[s].value).type&&(u=a.collapse(c.fieldName,c.item),i.ki(P.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,item:c.item,newValue:u,oldValue:c.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},zt=Hi,P.Commands[bt]={canUndo:!0,execute:function(t,i,n){return r(t,zt,i,n)}},n(Ji,wi=t),Ji.prototype.execute=function(){var t,i,n,e,r,n,o,a,s,n,c,u,l,f,h,v,d,p,m,b,g,n,t=this,i=!1;if(t.canExecute())if(n=t.tT,r=(e=t.Mf).Ut,o=(n=n.cmdOption).isSusPaint,a=n.fieldName,s=n.checked,n=n.pivotName,c=e.pivotTables&&e.pivotTables.get(n),u=void 0,l=o?c.dh.copyFieldsModel:c.dh,o)s?l.qVt(a):l.HVt(a),l.q3(o);else{r.startTransaction(),t.X5(e,!0);try{if(s)f=l.qVt(a),u=(v=(h=l.Ti.getPivotCacheByName(l.L).Pq)[a].W5)===_.PivotDataType.number?{pivotArea:F.PivotTableFieldType.valueField,pivotIndex:l.nw(F.PivotTableFieldType.valueField).length-1}:c.getField(a),c.updateDataModel(),e.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f&&f.Zc,oldArea:N,oldIndex:N,newArea:u.pivotArea,newIndex:u.pivotIndex,pivotTableName:c.Zc});else{for(d=void 0,p=[],m=F.PivotTableFieldType.valueField;m>=F.PivotTableFieldType.filterField;m--)for(b=(d=l.nw(m)).length-1;0<=b;b--)d[b].a===a&&p.unshift(c.getField(d[b].Zc));for(l.HVt(a),g=0;g<p.length;g++)u=p[g],e.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:u.fieldName,sourceName:a,oldArea:u.pivotArea,oldIndex:u.pivotIndex,newArea:N,newIndex:N,pivotTableName:c.Zc})}l.q3(o,null,!1),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Ji.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"removeField"===(s=o[a].value).type?i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:s.area,oldIndex:s.index,newArea:N,newIndex:N,pivotTableName:t.tT.cmdOption.pivotName}):i.ki(P.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:N,oldIndex:N,newArea:s.area,newIndex:s.index,pivotTableName:t.tT.cmdOption.pivotName});n=!0}finally{t.q5(i,!0)}}return n},Zt=Ji,P.Commands[f]={canUndo:!0,execute:function(t,i,n){return r(t,Zt,i,n)}},n(qi,yi=t),qi.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{a=(o=n.cmdOption).fieldsInfo,(c=(s=e.pivotTables&&e.pivotTables.get(o.pivotName)).dh).VT(a),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},qi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Yt=qi,P.Commands[wt]={canUndo:!0,execute:function(t,i,n){return r(t,Yt,i,n)}},n($i,Ci=t),$i.prototype.execute=function(){var t,i,n,e,r,o,a,s,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{a=(o=n.cmdOption).name,(s=o.views).apply(a),e.ki(P.Events.PivotTableChanged,{type:"viewChanged",viewName:a,pivotTableName:o.pivotName}),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},$i.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),i.ki(P.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Ht=$i,P.Commands[ct]={canUndo:!0,execute:function(t,i,n){return r(t,Ht,i,n)}},P.Commands[vt]={canUndo:!1,execute:function(t,i,n){var t,i,e,i,r,i,r,o,a,i,r,e,t,t=P.Commands.Tp(t,i),i=i.commandOptions,e=t.pivotTables.get(i.pivotTableName),i=i.pivotTableCellInfo,r=i.rowInfos,i=i.colInfos,r=r&&i?r.concat(i):r||i||[],o=[],a=0;(0,_.o)(r,function(t){t.fieldName!==L().sigmaValue&&(o[a]={fieldName:t.fieldName,fieldItem:t.itemName},a++)}),i=e.getPivotDetails(o),(r=t.getParent())&&((e=new P.Worksheet).setRowCount(200<i.length?i.length:200),e.setColumnCount(20<i[0].length?i[0].length:20),e.setArray(0,0,i),t=Xi(r),e.tables.add(t,0,0,i.length,i[0].length),r.addSheet(r.getActiveSheetIndex(),e))}},P.Commands[C]={canUndo:!1,execute:function(t,i){var t,i,n,e,r,o,a,s,c,i,t,r,u,l,t=P.Commands.Tp(t,i),i=i.cmdOption,n=i.fieldName,e=i.pivotName,r=i.commandName,o=i.host,a=i.position,s=i.filterDialog,i=[],u,l=(t.pivotTables&&t.pivotTables.get(e)).dh,t=l.K.get(n);if("ValueFilter"===r)c=new v.PivotValuesDialog(o,l,e,n,N,N,s),t&&t.valueFilter&&(3===t.valueFilter.condition.sn?i.push(8):i.push(t.valueFilter.condition.LVt));else{switch(l.rBt(n)){case 0:c=new v.PivotNumberFilter(o,l,e,n,N,N,s);break;case 2:c=new v.PivotDateFilterDialog(o,l,e,n,N,N,s);break;default:c=new v.PivotStringFilterDialog(o,l,e,n,N,N,s)}t&&t.labelFilter&&t.labelFilter.condition&&(r=2===t.labelFilter.condition.sn?t.labelFilter.condition.LVt+6:t.labelFilter.condition.LVt,i.push(r))}c.rQ(a,{existed:i,dataType:1})}},P.Commands[Z]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,c,u,i,i,i,l,f,e=i.cmdOption,t=P.Commands.Tp(t,i);(0,_.ht)(e)?(i=i.commandOptions,u=t.pivotTables.get(i.pivotTableName),i=i.pivotTableCellInfo,r=u.dh,o=M(i),a=u.name(),c=(l=(i=u.labelFilter(o))&&i.conditionInfo&&i.conditionInfo.LVt)||0):(o=e.fieldName,a=e.pivotName,c=e.command,r=(u=t.pivotTables.get(a)).dh),new((f=r.rBt(o))===_.PivotDataType.date?(s=L().getDateLabelFilterItemText(),w.DateFilterDialog):(s=L().getStringLabelFilterItemText(),v.LabelFilter))(document.body,s,r,o,a,+c)}},P.Commands[u]={canUndo:!1,execute:function(t,i,n){var t,i,e,r,i,o,t,a,s,c,u,a,l,t=P.Commands.Tp(t,i),i=i.cmdOption,e=i.position,r=i.fieldName,i=i.pivotName,o,t=t.pivotTables.get(i).dh,a=t.getFieldInfoByName(r),u=t.Z[r],a=Ai(t,a,r,c,i,u);return u===F.PivotTableFieldType.filterField?c=!(s=24):(s=30,u!==F.PivotTableFieldType.valueField&&(c=!0)),a.isColOrRow=c,(l=new v.PivotFilterDialog(document.body,t,i)).init(s,r,e,a),!0}},P.Commands[c]={canUndo:!1,execute:function(t,i){var n,t,e,r,o,i,a,i,s,t,n,t,n=i.cmdOption,t=P.Commands.Tp(t,i),i=((0,_.ht)(n)?(r=M(s=(i=i.commandOptions).pivotTableCellInfo,e=(a=t.pivotTables.get(i.pivotTableName))&&a.dh),o=i.pivotTableName):(a=t.pivotTables.get(n.pivotName),r=n.fieldName,o=n.pivotName,e=a&&a.dh),a&&a.lZt),t=e.getFieldInfoByName(r),n=e.a1(t.a),t=!!t.Spi;return new E.PivotDimFieldSettingDialog(e,r,o,i,n,t,a.layoutType()).$c(),!0}},P.Commands[Y]={canUndo:!1,execute:function(t,i,n){var t,e,r,e,o,a,s,c,i,u,l,f,c,h,t=P.Commands.Tp(t,i),e=It(t,i.row,i.col),r=e.pivotInfo,e=e.pt;if(r){switch(a=void 0,o=r.area){case 0:a=r.pageFieldInfo;break;case 1:a=r.cornerFieldInfo;break;case 2:a=r.colHeadFieldInfo}if(!a)return!1;s=a.fieldName,c=a.isCompactRoot,i=t.getCellRect(i.row,i.col),u=e.dh,i.y+=i.height,l=Ai(u,u.getFieldInfoByName(s),s,!0,e.Zc,u.Z[s]),(f=0)===r.area?f=24:(f=30,c&&(c=void 0,1===r.area&&(c=u.B.length),1<(c=2===r.area?u.R.length:c)&&(f+=1),l.areaFieldName=u.nw(r.area).map(function(t){return t.Zc}))),(h=new v.PivotFilterDialog(t.parent&&t.parent.j2(),e.dh,e.getName(),{allowResize:!0,keepDialogSize:!0})).init(f,s,i,l)}return!0}},P.Commands[l]={canUndo:!1,execute:function(t,i){var t,i,n,e,r,o,i,a,t,i,s,c,u,t,t=P.Commands.Tp(t,i),i=i.cmdOption,n=i.fieldName,e=i.configurationNumber,r=i.position,o=i.filterDialog,i=i.pivotName,a,t=t.pivotTables.get(i).dh,i=t.getFieldInfoByName(n),s=[],c=t.Z[n],u;return t.nw(c).forEach(function(t){s.push(t.Zc)}),s.splice(s.indexOf(n),1),s.unshift(n),(t=Ai(t,i,n,!0,null,c)).areaFieldName=s,o.init(e,n,r,t),!0}},P.Commands[K]={canUndo:!1,execute:function(i,t,n){var e,r,i,o,a,s,c,u,l,t,f,e,r,h,e,r,h,v,e=t.cmdOption,r=t.commandOptions,i=P.Commands.Tp(i,t);if(e)return o=e.fieldName,a=e.pivotName,u=(c=(s=i.pivotTables.get(a)).dh).nw(3),l=[o],u.forEach(function(t){l.push(t.Zc)}),new d.SortFieldDialog(document.body,l,c,o,a,i),!0;if(r){if(t=r.pivotTableCellInfo,a=r.pivotTableName,c=(s=i.pivotTables.get(a)).dh,4===(f=t.area)){e=s.getRange().content,r=s.rZt.HWt[4].getRange(),h=e.row+t.relativeRow+r.row,e=e.col+t.relativeColumn+r.col,r=s.getPivotInfo(h,e);try{new d.SortValueDialog(document.body,i,s,r)}catch(t){return i.jT(10,t.message),!1}}else{if(o=void 0,t.colHeadFieldInfo?o=t.colHeadFieldInfo.fieldName:t.activeColFieldInfo?o=t.activeColFieldInfo.name:t.activeRowFieldInfo?o=t.activeRowFieldInfo.name:t.cornerFieldInfo&&(o=t.cornerFieldInfo.fieldName),!o)return!1;if(u=c.nw(3),h=[o],v=[],u.forEach(function(t){v.push(t.Zc)}),-1!==v.indexOf(o))return!1;o===L().Values?new d.SortValueDialog(document.body,i,s,t,!0):(h=h.concat(v),new d.SortFieldDialog(document.body,h,c,o,a,i))}return!0}return!1}},n(tn,Ni=t),tn.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.pivotName,a=n.fieldName,s=n.sortInfo,(c=e.pivotTables.get(o)).sort(a,s),e.ki(P.Events.PivotTableChanged,{type:"sort",fieldName:a,sortType:s.sortType,sortInfo:c.sort(a),pivotTableName:o}),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},tn.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(P.Events.PivotTableChanged,{type:"sort",fieldName:o.fieldName,sortType:o.sortInfo.sortType,sortInfo:(0,A.RF)(o.sortInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Jt=tn,P.Commands[X]={canUndo:!0,execute:function(t,i,n){return r(t,Jt,i,n)}},n(nn,Ii=t),nn.prototype.execute=function(){var t,i,n,e,r,o,a,s,c,u,l,f,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{for(o=n.pivotName,a=n.sortedFieldNames,s=n.sortType,l=(u=(c=e.pivotTables.get(o)).dh).Q.map(function(t){return t.Zc}),f=0;f<a.length-1;f++)u.changeFieldArea(a[f],3,f);c.refresh(),e.ki(P.Events.PivotTableChanged,{type:"sort",fieldName:L().Values,sortType:s,oldOrder:l,newOrder:a,pivotTableName:o}),i=!0}finally{t.q5(e,!0),n=P.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},nn.prototype.undo=function(){var t,i,n,e,r,o,a,s,c,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=P.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),a=(o=t.tT.cmdOption).sortedFieldNames,s=o.sortType,c=o.pivotName,i.ki(P.Events.PivotTableChanged,{type:"sort",sortType:s,fieldName:L().Values,oldOrder:T([],a,!0),newOrder:T([],a.reverse(),!0),pivotTableName:c}),n=!0}finally{t.q5(i,!0)}}return n},qt=nn,P.Commands[$]={canUndo:!0,execute:function(t,i,n){return r(t,qt,i,n)}},P.Commands[J]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,c,u,l,i,o,i,f,i,h,e=i.cmdOption,t=P.Commands.Tp(t,i);if((0,_.ht)(e)){if(i=i.commandOptions,l=t.pivotTables&&t.pivotTables.get(i.pivotTableName),o=i.pivotTableCellInfo,u=i.isTop10,0===(r=l.dh).nw(3).length)return t.jT(10,L().EmptyValueFieldError),!1;o=M(o),a=l.name(),s=L().getValueFilterItemText(),u||(c=(f=(i=l.valueFilter(o))&&i.conditionInfo&&i.conditionInfo.LVt)||0)}else{if(o=e.fieldName,a=e.pivotName,s=e.content,c=e.command,0===(r=(l=t.pivotTables.get(a)).dh).nw(3).length)return t.jT(10,L().EmptyValueFieldError),!1;"Top10"===c&&(u=!0)}i=r.nw(3),h=[],i.forEach(function(t){h.push(t.Zc)}),new w.ValueFilter(document.body,s,h,r,o,a,+c,u)}},P.Commands[nt]={canUndo:!1,execute:function(t,i){var n,t,e,r,o,i,a,i,s,n=i.cmdOption,t=P.Commands.Tp(t,i),i=((0,_.ht)(n)?(r=M(s=(i=i.commandOptions).pivotTableCellInfo,e=(a=t.pivotTables.get(i.pivotTableName))&&a.dh),o=i.pivotTableName):(o=n.pivotName,e=(a=t.pivotTables.get(o)).dh,r=n.fieldName),a.lZt);return new E.PivotValuesFieldSettingDialog(e,r,o,i).$c(),!0}},P.Commands[at]={canUndo:!1,execute:function(t,i){var t,n,e,r,o,r,o,r,a,e,s,c,u,l,u,c,r,i,f,t=P.Commands.Tp(t,i),n=i.commandOptions,e=t.pivotTables.get(n.pivotTableName);if(e)if(o=(r=n.pivotTableCellInfo).activeRowFieldInfo,r=r.activeColFieldInfo,o=o&&o.name||r&&r.name,r=e.getGroupInfo(o),a=e.getField(o),e=e.dh,c=1===(s=n.selections||t.getSelections()).length&&1===s[0].rowCount&&1===s[0].colCount,a.dataType===_.PivotDataType.number&&c){if(u=Si(a,r),!(0,_.ht)(u))return(l=new R.PivotNumberGroupDialog(document.body,n.pivotTableName,o,e,a.start,u.start,a.end,u.end,u.by)).$c(),!0}else if(a.dataType===_.PivotDataType.date&&c){if(u=xi(a,r),!(0,_.ht)(u))return c=i.activeRow||t.getActiveRowIndex(),r=i.activeCol||t.getActiveColumnIndex(),i=t.getActualStyle(c,r)&&t.getActualStyle(c,r).formatter,(f=new G.PivotDateGroupDialog(document.body,n.pivotTableName,o,e,a.start,u.start,a.end,u.end,u.by,s,i)).$c(),!0}else t.Qy().execute({cmd:"pivotTableGroup",sheetName:t.name(),commandOptions:n,selections:s})}},P.Commands[st]={canUndo:!1,execute:function(t,i){var t,i,t,n,t,e,r,i,t=P.Commands.Tp(t,i),i=i.commandOptions,t=t.pivotTables.get(i.pivotTableName),n=i.pivotTableCellInfo,t=t&&t.dh,e=M(n,t),r=i.pivotTableName,i=i.showValueAsType;return new B.PivotShowValueAsDialog(document.body,t,e,r,n,i),!0}},P.Commands[y]={canUndo:!1,execute:function(t,i){var n,e,t,n=i.cmdOption,e,t=P.Commands.Tp(t,i).parent;try{t.kx(n.pivotCacheName,n.pivotCache,n._ptName)}catch(t){(0,b.throwError)(L().NoHaveSpread)}}},P.Commands[lt]={canUndo:!1,execute:function(t,i){var t,i,t,t=P.Commands.Tp(t,i),i=i.commandOptions,t=t.pivotTables.get(i.pivotTableName);(0,_.ht)(t)||t.updateSource()}},P.Commands[ot]={canUndo:!1,execute:function(t,i){var i,n,e,i,r,i=i.cmdOption,n=i.position,e=i.views,i=i.width,r;new v.PivotViewListDialog(document.body,e,i).init(n)}},P.Commands[ut]={canUndo:!1,execute:function(t,i){var i,n,i,i=i.cmdOption,n=i.name,i=i.views;return!i.save(n)&&(en(n,i),!0)}},P.Commands[Ct]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,c,u,c,l,e=rn(t,i),t=e.getSelections();if(1===t.length&&!e.isEditing())for(r=t[0],o=e.pivotTables.all(),a=0;a<o.length;a++)if(u=(c=(s=o[a]).getRange()).page,c=c.content,l=u?u.union(c):c,u&&u.containsRange(r)||c&&c.containsRange(r)){e.setSelection(l.row,l.col,l.rowCount,l.colCount);break}}},P.Commands.fZt=function(t){var i=P.mt.Qf(),n=!i,i=i;t.register(e,P.Commands[e]),t.register(o,P.Commands[o]),t.register(a,P.Commands[a]),t.register(c,P.Commands[c]),t.register(s,P.Commands[s]),t.register(u,P.Commands[u]),t.register(ct,P.Commands[ct]),t.register(ut,P.Commands[ut]),t.register(ot,P.Commands[ot]),t.register(l,P.Commands[l]),t.register(h,P.Commands[h]),t.register(m,P.Commands[m]),t.register(K,P.Commands[K]),t.register(X,P.Commands[X]),t.register($,P.Commands[$]),t.register(g,P.Commands[g]),t.register(C,P.Commands[C]),t.register(Z,P.Commands[Z]),t.register(H,P.Commands[H]),t.register(J,P.Commands[J]),t.register(q,P.Commands[q]),t.register(tt,P.Commands[tt]),t.register(it,P.Commands[it]),t.register(yt,P.Commands[yt]),t.register(Y,P.Commands[Y]),t.register(at,P.Commands[at]),t.register(nt,P.Commands[nt]),t.register(rt,P.Commands[rt]),t.register(et,P.Commands[et]),t.register(f,P.Commands[f]),t.register(lt,P.Commands[lt]),t.register(y,P.Commands[y]),t.register(wt,P.Commands[wt]),t.register(gt,P.Commands[gt]),t.register(ft,P.Commands[ft]),t.register(ht,P.Commands[ht]),t.register(dt,P.Commands[dt]),t.register(pt,P.Commands[pt]),t.register(mt,P.Commands[mt]),t.register(bt,P.Commands[bt]),t.register(vt,P.Commands[vt]),t.register(st,P.Commands[st]),t.register(Ct,P.Commands[Ct],65,n,!1,!1,i)}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(t,M,i){"use strict";var F,_,j,r,n,e,O,o,P,L,C,a,i,E,s,c,u,S,l,f;function x(){return o.Functions.CALC_PRECISION||14}function B(t,i,n,e){return!0!==t&&i!==a&&2<=n&&0===e?1:0}function h(){}Object.defineProperty(M,"__esModule",{value:!0}),M.PivotTableLayoutBase=M.getValuesRowOffset=M.hZt=void 0,F=i("Pivot"),_=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=i("Core"),r=i("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),n=i("Common"),e=i("./dist/plugins/pivot/pivot.ns.js"),O=i("./dist/plugins/pivot/pivot-util.js"),o=i("@grapecity/js-calc"),P=n.Common.lt.ht,L=null,C=Math.max,a=void 0,i=new n.Common.ResourceManager(e.SR,"PivotTables"),E=i.getResource.bind(i),s=j.GC$,c="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",u="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",S=n.Common.st.E8,M.hZt=l=function(t,i,n,e,r,o,a){var s;return r&&(s=r[a]),t.vZt(i,n,e,s,o,a)},M.getValuesRowOffset=B,h.dZt=function(t,i){var i,n,t,e,r,o,i,a,s,c,u,i,l,f,h,v,d,r,p,m,m,b,g,w,y,C,N,I,A,T,N,M,S,x,D,k,j,O,P,e=!0,o=t.pivotTables.get(i);if(o){for(t=o.pZt(),i=o.rZt,n=o.Get(),a=(i=i.HWt)[0],s=i[1],c=i[2],u=i[3],i=i[4],f=(l=o.mZt()).length,h=o.bZt(),v=o.dh.nrt,d=h.length,r=l.length,m=(m=(p=o.options).subTotalsPosition)===_.SubtotalsPosition.top||m===_.SubtotalsPosition.bottom,b=o.gZt(),g=o.dh.getSigmaValuePosition(),w=(N=o.wZt()).Nkt,y=N.yZt,C=N,I=[],A={},(0,F.o)(t,function(t){var i,i,i,i=o.dh.bl(t.a),i=i&&i.D5?F.SubtotalType.sum:t.Ar,i={name:t.Zc,subtotalText:F.SubtotalType[i],subtotalType:i,cacheName:t.a,hasShowDataAs:!(!C.CZt[t.Zc]||C.CZt[t.Zc].showDataAs===F.PivotShowDataAs.normal)};I.push(i),A[t.Zc]=i}),T=0,M=N=-1,1<I.length&&(g.positionType===F.DataPosition.col?N=g.positionIndex:M=g.positionIndex),S=[],l.forEach(function(t){S.push(t.Zc)}),0<=N&&S.splice(N,L,E().Values),k=B(x=o.options.hideValuesRow,D=o.cCi,t.length,l.length),j={},O=0;O<S.length;O++)j[S[O]]=O+k;return P={},[].concat(b,l,h).forEach(function(t){var i=o.dh.bl(t.a);(0,F.isEmptyObject)(i.P)&&(0,F.isEmptyObject)(i.AQt)||(P[t.Zc]=i.getFieldsItemList()||[])}),o.IZt=P,o.AZt=d+(-1<M?1:0),o.NZt=r+(-1<N?1:0)+k,o.options.showHeaders?e=!1:1===t.length?0===h.length&&0!==l.length||(e=!1):1<t.length&&0===l.length&&-1<N&&(e=!1),c.isHideFirstRow=e,r=o.options.showHeaders,{sharedMap:P,repeatValueFiledChildLength:0,rowDeep:d,rowFields:h,colFields:l,hasColumnSubTotal:m,fieldMap:n,pageModel:a,cornerModel:s,columnModel:c,rowModel:u,contentModel:i,options:p,pageFields:b,valuePositionInfo:g,valueFieldsInfo:I,columnValuePosition:N,rowValuePosition:M,columnDeep:f,rootNode:w,headerNode:y,subtotalCollection:C,valueFieldsMap:A,pt:o,sortInfo:v,columnFieldsIndexes:S,colFieldsMap:j,isHideFirstRow:e,showHeaders:r,hideValuesRow:x,dataCaption:D}}},h.render=function(t){var i=this.dZt(t.Ti,t.Zc);i&&(this.TZt(i),this.MZt(i),this.xZt(i),this.DZt(t,i.rowModel),this.SZt(i),this.kZt(i),t.Uct(),this.jZt(i))},h.jZt=function(t){delete t.rootNode,delete t.headerNode,t.subtotalCollection.L0(),delete t.subtotalCollection},h.OZt=function(t,i,n){P(n.rowHeaderLevel)?n.YAt=n.grandTotalLevel:n.YAt=n.rowHeaderLevel,t.zWt[i]=n},h.recalcFormula=function(t){var t=t.Ti;t&&(t.suspendPaint(),t.getCalcService().recalculateAll(!1,!1),t.resumePaint())},h.PZt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,i=t.sharedMap,n=t.rowFieldsIndexes,e=t.rowModel,r=e.zWt,o=r.length,a=t.rowValuePosition,s=t.rowFieldsIndexes.length;for(e.YWt={},c=0;c<o;c++)if((u=r[c])&&(l=u.path,!P(l))&&""!==l&&!u.isBlankRow&&!u.isSubtotal)for(f=l.split(F.Separator),t.valuePositionInfo.display&&t.valuePositionInfo.positionType===F.DataPosition.row&&!P(u.valueFieldName)&&f.splice(a,null,u.valueFieldName),h=0,v=f.length;h<v;h++)d=n[h],p=f[h],e.tZt(c,d,d!==E().Values?(0,O.FZt)(i,d,p):p,s-h)},h._Zt=function(t,i,n,e){t.push({path:i,isBlankRow:!0}),n.push([]),e.push([])},h.DZt=function(t,i){var e,r,o,a,n,s,c,u,l,f,h,v,d,p;if(t.options.mergeItem&&t.layoutType()===_.PivotTableLayoutType.tabular)for(s in e=t.EZt.LZt,r=i.Tx,o=i.dataTable,a=i.zWt,n=i.YWt,(0,F.o)(o,function(t,i){var n,n,n=a[i];(n.isBlankRow||n.isSubtotal||n.isGrandTotal)&&(n=n.isBlankRow?o[i-1].length-1:t.length-1,e.push({row:i,col:n,rowCount:1,colCount:r-n}))}),n)if(n.hasOwnProperty(s))for(u in c=n[s])if(c.hasOwnProperty(u)&&(f=(l=c[u]).ranges,1<(h=l.level))&&-1<r-h&&1<f.length){for(d=v=f[0],p=1;p<f.length;p++)f[p]-f[p-1]==1?d+=1:(0<d-v&&e.push({row:v,col:r-h,rowCount:d-v+1,colCount:1}),d=v=f[p]);0<d-v&&e.push({row:v,col:r-h,rowCount:d-v+1,colCount:1})}},h.SZt=function(t){var i,n,t,e,r,o,i,a,s,c,u,l,f,h,v,d,p,m,b,i=t.pt,n=t.columnModel,t=t.isHideFirstRow;if(i.options.mergeItem)for(u in e=i.EZt.BZt,r=n.Sx-1,o=t?1+r:r,i=this.twoDimensionalArraySpin(n.dataTable),a=n.WWt,s=n.YWt,c=t?0:1,(0,F.o)(i,function(t,i){var n,n,n=a[i];P(n)||n.isBlankColumn||(n.isSubtotal||n.isGrandTotal)&&(n=t.length-1,e.push({row:n,col:i,rowCount:r-n+1,colCount:1}))}),s)if(s.hasOwnProperty(u))for(f in l=s[u])if(l.hasOwnProperty(f)&&(v=(h=l[f]).ranges,1<(d=h.level))&&-1<o-d&&1<v.length){for(m=p=v[0],b=1;b<v.length;b++)v[b]-v[b-1]==1?m+=1:(0<m-p&&e.push({row:o-d+c,col:p,rowCount:1,colCount:m-p+1}),m=p=v[b]);0<m-p&&e.push({row:o-d+c,col:p,rowCount:1,colCount:m-p+1})}},h.twoDimensionalArraySpin=function(t){var i,n,e,r,o;if(t&&0!==t.length){for(n=t.length,e=i=0;e<t.length;e++)t[e]&&i<t[e].length&&(i=t[e].length);if(0!==i){for(r=new Array(i),e=0;e<i;e++)r[e]=[];for(e=0;e<i;e++)for(o=0;o<n;o++)t[o]&&t[o][e]&&(r[e][o]=t[o][e]);return r}}},h.TZt=function(o){var a,t,s,i,c,u,l,f,i,h,v,a=this,t=o.pageFields,s=o.pageModel,i=o.pt,c=0,u=0,l=0,f=i.dh,i=o.options,h=i.displayFieldsInPageFilterArea,v=i.reportFilterFieldsPerColumn;h===_.DisplayFields.overThenDown?0===v?s.setRowCount(1):s.setRowCount(Math.ceil(t.length/v)):0===v?s.setRowCount(t.length):s.setRowCount(t.length>=v?v:t.length),(0,F.o)(t,function(t,i){var n,t,e,r,i,t,n=t.Zc,t=t.a,e=f.isFilter(t);h===_.DisplayFields.overThenDown?c=0===v?(u=0,3*i):(u=Math.floor(i/v),3*(r=i%v)):0===v?(u=i,c=0):(c=3*Math.floor(i/v),u=i%v),s.Kbt(u,c,n),e?(t=(i=f.getFilterInfo(t))&&i.getSlicerItemInfo(),s.Kbt(u,c+1,t.hasMoreThanOneSelect?E().MultipleItems:t.text)):s.Kbt(u,c+1,E().All),s.qWt(u,c+1,a.RZt(e,L,8,o.options.showFilter)),s.KWt(u,c+1,n),l=l<c+1?c+1:l}),s.setColCount(l+1)},h.GZt=function(t,r,o,a,e,i,s,c){var u,n,l,f,h,v,d,p,t,m,u=this,n=t.columnModel,l=t.contentModel,f=t.columnValuePosition,h=t.rowValuePosition,v=t.valueFieldsMap,d=t.subtotalCollection,p=t.rowModel,t=t.rowDeep,m;-1!==f?(0,F.o)(n.WWt,function(t,i){var n,e;t&&(n=t.rowPathMap,e=v[t.valueFieldName],n)&&n.indexList&&n.indexList[a]&&e&&(u.VZt(d,d.CZt[t.valueFieldName],r,t.valueFieldName,n,t)?l.Kbt(o,i,O.GC_EMPTY_VALUE):l.Kbt(o,i,S((0,M.hZt)(d,n.indexList[a],e.cacheName,e.subtotalText,r.UZt,r.YAt,t.valueFieldName),x())))}):(p.tZt(o,E().Values,c,t+1-h),(0,F.o)(n.WWt,function(t,i){var n=t&&t.rowPathMap;n&&n.indexList&&n.indexList[a]&&(u.VZt(d,d.CZt[c],r,c,n,t)?l.Kbt(o,i,O.GC_EMPTY_VALUE):l.Kbt(o,i,S((0,M.hZt)(d,n.indexList[a],e,s,r.UZt,r.YAt,c),x())))}))},h.VZt=function(t,i,n,e,r,o){var a,a,e,s,a=n.UZt;if(a&&a[e]){if(a=a[e],P(a.minorPath)||(a.minorPath=o.path),P(a.colTotalIndex)||(a.colTotalIndex=r.indexList[""]),8===i.showDataAs||9===i.showDataAs){if(-1<i.baseRootLevel&&0<(i.showDataAsIndex&n.QZt))return!0;if(-1<i.baseHeaderLevel&&0<(i.showDataAsIndex&o.showDataAsIndex))return!0}if(i.isDifferenceOrPercent)if(i.isHeaderOfPercentOrDiff){if(r.level<i.baseHeaderLevel+1)return!0;a.indexInfo.baseMinorPath=o.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(i.baseRootLevel+1>n.YAt||n.nodeName===i.baseFieldItemShared&&i.baseRootLevel+1===n.YAt)return!0;a.indexInfo.baseMinorPath=o.path}if(i.needBuildRunningTotalOrRankPath){if(n.zEt&&-1<i.baseRootLevel)return!0;if(-1<i.baseHeaderLevel&&r.level<i.baseHeaderLevel+1)return!0;a.indexInfo.minorPath=o.path,a.indexInfo.baseMinorPath=o.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(i.showDataAs===F.PivotShowDataAs.percentOfRow&&(a.indexInfo.baseIndex=t.WZt("").indexList[n.zZt]),i.showDataAs===F.PivotShowDataAs.percentOfCol&&(a.indexInfo.baseIndex=r.indexList[""]),i.showDataAs===F.PivotShowDataAs.percentOfParent){if(-1<i.baseRootLevel&&n.YAt<i.baseRootLevel+1)return!0;if(-1<i.baseHeaderLevel){if(i.baseHeaderLevel+1>r.level)return!0;r.level===i.baseHeaderLevel+1&&(a.indexInfo.baseIndex=r.indexList[n.zZt]),r.level>i.baseHeaderLevel+1&&(e=o.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,P(e)||(a.indexInfo.baseIndex=t.WZt(e).indexList[n.zZt]))}}if(i.showDataAs===F.PivotShowDataAs.index&&(a.indexInfo.rowTotalIndex=t.WZt("").indexList[n.zZt],a.indexInfo.colTotalIndex=r.indexList[""]),i.showDataAs===F.PivotShowDataAs.percentOfParentRow&&(a.indexInfo.minorPath=o.path),i.showDataAs===F.PivotShowDataAs.percentOfParentCol&&(a.indexInfo.baseIndex=t.WZt(o.rowPathMap.parentPath).indexList[n.zZt]),s=""===o.path&&i.needBuildPercentOfPath&&-1===i.baseRootLevel)return!0}},h.ZZt=function(t,i,n,e,r){var o,a,s,c,u,c,s,l,f,h,v,d,p,m,b,g,w,v,y,C,N,I,A,T,c,s,e;if(void 0===r&&(r=""),o=t.colMap,a=t.contentModel,s=t.columnValuePosition,c=t.rowValuePosition,u=t.rowDeep,c=-1!==c,s=-1!==s,!(n.zEt&&0<u&&t.options.grandTotalPosition!==_.GrandTotalPosition.both&&t.options.grandTotalPosition!==_.GrandTotalPosition.row||""===r&&n.YAt<u)){if(l=r,s)for(""!==r&&(r+=F.Separator),f=0,h=e;f<h.length;f++)d=(v=h[f]).name,p=v.cacheName,m=v.subtotalText,b=v.hasShowDataAs,w=o[g=r+d],v=!1,(v=b?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[d],r,n,d,l,u):v)?a.Kbt(i,w,O.GC_EMPTY_VALUE):a.Kbt(i,w,S((0,M.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,d),x()));if(c&&(w=o[r],!P(w)))for(y=i,C=0,N=e;C<N.length;C++)A=(I=N[C]).name,p=I.cacheName,m=I.subtotalText,T=!1,(T=(b=I.hasShowDataAs)?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[A],r,n,A,l,u):T)?a.Kbt(y,w,O.GC_EMPTY_VALUE):a.Kbt(y,w,S((0,M.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,A),x())),y++;c||s||1!==e.length||(s=(c=e[0]).name,p=c.cacheName,m=c.subtotalText,b=c.hasShowDataAs,""!==r&&(r+=F.Separator),w=o[r+s],P(w))||(e=!1,(e=b?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[s],r,n,s,l,u):e)?a.Kbt(i,w,O.GC_EMPTY_VALUE):a.Kbt(i,w,S((0,M.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,s),x())))}},h.YZt=function(t,i,n,e,r,o,a){return i.needBuildRunningTotalOrRankPath&&-1<i.baseHeaderLevel&&(e.UZt[r].indexInfo.minorPath=o),(8===i.showDataAs||9===i.showDataAs)&&0<(i.showDataAsIndex&e.QZt)||(i.showDataAs===F.PivotShowDataAs.percentOfRow&&e.YAt<=a&&(e.UZt[r].indexInfo.baseIndex=t.JZt(e.zZt,!1)),i.showDataAs===F.PivotShowDataAs.index&&e.YAt<=a&&(e.UZt[r].indexInfo.rowTotalIndex=t.JZt(e.zZt,!1)),!!(i.isDifferenceOrPercent&&-1<i.baseHeaderLevel&&e.YAt<i.actualBaseLevel))||""===n&&i.showDataAs===F.PivotShowDataAs.percentOfParent&&-1===i.baseRootLevel||-1<i.baseHeaderLevel&&e.YAt<i.actualBaseLevel||!!(e.zEt&&i.needBuildRunningTotalOrRankPath&&-1<i.baseRootLevel)||!!(""===n&&i.needBuildRunningTotalOrRankPath&&-1<i.baseHeaderLevel&&i.actualBaseLevel===e.YAt)},h.MZt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,p,m,b,g,w,y,r,i=t.columnModel,n=t.valueFieldsInfo,e=t.headerNode,r=t.hasColumnSubTotal,o=t.colFields,a=t.columnValuePosition,s=t.columnDeep,c=t.isHideFirstRow,u=t.showHeaders,l=t.pt,f=t.hideValuesRow,h=t.dataCaption,v=e.qZt+(c?0:1)+B(f,h,n.length,o.length),d=r?e.KZt+e.XZt+e.$Zt:e.KZt+e.$Zt,p=t.options.grandTotalPosition;if(p!==_.GrandTotalPosition.both&&p!==_.GrandTotalPosition.row?r&&(d-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length,d=C(d,0)):r||(d+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length),0===o.length&&(d=e.KZt+e.$Zt),p=n.length,(d=0===s&&0===p?0:d)<(m=t.columnFieldsIndexes.length)){for(b=d;b<m;b++)i.WWt[b]={path:"",isBlankColumn:!0};d=m}-1!==a&&0<s&&(v+=1),i.setColCount(d),t.contentModel.setColCount(d),i.setRowCount(v),g={},w=[],y=s?1:0,y+=B(f,h,p,o.length),0<s&&(u&&this.tYt(i,o,a,t),(0,F.o)(o,function(t){w.push({name:t.Zc,isFilter:l.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})})),-1!==a&&w.splice(a,0,{name:E().Values,isFilter:!1,isDim:!1}),(0,F.o)(w,function(t,i){var t=t.name;g[t]=i+y}),t.columnHeaderRowMap=g,r=0,1===B(f,h,n.length,o.length)&&(i.Kbt(r,0,h),r++),this.iYt(t,e,r<s?r+1:r,0,n),c&&i.dataTable.splice(r,1),t.colMap=i.getColInfoMap()},h.nYt=function(t,i){var n,e,n,r,i,e,n=t.options,e=n.subTotalsPosition,n=n.grandTotalPosition,r=e!==_.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt;return i.zEt&&(0===t.colFields.length&&(r=i.KZt+i.$Zt),i=e!==_.SubtotalsPosition.none,e=n!==_.GrandTotalPosition.none&&n!==_.GrandTotalPosition.col,0<t.columnDeep)&&(i&&!e?r-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length:e&&!i&&(r+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length)),r},h.iYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,h,C,N,I,n,A,T,M,S,x,D,k,n,p,h,o=t.columnModel,a=t.columnDeep,s=t.columnValuePosition,c=t.sharedMap,u=t.columnHeaderRowMap,l=t.colFields,f=t.columnFieldsIndexes,h=i.nodeName,v=i.YAt,d=i.zEt,p=i.eYt,m=i.rYt,b=i.oYt,g=1,w=t.options.subTotalsPosition!==_.SubtotalsPosition.none,y=t.options.grandTotalPosition!==_.GrandTotalPosition.none&&t.options.grandTotalPosition!==_.GrandTotalPosition.col;if(-1!==s&&v<=s&&(g=r.length),h=(0,O.FZt)(c,m,h),C=t.pt.collapse(m,h)&&v!==a,o.Kbt(n,e,h),C)for(I=(N=i.lYt).split(F.Separator),0<=s&&s<=v&&(n=u[E().Values]-1,I.splice(n,L,r[0].name)),A=0,T=I.length;A<T;A++)o.tZt(e,f[A],f[A]!==E().Values?(0,O.FZt)(c,f[A],I[A]):I[A],f.length-A);if(M=e,p){for(S=u[E().Values],d||0===s||(o.Kbt(S-1,e,h),b&&0<b.length&&v<a&&t.options.showDrill&&o.qWt(S-1,e,this.aYt(C,j.ButtonPosition.leftOfText))),x=0,D=r;x<D.length;x++)k=D[x],o.Kbt(S,M,k.name),d&&0===a&&o.tZt(M,E().Values,k.name,l.length-s+1),M+=C?1:this.sYt(t,i,S+1,M,[k]);if(C)return this.uYt(t,i,S,M-g,r,S),v===a&&0!==a&&this.cYt(t,o,M,i,s,a,r),g}else{if(n=u[m],P(n))n=0;else if(o.Kbt(n,M,h),b&&0<b.length&&v<a&&t.options.showDrill&&o.qWt(n,M,this.aYt(C,j.ButtonPosition.leftOfText)),C)return this.uYt(t,i,n,M,r,n),v===a&&0!==a&&this.cYt(t,o,M,i,s,a,r),g;this.sYt(t,i,n+1,M,r)}return h=e+(p=this.nYt(t,i)||g)-g,v===a&&0!==a&&this.cYt(t,o,h,i,s,a,r),(w||d&&y||!a&&r.length)&&this.uYt(t,i,u[m]||1,h,r),p},h.cYt=function(t,i,n,e,r,o,a){var s,c,u,l,f,h,s=t.columnFieldsIndexes,c=t.colFieldsMap,u;if(-1!==r)for(l=0,f=a.length;l<f;l++)h=a[l],i.WWt[n+l]={path:e.lYt,valueFieldName:h.name,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n+l,t.sharedMap,e.lYt,e.YAt,r,s,c,h.name,!1);else i.WWt[n]={path:e.lYt,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n,t.sharedMap,e.lYt,e.YAt,r,s,c,a&&a[0]&&a[0].name,!1)},h.tZt=function(t,i,n,e,r,o,a,s,c,u){var l,e,f,h,v,l=e.split(F.Separator);for(0<=o&&o<=r&&(e=s[E().Values],l.splice(e,L,c)),f=a.length,h=0,v=u?l.length-1:l.length;h<v;h++)t.tZt(i,a[h],(0,O.FZt)(n,a[h],l[h]),f-h)},h.uYt=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,N,S,x,D,k,u,w,a=t.columnModel,s=t.columnDeep,c=t.columnValuePosition,u=t.sharedMap,l=t.columnHeaderRowMap,f=t.columnFieldsIndexes,h=t.colFieldsMap,v=t.hideValuesRow,d=t.dataCaption,p=t.colFields,m=r.length,b=i.zEt,g=i.YAt,w=i.nodeName,y=i.lYt,C=i.rYt,N=t.options.grandTotalPosition;if(!(b&&0<s&&N!==_.GrandTotalPosition.both&&N!==_.GrandTotalPosition.row||s-1<g&&0!==s))if(A=(0,O.FZt)(u,C,w),T=t.pt.collapse(C,A),M=l[E().Values],N=B(v,d,r.length,p.length),g<=c)for(n=b?0===s?0+N:1+N:l[C]+N,S=e,x=0;x<m;x++)D=r[x].name,I=0===s?T?A:b?D:A+" "+D:T?A:b?E().Total+" "+D:A+" "+D,(T&&0===x||!T)&&a.Kbt(n,S+x,I),T&&a.Kbt(M,S+x,D),k={path:y,valueFieldName:D,grandTotalLevel:g,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},y&&g<s&&a.tZt(S+x,E().Values,D,s+1-g),P(o)||(k.collapseIndex=o-1),b?0===c&&0===s||(k.isGrandTotal=!0):k.isSubtotal=!0,a.WWt[S+x]=k;else u=e,0===s&&-1===c?(I=r[0]&&r[0].name||"",n=0):I=T?A:b?E().GrandTotal:A+E().Total,t.valuePositionInfo.display&&t.valuePositionInfo.positionType===F.DataPosition.row&&0===s&&(I=""),a.Kbt(n,u,I),w=void 0,k={path:y,valueFieldName:w=1===r.length?r[0].name:w,grandTotalLevel:g,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},y&&this.tZt(a,u,t.sharedMap,i.lYt,i.YAt,c,f,h,r&&r[0]&&r[0].name,!0),P(o)||(k.collapseIndex=o-1),b?k.isGrandTotal=!0:k.isSubtotal=!0,a.WWt[u]=k},h.fYt=function(t,i,n){if(!(t<i&&n<=1||t+1<i&&1<n))return i},h.tYt=function(o,t,i,a){var s,n,e,s=this,n=[],e=a.pt.dh;(0,F.o)(t,function(t){n.push({name:t.Zc,isFilter:e.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:E().Values,isFilter:!1,isDim:!1}),(0,F.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),e&&o.qWt(0,i,s.RZt(r,t,24,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},h.sYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,o=t.columnDeep,a=t.options,s=t.columnModel,c=e,u=i.oYt,l=0;if(0<u.length&&i.YAt<o)for(f=a.fillDownLabels,v=a.subTotalsPosition===_.SubtotalsPosition.none?0:1,b=m=p=d=h=void 0,b=0;b<u.length;b++){if(h=1,d=u[b],m=(p=this.iYt(t,d,n,c,r))-v,f)for(g=s.Sl(n,c);h<m;h++)s.Kbt(n,h+c,g);c+=p,l+=p}return l=i.YAt>=o?1:l},h.hYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,u,v,o=t.valueFieldsInfo,a=t.columnModel,s=t.columnDeep,c=t.columnValuePosition,u=t.sharedMap,l=o.length,f=e.zEt,h=e.YAt,v=e.nodeName,d=e.lYt,p=e.rYt;if(!(s-1<h&&0!==s))if(b=(0,O.FZt)(u,p,v),g=t.pt.collapse(p,b),r&&h<=c)for(w=g?n:n+(e.KZt+e.vYt-1)*l,y=0;y<l;y++)C=o[y].name,m=0===s?g?b:f?C:b+" "+C:g?b:f?E().Total+" "+C:b+" "+C,a.Kbt(i,w+y,m),N={path:d,valueFieldName:C,grandTotalLevel:h,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},f?N.isGrandTotal=!0:N.isSubtotal=!0,a.WWt[w+y]=N;else u=g?n:n+e.KZt+e.XZt-1,m=0===s?o[0]&&o[0].name||"":g?b:f?E().GrandTotal:b+E().Total,a.Kbt(i,u,m),v=void 0,N={path:d,valueFieldName:v=1===o.length?o[0].name:v,grandTotalLevel:h,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},f?N.isGrandTotal=!0:N.isSubtotal=!0,a.WWt[u]=N},h.dYt=function(t,i,n,e){var r=new j.Style;return r.textIndent=i,r.hAlign=0,r.cellButtons=[{position:void 0===n?j.ButtonPosition.left:n,imageType:j.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:j.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?u:c,imageSize:{width:18,height:18}}],r},h.pYt=function(t){var i=new j.Style;return i.textIndent=t,i},h.Gn=function(t,i,n){var e,r,t,o,t,o,e=t.rowDeep,r=t.rowValuePosition,t=t.options,o=t.rowLabelIndent,t=t.showDrill,o=o*i*2;return n&&t&&(1<e||1===e&&-1!==r)&&(o+=3),o},h.aYt=function(t,i){var n=new j.Style;return n.cellButtons=[{position:void 0===i?j.ButtonPosition.left:i,command:"PivotOutlineButtonToggle",imageType:j.ButtonImageType.custom,visibility:j.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?u:c,imageSize:{width:18,height:18}}],n},h.RZt=function(t,i,n,e){var e,i,t;return e?(e=0,i&&(i.sortType===F.SortType.asc&&(e=1),i.sortType===F.SortType.desc)&&(e=2),i=t?[3,4,5][e]:e,(t=new j.Style).cellButtons=[(0,r.getFilterCellButtonInfo)(i,n)],t):{}},h.mYt=function(t){var t,i,t=t?"0px 0px 0px 25px":void 0,i=new j.Style;return i.cellPadding=t,i},M.PivotTableLayoutBase=h},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(t,i,n){"use strict";var e,L,E,I,B,A,r,F,R,T,G,n,V,o,a,U;function s(){return null!==U&&U.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableCompactLayout=void 0,L=n("Pivot"),E=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),I=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),B=n("./dist/plugins/pivot/pivot-util.js"),A=n("Common"),r=n("./dist/plugins/pivot/pivot.ns.js"),F=n("Core"),R=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),T=n("@grapecity/js-calc"),G=A.Common.lt.ht,n=new A.Common.ResourceManager(r.SR,"PivotTables"),V=n.getResource.bind(n),U=I.PivotTableLayoutBase,e(s,U),s.kZt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,n,v,l,d,p,m,i=t.cornerModel,n=t.columnModel,e=t.rowModel,r=t.valueFieldsInfo,o=t.rowFields,a=t.options,s=t.showHeaders,c=t.colFields,u=t.rowValuePosition,l=t.pt,f=t.hideValuesRow,h=t.dataCaption,n=n.Sx,v=l.dh;i.setRowCount(n),i.setColCount(e.Tx),l=(0,I.getValuesRowOffset)(f,h,r.length,c.length),0<o.length?(1!==r.length||c.length<1&&!s||i.Kbt(0+l,0,r[0].name),s&&(G(a.rowHeaderCaption)?i.Kbt(n-1,0,V().RowLabels):i.Kbt(n-1,0,a.rowHeaderCaption),d=!1,m=[],(p=null,L.o)(o,function(t){d=d||v.isFilter(t.a),p=p||t.nrt,m.push(t.Zc)}),i.qWt(n-1,0,this.RZt(d,p,24,t.options.showFilter)),i.JWt(0,{isCompactRoot:!0,fieldName:o[0]&&o[0].Zc||""}),e.JWt(0,{isCompactRoot:!0,compactFieldList:m}),e.WWt)&&o[o.length-1]&&(e.WWt[0]={path:o[o.length-1].Zc})):0<=u&&s&&i.Kbt(i.Sx-1,0,V().Values)},s.tYt=function(r,t,i,o){var a,s,a=this;G(o.options.colHeaderCaption)?r.Kbt(0,0,0<t.length?V().ColumnLabels:V().Values):r.Kbt(0,0,o.options.colHeaderCaption),s=o.pt.dh,r.JWt(0,{isCompactRoot:!0,fieldName:t[0]&&t[0].Zc}),(0,L.o)(t,function(t,i){var n=t.Zc,e=s.isFilter(t.a),t=t.nrt;r.zWt[i+1]={path:n},0===i&&r.qWt(0,i,a.RZt(e,t,30,o.options.showFilter))})},s.xZt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,u,r,i=t.rootNode,n=t.options,e=t.valueFieldsInfo,r=t.rowFields,o=t.colFields,a=t.rowValuePosition,s=t.hideValuesRow,c=t.dataCaption,u=0<r.length?1:0;for(0===u&&1===e.length&&0<o.length&&(u=1),0===r.length&&-1<t.rowValuePosition&&(u+=1),t.rowModel.setColCount(u),l=[],f={},h=[],v=0,d=r;v<d.length;v++)p=d[v],h.push(p.Zc);for(-1!==a&&h.splice(a,0,V().Values),m=(0,I.getValuesRowOffset)(s,c,e.length,o.length),b=0,g=h.length;b<g;b++)f[h[b]]=b+m,l.push(h[b]);t.rowFieldsIndexes=l,t.rowFieldsMap=f,u=n.subTotalsPosition===E.SubtotalsPosition.bottom,r=this.bYt(t,i,u,0,e),t.rowModel.setRowCount(r),t.contentModel.setRowCount(r)},s.gYt=function(t,i){var n,e,r,e,r,e,n=i.KZt+i.wYt,e=t.options,r=e.subTotalsPosition,e=e.grandTotalPosition;return r===E.SubtotalsPosition.top?(n+=i.yYt,0<i.kpi&&(n+=i.kpi)):r===E.SubtotalsPosition.bottom&&(n+=i.vYt),n=i.zEt&&(r=r!==E.SubtotalsPosition.none,e=e!==E.GrandTotalPosition.none&&e!==E.GrandTotalPosition.row,r&&!e?n-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!r&&e||e&&0===i.vYt)&&(n+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length)?i.KZt+i.wYt:n},s.CYt=function(t,i){var t;return 0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition?t.options.subTotalsPosition===E.SubtotalsPosition.none?i.IYt:i.AYt:t.options.subTotalsPosition===E.SubtotalsPosition.bottom?i.AYt:(t=i.IYt,0<i.jpi&&(t+=i.jpi),t)},s.bYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,y,u,C,N,I,v,A,T,M,S,x,D,k,j,O,h,v,w,u,h,b,P,f,v,y,o=t.rowModel,a=t.rowValuePosition,s=t.rowDeep,c=t.options,u=t.sharedMap,l=t.rowFieldsIndexes,f=t.rowFieldsMap,h=i.eYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=i.rYt,g=1,w=0;if(-1!==a&&(d<=a?g=r.length:w=1),y=(y=t.pt.dh.getFieldInfoByName(b))&&y.Spi,u=(0,B.FZt)(u,b,v),C=e,N=t.pt.collapse(i.rYt,u)&&d!==s,v=d<s,h){if(p||t.repeatValueFiledChildLength++,!p&&0!==a){for(I={path:m,isValueFieldDim:!1},t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?I.compactLevel=(0,R.in)(t.rowFields,b,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:r[0].name}):I.compactLevel=i.YAt-1,v&&(I.rowHeaderLevel=this.fYt(s,d+w,g)),this.OZt(o,C,I),T=0,M=(A=i.lYt.split(L.Separator)).length;T<M;T++)o.tZt(C,l[T],(0,B.FZt)(t.sharedMap,l[T],A[T]),l.length-T);o.Kbt(C,0,u),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill?o.qWt(C,0,this.aYt(N,F.ButtonPosition.leftOfText)):o.qWt(C,0,this.pYt(U.Gn.call(this,t,i.YAt-1,!0))),C++}for(S=void 0,D=!1,k=x=0,j=r;k<j.length;k++){if(O=j[k],o.Kbt(C,0,O.name),o.qWt(C,0,this.pYt(U.Gn.call(this,t,a,0!==a))),S={path:m,grandTotalLevel:d,valueFieldName:O.name,isValueFieldDim:!(i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep),rowHeaderLevel:this.fYt(s,d,g),isSigmaValue:!0},t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?S.compactLevel=(0,R.in)(t.rowFields,O.name,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:O.name}):I.compactLevel=i.YAt-1,this.OZt(o,C,S),i.YAt<s)for(A=i.lYt.split(L.Separator),0<=a&&a<=d&&A.splice(a,null,O.name),T=0,M=A.length;T<M;T++)A[T]&&o.tZt(C,l[T],l[T]!==V().Values?(0,B.FZt)(t.sharedMap,l[T],A[T]):A[T],l.length-T);C++,N?i.YAt<=a&&a<s&&!p&&c.insertBlankLineAfterEachItem&&(this.NYt(t,i,o.zWt.length),C++,x++,D=!0):(i.zEt&&0===s&&0===a&&(this.TYt(t,i,C-1,"",r),e=r.length),C+=this.MYt(t,i,n,C,[O]),!i.zEt&&d<s&&c.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,o.zWt.length)))}if(d===s&&c.insertBlankLineAfterEachItem&&(C++,this.NYt(t,i,o.zWt.length)),N)return(g=this.xYt(t,i,C-r.length-x,r,g,void 0,0,!0,D))+1}else{if(!p){if(o.Kbt(C,0,u),I={path:m,grandTotalLevel:d,valueFieldName:r[0]&&r[0].name},v&&(I.rowHeaderLevel=this.fYt(s,d+w,g)),h=-1!==t.rowValuePosition&&i.YAt>t.rowValuePosition?i.YAt:i.YAt-1,i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep?(I.isValueFieldDim=!1,t.options.showDrill?o.qWt(C,0,this.dYt(t.pt.collapse(i.rYt,u),U.Gn.call(this,t,h),F.ButtonPosition.leftOfText)):o.qWt(C,0,this.pYt(U.Gn.call(this,t,h)))):(I.isValueFieldDim=!0,o.qWt(C,0,this.pYt(U.Gn.call(this,t,h,!0)))),t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?I.compactLevel=(0,R.in)(t.rowFields,b,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:r[0].name}):I.compactLevel=i.YAt-1,this.OZt(o,C,I),i.YAt<s)for(A=i.lYt.split(L.Separator),0<=a&&a<d&&(v=f[V().Values],A.splice(v,null,r[0].name)),T=0,M=A.length;T<M;T++)o.tZt(C,l[T],l[T]!==V().Values?(0,B.FZt)(t.sharedMap,l[T],A[T]):A[T],l.length-T);if(N)return 1<r.length&&t.rowValuePosition>d?(g=this.xYt(t,i,++C,r,g,void 0,0,!0))+1:this.xYt(t,i,C,r,g,void 0,0);C++}this.MYt(t,i,n,C,r)}return w=(0,B.getActualSubtotalPosition)(c.subTotalsPosition,y),u=0,h=this.gYt(t,i),c.insertBlankLineAfterEachItem&&(h+=u=this.CYt(t,i)),b=e+h-g,f=!0,(v=s||!r.length?w:E.SubtotalsPosition.bottom)===E.SubtotalsPosition.bottom||v===E.SubtotalsPosition.top&&d<a||c.subTotalsPosition===E.SubtotalsPosition.top&&p?b=e+h-g:v===E.SubtotalsPosition.top&&a<=d?(b=e,P=!0,d===a&&(b=e+h-g,P=!1)):c.subTotalsPosition!==E.SubtotalsPosition.none||!p||c.grandTotalPosition!==E.GrandTotalPosition.both&&c.grandTotalPosition!==E.GrandTotalPosition.col?f=!1:b=e+h-g,f?(!P&&c.insertBlankLineAfterEachItem&&i.AYt&&!p&&b--,0===s&&p?(y=r[0]&&r[0].name||"",o.Kbt(b,0,y),-1===a&&(S={path:m,rowHeaderLevel:this.fYt(s,d,g)},this.OZt(o,b,S)),this.ZZt(t,b,i,r,"")):this.xYt(t,i,b,r,void 0,P)):c.subTotalsPosition===E.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<u&&this.NYt(t,i,b),h},s.xYt=function(t,i,n,e,r,o,a,s,c){var u,l,f,h,v,d,p,m,b,g,w,y,C,C,N,I,n,h,b,A,C,T,M,S,x,D,k,j,O,P,F,j,_,_,u=t.rowDeep,l=t.rowModel,f=t.rowValuePosition,h=t.sharedMap,v=t.options,d=t.rowFieldsMap,p=t.rowFieldsIndexes,m=i.YAt,b=i.nodeName,g=i.zEt,w=i.lYt,y=i.rYt;if(!g||t.options.grandTotalPosition!==E.GrandTotalPosition.none&&t.options.grandTotalPosition!==E.GrandTotalPosition.row){if(C=(C=t.pt.dh.getFieldInfoByName(y))&&C.Spi,m<u||0===u){if(-(N=1)!==f&&m<=f&&(N=e.length),n=I=n,h=(0,B.FZt)(h,y,b),I>=l.Sx)return;if(b=void 0,b=g?1<e.length&&0<=f?V().Total:V().GrandTotal:1<e.length&&0<=f||(0,B.getActualSubtotalPosition)(v.subtotalsPosition,C)!==E.SubtotalsPosition.bottom?h:h+V().Total,0===u&&(b=e[0]&&e[0].name||""),A=t.pt.collapse(i.rYt,h)?f<=0?h:"":b,C=-1!==t.columnValuePosition,T={path:w,rowHeaderLevel:this.fYt(u,m,N),grandTotalLevel:m},(0,L.ht)(a)||(T.collapseIndex=a),g?T.isGrandTotal=!0:T.isSubtotal=!0,t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?T.compactLevel=(0,R.in)(t.rowFields,y,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:e[0].name}):T.compactLevel=i.YAt-1,C){for(l.Kbt(I,0,A),S=0,x=(M=i.lYt.split(L.Separator)).length;S<x-1;S++)l.tZt(I,p[S],p[S]!==V().Values?(0,B.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);this.DYt(l,I,U.Gn.call(this,t,T.rowHeaderLevel-1)),this.OZt(l,I,T),this.GZt(t,i,I,w)}else{if(0===t.valueFieldsInfo.length){if(!o){for(l.Kbt(I,0,A),S=0,x=(M=i.lYt.split(L.Separator)).length;S<x-1;S++)l.tZt(I,p[S],p[S]!==V().Values?(0,B.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);this.DYt(l,I,U.Gn.call(this,t,T.rowHeaderLevel-1))}this.OZt(l,I,T)}for(D=0,k=e;D<k.length;D++){for(O=(j=k[D]).name,P=j.cacheName,F=j.subtotalType,j=j.subtotalText,T={path:w,rowHeaderLevel:this.fYt(u,m,N),grandTotalLevel:m,valueFieldName:O},(0,L.ht)(a)||(T.collapseIndex=a),s&&(T.collapse=!0),c||(1<N?l.Kbt(I,0,A+" "+O):l.Kbt(I,0,A)),M=i.lYt.split(L.Separator),0<=f&&f<m&&(_=d[V().Values],M.splice(_,null,O)),S=0,x=M.length;S<x-1;S++)l.tZt(I,p[S],p[S]!==V().Values?(0,B.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);_=-1!==t.rowValuePosition&&i.YAt>t.rowValuePosition?i.YAt:i.YAt-1,this.DYt(l,I,U.Gn.call(this,t,_)),g?T.isGrandTotal=!0:T.isSubtotal=!0,t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?T.compactLevel=(0,R.in)(t.rowFields,i.eYt?O:y,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:O}):T.compactLevel=i.YAt-1,this.OZt(l,I,T),this.GZt(t,i,I,w,P,F,j,O),I++,c&&(I++,r++)}}this.ZZt(t,n,i,e)}return g||!v.insertBlankLineAfterEachItem||c||(this.NYt(t,i,l.zWt.length),G(r))||r++,r}},s.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},s.DYt=function(t,i,n){var e=t.ML(i,0)||new F.Style;e.h5(this.pYt(n)),t.qWt(i,0,e)},s.MYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,N,o=t.rowDeep,a=t.rowValuePosition,s=t.rowFieldsIndexes,c=t.rowModel,u=i.oYt,l=i.YAt,f=u.length;if(o<=l)for(h=i.lYt.split(L.Separator),0<=a&&!G(r)&&h.splice(a,null,r[0].name),v=0,d=h.length;v<d;v++)h[v]&&c.tZt(e-1,s[v],s[v]!==V().Values?(0,B.FZt)(t.sharedMap,s[v],h[v]):h[v],s.length-v);if((p=0)<f)for(m=e,b=0,g=u;b<g.length;b++)y=0,o<(C=(w=g[b]).YAt)?(N=m-1,i.zEt&&0===o&&0<t.columnDeep&&-1===a&&(N=m),this.TYt(t,w,N,"",r)):(C===o&&(N=w.eYt?m+1:m,this.ZZt(t,N,w,r)),p+=y=this.bYt(t,w,n,m,r),m+=y);return p},s.TYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,d,b,b,g,w,y,C,N,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,c=i.oYt,u=i.nodeName,l=i.HZt;if(""!==e&&(e+=L.Separator),f=-1!==o,0===c.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=u),f&&(""!==b?b+=L.Separator+p:b=p),b=s[b],G(b)||(g=!1,g=!!((w=t.subtotalCollection.CZt[p])&&(w.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===w.showDataAs||9===w.showDataAs)&&0<(w.showDataAsIndex&i.QZt))||g)||a.Kbt(n,b,A.Common.st.E8((0,I.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=c;y<C.length;y++)N=C[y],this.TYt(t,N,n,e+u,r);i.kYt||this.ZZt(t,n,i,r,e+u)},s.uit=E.PivotTableLayoutType.outline,i.PivotTableCompactLayout=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(t,i){"use strict";var m,n,e;function r(t,i,n,e,r,o,a,s){var c,u,l,f,h,v,d,p,m,b,g,a;o<3||r<3||(c=.125,u=.08,l=.75,f=20,h=11,p=o/(v=194),m=r/(d=362),b=r-2,g=0,t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),1<b&&(t.translate(n,e),w(t,o,r),b-=2),0<b&&(t.translate((o-2)*c,.08*(r-2)),y(t,.75*o,20,i),b-=.08*(r-2)+20),0<b&&(t.translate(.75*(o-2)/2,.08*(r-2)),b-=.08*(r-2)+(g=C(t,o,s))),0<b&&(t.translate(0,.9*(a=.7*b)),N(t,o-11*p,a,Math.min(p,m))),t.restore())}function w(t,i,n){t.save(),t.strokeStyle=m.frameColor,t.lineWidth=m.frameLineWidth,t.strokeRect(0,0,i,n),t.fillStyle=m.tableHeadLine,t.fillRect(0,0,i,n),t.restore()}function y(t,i,n,e){var r=.5;t.save(),t.strokeStyle=m.frameColor,t.lineWidth=m.inputLineWidth,t.strokeRect(0,0,i,n),t.rect(1,0,i-2,n),t.clip(),t.translate(.5*i,0),s(t,e),t.restore()}function C(t,i,n){for(var e,r,o,a,e=10,r=20,o=h(n,i-10,m.font),a=0;a<o.length;a++)t.translate(0,20),s(t,o[a]);return 20*o.length}function s(t,i){t.save(),t.textBaseline=m.nameBaseline,t.textAlign=m.textAlign,t.font=m.font,t.fillStyle=m.nameColor,t.fillText(i,0,4),t.restore()}function N(t,i,n,e){a(t,i,n),o(t,e)}function o(t,i){var n=180,e=152,r=63,o=54,a=70,s=152,c=32;t.save(),t.translate(-180*i*.5,-152*i*.5),u(t,63,54,i),t.translate(110*i,0),l(t,70,152,i),t.translate(-2*i,64*i),f(t,32,i),t.restore()}function u(t,i,n,e){var r,o,a,s,c,u,l,f,h,v,d,p,r=8,o=13,a=7,s=2,c=4,u=5,l=49,f=45;for(t.save(),t.scale(e,e),b(t,0,0,13,8,m.tableHeadColor,!0),b(t,3,3,7,2,m.tableHeadLine,!0),b(t,14,0,49,8,m.tableHeadColor,!0),d=v=h=0;d<4;d++)b(t,h=12*d+17,3,7,2,m.tableHeadLine,!0);for(b(t,0,9,13,45,m.tableHeadColor,!0),d=0;d<7;d++)b(t,3,v=6*d+12,7,2,m.tableHeadLine,!0);for(b(t,14,9,49,45,m.tableContentRim,!0),d=0;d<7;d++)for(v=6*d+8+4,p=0;p<4;p++)b(t,h=12*p+17,v,7,2,m.tableContent,!0);t.restore()}function l(t,i,n,e){var r,o,a,s,c,u,l,f,h,r=57,o=55,a=7,s=41,c=3;for(t.save(),t.scale(e,e),b(t,0,0,i,n,m.tableContentRim,!0),b(t,8,8,41,3,m.tableHeadColor,!0),b(t,7,19,57,55,m.recordBookFrameColor,!1),b(t,8,20,55,53,m.tableHeadLine,!0),l=u=0;l<9;l++)b(t,11,u=26+5*l,2,2,m.recordColor,!0),b(t,14,u,42,2,m.recordColor,!0);for(b(t,8,82,41,3,m.tableHeadColor,!0),l=f=0;l<2;l++)for(f=92+30*l,h=0;h<2;h++)b(t,u=7+31*h,f,26,24,m.recordBookFrameColor,!1),b(t,u+1,1+f,24,22,m.tableHeadLine,!0);t.restore()}function f(t,i,n){t.save(),t.scale(n,n),t.beginPath(),t.save(),t.arc(0,0,i,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i,0,2*Math.PI,!0),t.strokeStyle=m.MagnifierFrameColor,t.stroke(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.fillStyle=m.tableHeadLine,t.fill();for(var e=0,r=0;r<3;r++)b(t,-16,-(e=24-18*r),13,13,m.tableContent,!1),b(t,1,4-e,35,5,m.recordColor,!0);c(t,-15,-6,11),t.restore(),t.restore()}function a(t,i,n){t.save(),t.fillStyle=m.tableHeadLine,t.fillRect(.5*-i,.5*-n,i,n),t.restore()}function b(t,i,n,e,r,o,a){t.save(),t.translate(i,n),a?(t.fillStyle=o,t.fillRect(0,0,e,r)):(t.strokeStyle=o,t.strokeRect(0,0,e,r)),t.restore()}function c(t,i,n,e){t.save();var e=e;t.translate(Math.round(i+e/2),Math.round(n+e/2)),t.strokeStyle="red",t.rotate(-.25*Math.PI),t.beginPath(),t.fillStyle=m.tickColor,t.fillRect(.375*-e,.25*-e,.2*e,.5*e),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=m.tickColor,t.fillRect(.375*-e,.05*e,.75*e,.2*e),t.closePath(),t.fill(),t.stroke(),t.restore()}function h(t,i,n){var e,r,o,a,s,c,e=[];if(t&&0<t.length){for(r=t.split(/\r\n|\r|\n/),(o=p()).save(),n&&(o.font=n),a=0,s=r.length;a<s;a++)(c=v(o,r[a],i))&&(0===c.length?e.push(""):c.forEach(function(t){e.push(t)}));o.restore()}return e}function v(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,e=i.split(" "),r=[],o="",a=0,s=t.measureText(" ").width;if(1===i.length)return e;for(c=0,u=e.length;c<u;c++)l=e[c],n<(f=t.measureText(l).width)?(0<o.length&&r.push(o),(h=d(t,e[c],n,f)).forEach(function(t){r.push(t)}),o="",a=0):(v=o+l,o=n<(a+=f+s)?a-s<=n?(r.push(v),a=0,""):(r.push(o),n<(a=f+s)?(r.push(l),a=0,""):l+" "):v+" ");return 0<o.length&&r.push(o),r}function d(t,i,n,e){var r,o,a,s,c,u,l,r=Math.ceil(e/n),o=i.length/r,a=[];for(r=0;0<n&&r<i.length;){for(s=i.substring(r,r+o),u=(c=t.measureText(s).width)<=n?1:-1,l=0;(c<n&&0<u||n<c&&u<0)&&!(r+o+(l+=u)>=i.length||r+o+l===0);)s=i.substring(r,r+o+l),c=t.measureText(s).width;if(!(r<r+o+(l-=u)))break;a.push(i.substring(r,r+o+l)),r=r+o+l}return a}function p(){var t,i,t=e;return t||((i=document.createElement("canvas")).hidden=!0,i.width=1,i.height=1,document.body.appendChild(i),e=t=(n=i).getContext("2d")),t}Object.defineProperty(i,"__esModule",{value:!0}),i.jYt=void 0,m={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2},i.jYt=r},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(t,i,n){"use strict";var e,B,R,I,G,A,r,T,V,n,U,o,a,s;function c(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableOutlineLayout=void 0,B=n("Pivot"),R=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),I=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),G=n("./dist/plugins/pivot/pivot-util.js"),A=n("Common"),r=n("./dist/plugins/pivot/pivot.ns.js"),T=n("@grapecity/js-calc"),V=A.Common.lt.ht,n=new A.Common.ResourceManager(r.SR,"PivotTables"),U=n.getResource.bind(n),s=I.PivotTableLayoutBase,e(c,s),c.kZt=function(o){var a,s,t,c,i,u,l,n,e,r,f,h,v,t,d,h,p,a=this,s=o.cornerModel,t=o.columnModel,c=o.rowModel,i=o.valueFieldsInfo,u=o.rowFieldsMap,l=o.pt,n=o.rowFields,e=o.showHeaders,r=o.colFields,f=o.rowValuePosition,h=o.hideValuesRow,v=o.dataCaption,t=t.Sx,d=l.dh;s.setRowCount(t),s.setColCount(c.Tx),h=(0,I.getValuesRowOffset)(h,v,i.length,r.length),0<n.length?(1!==i.length||r.length<1&&!e||s.Kbt(0+h,0,i[0].name),e&&(p=t-1,(0,B.o)(Object.keys(u),function(t){var i,n,e,r,e,i=u[t];s.Kbt(p,i,t),(n=t!==U().Values)&&(e=l.zRt(t),r=d.isFilter(e.a),e=e.nrt,s.qWt(p,i,a.RZt(r,e,30,o.options.showFilter))),s.JWt(i,{isCompactRoot:!1,fieldName:t,isDim:n}),c.WWt[i]={path:t}}))):0<=f&&e&&s.Kbt(s.Sx-1,0,U().Values)},c.tYt=function(o,t,i,a){var s,n,s=this,n=[];(0,B.o)(t,function(t){n.push({name:t.Zc,isFilter:a.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:U().Values,isFilter:!1,isDim:!1}),(0,B.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),o.zWt[i+1]={path:n},e&&o.qWt(0,i,s.RZt(r,t,30,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},c.CYt=function(t,i){var t;return 0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition?t.options.subTotalsPosition===R.SubtotalsPosition.none?i.IYt:i.AYt:t.options.subTotalsPosition===R.SubtotalsPosition.bottom?i.AYt:(t=i.IYt,0<i.jpi&&(t+=i.jpi),t)},c.gYt=function(t,i){var n,e,r,e,r,e,n=i.KZt+i.wYt,e=t.options,r=e.subTotalsPosition,e=e.grandTotalPosition;return r===R.SubtotalsPosition.top?(n+=i.yYt,0<i.kpi&&(n+=i.kpi)):r===R.SubtotalsPosition.bottom&&(n+=i.vYt),n=i.zEt&&(r=r!==R.SubtotalsPosition.none,e=e!==R.GrandTotalPosition.none&&e!==R.GrandTotalPosition.row,r&&!e?n-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!r&&e||e&&0===i.vYt)&&(n+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length)?i.KZt+i.wYt:n},c.xZt=function(t){var i,n,i;this.OYt(t),i=t.rootNode,n=t.valueFieldsInfo,i=this.bYt(t,i,0,n),t.rowModel.setRowCount(i),t.contentModel.setRowCount(i)},c.bYt=function(t,i,n,e){var r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,w,C,N,I,A,T,M,S,x,D,k,j,O,c,h,v,f,P,w,r,b,r=t.rowFieldsMap,o=t.rowModel,a=t.rowValuePosition,s=t.options,c=t.sharedMap,u=t.rowDeep,l=t.rowFieldsIndexes,f=i.eYt,h=i.rYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=r[h],g=1;if(-1!==a&&d<=a&&(g=e.length),y=(w=t.pt.dh.getFieldInfoByName(h))&&w.Spi,w=(0,G.FZt)(c,h,v),C=n,N=t.pt.collapse(i.rYt,w)&&d!==u,f){if(p||t.repeatValueFiledChildLength++,I=r[U().Values],!p&&0!==a){for(o.Kbt(C,b,w),this.OZt(o,C,{path:m,isValueFieldDim:!1,rowHeaderLevel:this.fYt(u,d,g)}),T=0,M=(A=i.lYt.split(B.Separator)).length;T<M;T++)o.tZt(C,l[T],(0,G.FZt)(t.sharedMap,l[T],A[T]),l.length-T);i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&o.qWt(C,b,this.aYt(N)),C++}for(S=void 0,D=!1,k=x=0,j=e;k<j.length;k++){if(O=j[k],o.Kbt(C,I,O.name),S={path:m,rowHeaderLevel:this.fYt(u,d,g),isValueFieldDim:!(i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep),valueFieldName:O.name},this.OZt(o,C,S),i.YAt<u)for((A=i.lYt.split(B.Separator)).splice(I,null,O.name),T=0,M=A.length;T<M;T++)A[T]&&o.tZt(C,l[T],l[T]!==U().Values?(0,G.FZt)(t.sharedMap,l[T],A[T]):A[T],l.length-T);C++,N?i.YAt<=a&&a<u&&!p&&s.insertBlankLineAfterEachItem&&(this.NYt(t,i,o.zWt.length),C++,x++,D=!0):(i.zEt&&0===u&&0===a&&(this.TYt(t,i,C-1,"",e),n=e.length),C+=this.MYt(t,i,C,[O],y),!i.zEt&&d<u&&s.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,o.zWt.length)))}if(d===u&&s.insertBlankLineAfterEachItem&&(C++,this.NYt(t,i,o.zWt.length)),N)return(g=this.xYt(t,i,C-e.length-x,e,g,void 0,b,!0,D))+1}else{if(!V(b)){if(o.Kbt(C,b,w),S={path:m,rowHeaderLevel:this.fYt(u,d,g),valueFieldName:e[0]&&e[0].name},i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep?(S.isValueFieldDim=!1,t.options.showDrill&&o.qWt(C,b,this.aYt(t.pt.collapse(i.rYt,w)))):S.isValueFieldDim=!0,this.OZt(o,C,S),i.YAt<u)for(A=i.lYt.split(B.Separator),0<=a&&a<d&&(I=r[U().Values],A.splice(I,null,e[0].name)),T=0,M=A.length;T<M;T++)o.tZt(C,l[T],l[T]!==U().Values?(0,G.FZt)(t.sharedMap,l[T],A[T]):A[T],l.length-T);if(N)return d<a?(g=this.xYt(t,i,++C,e,g,!1,b,!0))+1:this.xYt(t,i,C,e,g,void 0,b);C++}this.MYt(t,i,C,e,y)}return c=(0,G.getActualSubtotalPosition)(s.subTotalsPosition,y),h=0,v=this.gYt(t,i),s.insertBlankLineAfterEachItem&&(v+=h=this.CYt(t,i)),f=n+v-g,w=!0,(r=u||!e.length?c:R.SubtotalsPosition.bottom)===R.SubtotalsPosition.bottom||r===R.SubtotalsPosition.top&&d<a||r===R.SubtotalsPosition.top&&p?f=n+v-g:r===R.SubtotalsPosition.top&&a<=d?(f=n,P=!0,d===a&&(f=n+v-g,P=!1)):s.subTotalsPosition!==R.SubtotalsPosition.none||!p||s.grandTotalPosition!==R.GrandTotalPosition.both&&s.grandTotalPosition!==R.GrandTotalPosition.col?w=!1:f=n+v-g,w?(!P&&s.insertBlankLineAfterEachItem&&i.AYt&&!p&&f--,0===u&&p?(b=e[0]&&e[0].name||"",o.Kbt(f,0,b),-1===a&&(S={path:m,rowHeaderLevel:this.fYt(u,d,g)},this.OZt(o,f,S)),this.ZZt(t,f,i,e,"")):this.xYt(t,i,f,e,void 0,P)):s.subTotalsPosition===R.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<h&&this.NYt(t,i,f),v},c.xYt=function(t,i,n,e,r,o,a,s,c){var u,l,f,h,v,d,p,m,L,b,g,w,y,y,C,N,I,n,A,v,w,T,M,S,x,D,k,j,O,P,E,j,F,_,_,u=t.rowDeep,l=t.rowModel,f=t.rowFieldsMap,h=t.rowValuePosition,v=t.sharedMap,d=t.options,p=t.rowFieldsIndexes,m=i.YAt,L=i.nodeName,b=i.zEt,g=i.lYt,w=i.rYt;if(!i.zEt||t.options.grandTotalPosition!==R.GrandTotalPosition.none&&t.options.grandTotalPosition!==R.GrandTotalPosition.row){if(y=(y=t.pt.dh.getFieldInfoByName(w))&&y.Spi,m<u||0===u){if(C=b?0:f[i.rYt],-(N=1)!==h&&m<=h&&(N=e.length),(n=I=n)>=l.Sx)return;if(A=void 0,A=0===u?e[0]&&e[0].name||"":(v=(0,G.FZt)(v,w,L),t.pt.collapse(i.rYt,v)?v:b?1<e.length&&0<=h?U().Total:U().GrandTotal:1<e.length&&0<=h||e.length<2&&(0,G.getActualSubtotalPosition)(d.subtotalsPosition,y)===R.SubtotalsPosition.top?v:v+U().Total),w=-1!==t.columnValuePosition,T={path:g,rowHeaderLevel:this.fYt(u,m,N),grandTotalLevel:m},(0,B.ht)(a)||(T.collapseIndex=a),b?T.isGrandTotal=!0:T.isSubtotal=!0,w){if(!o)for(l.Kbt(I,C,A),S=0,x=(M=i.lYt.split(B.Separator)).length;S<x-1;S++)l.tZt(I,p[S],p[S]!==U().Values?(0,G.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);this.OZt(l,I,T),this.GZt(t,i,I,g)}else{if(0===t.valueFieldsInfo.length){if(!o)for(l.Kbt(I,C,A),S=0,x=(M=i.lYt.split(B.Separator)).length;S<x-1;S++)l.tZt(I,p[S],p[S]!==U().Values?(0,G.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);this.OZt(l,I,T)}for(D=0,k=e;D<k.length;D++){for(O=(j=k[D]).name,P=j.subtotalType,E=j.cacheName,j=j.subtotalText,T={path:g,rowHeaderLevel:this.fYt(u,m,N),grandTotalLevel:m,valueFieldName:O},(0,B.ht)(a)||(T.collapseIndex=a),s&&(T.collapse=!0),(_=F=void 0)===o||1<N?(F=h>=T.grandTotalLevel?A+" "+O:A,_=C):o?(F=A,s||(_=C)):(F=O,_=t.valuePositionInfo.positionIndex),c||l.Kbt(I,_,F),M=i.lYt.split(B.Separator),0<=h&&h<m&&(_=f[U().Values],M.splice(_,null,e[0].name)),S=0,x=M.length;S<x-1;S++)l.tZt(I,p[S],p[S]!==U().Values?(0,G.FZt)(t.sharedMap,p[S],M[S]):M[S],p.length-S);b?T.isGrandTotal=!0:T.isSubtotal=!0,this.OZt(l,I,T),this.GZt(t,i,I,g,E,P,j,O),I++,c&&(I++,r++)}}this.ZZt(t,n,i,e)}return b||!d.insertBlankLineAfterEachItem||c||(this.NYt(t,i,l.zWt.length),V(r))||r++,r}},c.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},c.MYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,k,j,O,k,o=t.rowDeep,a=t.options,s=t.rowFieldsMap,c=t.rowModel,u=t.rowValuePosition,l=t.rowFieldsIndexes,f=1,h=i.oYt,v=i.YAt,d=h.length;if(o<=v)for(p=i.lYt.split(B.Separator),0<=u&&!V(e)&&p.splice(u,null,e[0].name),m=0,b=p.length;m<b;m++)p[m]&&c.tZt(n-1,l[m],l[m]!==U().Values?(0,G.FZt)(t.sharedMap,l[m],p[m]):p[m],l.length-m);if((g=0)<d)for(w=n,y=a.fillDownLabels,A=(I=N=C=void 0,G.getActualSubtotalPosition)(a.subTotalsPosition,r)===R.SubtotalsPosition.bottom?1:0,T=this.mYt(a.showDrill),M=0,S=h;M<S.length;M++)if(x=S[M],D=0,o<=v)k=w-1,i.zEt&&0===o&&0<t.columnDeep&&-1===u&&(k=w),this.TYt(t,x,k,"",e);else{if(D=this.bYt(t,x,w,e),y)for(C=s[x.rYt],I=D+w-A,N=c.Sl(w,C),j=void 0,O=w+1;O<I;O++)(j=c.zWt[O])&&!j.isBlankRow&&(!j.isSubtotal||v<j.grandTotalLevel-1)&&(c.Kbt(O,C,N),c.qWt(O,C,T));g+=D,v+1===o&&(k=x.eYt?w+1:w,this.ZZt(t,k,x,e)),w+=D}return g},c.TYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,d,b,b,g,w,y,C,N,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,c=i.oYt,u=i.nodeName,l=i.HZt;if(""!==e&&(e+=B.Separator),f=-1!==o,0===c.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=u),f&&(""!==b?b+=B.Separator+p:b=p),b=s[b],g=t.subtotalCollection.CZt[p],V(b)||(w=!1,w=!!(g&&(g.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===g.showDataAs||9===g.showDataAs)&&0<(g.showDataAsIndex&i.QZt))||w)||a.Kbt(n,b,A.Common.st.E8((0,I.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=c;y<C.length;y++)N=C[y],this.TYt(t,N,n,e+u,r);i.kYt||this.ZZt(t,n,i,r,e+u)},c.OYt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,i=t.rowModel,n=t.rowFields,e=t.rowValuePosition,r=t.valueFieldsInfo,o=t.colFields,a=n.length;for(0===a&&1===r.length&&0<o.length&&(a=1),s=[],c=0,u=n;c<u.length;c++)l=u[c],s.push(l.Zc);for(-1!==e&&(a+=1,s.splice(e,0,U().Values)),i.setColCount(a),f={},h=[],v=0,d=s.length;v<d;v++)f[s[v]]=v,h.push(s[v]);t.rowFieldsMap=f,t.rowFieldsIndexes=h},c.uit=R.PivotTableLayoutType.outline,i.PivotTableOutlineLayout=c},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(t,i,n){"use strict";var e,G,V,I,A,r,U,T,Q,n,W,o,a,s;function c(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTabularLayout=void 0,G=n("Pivot"),V=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),I=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),A=n("Common"),r=n("./dist/plugins/pivot/pivot.ns.js"),U=n("./dist/plugins/pivot/pivot-util.js"),T=n("@grapecity/js-calc"),Q=A.Common.lt.ht,n=new A.Common.ResourceManager(r.SR,"PivotTables"),W=n.getResource.bind(n),s=I.PivotTableLayoutBase,e(c,s),c.kZt=function(o){var a,s,t,c,i,n,u,e,r,l,f,h,v,t,h,d,a=this,s=o.cornerModel,t=o.columnModel,c=o.rowModel,i=o.valueFieldsInfo,n=o.rowFieldsMap,u=o.pt,e=o.rowFields,r=o.showHeaders,l=o.colFields,f=o.rowValuePosition,h=o.hideValuesRow,v=o.dataCaption,t=t.Sx;s.setRowCount(t),s.setColCount(c.Tx),h=(0,I.getValuesRowOffset)(h,v,i.length,l.length),e.length?(1!==i.length||l.length<1&&!r||s.Kbt(0+h,0,i[0].name),r&&(d=t-1,(0,G.o)(Object.keys(n),function(t,i){var n,e,r,e;s.Kbt(d,i,t),(n=t!==W().Values)&&(e=u.zRt(t),r=u.dh.isFilter(e.a),e=e.nrt,s.qWt(d,i,a.RZt(r,e,30,o.options.showFilter))),s.JWt(i,{isCompactRoot:!1,fieldName:t,isDim:n}),c.WWt[i]={path:t}}))):0<=f&&r&&s.Kbt(s.Sx-1,0,W().Values)},c.tYt=function(o,t,i,a){var s,n,s=this,n=[];(0,G.o)(t,function(t){n.push({name:t.Zc,isFilter:a.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:W().Values,isFilter:!1,isDim:!1}),(0,G.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),o.zWt[i+1]={path:n},e&&o.qWt(0,i,s.RZt(r,t,30,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},c.xZt=function(t){var i,n,e,r,o,n;this.OYt(t),i=t.rootNode,n=t.options,e=t.valueFieldsInfo,r=t.rowModel,o=t.contentModel,n=n.subTotalsPosition!==V.SubtotalsPosition.none,this.bYt(t,i,n,0,e),r.setRowCount(r.zWt.length),o.setRowCount(r.zWt.length)},c.bYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,u,C,N,I,A,T,M,S,x,D,k,h,j,O,v,f,u,o,h,o=t.rowFieldsMap,a=t.rowModel,s=t.rowValuePosition,c=t.rowDeep,u=t.sharedMap,l=t.rowFieldsIndexes,f=i.eYt,h=i.rYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=o[h],g=1,w=t.options.subTotalsPosition!==V.SubtotalsPosition.none,y=t.options.grandTotalPosition!==V.GrandTotalPosition.none&&t.options.grandTotalPosition!==V.GrandTotalPosition.row;if(-1!==s&&d<=s&&(g=r.length),u=(0,U.FZt)(u,h,v),C=e,N=t.pt.collapse(i.rYt,u)&&d!==c,f){for(I=o[W().Values],p||0===s||(a.Kbt(C,b,u),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&a.qWt(C,b,this.aYt(N))),A=void 0,M=!1,S=T=0,x=r;S<x.length;S++)D=x[S],a.Kbt(C,I,D.name),A={path:m,rowHeaderLevel:this.fYt(c,d,g)},1<g&&(A.valueFieldName=D.name,A.isValueFieldDim=!0),this.OZt(a,C,A),N?i.YAt<=s&&s<c&&!p&&t.options.insertBlankLineAfterEachItem?(this.NYt(t,i,a.zWt.length),C++,C++,T++,M=!0):C++:(i.zEt&&0===c&&0===s&&(this.TYt(t,i,C,"",r),e=r.length),C+=this.MYt(t,i,n,C,[D],!0),!i.zEt&&d<c&&t.options.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,a.zWt.length)));if(d===c&&t.options.insertBlankLineAfterEachItem&&(C++,this.NYt(t,i,a.zWt.length)),N)return g=this.xYt(t,i,n,C-g-T,r,g,!0,b,!0,M),n||(g+=T),g}else{if(!Q(b)&&(a.Kbt(C,b,u),this.OZt(a,C,{path:m,rowHeaderLevel:this.fYt(c,d,g),valueFieldName:r[0]&&r[0].name}),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&a.qWt(C,b,this.aYt(N)),N)){if(i.YAt<c)for(k=i.lYt.split(G.Separator),0<=s&&s<=d&&(h=o[W().Values]-1,k.splice(h,null,r[0].name)),j=0,O=k.length;j<O;j++)k[j]&&a.tZt(C,l[j],l[j]!==W().Values?(0,U.FZt)(t.sharedMap,l[j],k[j]):k[j],l.length-j);return v=!0,0!==t.valuePositionInfo.positionIndex&&(v=!1),g=this.xYt(t,i,!0,C,r,g,v,b,!0)}this.MYt(t,i,n,C,r)}return f=this.gYt(t,i)||g,u=0,t.options.insertBlankLineAfterEachItem&&(f+=u=this.CYt(t,i)),o=e+f-g,w||p&&y||!c&&r.length?(t.options.insertBlankLineAfterEachItem&&i.AYt&&!p&&o--,0===c&&p?(h=r[0]&&r[0].name||"",a.Kbt(o,0,h),-1===s&&(A={path:m,rowHeaderLevel:this.fYt(c,d,g)},this.OZt(a,o,A)),this.ZZt(t,o,i,r,"")):s<=0?this.xYt(t,i,n,o,r,void 0,!0):this.xYt(t,i,n,o,r)):t.options.subTotalsPosition===V.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<u&&this.NYt(t,i,o),f},c.CYt=function(t,i){return t.options.subTotalsPosition===V.SubtotalsPosition.none?i.IYt:i.AYt},c.gYt=function(t,i){var n,e,n,r,e,n,n=t.options,e=n.subTotalsPosition,n=n.grandTotalPosition,r=e!==V.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt;return i.zEt&&(0===t.rowFields.length&&(r=i.KZt+i.$Zt),e=e!==V.SubtotalsPosition.none,n=n!==V.GrandTotalPosition.none&&n!==V.GrandTotalPosition.row,e&&!n?r-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(n&&!e||n&&0===i.vYt&&0!==t.rowFields.length)&&(r+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length)),r},c.xYt=function(t,i,n,e,r,o,a,s,c,u){var l,f,h,L,v,d,p,m,E,b,g,B,w,y,C,N,n,I,w,R,A,T,M,S,x,D,k,j,O,P,k,F,_,_,l=t.rowDeep,f=t.rowModel,h=t.rowFieldsMap,L=t.sharedMap,v=t.options,d=t.rowValuePosition,p=t.rowFieldsIndexes,m=i.YAt,E=i.nodeName,b=i.zEt,g=i.lYt,B=i.rYt,w=!1;if(b){if(t.options.grandTotalPosition===V.GrandTotalPosition.none||t.options.grandTotalPosition===V.GrandTotalPosition.row)return;w=!0}if(n&&m<l||0===l||w){if(-(y=1)!==d&&m<=d&&(y=r.length),C=b?0:h[i.rYt],(n=N=e)>=f.Sx)return;if(I=void 0,I=0===l?r[0]&&r[0].name||"":(w=(0,U.FZt)(L,B,E),t.pt.collapse(i.rYt,w)?w:b?1<r.length&&0<=d?W().Total:W().GrandTotal:1<r.length&&0<d||r.length<2&&v.subtotalsPosition===V.SubtotalsPosition.none?w:w+W().Total),R=-1!==t.columnValuePosition){for(A={path:g,grandTotalLevel:m},b?A.isGrandTotal=!0:A.isSubtotal=!0,(0,G.ht)(s)||(A.collapseIndex=s),f.Kbt(N,C,I),M=0,S=(T=i.lYt.split(G.Separator)).length;M<S-1;M++)f.tZt(N,p[M],p[M]!==W().Values?(0,U.FZt)(t.sharedMap,p[M],T[M]):T[M],p.length-M);this.OZt(f,N,A),this.GZt(t,i,N,g)}else{if(A=void 0,0===t.valueFieldsInfo.length){for(f.Kbt(N,C,I),M=0,S=(T=i.lYt.split(G.Separator)).length;M<S-1;M++)f.tZt(N,p[M],p[M]!==W().Values?(0,U.FZt)(t.sharedMap,p[M],T[M]):T[M],p.length-M);A={path:g,grandTotalLevel:m},b?A.isGrandTotal=!0:A.isSubtotal=!0,(0,G.ht)(s)||(A.collapseIndex=s),this.OZt(f,N,A)}for(x=0,D=r;x<D.length;x++){for(j=(k=D[x]).cacheName,O=k.subtotalType,P=k.subtotalText,A={path:g,grandTotalLevel:m,valueFieldName:k=k.name},b?A.isGrandTotal=!0:A.isSubtotal=!0,_=F=void 0,c&&(A.collapse=!0),void 0===a||1<y?(F=I+" "+k,_=C):a?(F=I,c||(_=C)):(F=k,_=t.valuePositionInfo.positionIndex),A.valueFieldName=k,u||f.Kbt(N,_,F),T=i.lYt.split(G.Separator),0<=d&&d<m&&(_=h[W().Values],T.splice(_,null,F)),M=0,S=T.length;M<S-1;M++)f.tZt(N,p[M],p[M]!==W().Values?(0,U.FZt)(t.sharedMap,p[M],T[M]):T[M],p.length-M);(0,G.ht)(s)||(A.collapseIndex=s),this.OZt(f,N,A),this.GZt(t,i,N,g,j,O,P,k),N++,u&&(N++,o++)}}this.ZZt(t,n,i,r)}return b||!v.insertBlankLineAfterEachItem||u||(this.NYt(t,i,f.zWt.length),Q(o))||o++,o},c.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},c.MYt=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,k,j,a=t.rowDeep,s=t.rowModel,c=t.options,u=t.rowFieldsMap,l=t.rowValuePosition,f=t.rowFieldsIndexes,h=1,v=i.oYt,d=i.YAt,p=v.length;if(a<=d)for(m=i.lYt.split(G.Separator),0<=l&&!Q(r)&&m.splice(l,null,r[0].name),b=0,g=m.length;b<g;b++)m[b]&&s.tZt(e,f[b],f[b]!==W().Values?(0,U.FZt)(t.sharedMap,f[b],m[b]):m[b],f.length-b);if((w=0)<p)for(y=e,C=c.fillDownLabels,A=I=N=void 0,T=c.subTotalsPosition===V.SubtotalsPosition.bottom?1:0,M=this.mYt(c.showDrill),S=0,x=v;S<x.length;S++)if(D=x[S],a<=d)this.TYt(t,D,y,"",r);else{if(d+1===a&&this.ZZt(t,y,D,r),k=this.bYt(t,D,n,y,r),C)for(N=u[D.rYt],A=k+y-T,I=s.Sl(y,N),j=y+1;j<A;j++)s.zWt[j]&&!s.zWt[j].isBlankRow&&(s.Kbt(j,N,I),s.qWt(j,N,M));y+=k,w+=k}return w=a<=d?1:w},c.TYt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,d,b,b,g,w,y,C,N,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,c=i.oYt,u=i.nodeName,l=i.HZt;if(""!==e&&(e+=G.Separator),f=-1!==o,0===c.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=u),f&&(""!==b?b+=G.Separator+p:b=p),b=s[b],Q(b)||(g=!1,g=!!((w=t.subtotalCollection.CZt[p])&&(w.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===w.showDataAs||9===w.showDataAs)&&0<(w.showDataAsIndex&i.QZt))||g)||a.Kbt(n,b,A.Common.st.E8((0,I.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=c;y<C.length;y++)N=C[y],this.TYt(t,N,n,e+u,r);i.kYt||this.ZZt(t,n,i,r,e+u)},c.OYt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,i=t.rowModel,n=t.rowFields,e=t.rowValuePosition,r=t.valueFieldsInfo,o=t.colFields,a=n.length;for(0===a&&1===r.length&&0<o.length&&(a=1),s=[],c=0,u=n;c<u.length;c++)l=u[c],s.push(l.Zc);for(-1!==e&&(a+=1,s.splice(e,0,W().Values)),i.setColCount(a),f={},h=[],v=0,d=s.length;v<d;v++)f[s[v]]=v,h.push(s[v]);t.rowFieldsMap=f,t.rowFieldsIndexes=h},c.uit=V.PivotTableLayoutType.outline,i.PivotTableTabularLayout=c},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(b,t,i){"use strict";var S,n,x,I,A,T,M,g,D,u,e,N,w,r,V,o,k,U,j,y,O,Q,W,d,P,F,i,_,L,a,E,s,c,C,B,l,R,f;function z(t){return t?"0"===t.defaultSubtotal?T.SubtotalsPosition.none:"0"===t.subtotalTop?T.SubtotalsPosition.top:T.SubtotalsPosition.bottom:T.SubtotalsPosition.bottom}function h(t){this.PYt=[],this.Mf=t,this.FYt={},this._Yt={}}function Z(t,i,n){var e,r,o,a,s,c,e=i.LYt,r=i.eZt;if(!R(e))for(o=0;o<e.rowCount;o++)for(a=e.row+o,R(t[a])&&(t[a]={}),s=0;s<e.colCount;s++)c=e.col+s,R(t[a][c])&&(t[a][c]={}),n(t[a][c],i.getValue(a,c));if(!R(r))for(o=0;o<r.rowCount;o++)for(a=r.row+o,R(t[a])&&(t[a]={}),s=0;s<r.colCount;s++)c=r.col+s,R(t[a][c])&&(t[a][c]={}),n(t[a][c],i.getValue(a,c))}function p(t,i,n){var e,e,r,r,o,o,t,n,t,e,r,o,n,e=t.row,e=void 0===e?-1:e,r=t.col,r=void 0===r?-1:r,o=t.rowCount,o=void 0===o?n.getRowCount():o,t=t.colCount,n=void 0===t?n.getColumnCount():t,t=new S.Range(e,r,o,n),e=i.getRange(),r=e.page,o=e.content,n=o;return r&&(n=o.union(r)),t.containsRange(n)}function v(t,i,n){var e,e,r,r,o,o,t,n,t,i,t,e=t.row,e=void 0===e?-1:e,r=t.col,r=void 0===r?-1:r,o=t.rowCount,o=void 0===o?n.getRowCount():o,t=t.colCount,n=void 0===t?n.getColumnCount():t,t=i.getRange(),i=t.page,t=t.content;return i&&i.intersect(e,r,o,n)||t.intersect(e,r,o,n)}function m(t,i,n,e){var r,o,r,a,e;return"deletingRows"===e||"deletingColumns"===e||"clear"===e?!v(t,i,n)||p(t,i,n):"addingRows"===e?(o=(r=i.getRange()).page,a=r=r.content,o&&(a=r.union(o)),!v(t,i,n)||t.row<=a.row):"addingColumns"===e&&(o=(e=i.getRange()).page,a=r=e.content,o&&(a=r.union(o)),!v(t,i,n)||t.col<=a.col)}function Y(t,i){return t&&i&&t.color===i.color&&t.type===i.type||!t&&!i}function G(t,i,n,e){for(var r,o,a,s,c,r=i.getDefaultStyle(),o=e.startRow,a=e.endRow;o<a;o++)for(s=e.startCol,c=e.endCol;s<c;s++)H(i,o,s,r,n,t)}function H(t,i,n,e,r,o){var t,i,a,s,c,n;if(t.Ut&&(i=(t=t.Ut.sheetModels[3].J_(i,n))&&t.style)&&o&&"string"==typeof i)if(r[i])t.style=r[i];else if(a=o.i3(i)){for(s in a=a.clone(!0),l)!l.hasOwnProperty(s)||R(a[s])||(0===(c=l[s])?a[s]===e[s]&&(a[s]=F):1===c?Y(a[s],e[s])&&(a[s]=F):2===c&&S.mt.rfe(a[s],e[s])&&(a[s]=F));n=C+B+i,B++,a.name=n,o.$p(a),t.style=n,r[i]=n}}function J(t,i){var n,e,r,o,a,s,c,u,l,f,n={};for(e in t)if(t.hasOwnProperty(e)&&(n[e]={},"string"==typeof(o=(r=t[e]).EYt)&&0<o.indexOf("!")&&((a=o.split("!"))[0]&&("="===a[0][0]&&(a[0]=a[0].slice(1)),"'"===a[0][0])&&"'"===a[0][a[0].length-1]&&(a[0]=a[0].slice(1,a[0].length-1)),o=(0,N.getSheetNameForFormula)(a[0])+"!"+a[1]),!R(o))&&"string"==typeof o){s=void 0;try{if((s=D.formulaToExpression((0,S.jf)(i),o,0,0,!0)).abt){c=s.abt,n[e].sourceType="worksheet",n[e].sourceName=c.name();continue}}catch(t){}u=void 0;try{if(f=l=void 0,(u=D.formulaToRanges((0,S.jf)(i),o,0,0))[0]&&u[0].ranges){if(n[e].sourceType="worksheet",s&&8===s.type&&s.value){n[e].sourceName=s.value;continue}l=u[0].sheetName,f=u[0].ranges[0],n[e].sheet=l,n[e].ref=D.rangeToFormula(f,0,0,15);continue}}catch(t){}0<o.indexOf("!")?(a=o.split("!"),n[e].sourceType="worksheet",n[e].sheet=a[0],n[e].ref=a[1]):(n[e].sourceType="worksheet",n[e].sourceName=o)}return n}function q(t,i){var n,t;"Object"===i.constructor.name&&(n=D.formulaToRange(t,i.ref),(t=t.pivotTables.add(i.name,i.dataRef,n.row,n.col))&&t.fromJson(i),i=t)}function K(t,i){for(var n,e,r,o,a,s,c,u,l,f,n=i.colCount,r=0;r<n&&(e=t.fDi(r),R(e)||e.isGroup);r++)i.col++,i.colCount--;for(o=[[]],s=0,c=i.colCount;s<c;s++)u=void 0,(a=t.fDi(i.col+s))&&(l=a.caption,u=f=a.value,"string"==typeof l&&""!==l?u=l:Array.isArray(l)&&(u=l[l.length-1])),o[0][s]=u;return o}function X(t,i){var n,e,r,n="_",e=t.split("_");return isNaN(parseInt(e[e.length-1],10))?t+="_1":(r=e[e.length-1],e.splice(e.length-1,1,"_"+(parseInt(r,10)+1)),t=e.join("")),t=-1!==i.indexOf(t)?X(t,i):t}Object.defineProperty(t,"__esModule",{value:!0}),t.PivotTableManager=void 0,S=i("Core"),n=i("Common"),x=i("Pivot"),I=i("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),A=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),T=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),M=i("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),g=i("./dist/plugins/pivot/pivot.ns.js"),D=i("SheetsCalc"),u=i("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),e=i("ConditionalFormatting"),N=i("./dist/plugins/pivot/pivot-util.js"),w=i("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),r=i("Tables"),V=i("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),o=n.Common.kh,k=S.mt.xr,U=S.mt.go,j=S.Util.Sr,y=S.Util.wr,O=S.NodeHelper.ur,Q=S.NodeHelper.sr,W=S.Util.po,d=null,P=n.Common.lt.Nh,F=void 0,i=new n.Common.ResourceManager(g.SR,"PivotTables"),_=i.getResource.bind(i),L="pivot",a=S.GC$,E=a.isEmptyObject,s=S.UsedRangeUtil.hh,c=S.UsedRangeUtil.vh,C="__builtInPivotTableStyle",l={backColor:2,foreColor:B=0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},R=n.Common.lt.ht,h.prototype.all=function(){return this.PYt.concat([])},h.prototype.add=function(t,i,n,e,r,o,a){var s,c,u,l,i,s,s=this.Mf.parent,c={};return s&&(u=!s.BYt(t))?((0,A.RYt)(new S.Range(0,0,0,0),new S.Range(n,e,18,3),this.Mf,t,!1,null,null,T.overlapCheck.value),(l=s.GYt(i))||(l=s.VYt(t,i),c.pivotCacheName=l.Zc),i=s.UYt(l.getName(),t),s=new A.PivotTable(t,this.Mf,n,e,r,o,a,i),R(c.pivotCache)||(c.fieldsModelName=i.getName()),this._Qt(s,void 0,c),this.Mf.hP()&&this.Mf.repaint(),s):null},h.prototype._Qt=function(t,i,n){t&&(this.DT(t,"add",void 0,i,n),this.PYt.push(t),t.dh.addPivotView(t),this.Mf.parent&&this.Mf.parent.QYt(t.name(),!0),t.Oy()||t.dh.q3())},h.prototype.getUsedRange=function(){var t,i,n,e,r,o,a,t,i=this.all(),n={};if(i)for(e=void 0,r=0,o=i;r<o.length;r++)e=(a=o[r]).getRange(),c(n,s(e.page)),c(n,s(e.content));return n},h.prototype.DT=function(t,i,n,e,r){var o,a,s,a,o,a=this.Mf;a&&(a=a.Ut).G8&&("add"===i?s={type:i,value:t.Zc,isMove:e,pivotType:0}:"remove"===i&&(s={type:i,value:t,index:n,isMove:e,pivotType:0,pivotCacheInfo:r}),a.WYt(t,s))},h.prototype.AP=function(t){var i,n,e,r,r;t&&(i=this,r=(t.type?(n=t.type,e=t.value,t):(n=t.value.type,e=t.value.value,t.value)).isMove,"add"===n?i.zYt(e,r):"remove"===n&&i.ZYt(t.value))},h.prototype.zYt=function(t,i){this.TOt(t,i)},h.prototype.ZYt=function(t){var i,n,e,r,o,i,i=this.PYt,n=t.value,e=t.index,r=this.Mf,o=r.parent;this.PYt=i.slice(0,e).concat(n).concat(i.slice(e)),i=n.dh,(0,x.o)(i.z,function(t){t instanceof u.PivotPanel&&t.attach(n)}),i.q3(),o&&(o.QYt(n.Zc,!1),o.EQt&&o.EQt.undoRemovingPivotTable(n),t.pivotCacheInfo)&&o.YYt(t.pivotCacheInfo,!0),r.repaint()},h.prototype.HYt=function(t,i,n,e){for(var r,o,a,s,c,s,r=this.all(),o=0;o<r.length;o++)if(c=(s=(a=r[o]).getRange()).page,s=s.content,c&&c.intersect(t,i,n,e)||s.intersect(t,i,n,e))return this.Mf.jT(10,_().PivotTableErrorMessage_MakeChange),!1;return!0},h.prototype.remove=function(t){var i,n,i,n;0<this.PYt.length&&(this.TOt(t,!1),this.Mf.repaint())},h.prototype.TOt=function(t,i){for(var n,e,r,o,a,s,c,n=this.PYt,e=n.length,r=this.Mf&&this.Mf.parent,o=e-1;0<=o;o--)if(n[o].Zc===t){a=n[o].dh,s=this.PYt.splice(o,1)[0],c=void 0,i||(c=r&&r.JYt(a.getName())),this.DT(s,"remove",o,i,c),i||(0,x.o)(a.z,function(t){t instanceof u.PivotPanel&&t.detach()}),r&&r.QYt(t,!1),r&&r.EQt&&r.EQt.undoAddingPivotTable(s);break}this.Mf.repaint()},h.prototype.get=function(t){for(var i,n,e,i=0,n=this.PYt;i<n.length;i++)if((e=n[i]).Zc===t)return e;return null},h.prototype.eG=function(){for(var t,i,n,e,t,i=0,n=this.PYt;i<n.length;i++)e=n[i],this.remove(e.name());this.PYt=[]},h.prototype.findPivotTable=function(t,i){var n,e,r,o,a,s,c,o,u,l,f,h,v,u;if(this.FYt[t]&&this._Yt[i]){for(n=0,e=this.PYt;n<e.length;n++)if(a=(o=(r=e[n]).getRange().content).row,s=o.col,c=o.rowCount,o=o.colCount,l=!1,(u=r.LYt)&&(f=u.row,h=u.col,v=u.rowCount,u=u.colCount,l=f<=t&&t<v+f&&h<=i&&i<h+u),a<=t&&t<c+a&&s<=i&&i<s+o||l)return r;return d}},h.prototype.qYt=function(){var i=this;i.FYt={},i._Yt={},(0,x.o)(i.PYt,function(t){t.qYt(i.FYt,i._Yt)})},h.prototype.KYt=function(t,i,n,e){return!R(t)&&this.XYt(t)&&(0,A.RYt)(t,i,n,e,!1)},h.prototype.XYt=function(t){var i,n,e,r,o,r,i=this;if(0!==i.PYt.length)for(n=0;n<i.PYt.length;n++){if(o=(r=(e=i.PYt[n]).getRange()).content,(r=r.page)&&(r.containsRange(t)||r.intersect(t.row,t.col,t.rowCount,t.colCount)&&r.union(o).containsRange(t)))return!0;if(o.containsRange(t))return!0}return!1},h.prototype.KB=function(t,i){var r,t,r=this,t=(0,N.$Yt)(this.Mf,t);return i&&(0,x.o)(t,function(t){for(var i,n,e,i=r.PYt,n=0;n<i.length;n++)(e=i[n]).Zc===t.name&&(t.pt=e,r.TOt(e.Zc,!0))}),t},h.prototype.JB=function(t,s,i,n,c,u,l,e,r,f){function h(t,i){var t=t.getRange().page;return t&&(i+=t.rowCount+1),i}(0,x.o)(t,function(t){var i,n,e,r,o,a,r,i,i=s.pivotTables.get(t.name),n=u+t.startPoint[0],e=l+t.startPoint[1];if(f){if(n=h(r=t.pt,n),r.suspendLayout(),r.position(n,e,c.name()),c.name()===s.name()){for(o=t.pt.dh.z,a=0;a<o.length;a++)if(o[a].Zc===t.pt.Zc){o.splice(a,1);break}c.pivotTables._Qt(t.pt,!0)}r.resumeLayout()}else r=i.serialize(),n=h(i,n),i=i.clone(i.name(),c,n,e),c.pivotTables._Qt(i),i.tJt(r,1023)})},h.prototype.getRangePivotAreas=function(t){var e,r,o,i,n,a,s,e=this,r=[];for(r=(0,N.iJt)(e.Mf,t),o={},i=function(t){var i,t,n,i=e.get(t),t=r[t],n=[];(0,x.o)(t,function(t){n=n.concat.apply(n,(0,w.rangeToAreas)(i,t))}),o[i.Zc]=n},n=0,a=Object.keys(r);n<a.length;n++)i(s=a[n]);return o},h.prototype.jT=function(t,i){var n,e,n=this,e=n.Mf;e&&(t?(n.nJt&&e.ki(S.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:n.nJt.type,message:n.nJt.args},!0),n.nJt=d):!i||!i.args.force&&n.nJt||(n.nJt=i))},h.prototype.eJt=function(t,i,n){var e,r,t,o,e;return"number"==typeof n&&!!((r=this.findPivotTable(t,i))&&r.options.enableDataValueEditing&&r.rJt(t,i))&&(t=r.getNodeInfo(t,i),(o=r.getNodeValue(t))!==n)&&(r.oJt(t,n,!0),!0)},f=h,t.PivotTableManager=f,a.extend(S.Worksheet.prototype,{aJt:function(t,i){var n,e,r,o,a,s,n=this,o=n.pivotTables.findPivotTable(t,i);return o&&((a=n.getParent())&&a.options.enableAccessibility&&(s=o.sJt(t,i,!0))&&setTimeout(function(){a.n2(s)},0),e=o.getValue(t,i),r=!0),{value:e,inPivot:r}},uJt:function(t,i){var n,e,i,r,o,a,s,c,u,l,f,i,h,v,d,p,m,b,g,w,y,C,N,I,y,C,n=i.ctx,e=i.clipRect,i=t.position(),r=i.row,o=i.col,a=18,s=3,c=0,u=0,l=0,f=0,i=this.getActiveColumnIndex(),h=this.getActiveRowIndex(),v=new S.Range(r,o,18,3),d=t.getName(),p=_().EmptyPivotTable_PromptMessage1;for(o<=i&&i<o+3&&r<=h&&h<r+18&&!this.options.isProtected&&(p=_().EmptyPivotTable_PromptMessage2),m=0;m<18;m++)u+=this.Gt(r+m);for(b=0;b<3;b++)c+=this.nn(o+b);for(g=0;g<=2;g++)for(w=0;w<=2;w++)C=(y=this.getRangeRect(g,w,v)).x,N=y.y,I=y.width,y=y.height,C=new S.Rect(C,N,I,y),(e=this.Fi().c9(g,w))&&0!==e.width&&0!==e.height&&e.intersectRect(C)&&(l=0===w?C.x:C.x-(c-C.width),f=0===g?C.y:C.y-(u-C.height),(0,M.jYt)(n,d,l,f,u,c,e,p))}}),S.Worksheet.ch("pivotTable",{init:function(){var t,i,n,t,e,r,o,t=this,i=t.pivotTables,n=t.parent;if(!R(i)&&!R(n)&&(t=i.all())&&0<t.length)for(e=0,r=t;e<r.length;e++)o=r[e],n.QYt(o.name(),!1);this.pivotTables=new f(this)},getUsedRange:function(t){var i,n,e;t.type&S.UsedRangeType.pivottable&&(e=(n=(i=this).pivotTables).getUsedRange(),c(t.range,e))},dispose:function(t){!1!==t.clearCache&&(this.pivotTables&&this.pivotTables.eG(),this.pivotTables=null)},beforePaintAdornment:function(t){for(var i,n,e,i=0,n=this.pivotTables.all();i<n.length;i++)(e=n[i]).Oy()&&this.uJt(e,t)},onLayoutChanged:function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d;if(R(t.sheetArea)||3===t.sheetArea)if(i=this,n=t.changeType,e=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=new S.Range(e,r,o,a),c=i.pivotTables.all(),"deletingRows"===n||"deletingColumns"===n)for(u=0;u<c.length;u++){if(!m(s,l=c[u],i,n)){t.canDelete=!1,i.jT(10,_().PivotTableErrorMessage_MakeChange);break}p(s,l,i)?i.pivotTables.remove(l.name()):(h=(f=l.position()).row,v=f.col,"deletingRows"===n?s.row<h&&l.position(h-s.rowCount,v):s.col<v&&l.position(h,v-s.colCount))}else if("addingRows"===n||"addingColumns"===n)for(u=0;u<c.length;u++){if(!m(s,l=c[u],this,n)){i.jT(10,_().PivotTableErrorMessage_MakeChange),t.canAdd=!1;break}h=(d=l.position()).row,v=d.col,"addingRows"===n?s.row<=h&&l.position(h+s.rowCount,v):s.col<=v&&l.position(h,v+s.colCount)}else if("clear"===n&&!t.ignorePivotTable)for(u=0;u<c.length;u++){if(!m(s,l=c[u],i,n)){t.canClear=!1,i.ki(S.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:_().PivotTableErrorMessage_MakeChange},i.QI);break}p(s,l,i)&&i.pivotTables.remove(l.name())}},allowStartEdit:function(t){var i,n,e,r,o,a,s,c,s,i=this,n=t.row,e=t.col;if(i.pivotTables)for(r=i.pivotTables.all(),o=0;o<r.length;o++)if(c=(s=(a=r[o]).getRange()).page,s=s.content,(c&&c.contains(n,e)||s&&s.contains(n,e))&&(!a.options.enableDataValueEditing||!a.rJt(n,e)))return void(t.isAllow=!1)},fromJson:function(t,i,n){var e,r,o,a,s,c,u,l,l,f,h,v,d,h,v,d,h,f,p,m,b,m,h,e=this,r=e.parent;if(!(R(r)||n&&n.ignoreStyle)&&(o=r.fMt,a=t.pivotTables,o)&&a&&0<a.length)for(s={},c=B=0;c<a.length;c++)u=a[c],!(l=o.getPivotCacheByCacheId(+u.cacheId))||E(l.Pq)||(l=new I.PivotFieldsModel(u.name,u.cacheId,o,this.parent.Qy),r.BQt[u.name]=l,f=D.formulaToRanges(e,u.ref,0,0,!0)[0].ranges,h=u.pageFields,v=u.rowPageCount,d=u.colPageCount,h&&0<h.length&&1<f[0].row&&(h=new S.Range(f[0].row-v-1,f[0].col,v,3*d-1),e.clear(h.row,h.col,h.rowCount,h.colCount,3,S.StorageType.data),G(r,e,s,{startRow:h.row,startCol:h.col,endRow:h.row+h.rowCount,endCol:h.col+h.colCount})),e.clear(f[0].row,f[0].col,f[0].rowCount,f[0].colCount,3,S.StorageType.data),G(r,e,s,{startRow:f[0].row,startCol:f[0].col,endRow:f[0].row+f[0].rowCount,endCol:f[0].col+f[0].colCount}),(v=new A.PivotTable(u.name,e,f[0].row,f[0].col,null,null,null,l)).suspendLayout(),d=u.outline,h=u.compact,f=u.outlineData,p=u.compactData,u.fields&&0<u.fields.length&&(v.options.insertBlankLineAfterEachItem=!!u.insertBlankRowDefault,v.options.subTotalsPosition=!1===u.enabledSubtotalsDefault?T.SubtotalsPosition.none:!1===u.subtotalsOnTopDefault?T.SubtotalsPosition.bottom:T.SubtotalsPosition.top,l.Dpi=v.options.subTotalsPosition,b=(m=u.fields[0]).outline,m=m.compact,!0===d&&!0===f&&!1===h&&!1===p&&!1===m?v.layoutType(T.PivotTableLayoutType.outline):!1===b?v.layoutType(T.PivotTableLayoutType.tabular):!0===d&&!0===f&&v.layoutType(T.PivotTableLayoutType.compact)),l.fromJson(u,v),v.fromJson(u,t),e.pivotTables._Qt(v),v.Xst--,v.iM(!1,!0),h=v.eZt,R(h))||(e.getColumnCount()<h.col+h.colCount&&e.setColumnCount(h.col+h.colCount),e.getRowCount()<h.row+h.rowCount&&e.setRowCount(h.row+h.rowCount))},toJson:function(t,i){var n,e,r,o,a,s,n,e=this.pivotTables.all();if(e&&0<e.length)if(r=void 0,R(t.data.dataTable)&&(t.data.dataTable={}),r=t.data.dataTable,i&&i.ignoreStyle)for(o=0;o<e.length;o++)(a=e[o]).toJson(t,i);else for(s=t.pivotTables=[],o=0;o<e.length;o++)a=e[o],s.push(a.toJson(t,i)),Z(r,a,function(t,i){t.value=i})},setName:function(t){var i,i,n,e,r,i=this.getParent(),i=i&&i.fMt,n=i&&i.cut;if(!R(n))for(e in n)n.hasOwnProperty(e)&&(r=n[e],!R(r.sheet))&&t&&r.sheet===t.oldName&&(r.sheet=t.newName,R(r.sourceName))&&"string"==typeof r.EYt&&(r.EYt=t.newName+"!"+r.EYt.split("!")[1])},lastNonNullRowAndCol:function(){var t,i,n,e,r,o,a,o,s,c,u,t,i,n=0,e=0,r=this.pivotTables.all();if(r)for(s=0,c=r;s<c.length;s++)o=(u=c[s]).getRange(),a=Math.max(o.page?o.page.row+o.page.rowCount:-1,o.content.row+o.content.rowCount)-1,o=Math.max(o.page?o.page.col+o.page.colCount:-1,o.content.row+o.content.colCount)-1,n=Math.max(n,a),e=Math.max(e,o);return{lastNonNullRow:n,lastNonNullCol:e}},yh:function(t,p,i){var m,b,n,e,r,g,w,y,C,N,o,a,m=this,b=m.parent,n=b&&b.v2&&b.v2.sheetsState,e=b&&b.v2&&b.v2.refSheetsState;if(i&&!1===i.includeStyles){if(r=!1,!n)return;if(Object.keys(n).forEach(function(t){2!==n[t]&&1!==n[t]||(r=!0)}),!r||b.getActiveSheet()===m)return}if(b&&(g=b.fMt,w=m,C=(y=t).rels&&y.rels.c_,!(n&&2===n[w.name()]||e&&2===e[w.name()])))for(N={},o=function(t){var t,i,n,i,t,t,i,i,e,r,o,a,e,o,s,a,e,o,r,c,u,l,f,h,v,c,c,c,d,e,t=C[t],i=t.Type;if(i===S.RelationshipConstants.oc&&(i=(n=t.Target).split("/").pop().slice(0,-4),t=p.pivotTables)&&(t=t[i],g)){if(i=g.getPivotCacheByCacheId(+t.cacheId),b.BQt[t.name]&&(t.name=X(t.name,Object.keys(b.BQt))),!i||E(i.Pq)||b.BQt[t.name])return"continue";if(i=new I.PivotFieldsModel(t.name,t.cacheId,g,m.parent.Qy),b.BQt[t.name]=i,e=k(t,"location"),r=D.formulaToRanges(w,e.ref,0,0,!0)[0].ranges,o=k(t,"pageFields"),a=+e.rowPageCount,e=+e.colPageCount,o&&1<r[0].row&&(o=new S.Range(r[0].row-a-1,r[0].col,a,3*e-1),w.clear(o.row,o.col,o.rowCount,o.colCount,3,S.StorageType.data),G(b,m,N,{startRow:o.row,startCol:o.col,endRow:o.row+o.rowCount,endCol:o.col+o.colCount})),w.clear(r[0].row,r[0].col,r[0].rowCount,r[0].colCount,3,S.StorageType.data),G(b,m,N,{startRow:r[0].row,startCol:r[0].col,endRow:r[0].row+r[0].rowCount,endCol:r[0].col+r[0].colCount}),(s=new A.PivotTable(t.name,w,r[0].row,r[0].col,null,null,null,i)).suspendLayout(),a=O(t.outline),e=O(t.compact),o=O(t.outlineData),r=O(t.compactData),u=(c=k(t,"pivotFields"))&&c.c_){for(l=u[0],f=z(l),h=0,v=u.length;h<v;h++)if(z(u[h])!==f){f=F;break}(c=k(t,"extLst"))&&(c=c.c_)&&c.forEach(function(t){var t=k(t,"pivotTableDefinition16");t&&(f!==F?s.options.subTotalsPosition=f:R(t.EnabledSubtotalsDefault)||!1!==O(t.EnabledSubtotalsDefault)?R(t.SubtotalsOnTopDefault)||!1!==O(t.SubtotalsOnTopDefault)?s.options.subTotalsPosition=T.SubtotalsPosition.top:s.options.subTotalsPosition=T.SubtotalsPosition.bottom:s.options.subTotalsPosition=T.SubtotalsPosition.none,R(t.InsertBlankRowDefault)?s.options.insertBlankLineAfterEachItem=O(l.insertBlankRow):s.options.insertBlankLineAfterEachItem=O(t.InsertBlankRowDefault))}),i.Dpi=s.options.subTotalsPosition,c=O(l.outline),d=O(l.compact),!0===a&&!0===o&&!1===e&&!1===r&&!1===d?s.layoutType(T.PivotTableLayoutType.outline):!1===c?s.layoutType(T.PivotTableLayoutType.tabular):!0===a&&!0===o&&s.layoutType(T.PivotTableLayoutType.compact)}i.yh(t,s),s.yh(t,p,y),w.pivotTables._Qt(s),s.Xst--,s.iM(!1,!0),e=s.eZt,R(e)||(w.getColumnCount()<e.col+e.colCount&&w.setColumnCount(e.col+e.colCount),w.getRowCount()<e.row+e.rowCount&&w.setRowCount(e.row+e.rowCount))}},a=B=0;a<C.length;a++)o(a)},wh:function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,l,p,m,b,b,e,r=this.pivotTables.all();if(r&&0<r.length)if(o=k(t,"sheetData"),R(o)&&(o={n_:"sheetData"}),t.rels||(t.rels={}),a=i.sharedStrings,s=t.rels,n&&!1===n.includeStyles)for(c=0;c<r.length;c++)f=(l=(u=r[c]).rZt.HWt)[0],h=l[1],v=l[2],d=l[3],l=l[4],p=u.LYt,m=u.getRange().content,(0,A.synchronizeDataTable)(p.row+f.DQ,p.col+f.jN,o,f.dataTable,function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)}),(0,A.synchronizeDataTable)(m.row+h.DQ,m.col+h.jN,o,h.dataTable,function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)}),(0,A.synchronizeDataTable)(m.row+v.DQ,m.col+v.jN,o,v.dataTable,function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)}),(0,A.synchronizeDataTable)(m.row+d.DQ,m.col+d.jN,o,d.dataTable,function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)}),(0,A.synchronizeDataTable)(m.row+l.DQ,m.col+l.jN,o,l.dataTable,function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)});else for(c=0;c<r.length;c++)Z(o,u=r[c],function(t,i){(0,A.setDataForSJSPivotTable)(t,i,a)}),b=y(s),b=S.XFileConstants.Rr+b,s.c_.push({n_:S.XFileConstants.Lr,Id:b,Type:S.RelationshipConstants.oc,Target:"../"+S.XFileConstants.Mu+"s/"+S.XFileConstants.Mu+u.Mp+"."+S.XFileConstants.Cr})}}),S.Workbook.ch("pivotTable",{setHost:function(){},init:function(){this.cJt(),S.Commands.fZt(this.commandManager())},dispose:function(){if(this.fMt){for(var t in this.fMt.dispose(),this.fMt=null,this.BQt)this.BQt.hasOwnProperty(t)&&this.BQt[t].dispose();this.BQt=null,this.qp=null,this.lJt=null}},preFromJson:function(t,i,n){var e,t,r;if(this.cJt(),e=this.fMt,t=t.pivotCaches,!R(e)){if(e.dispose(),n&&n.ignoreStyle)return;e.fromJson(t)}for(r in this.BQt)this.BQt.hasOwnProperty(r)&&this.BQt[r]&&this.BQt[r].dispose();this.BQt={}},preFromSJSFormat:function(t,i,n){var e,r,n,i,o,a,s,c,u,l,n,f,h,v,d,p,m,p,m,b,m,m,g,w,g,y,C,N;if(this.cJt(),e=this.fMt,!R(e)){if(e.dispose(),n&&!1===n.includeStyles)return;if(r=i.styleManager,(i=(n=t.styles)&&n.tableStyles)&&(r.addDefaultStyleName("defaultPivotStyle",i.defaultPivotStyle||"PivotStyleLight16"),0<(o=Q(i.count,0)))&&(a=U(i,"tableStyle")))for(s=0,c=[].concat(a);s<c.length;s++)u=c[s],O(u.table)||(l=new V.PivotTableTheme).yh(u,r);if(f=!1,n=k(t.workbook,"pivotCaches"))for(h=n.c_,v=t.pivotCache,d=0;d<h.length;d++)if(m=(p=h[d])["r:id"],p=p.cacheId,m=j(t.workbook.rels.c_,m)){if(m=(b=m.Target).split("/").pop().slice(0,-4),!(m=v&&v[m]))return;g=m["r:id"],w=void 0,R(g)||(w=v[C=(y=(g=j(m.rels.c_,g))&&g.Target).split("/").pop().slice(0,-4)]),e.yh(m,p,w),f=!0}f||e.resetDataAnalyzer()}for(N in this.BQt)this.BQt.hasOwnProperty(N)&&this.BQt[N]&&this.BQt[N].dispose();this.BQt={}},initCustomName:function(){var t,i,n,e,r,o,a,t=this;if(t.fMt&&(i=t.fMt.cut))for(n in i)i.hasOwnProperty(n)&&(e=i[n],(0,x.ht)(e)||(r="pivot"+e.Zc,0<(o=e.EYt).indexOf("!")&&((a=o.split("!"))[0]&&"="===a[0][0]&&(a[0]=a[0].slice(1)),o=(0,N.getSheetNameForFormula)(a[0])+"!"+a[1]),!(0,x.ht)(o)&&""!==o&&(t.zwt(t.lJt,r,o,null,null,!0,null),R(e.oQt)||e.oQt.length<1)&&t.kx(e.Zc,e)))},toJson:function(e,t){var t,i,n,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g;if(!t||!t.ignoreStyle){for(i=(t=this).fMt,n=t.sheets,r={},o=0;o<n.length;o++)for(s=(a=n[o]).pivotTables.all(),c=0;c<s.length;c++)if((u=s[c])&&(l=u.dh.L,R(r[l])&&(r[l]={}),f=u.dh.Z))for(h in f)f.hasOwnProperty(h)&&3!==f[h]&&(r[l][h]=!0);for(v={},d=0,p=n;d<p.length;d++)if((a=p[d]).pivotTables&&a.pivotTables.PYt)for(m=0,b=a.pivotTables.PYt;m<b.length;m++)v[(u=b[m]).dh.L]=1;e.pivotCaches=i&&i.toJson(r,Object.keys(v)),g=J(e.pivotCaches,t),Object.keys(g).forEach(function(t){var i=g[t],n=e.pivotCaches[t];i&&n&&Object.keys(i).forEach(function(t){n[t]=i[t]})})}},onCultureChanged:function(){_(),(0,x.getSR)()},wh:function(c,u,l){var t,i,n,e,r,o,a,s,f,h,v,d,p,m,b,g,w,y,C,i,N,t,I,A,T,t,M;if(!l||!1!==l.includeStyles){for(i=(t=this).fMt,n=t.sheets,e={},r=0;r<n.length;r++)for(a=(o=n[r]).pivotTables.all(),s=0;s<a.length;s++)if((f=a[s])&&(h=f.dh.L,R(e[h])&&(e[h]={}),v=f.dh.Z))for(d in v)v.hasOwnProperty(d)&&3!==v[d]&&(e[h][d]=!0);for(p={},m=0,b=n;m<b.length;m++)if((o=b[m]).pivotTables&&o.pivotTables.PYt)for(g=0,w=o.pivotTables.PYt;g<w.length;g++)p[(f=w[g]).dh.L]=1;y=i.wh(e,Object.keys(p)),C=J(i.cut,t),Object.keys(C).forEach(function(t){var i,t,t,n,i=C[t],t=y[t];i&&t&&(t=k(t.pivotCacheDefinition,"cacheSource"))&&(i.sourceType&&(t.type=i.sourceType),"worksheet"===i.sourceType)&&(n={n_:"worksheetSource"},(0,x.ht)(i.sourceName)||(n.name=i.sourceName),(0,x.ht)(i.ref)||(n.ref=i.ref),(0,x.ht)(i.sheet)||(n.sheet=i.sheet),t.c_=[n])}),i=Object.keys(y),N={},0<i.length&&(t=c.workbook.rels,I=t.c_,A=I.length,T=c.pivotCache={},M=(t={n_:"pivotCaches",c_:[]}).c_,i.forEach(function(t,i){var n,e,r,n,o,a,t,n=y[t],e=n.pivotCacheDefinition,r=n.pivotCacheRecords,n=n.cacheId,o=i+1,a=S.XFileConstants.yu+"/"+S.XFileConstants.bu+o+"."+S.XFileConstants.Cr;N[t]=a,t=S.XFileConstants.Rr+(A+1+i),I.push({n_:S.XFileConstants.Lr,Id:t,Type:S.RelationshipConstants.ec,Target:a}),M.push({n_:"pivotCache",cacheId:n,"r:id":t}),T["pivotCacheDefinition"+o]=e,T["pivotCacheRecords"+o]=r,e.rels={n_:S.XFileConstants.Dr,xmlns:S.RelationshipConstants._r,c_:[{n_:S.XFileConstants.Lr,Id:"rId1",Type:S.RelationshipConstants.ic,Target:S.XFileConstants.wu+o+"."+S.XFileConstants.Cr}]}}),c.workbook.c_||(c.workbook.c_=[]),c.workbook.c_.push(t)),n.forEach(function(t){var i,n,e,r,o,a,s,o,o,i=t.pivotTables.all(),n=W(c,t.name());if(i&&0<i.length)for(c.pivotTables||(c.pivotTables={}),e=c.pivotTables,r=0;r<i.length;r++)a=(o=i[r]).wh(n,u,l),e[s=S.XFileConstants.Mu+o.Mp]=a,o=o.dh.L,o=N[o],a.rels={n_:S.XFileConstants.Dr,xmlns:S.RelationshipConstants._r,c_:[{n_:S.XFileConstants.Lr,Id:"rId1",Type:S.RelationshipConstants.ec,Target:"../"+o}]}})}}}),a.extend(S.Workbook.prototype,{UYt:function(t,i){var n,t,n=this.fMt;return this.BYt(i)&&(0,I.throwError)(_().RepeatName),n.hasPivotCache(t)||(0,I.throwError)("pivot cache not exist"),t=new I.PivotFieldsModel(i,t,n,this.Qy),this.BQt[i]=t},addPivotLayoutModelWithExistCache:function(t,i){var n=this.fMt;n.hasPivotCache(i)||(0,I.throwError)(_().NotExist),this.BQt[t]=new I.PivotFieldsModel(t,i,n)},BYt:function(t){return!!this.qp[t]},QYt:function(t,i,n){i?this.qp[t]=1:delete this.qp[t],R(n)||delete this.qp[n]},YYt:function(t,i){i?R(t.fieldsModel)||(this.BQt[t.fieldsModel.getName()]=t.fieldsModel,this.fMt.cut[t.fieldsModel.L]=t.pivotCache):(delete this.BQt[t.fieldsModelName],delete this.fMt.cut[t.pivotCacheName])},fJt:function(t){var i;return this.fMt.hasPivotCache(t)?this.fJt(t+="1"):t},hJt:function(t){for(var i,n,e,r,o,o,i=this,n=[],e=0,r=Object.keys(i.BQt);e<r.length;e++)o=r[e],(o=i.BQt[o]).L===t&&(0,x.o)(o.z,function(t){if(t instanceof A.PivotTable)return n.push(t.getName()),!0});return n},JYt:function(t){var i,n,e,r,o,a,s,c,c,u,l,f,h,v,d,p,e,m,i=this,n=i.BQt,e=n[t];if(!R(e)){for(r=e.L,a=0,s=o=i.sheets;a<s.length;a++)if(c=(c=s[a]).pivotTables&&c.pivotTables.PYt,!R(c)&&0<c.length)for(u=0,l=c;u<l.length;u++)if((f=l[u])._fieldModel&&f._fieldModel.Zc===t)return;for(v=0,d=h=Object.keys(n);v<d.length;v++)if((p=d[v])!==t&&n[p].L===r)return;return e=n[t],m=i.fMt.cut[r],delete n[t],delete i.fMt.cut[r],{fieldsModel:e,pivotCache:m}}},VYt:function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,u;if(t=this.fJt(t),n=null,e="",r=L+t,"string"==typeof i)try{(o=D.formulaToExpression((0,S.jf)(this),i,0,0)).abt?(a=(u=o.abt).range&&u.range()||u.dataRange&&u.dataRange(),s=u.Mf.name(),c=e=u.name(),R(this.vJt(r))||this.dJt(r),this.zwt(this.lJt,r,"="+i,null,null,!0,null)):(o=D.formulaToRanges((0,S.jf)(this),i,0,0,!1))[0]&&o[0].ranges&&(s=o[0].sheetName,a=o[0].ranges[0],e=-1!==i.indexOf("!")?i:s+"!"+i,R(this.vJt(r))||this.dJt(r),this.zwt(this.lJt,r,e,null,null,!0,null)),l=(0,S._f)(this,s),f=new S.Range(-1===a.row?0:a.row,-1===a.col?0:a.col,-1===a.rowCount?l.getRowCount():a.rowCount,-1===a.colCount?l.getColumnCount():a.colCount),h=l.NMi,R(h)||(n=K(h,f)),v=l.getArray(f.row,f.col,f.rowCount,f.colCount),(n=R(n)?v:n.concat(v))||(0,I.throwError)(_().SourceError)}catch(t){(0,I.throwError)(_().SourceNotIsTableNameOrFormula)}else P(i)&&P(i[0])?n=i:(0,I.throwError)(_().SourceNotIsTableNameOrFormula);for(n.length<2&&(0,I.throwError)(_().SourceDataOnlyOne),d=[],p=n[0],m=n.slice(1),b={},w=0,y=p.length;w<y;w++)C=this.pJt(m,w),b[g=(0,N.dz)(b,p[w])]=!0,d.push({name:g,dataType:C,index:w});return(u=new x.PivotCache(t,d,m,i)).EYt=e,R(s)||(u.sheet=s),R(c)||(u.sourceName=c),this.fMt.addPivotCache(u),u},pJt:function(t,i){for(var n,e,r,o,n=!1,e=0;e<t.length;){if("number"==(o=typeof(r=t[e])[i]))return 0;if("object"==o&&r[i]instanceof Date)return 2;if("string"==o)return 1;e+=1}return 5},kx:function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,e=null,r=this,o=L+t;if("string"==typeof t){a=void 0;try{if(!r.mJt(t,n))return;if(a=(a=r.vJt(o))?a.getExpression():null,s={},c=void 0,a&&(c=a.source&&a.source.Mf,a.abt?s=(u=a.abt).range&&u.range()||u.dataRange&&u.dataRange():(s.row=a.row,s.col=a.column,s.rowCount=a.endRow-a.row+1,s.colCount=a.endColumn-a.column+1,s.row<0&&(s.row=0,s.rowCount=c?c.getRowCount():s.rowCount),s.colCount<0&&(s.col=0,s.colCount=c?c.getColumnCount():s.colCount)),l=c.NMi,R(l)||(e=K(l,s)),f=c.getArray(s.row,s.col,s.rowCount,s.colCount),e=R(e)?f:e.concat(f)),!e||e.length<2)return}catch(t){return}for(h=[],v=e[0],d=e.slice(1),p={},b=0,g=v.length;b<g;b++)w=r.pJt(d,b),p[m=(0,N.dz)(p,v[b])]=!0,h.push({name:m,dataType:w,index:b});i.ln(h,d),r.bJt(i.Zc)}},bJt:function(t){var i,n,e,i,n=this.BQt;for(e in n)o(n,e)&&n[e].L===t&&n[e].LS()},GYt:function(t){return this.fMt.gJt(t)},mJt:function(t,n){var e,i,r,o,e=this,i=this.BQt,r=Object.keys(i).map(function(t){return i[t]}),o=!0;return(0,x.o)(r,function(i){o&&i.Zc!==n&&i.L===t&&(0,x.o)(e.sheets,function(t){o&&t.options.isProtected&&t.pivotTables.get(i.Zc)&&(t.jT(10,_().PivotTableErrorMessage_Protect),o=!1)})}),o},vJt:function(t){return t?this.lJt[n.Common.zf.Gmt(t)]:void 0},wJt:function(){var n=[];return a.each(this.bp,function(t,i){n.push(i)}),n},dJt:function(t){var i;t&&(delete this.lJt[n.Common.zf.Gmt(t)],(i={})[t]=t,this.Zwt(i,!1))},ok:function(){var t,i,n,e,t,i=this.BQt;for(e in i)o(i,e)&&(n=i[e])&&n.JVt()},wQt:function(t){var i,n,n,e,i=this.sheets;if(i)for(e=0;e<i.length;e++)if((n=i[e].pivotTables)&&(n=n.get(t)))return n;return d},getPivotCaches:function(){var t,i,t,i={};return S.Workbook.fh.find(function(t){return"pivotTable"===t.name}).toJson.call(this,i),i},getPivotCacheByName:function(t){return this.fMt.getPivotCacheByName(t)},cJt:function(){var t=this;t.fMt=new x.PivotEngine,t.BQt={},t.qp={},t.lJt={}}}),a.extend(S.Y8.prototype,{yJt:function(t){var i=this.CJt;return!i||!i[t]},WYt:function(t,i){var n,e,n,n=this,e=n.G8;e&&n.yJt(t.Zc)&&((n=e.pivotTableChanges)?delete n.isRestored:n=e.pivotTableChanges=[],n.push({pivotObj:t,value:i}))},TVt:function(t,i){var n,e,r,n,e=this.G8;e&&((r=e.pivotTableChanges)?delete r.isRestored:r=e.pivotTableChanges=[],r.push({pivotObj:t,value:i}))},IJt:function(t){for(var i,n,e,r,o,i={},n=t.length-1;0<=n;n--)(e=t[n]).pivotObj instanceof A.PivotTable&&!i[e.pivotObj.name()]&&(i[e.pivotObj.name()]=e.pivotObj);for(r in i)i.hasOwnProperty(r)&&(o=i[r]).suspendLayout();return i},AJt:function(t){var i,n;for(i in t)t.hasOwnProperty(i)&&(n=t[i]).resumeLayout()},NJt:function(t){for(var i,n,e,i=this.Mf.pivotTables,n=t.length-1;0<=n;n--)e=t[n],i.AP(e)},applyPivotTableChange:function(t,i){var n,e,n=t.value.type,e=this.Mf.pivotTables;i?"add"===n?e.get(t.pivotObj.name)||q(this.Mf,t.pivotObj):"remove"===n&&e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"add"===n?e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"remove"!==n||e.get(t.pivotObj.name)||q(this.Mf,t.pivotObj),this.applyPivotTableFieldChange(t,i)},applyPivotTableFieldChange:function(t,i){var n,e,n,e=this.Mf.pivotTables.get(t.pivotObj.name);e&&e.dh.fromJson(t.pivotObj,e)},TJt:function(t,i){var t,n,e,t=t,n=t.value.type,e=this.Mf.pivotTables;"add"!==n&&"remove"!==n||(e.AP(t),t.value.isMove)?t.pivotObj.AP(t.value):"add"===n&&i[t.pivotObj.name()]&&delete i[t.pivotObj.name()]},MJt:function(t){t.pivotObj.AP(t.value),R(t.pivotObj.copyFieldsModel)&&(t.pivotObj.copyFieldsModel=t.pivotObj.clone())}}),S.Y8.ch("PivotTable",{priority:8e3,getValue:function(t){var i,n,e,r,o,e,o,r,i=t.row,n=t.col,e=t.sheetArea,r=this.Mf,o=r.pivotTables.PYt;3===e&&o&&0<o.length&&(o=(e=r.aJt(i,n)).inPivot,r=e.value,o)&&(t.isValueGet=!0,t.value=r)},setValue:function(t){var i,n,e,r,o,a,e,o,s,o,s,o,c,i=t.row,n=t.col,e=t.sheetArea,r=t.value,o=this.Mf,a=o.parent&&o.parent.Gie;3===e&&(e=o.pivotTables.findPivotTable(i,n))&&(s=(o=e.getRange()).page,o=o.content,s&&s.contains(i,n)||o&&o.contains(i,n))&&(s=!0,a?e.Kbt(i,n,r):e.options.enableDataValueEditing&&e.rJt(i,n)&&(o=e.getNodeInfo(i,n),s=!!(c=e.setNodeValue(o,r))),t.isValueSet=s)},applyChanges:function(t){var n,i,t,e,r,o,a,n=this,i=t.changes,t=t.isUndo;if(i&&(e=i.pivotTableChanges)){if(r={},t)for(o=e.length-1;0<=o;o--)r[e[o].pivotObj.name]=1,0===e[o].value.pivotType?n.applyPivotTableChange(e[o],!1):n.applyPivotTableFieldChange(e[o],!1);else for(o=0;o<e.length;o++)r[e[o].pivotObj.name]=1,0===e[o].value.pivotType?n.applyPivotTableChange(e[o],!0):n.applyPivotTableFieldChange(e[o],!0);(a=Object.keys(r)).forEach(function(t){var i,t,i,t=n.Mf.pivotTables.get(t);t&&t.refresh()})}},undo:function(t){var i,n,e,r,o,t,a,s,c,u,i=this;if(i.CJt={},n=t.pivotTableChanges,i.Mf.pivotTables.xJt=!0,e={},n&&!n.isRestored){for(r=i.IJt(n),o=n.length-1;0<=o;o--)0===n[o].value.pivotType?i.TJt(n[o],r):(i.MJt(n[o]),e[n[o].pivotObj.Zc]=1);if(i.AJt(r),t=Object.keys(e),a=i.Mf.parent&&i.Mf.parent.BQt,!R(a))for(s=0,c=t;s<c.length;s++)a[u=c[s]]&&a[u].q3()}i.Mf.pivotTables.xJt=!1,delete i.CJt}}),S.Worksheet.ch("PivotTable",{priority:8e3,applyEditingSetFormula:function(t){var i,n,e,r,e,o,a,o,i=t.row,n=t.col,e=t.sheetArea,r;3!==e&&e!==d||(e=this.pivotTables.findPivotTable(i,n))&&(a=(o=e.getRange()).page,o=o.content,a&&a.contains(i,n)||o&&o.contains(i,n)&&!e.options.enableDataValueEditing)&&(t.isAllow=!1)}}),e.ConditionalFormats&&e.ConditionalFormats.ch("pivotTable",{onRuleRemoved:function(t){var i,n,e,r,o,i,n=this.pivotTables.all(),e=t.priority;if(e)for(r=0;r<n.length;r++)(o=n[r]).DJt(e)}}),r.Table&&r.Table.ch("pivotTable",{tableNameChanged:function(t){var i,n,n,i,n=this.getParent();n&&(n=n.GYt(t.oldName))&&(n.EYt=t.newName)}})},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(k,t,i){"use strict";var j,Pt,Ft,O,h,o,c,P,F,n,a,_t,Lt,s,_,u,Et,L,l,E,B,Bt,f,v,i,R,G,d,p,m,b,g,V,w,y,C,N,I,U,A,T,Q,W,e;function r(t,i,n,e,r,o,a,s,c,u){var l=this,f=arguments;h(w,function(t,i){l[i]=f[t]})}function M(){}function S(t,i){return isNaN(i)?i:new Pt.LineBorder(t,i)}function x(t,i,n,e,r,o,a,s,c,u){var l=new A;return i&&(l.backColor=i),n&&(l.foreColor=n),e&&(l.font=R),r&&(l.borderLeft=S(t,r)),o&&(l.borderTop=S(t,o)),a&&(l.borderRight=S(t,a)),s&&(l.borderBottom=S(t,s)),c&&(l.borderHorizontal=S(t,c)),u&&(l.borderVertical=S(t,u)),l}function D(t){var t,t=0===t?"Background 1":"Accent "+t;return t}function z(t){var i,n,e,e,i,i=t-1,e=_t(i/7);return 0<=e&&e<=3?((n=[Y,H,J,q][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Light"+t),n.builtInName(e)):((n=Z()).name(i="Light0"),n.builtInName(i)),n}function Z(){return new T}function Y(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",y.TEXT1+" 50"):(n=" 80",e=" 60",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(n,0,0,0,I,I,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(t,0,0,0,I,C,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(t,0,0,0,I,C,I,C)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(e,n,0,0,C,C,C,C,C,C)),i[Et.FIRST_ROW_STRIPE_STYLE](x(e,n,0,0,I,C,I,C)),i[Et.HEADER_ROW_STYLE](x(t,0,0,1,I,C,I,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(n,0,0,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,0,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,0,0,1)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,0,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(t,0,0,1,I,C,I,C)),i}function H(t){var i,n,e,r,o,a,t,i=D(t);return 0===t?(n=" -15",e=" -35",o=y.TEXT1,r=y.TEXT1+" 50",a=y.COLUMN_STRIPE):(n=" 80",e=" 60",o=i+" -25",r=a=i),n=i+n,e=i+e,(t=new T)[Et.WHOLE_TABLE_STYLE](x(n,0,o,0,I,I,I,I,C)),t[Et.FIRST_COLUMN_STRIPE_STYLE](x(a,0,0,0,C,C,C,C)),t[Et.FIRST_ROW_STRIPE_STYLE](x(e,0,0,0,C,C,C,C)),t[Et.FIRST_COLUMN_STYLE](x(r,0,y.TEXT1,1,I,I,C)),t[Et.HEADER_ROW_STYLE](x(r,0,y.TEXT1,1,N,N,N,N)),t[Et.SUBTOTAL_ROW1_STYLE](x(e,n,y.TEXT1,1,I,I,I,C)),t[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,y.TEXT1,1)),t[Et.COLUMN_SUBHEADING2_STYLE](x(e,0,0,0,I,C)),t[Et.ROW_SUBHEADING1_STYLE](x(i,n,0,1,I,I,I,C)),t[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,0,1)),t[Et.GRANDTOTAL_ROW_STYLE](x(r,0,y.TEXT1,1,N,N,N,N)),t}function J(t){var i,n,e,t,r,i,i=D(t),r="Background 1 -25",t=0===t?(n=" -15",e=" -35",y.TEXT1+" 50"):(n=" 80",e=" 40",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(y.WHITE,y.WHITE)),i[Et.REPORT_FILTER_LABELS_STYLE](x(e,n,0,0,I,I,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(e,n,0,0,I,I,I,C)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(r,y.BACKGROUND_COLOR,0,0,C,I,C,I)),i[Et.FIRST_ROW_STRIPE_STYLE](x(y.BLACK,y.BACKGROUND_COLOR)),i[Et.HEADER_ROW_STYLE](x(e,n,y.TEXT1,1,I,I,I,C)),i[Et.SUBTOTAL_COLUMN1_STYLE](x(y.BLACK,r,y.TEXT1)),i[Et.SUBTOTAL_ROW1_STYLE](x(t,0,0,1,I,C,I,C)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,0,1)),i[Et.ROW_SUBHEADING1_STYLE](x(e,0,y.TEXT1,1,I,I,I,C)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(e,n,y.TEXT1,1,I,C)),i}function q(t){var i,n,e,t,r,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=y.TEXT1,y.TEXT1+" 50"):(n=" 80",e=" 60",(r=i)+" -25"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(t,0,r,0,C,C,C,C,0,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.BLACK,0,r,1)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(y.BLACK,n)),i[Et.FIRST_ROW_STRIPE_STYLE](x(t,n,0,0,I,C,I,C)),i[Et.FIRST_COLUMN_STYLE](x(y.BLACK,0,r,1)),i[Et.HEADER_ROW_STYLE](x(t,0,r,1,I,I,I,C)),i[Et.SUBTOTAL_COLUMN1_STYLE](x(e,0,r,1,C,I,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,0,r,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,r,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(t,0,r,1,I,C)),i}function K(t){var i,n,e,e,i=t-1,n=s,e=_t(i/7);return 0<=e&&e<4&&((n=[X,$,tt,it][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Medium"+t),n.builtInName(e)),n}function X(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",y.TEXT1+" 50"):(n=" 80",e=" 60",i+" -25"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(n,0,y.TEXT1,0,I,I,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(n,0,0,0,I,C,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(n,0,0,0,I,C,I,C)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(t,0,0,0,C,I,C)),i[Et.FIRST_ROW_STRIPE_STYLE](x(t,0,0,0,I,C,I,C,C)),i[Et.HEADER_ROW_STYLE](x(t,t,y.WHITE,0,I,I,I,I,C)),i[Et.FIRST_HEADER_CELL_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,e,y.WHITE,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,y.BACKGROUND_COLOR,y.TEXT1,1)),i[Et.COLUMN_SUBHEADING1_STYLE](x(n,0,0,0,I,I,I,C)),i[Et.ROW_SUBHEADING1_STYLE](x(n,e,y.WHITE,0,I,I,I,C,C)),i[Et.ROW_SUBHEADING2_STYLE](x(n,n,0,0,I,I,I,C)),i[Et.GRANDTOTAL_ROW_STYLE](x(t,0,y.TEXT1,1,I,U)),i}function $(t){var i,n,e,r,o,a,t,i,i=D(t),t=0===t?(n=" -15",e=y.TEXT1+" 50",r=i+" -25",o=N,a=y.TEXT1,y.TEXT1+" 50"):(n=" 80",r=i+" 60",o=C,a=e=i+" -25",i),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(y.BLACK,0,y.TEXT1)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.BLACK,n)),i[Et.REPORT_FILTER_VALUES_STYLE](x(y.BLACK,n)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(n,0,0,0,o,I,o)),i[Et.FIRST_ROW_STRIPE_STYLE](x(r,0,0,0,I,C,I,C,C)),i[Et.HEADER_ROW_STYLE](x(e,t,y.WHITE,1,I,o)),i[Et.SUBTOTAL_COLUMN1_STYLE](x(r,0,y.TEXT1,1,o,o,o,o)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,r,y.TEXT1,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,n,y.TEXT1,1)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(a,0,y.TEXT1,1,I,C,I,N)),i}function tt(t){var i,n,e,r,o,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=y.TEXT1+" 50",o=i+" -5",i+" -25"):(o=i+(n=" 80"),i+(e=" 60")),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(n,o,y.TEXT1,0,C,I,C,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.TEXT1,0,0,0,I,C,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(y.TEXT1,0,y.BLACK,0,I,C,I,C)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(t,n,0,0,C,I,C)),i[Et.FIRST_ROW_STRIPE_STYLE](x(t,n,0,0,I,C,I,C)),i[Et.HEADER_ROW_STYLE](x(y.BLACK,y.TEXT1,y.WHITE)),i[Et.SUBTOTAL_COLUMN1_STYLE](x(e,t,y.TEXT1,0,C,C,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(t,0,y.TEXT1,1,I,I,I,C)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,r,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,r,1)),i[Et.ROW_SUBHEADING3_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.BLACK,y.TEXT1,y.WHITE)),i}function it(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=y.TEXT1+" 50",i+" -25"):(n=" 80",e=i+" -25",i+" 60"),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(y.WHITE,n,e,0,I,I,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.BLACK,t,e,1)),i[Et.REPORT_FILTER_VALUES_STYLE](x(y.BLACK,n,e,1)),i[Et.SECOND_COLUMN_STRIPE_STYLE](x(y.BLACK,t,0)),i[Et.SECOND_ROW_STRIPE_STYLE](x(y.BLACK,t)),i[Et.FIRST_COLUMN_STYLE](x(y.BLACK,t,e,1)),i[Et.HEADER_ROW_STYLE](x(y.WHITE,0,e,1,I,I,I,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.BLACK,0,e,1)),i}function nt(t){var i,n,e,e,i=t-1,n=s,e=_t(i/7);return 0<=e&&e<4&&((n=[et,rt,ot,at][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Dark"+t),n.builtInName(e)),n}function et(t){var i,n,e,r,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=y.TEXT1+" 50",i+" -25"):(n=" 80",e=" 40",r=i+" -50",i+" 60"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(n,t,y.TEXT1,0,I,I,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(r,r,y.WHITE,1,I,I,I,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(r,r,y.WHITE,0,I,I,I,I,C)),i[Et.SECOND_COLUMN_STRIPE_STYLE](x(n,0,0,0,C,I,C)),i[Et.SECOND_ROW_STRIPE_STYLE](x(y.BLACK,e)),i[Et.HEADER_ROW_STYLE](x(y.WHITE,r,y.WHITE,1,I,I,I,C,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(e,0,y.TEXT1,1,I,I,I,C)),i[Et.ROW_SUBHEADING1_STYLE](x(e,n,y.TEXT1,1,I,C,I,C)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.BLACK,r,y.WHITE,1)),i}function rt(t){var i,n,e,t,r,i,i=D(t),r=y.TEXT1+" -25",t=0===t?(n=" -15",e=y.TEXT1+" 50",i+" -25"):(n=" 80",i+" 60"),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(e,n,y.TEXT1,0,N,N,N,N)),i[Et.REPORT_FILTER_LABELS_STYLE](x(e,0,0,0,C,C,I,C)),i[Et.REPORT_FILTER_VALUES_STYLE](x(e,0,0,0,I,C,C,C)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(y.COLUMN_STRIPE,0,0,0,C,I,C)),i[Et.SECOND_COLUMN_STRIPE_STYLE](x(y.COLUMN_STRIPE,0,0,0,C,I,C)),i[Et.SECOND_ROW_STRIPE_STYLE](x(t,0,0,0,I,C,I,C)),i[Et.HEADER_ROW_STYLE](x(y.BLACK,r,y.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,t,y.TEXT1,1)),i[Et.COLUMN_SUBHEADING2_STYLE](x(t,0,0,0,I,C)),i[Et.COLUMN_SUBHEADING3_STYLE](x(t,0,0,0,I,C)),i[Et.ROW_SUBHEADING1_STYLE](x(n,t,y.TEXT1,1,I,I,I,C)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,y.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.BLACK,r,y.WHITE,1)),i}function ot(t){var i,n,e,r,t,o,i,i=D(t),o=i+" -25",t=0===t?(n=" -15",e=" -35",r=y.TEXT1+" 50",y.COLUMN_STRIPE):(n=" 80",e=" 60",r=i+" -25",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](x(y.BLACK,t,n)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.FIRST_COLUMN_STRIPE_STYLE](x(o,0,0,C,I,C)),i[Et.FIRST_ROW_STRIPE_STYLE](x(e,0,0,0,I,C,I,C)),i[Et.HEADER_ROW_STYLE](x(y.BLACK,y.TEXT1,y.WHITE,1)),i[Et.SUBTOTAL_COLUMN1_STYLE](x(e,r,0,0,C,C,C,C)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.COLUMN_SUBHEADING1_STYLE](x(e,0,0,0,I,I,I,C)),i[Et.ROW_SUBHEADING1_STYLE](x(r,r,y.WHITE,1,I,I,I,C)),i[Et.ROW_SUBHEADING2_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.BLACK,y.TEXT1,y.WHITE,1)),i}function at(t){var i,n,e,r,o,i,i=D(t);return 0===t?(n=" -15",e=y.TEXT1+" 50",r=i+" -50",o=y.COLUMN_STRIPE):(n=" 80",e=i+" -25",o=i+" 40",r=i),n=i+n,(i=new T)[Et.WHOLE_TABLE_STYLE](x(y.WHITE,r,n,0,I,I,I,I,I,C)),i[Et.REPORT_FILTER_LABELS_STYLE](x(y.BLACK,e,0,0)),i[Et.SECOND_COLUMN_STRIPE_STYLE](x(y.BLACK,o,0)),i[Et.SECOND_ROW_STRIPE_STYLE](x(y.BLACK,o)),i[Et.FIRST_COLUMN_STYLE](x(y.BLACK,e)),i[Et.HEADER_ROW_STYLE](x(y.WHITE,e,0,0,I,I,I,N)),i[Et.FIRST_HEADER_CELL_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](x(y.BLACK,0,n,1)),i[Et.SUBTOTAL_ROW2_STYLE](x(y.BLACK,0,0===t?y.TEXT1:y.WHITE,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.ROW_SUBHEADING1_STYLE](x(y.BLACK,0,y.WHITE,1)),i[Et.GRANDTOTAL_ROW_STYLE](x(y.WHITE,0,y.WHITE,1,I,N)),i}function st(){}function ct(){e.light0=z(0);for(var t=1;t<=28;t++)e["light"+t]=z(t),e["medium"+t]=K(t),e["dark"+t]=nt(t)}function ut(e,r){e.name(r.name()),h(f,function(t,i){e[i](r[i]())}),h(l,function(t,i){var n=r[i]();e[i](n?n.Gf():s)}),e.builtInName(r.builtInName(),!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.PivotTableThemes=t.PivotTableTheme=t.PivotTableStyle=void 0,j=i("Common"),Pt=i("Core"),Ft=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),O=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),h=Pt.GC$.each,o=Pt.GC$.isEmptyObject,c=Pt.mt.T1,P=JSON.stringify,F=JSON.parse,n=Pt.mt.p0,a=j.Common.lt.ht,_t=Math.floor,s=null,_=Pt.util.go,u=Pt.NodeHelper.sr,L={wholeTable:"wholeTableStyle",pageFieldLabels:"reportFilterLabelsStyle",pageFieldValues:"reportFilterValuesStyle",firstRowStripe:"firstRowStripeStyle",secondRowStripe:"secondRowStripeStyle",firstColumnStripe:"firstColumnStripeStyle",secondColumnStripe:"secondColumnStripeStyle",firstColumn:"firstColumnStyle",headerRow:"headerRowStyle",firstHeaderCell:"firstHeaderCellStyle",firstSubtotalColumn:"subtotalColumn1Style",secondSubtotalColumn:"subtotalColumn2Style",thirdSubtotalColumn:"subtotalColumn3Style",blankRow:"blankRowStyle",firstSubtotalRow:"subtotalRow1Style",secondSubtotalRow:"subtotalRow2Style",thirdSubtotalRow:"subtotalRow3Style",firstColumnSubheading:"columnSubheading1Style",secondColumnSubheading:"columnSubheading2Style",thirdColumnSubheading:"columnSubheading3Style",firstRowSubheading:"rowSubheading1Style",secondRowSubheading:"rowSubheading2Style",thirdRowSubheading:"rowSubheading3Style",lastColumn:"grandTotalColumnStyle",totalRow:"grandTotalRowStyle"},l=[(Et={WHOLE_TABLE_STYLE:"wholeTableStyle",REPORT_FILTER_LABELS_STYLE:"reportFilterLabelsStyle",REPORT_FILTER_VALUES_STYLE:"reportFilterValuesStyle",FIRST_COLUMN_STRIPE_STYLE:"firstColumnStripeStyle",SECOND_COLUMN_STRIPE_STYLE:"secondColumnStripeStyle",FIRST_ROW_STRIPE_STYLE:"firstRowStripeStyle",SECOND_ROW_STRIPE_STYLE:"secondRowStripeStyle",FIRST_COLUMN_STYLE:"firstColumnStyle",HEADER_ROW_STYLE:"headerRowStyle",FIRST_HEADER_CELL_STYLE:"firstHeaderCellStyle",SUBTOTAL_COLUMN1_STYLE:"subtotalColumn1Style",SUBTOTAL_COLUMN2_STYLE:"subtotalColumn2Style",SUBTOTAL_COLUMN3_STYLE:"subtotalColumn3Style",BLANK_ROW_STYLE:"blankRowStyle",SUBTOTAL_ROW1_STYLE:"subtotalRow1Style",SUBTOTAL_ROW2_STYLE:"subtotalRow2Style",SUBTOTAL_ROW3_STYLE:"subtotalRow3Style",COLUMN_SUBHEADING1_STYLE:"columnSubheading1Style",COLUMN_SUBHEADING2_STYLE:"columnSubheading2Style",COLUMN_SUBHEADING3_STYLE:"columnSubheading3Style",ROW_SUBHEADING1_STYLE:"rowSubheading1Style",ROW_SUBHEADING2_STYLE:"rowSubheading2Style",ROW_SUBHEADING3_STYLE:"rowSubheading3Style",GRANDTOTAL_COLUMN_STYLE:"grandTotalColumnStyle",GRANDTOTAL_ROW_STYLE:"grandTotalRowStyle"}).WHOLE_TABLE_STYLE,Et.REPORT_FILTER_LABELS_STYLE,Et.REPORT_FILTER_VALUES_STYLE,Et.FIRST_COLUMN_STRIPE_STYLE,Et.SECOND_COLUMN_STRIPE_STYLE,Et.FIRST_ROW_STRIPE_STYLE,Et.SECOND_ROW_STRIPE_STYLE,Et.FIRST_COLUMN_STYLE,Et.HEADER_ROW_STYLE,Et.FIRST_HEADER_CELL_STYLE,Et.SUBTOTAL_COLUMN1_STYLE,Et.SUBTOTAL_COLUMN2_STYLE,Et.SUBTOTAL_COLUMN3_STYLE,Et.BLANK_ROW_STYLE,Et.SUBTOTAL_ROW1_STYLE,Et.SUBTOTAL_ROW2_STYLE,Et.SUBTOTAL_ROW3_STYLE,Et.COLUMN_SUBHEADING1_STYLE,Et.COLUMN_SUBHEADING2_STYLE,Et.COLUMN_SUBHEADING3_STYLE,Et.ROW_SUBHEADING1_STYLE,Et.ROW_SUBHEADING2_STYLE,Et.ROW_SUBHEADING3_STYLE,Et.GRANDTOTAL_COLUMN_STYLE,Et.GRANDTOTAL_ROW_STYLE],B=!(E=!(Lt=void 0)),f=[(Bt={FIRST_ROW_STRIP_SIZE:"firstRowStripSize",SECOND_ROW_STRIP_SIZE:"secondRowStripSize",FIRST_COLUMN_STRIP_SIZE:"firstColumnStripSize",SECOND_COLUMN_STRIP_SIZE:"secondColumnStripSize"}).FIRST_ROW_STRIP_SIZE,Bt.SECOND_ROW_STRIP_SIZE,Bt.FIRST_COLUMN_STRIP_SIZE,Bt.SECOND_COLUMN_STRIP_SIZE],v={firstColumnStripeStyle:Bt.FIRST_COLUMN_STRIP_SIZE,firstRowStripeStyle:Bt.FIRST_ROW_STRIP_SIZE,secondColumnStripeStyle:Bt.SECOND_COLUMN_STRIP_SIZE,secondRowStripeStyle:Bt.SECOND_ROW_STRIP_SIZE},i="name",R="bold 11pt calibri",w=["backColor","foreColor","font",d="borderLeft",p="borderTop",m="borderRight",b="borderBottom",g="borderHorizontal",V="borderVertical","textDecoration"],y={TEXT1:"Text 1",BLACK:"rgb(0,0,0)",COLUMN_STRIPE:"rgb(140,140,140)",WHITE:"rgb(255,255,255)",BACKGROUND_COLOR:"Background 1 -15"},C=Pt.LineStyle.thin,N=Pt.LineStyle.medium,I=Pt.LineStyle.empty,U=Pt.LineStyle.double,r.prototype.h5=function(n,e,r,o,a){var s=this;h(w,function(t,i){0<=i.indexOf("border")?(r&&c(s[d])&&(n[d]=s[d]),e&&c(s[p])&&(n[p]=s[p]),!o&&c(s[g])&&(n[b]=s[g]),!a&&c(s[V])&&(n[m]=s[V]),a&&c(s[m])&&(n[m]=s[m]),o&&c(s[b])&&(n[b]=s[b])):c(s[i])&&(n[i]=s[i])})},r.prototype.Gf=function(){var t,i,t=new r,i=P(this.toJSON());return t.fromJSON(F(i)),t},r.prototype.toJSON=function(){var e,r,e=this,r={};return h(w,function(t,i){var n,n,n=e[i],n=n&&n.toJSON?n.toJSON():n;r[i]=o(n)?Lt:n}),r},r.prototype.fromJSON=function(r,o){var a;r&&(a=this,h(w,function(t,i){var n,e,n=r[i];c(n)&&(0<=i.indexOf("border")?((e=new Pt.LineBorder).fromJSON(n,o),a[i]=e):a[i]=n)}))},A=r,t.PivotTableStyle=A,M.prototype.h5=function(t,i,L,n){var e,E,r,B,o,R,G,V,U,Q,W,z,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ct,ut,lt,a,ft,ht,s,c,u,l,f,h,v,d,vt,p,m,v,b,g,dt,pt,mt,bt,w,gt,wt,yt,y,C,Ct,yt,N,I,A,T,M,S,Nt,x,D,s,k,S,T,r,s,A,r,T,S,r,j,O,It,At,M,P,F,Tt,Mt,St,xt,O,_,D,Dt,k,B,kt,s,T,S,o,jt,Ot,e=this;if(!n.Oy||!n.Oy()){if(E=n.Ti,r=e[Et.WHOLE_TABLE_STYLE](),B=e[Et.REPORT_FILTER_LABELS_STYLE](),o=e[Et.REPORT_FILTER_VALUES_STYLE](),R=e[Et.FIRST_COLUMN_STRIPE_STYLE](),G=e[Et.SECOND_COLUMN_STRIPE_STYLE](),V=e[Et.FIRST_ROW_STRIPE_STYLE](),U=e[Et.SECOND_ROW_STRIPE_STYLE](),Q=e[Et.FIRST_COLUMN_STYLE](),W=e[Et.HEADER_ROW_STYLE](),z=e[Et.FIRST_HEADER_CELL_STYLE](),Z=e[Et.SUBTOTAL_COLUMN1_STYLE](),Y=e[Et.SUBTOTAL_COLUMN2_STYLE](),H=e[Et.SUBTOTAL_COLUMN3_STYLE](),J=e[Et.BLANK_ROW_STYLE](),q=e[Et.SUBTOTAL_ROW1_STYLE](),K=e[Et.SUBTOTAL_ROW2_STYLE](),X=e[Et.SUBTOTAL_ROW3_STYLE](),$=e[Et.COLUMN_SUBHEADING1_STYLE](),tt=e[Et.COLUMN_SUBHEADING2_STYLE](),it=e[Et.COLUMN_SUBHEADING3_STYLE](),nt=e[Et.ROW_SUBHEADING1_STYLE](),et=e[Et.ROW_SUBHEADING2_STYLE](),rt=e[Et.ROW_SUBHEADING3_STYLE](),ot=e[Et.GRANDTOTAL_COLUMN_STYLE](),at=e[Et.GRANDTOTAL_ROW_STYLE](),st=e[Bt.FIRST_COLUMN_STRIP_SIZE](),ct=e[Bt.SECOND_COLUMN_STRIP_SIZE](),ut=e[Bt.FIRST_ROW_STRIP_SIZE](),lt=e[Bt.SECOND_ROW_STRIP_SIZE](),a=n.options.showRowHeader,ft=n.options.showColumnHeader,ht=n.options.insertBlankLineAfterEachItem,s=n.getRange().content,c=n.layoutType(),u=t-s.row,l=i-s.col,f=t-n.LYt.row,h=i-n.LYt.col,d=(v=n.rZt.HWt)[0],vt=v[1],p=v[2],m=v[3],b=u==(v=v[4]).DQ+v.Sx-1,g=l==s.colCount-1,dt=u===p.DQ,pt=u==p.DQ+p.Sx-1,mt=u===v.DQ,bt=0==l,w=l===m.jN,gt=l==m.jN+m.Tx-1,wt=m.zWt,yt=m.DQ,y=p.WWt,C=p.DQ,yt=u-yt,N=l-(Ct=p.jN),I=new Pt.Style,M=(T=new Pt.Range(n.LYt.row,n.LYt.col,n.LYt.rowCount,n.LYt.colCount)).contains(t,i),S=s.contains(t,i),r&&(Nt=t===s.row&&S||t===T.row&&M,x=t===s.row+s.rowCount-1&&S||t===T.row+T.rowCount-1&&M,D=i===s.col&&S||i===T.col&&M,s=i===T.col+s.colCount-1&&S||i===T.col+T.colCount-1&&M,M&&(h-d.jN)%3!=2&&(k=d.dataTable,x||D||k[1+f]&&k[1+f][h]===Lt&&(x=!0),s||Nt||k[f]&&k[f][1+h]===Lt&&(s=!0)),r.h5(I,Nt,D,x,s)),d.getRange().contains(f,h)&&(Nt=0==f,D=0==h,x=f==d.Sx-1,S=n.dh.nw(0).length,T=n.options.reportFilterFieldsPerColumn,r=n.options.displayFieldsInPageFilterArea,A=s=void 0,A=0===T?0===r?(s=S,0):(s=0,3*S):(s=_t(S/T),3*(S%n.options.reportFilterFieldsPerColumn-1)),T=t-(r=n.getRange().page).row,S=i-r.col,M&&(h-d.jN)%3!=2&&(k=d.dataTable,x||D||k[1+f][h]===Lt&&(x=!0)),(h-d.jN)%3==0?B&&(s===T&&A<S?I=new Pt.Style:B.h5(I,Nt,!0,x,!0)):(h-d.jN)%3==1?o&&(s===T&&A<S-1?I=new Pt.Style:o.h5(I,Nt,!0,x,!0)):I=new Pt.Style,A=d.ML(f,h)),r=new Pt.Range(v.DQ,v.jN,m.Sx,p.Tx),p.getRange().contains(u,l)||r.contains(u,l)){if(p.getRange().contains(u,l))ft&&(W&&W.h5(I,dt,w,pt,g),y[N]&&0!==y[N].grandTotalLevel&&$&&(O=(j=C+1)<u,u===j&&$.h5(I,!0,bt,!0,g),O)&&2===y[N].grandTotalLevel&&$.h5(I,!0,!0,!0,!0),y[N]&&0!==y[N].grandTotalLevel&&tt&&(O=(It=C+2)<u,u===It&&tt.h5(I,!0,bt,!0,g),O)&&3===y[N].grandTotalLevel&&tt.h5(I,!0,!0,!0,!0),y[N])&&0!==y[N].grandTotalLevel&&it&&(O=(At=C+3)<u,u===At&&it.h5(I,!0,bt,!0,g),O)&&4===y[N].grandTotalLevel&&it.h5(I,!0,!0,!0,!0),A=p.ML(u-p.DQ,l-p.jN);else if(M=u-v.DQ,Mt=Tt=F=P=void 0,n.options.bandColumns&&wt[M]&&0!==wt[M].grandTotalLevel&&0<(P=st+ct)){if((F=n.zSt[i])===Lt){if(St=0,E)for(xt=v.jN;xt<l;xt++)0<+E.getColumnWidth(xt)&&St++;F=n.zSt[i]=St%P}F<st&&R?R.h5(I,mt,Tt=0===F,b,Mt=g||F===st-1):st<=F&&G&&G.h5(I,mt,Tt=F===st,b,Mt=g||F===P-1)}_=(O=y[N])&&O.grandTotalLevel%3,D=n.NZt,Z&&(j=C+1,O)&&O.isSubtotal&&O.collapseIndex===Lt&&1===_&&j<=u&&1<D&&Z.h5(I,Dt=u===j,!0,b,!0),Y&&(It=C+2,O)&&O.isSubtotal&&O.collapseIndex===Lt&&2===_&&It<=u&&2<D&&Y.h5(I,Dt=u===It,!0,b,!0),H&&(At=C+3,O)&&O.isSubtotal&&O.collapseIndex===Lt&&0===_&&At<=u&&3<D&&H.h5(I,Dt=u===At,!0,b,!0)}if((k=m.getRange().contains(u,l))||r.contains(u,l)){if(k&&(Q&&a&&(Dt=u===vt.DQ,B=l===m.jN,kt=u==vt.Sx+m.Sx-1,s=l==m.Tx-1,Q.h5(I,Dt,B,kt,s)),A=m.ML(u-m.DQ,l-m.jN)),Mt=Tt=F=P=void 0,T=wt[yt],O=y[N],_=T&&T.grandTotalLevel%3,S=T&&T.rowHeaderLevel%3,o=n.AZt,n.options&&n.options.bandRows&&T&&0!==_&&(!O||!O.isSubtotal&&!O.isGrandTotal)&&0<(P=ut+lt)){if((F=n.HSt[t])===Lt){if(jt=0,E)for(Ot=v.DQ;Ot<u;Ot++)0<+E.getRowHeight(Ot)&&jt++;F=n.HSt[t]=jt%P}F<ut&&V?V.h5(I,Tt=0===F,w,Mt=b||F===ut-1,g):ut<=F&&U&&U.h5(I,Tt=F===ut,w,Mt=b||F===P-1,g)}q&&T&&1===_&&T.isSubtotal&&T.collapseIndex===Lt&&(-1<l||c===Ft.PivotTableLayoutType.compact)&&1<o&&q.h5(I,!0,w,!0,g),K&&T&&2===_&&T.isSubtotal&&T.collapseIndex===Lt&&(0<l||c===Ft.PivotTableLayoutType.compact)&&2<o&&K.h5(I,!0,w,!0,g),X&&T&&0===_&&T.isSubtotal&&T.collapseIndex===Lt&&(1<l||c===Ft.PivotTableLayoutType.compact)&&3<o&&X.h5(I,!0,w,!0,g),T&&nt&&a&&1<o&&!(T.isSubtotal&&(_<2||S<2)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(c!==Ft.PivotTableLayoutType.tabular&&1===T.rowHeaderLevel&&!T.isValueFieldDim||c===Ft.PivotTableLayoutType.tabular&&0==l)||c===Ft.PivotTableLayoutType.outline&&l<0||nt.h5(I,mt,w,b,gt)),T&&et&&a&&2<o&&!(T.isSubtotal&&(_<3||S<3)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(c!==Ft.PivotTableLayoutType.tabular&&2===T.rowHeaderLevel&&!T.isValueFieldDim||c===Ft.PivotTableLayoutType.tabular&&1==l)||c===Ft.PivotTableLayoutType.outline&&l<1||et.h5(I,mt,w,b,gt)),T&&rt&&a&&3<o&&!(T.isSubtotal&&(_<1||S<1)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(c!==Ft.PivotTableLayoutType.tabular&&3===T.rowHeaderLevel&&!T.isValueFieldDim||c===Ft.PivotTableLayoutType.tabular&&2==l)||c===Ft.PivotTableLayoutType.outline&&l<2||rt.h5(I,mt,w,b,gt)),ht&&J&&T&&T.isBlankRow&&J.h5(I,!0,w,!0,g)}ot&&(j=C+1,y[N])&&0===y[N].grandTotalLevel&&ot.h5(I,u===j,!0,b,!0),at&&wt[yt]&&0===wt[yt].grandTotalLevel&&at.h5(I,!0,w,!0,g),vt.getRange().contains(u,l)&&(Q&&a&&Q.h5(I,dt,w,b,gt),W&&ft&&W.h5(I,dt,w,pt,g),z&&ft&&a&&(kt=u==vt.getRange().rowCount-1,z.h5(I,dt,w,kt,gt)),A=vt.ML(u,l)),e.P5t(L,I,A)}},M.prototype.P5t=function(t,i,n){var t=t=a(t)?{}:t,e=20,r,r,r,r;a(t.backColor)&&(t.backColor=i.backColor),t.foreColor===Lt&&(t.foreColor=i.foreColor),a(t.themeFont)&&a(t.font)?(t.themeFont=i.themeFont,t.font=i.font):a(t.themeFont)||a(i.font)||(t.font=i.font),a(t.borderLeft)&&(r=i.borderLeft,t.borderLeft=r&&r.Gf()||r,t.borderLeft)&&(t.borderLeft.level=20),a(t.borderTop)&&(r=i.borderTop,t.borderTop=r&&r.Gf()||r,t.borderTop)&&(t.borderTop.level=20),a(t.borderRight)&&(r=i.borderRight,t.borderRight=r&&r.Gf()||r,t.borderRight)&&(t.borderRight.level=20),a(t.borderBottom)&&(r=i.borderBottom,t.borderBottom=r&&r.Gf()||r,t.borderBottom)&&(t.borderBottom.level=20),a(t.textDecoration)&&(t.textDecoration=i.textDecoration),a(t.cellType)&&(t.cellType=i.cellType),a(t.formatter)&&(t.formatter=i.formatter),a(n)||(a(t.cellButtons)&&!a(n.cellButtons)&&(t.cellButtons=n.cellButtons),a(t.textIndent)&&!a(n.textIndent)&&(t.textIndent=n.textIndent),a(t.cellPadding)&&!a(n.cellPadding)&&(t.cellPadding=n.cellPadding))},M.prototype.toJSON=function(){var n,t,e,r,n=this,t=n.builtInName();return t?{buildInName:t}:(e={name:n.name()},h(l,function(t,i){(r=n[i]())&&(e[i]=r.toJSON())}),h(f,function(t,i){1!==(r=n[i]())&&(e[i]=r)}),o(e)?Lt:e)},M.prototype.wh=function(e){var r=this,o,a=[];if(h(l,function(t,i){var n;((o=r[i]())||v[i])&&(n={n_:"tableStyleElement",type:Pt.SJSStylePropsToStyleProps[i]},o&&(n.dxfId=e.getDxfIndex(o)),v[i]&&1!==v[i]&&(n.size=r[v[i]]()),a.push(n))}),0<a.length)return a},M.prototype.fromJSON=function(r,o){var a,t,t;r&&(a=this,(t=r.buildInName)?ut(a,e[t.toLowerCase()]):(t=r.name,c(t)&&a.name(t,!1),h(f,function(t,i){var n=r[i]!==Lt?r[i]:r["_"+i];n&&a[i](n,!1)}),h(l,function(t,i){var n,e,n=r[i]!==Lt?r[i]:r["_"+i];n&&((e=new A).fromJSON(n,o),a[i](e,!1))})))},M.prototype.yh=function(t,o){var a,t,i,n,e,r,a=this;if(a.name(t.name),t=_(t,"tableStyleElement")){for(i=function(t){var i,n,t,e,r,i=u(t.dxfId,0),n=t.type,t=u(t.size,1),e=new A,r=L[n||"wholeTable"];"function"==typeof a[r]&&(o.getDxf(i,e,!0),h(w,function(t,i){0<=i.indexOf("border")&&e[i]===s&&(e[i]=new Pt.LineBorder)}),a[r](e,!1)),"firstRowStripe"!==n&&"secondRowStripe"!==n&&"firstColumnStripe"!==n&&"secondColumnStripe"!==n||a[n.substr(0,n.length-1)+"Size"](t,!1)},n=0,e=t;n<e.length;n++)i(r=e[n]);o.addPivotTableTheme(a)}},T=M,t.PivotTableTheme=T,h(l,function(t,i){T.prototype[i]=n(i)}),h(f,function(t,i){T.prototype[i]=n(i,1)}),T.prototype.name=n(i),T.prototype.builtInName=n("builtInName"),Q="white",W="black",e=st,t.PivotTableThemes=e,ct(),Pt.GC$.extend(Pt.StyleManager.prototype,{addPivotTableTheme:function(t){var i=this,n,n;(n=(n=i.SJt)||(i.SJt={}))[t.name()]=t},getPivotTableTheme:function(t){var i,n,e,r,i=this,n=i.SJt;return n=n||(i.SJt={}),O.BuiltInPivotTableThemeNames[t.toUpperCase()]?n[e=t.replace("PivotStyle","").toLowerCase()]?n[e]:(ut(r=new T,n[e]),i.addPivotTableTheme(r),r):n[t]}})},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(o,x,t){"use strict";var a,D,w,J,i,q,K,X,s,v,G,V,d,p,m,g,j,u,k,U,Q,z,I,A,O,P,T,E,t,$,M,S,B,t,b,R,tt,y,Z,t,it,Y,F,H,C,nt,et,l,rt,ot,f;function at(){for(var t,i,t={},i=1;i<=28;i++)t["PIVOTSTYLELIGHT"+i]=!0,t["PIVOTSTYLEMEDIUM"+i]=!0,t["PIVOTSTYLEDARK"+i]=!0;return t}function n(t){return t===tt?"":t}function st(t){var i="{type:"+n(t.type)+",fieldName:"+n(t.fieldName)+",offset:"+n(t.offset)+",dataLabel:"+n(lt(t))+",grandRow:"+n(t.grandRow)+",grandCol:"+n(t.grandCol)+",axis:"+n(t.axis);return t.references&&0<t.references.length&&(i+=",references:[",t.references.forEach(function(t){var t;t&&(i+="{axis:"+n(t.fieldName)+",subtotal:"+n(t.subtotal)+",offset:"+n(t.offset),(t=t.items)&&0<t.length&&(i+=",items[",t.forEach(function(t){i+=n(t)+","}),i+="]"),i+="},")}),i+="]"),i+="}"}function e(t,i){this.kJt=t,this.jJt=i,this.views=[]}function ct(t,i,n,e,r,o,a,s,c,u,l){var f,h,v,d,n,v,p,m,b,g,w,y,n,C,N,I,A,T,M,S,x,D,k,j,O,f=[],v=n.zWt,d=n.dataTable,n=v[t];if(n){if(v=n.path,p=n.isSubtotal,m=n.isGrandTotal,b=n.isBlankRow,g=n.valueFieldName,w=n.collapseIndex,y=n.isValueFieldDim,n=n.compactLevel,(0,K.ht)(g)||(h=g),m&&a&&(u||l))return{OJt:h,PJt:f};if(c&&!l&&(p&&$(w)||m)){for(C="",N=0;N<d[t].length;N++)d[t]&&d[t][N]&&(C+=d[t][N].value);return{PJt:I=[{fieldName:m?Y:F,itemName:C}],OJt:h}}for(A=v.split(K.Separator),T=[].concat(e),M=void 0,S=c?it().sigmaValueTemp:it().sigmaValue,$(o)||u||(T.splice(o,0,{Zc:S}),A.splice(o,0,S)),x=a||u||p&&$(w)?A.length-1:s?Math.max(n,0):i,D=0;D<=x;D++)I={},k=T[D],$(k)||(O="",I={fieldName:j=k.Zc,itemName:O=j===S?h:(0,q.FZt)(r,k.Zc,A[D])},D===x&&(M={name:j===S?O:j,index:D}),D===A.length-1&&(b&&(I.isBlankRow=!0),p&&(I.isSubtotal=!0),$(w)||(I.collapseIndex=w)),m&&(I.isGrandTotal=!0),f.push(I));return{isBlankRow:b,isValueFieldDim:y,OJt:h,activeRowFieldInfo:M,PJt:f}}}function ut(t,i,n,e,r,o,a,s,c,u,l){var f,h,v,d,n,v,p,m,b,g,w,n,y,C,N,I,A,T,M,S,x,D,k,j,f=[],v=n.WWt,d=n.dataTable,n=v[i];if(n){if(v=n.path,p=n.isSubtotal,m=n.isGrandTotal,b=n.valueFieldName,g=n.isBlankColumn,w=n.collapseIndex,n=n.grandTotalLevel,(0,K.ht)(b)||(h=b),g)return{isBlankColumn:g};if(m&&a&&(u||l))return{OJt:h,FJt:f};if(c&&!l&&(p&&$(w)&&0===n||m)){for(y="",C=0;C<d.length;C++)d[C]&&d[C][i]&&(y+=d[C][i].value);return{FJt:N=[{fieldName:m?Y:F,itemName:y}],OJt:h}}for(I=v.split(K.Separator),A=[].concat(e),T=void 0,M=c?it().sigmaValueTemp:it().sigmaValue,$(o)||u||(A.splice(o,0,{Zc:M}),I.splice(o,0,M)),S=a||u||p&&$(w)?I.length-1:t-1,x=0;x<=S;x++)N=void 0,D=A[x],$(D)||(j="",N={fieldName:k=D.Zc,itemName:j=k===M?b:(0,q.FZt)(r,D.Zc,I[x])},x===S&&(T={name:k===M?j:k,index:x}),x===I.length-1&&p&&(N.isSubtotal=!0),$(w)||(N.collapseIndex=w),m&&(N.isGrandTotal=!0),f.push(N));return{activeColFieldInfo:T,OJt:h,FJt:f}}}function N(t){var i=[];return t&&t.forEach(function(t){$(t.itemName)||i.push(t.itemName)}),i.join(" - ")}function lt(t){return!1===t.dataOnly&&$(t.labelOnly)||!0===t.dataOnly&&!0===t.labelOnly?"all":!1===t.dataOnly&&!1===t.labelOnly||$(t.dataOnly)&&$(t.labelOnly)?"dataOnly":!0!==t.labelOnly||t.dataOnly?t.labelOnly||t.dataOnly?void 0:"none":"labelOnly"}function h(t,i,n){return void 0===n&&(n=!0),!$(t)&&!$(i)&&st(t)===st(i)}function ft(t){t.references&&1<t.references.length&&(t.references.sort(function(t,i){return t.fieldName>i.fieldName?-1:t.fieldName<i.fieldName?1:void 0}),t.references.forEach(function(t){var i;t&&t.items&&1<t.items.length&&t.items.sort(function(t,i){return i<t?-1:1})}))}function ht(t){switch(t){case"origin":return X.PivotAreaType.corner;case"button":return X.PivotAreaType.button;case"topRight":case"topEnd":return X.PivotAreaType.topRight;case"all":return X.PivotAreaType.all;default:return}}function vt(t){switch(t){case X.PivotAreaType.corner:return"origin";case X.PivotAreaType.button:return"button";case X.PivotAreaType.topRight:return"topRight";case X.PivotAreaType.all:return"all";default:return}}function dt(t){for(var i,n,e,r,i=[],n={start:t[0],end:t[0]},e=1,r=t.length;e<r;e++)t[e]-1===t[e-1]?n.end=t[e]:(i.push(n),n={start:t[e],end:t[e]});return i.push(n),i}function pt(t){var i,n,e,r,o,a,s,c,u,i={},n=t.pivotArea;if(n)for(e in i.pivotArea={},n)if(n.hasOwnProperty(e))if("references"===e&&n.references)for(r=i.pivotArea.references=[],o=0;o<n.references.length;o++){for(c in s={},a=n.references[o])if(a.hasOwnProperty(c))if("items"===c&&a.items){if(a.items)for(s.items=[],u=0;u<a.items.length;u++)s.items.push(a.items[u])}else s[c]=a[c];r.push(s)}else i.pivotArea[e]=n[e];return t.style&&(i.style=W(t.style)),i}function W(t){if(t instanceof J.Style)return t.clone();var i=new J.Style;if("string"==typeof t)i.fromJSON(JSON.parse(t),!1,void 0);else{if("object"!=typeof t)return null;i.fromJSON(t,!1,void 0)}return i}function mt(t,i,s,o,c,n,e,r){var a,u,l,f,h,v,d,p,m,b,a,g,w,y,C,C;if(void 0===r&&(r=7),a=s.pivotTables.all(),u=!1,c=!!c,l=e?e.union(i):i,r&X.overlapCheck.pt&&(0,K.o)(a,function(t){var t,i,t,n,e,r,i;if((t.name()!==o||!o)&&(i=(t=t.getRange()).page,t=t.content,e=n=!1,i&&(n=null!==i.getIntersect(l,0,0)),(e=null!==t.getIntersect(l,0,0))||n))return i={message:r=it().PivotTableErrorMessage_Overlap,cancel:!1,force:!0},c?s.pivotTables.jT(!1,{type:11,args:i}):s.jT(11,i),u=!0}),u)return!0;function N(t,i,n){var e,r,o,a;if(i&&n)for(e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(t[e]&&i&&!i.contains(e,r)&&t[e][r]&&t[e][r].value)return a={message:o=it().PivotTableErrorMessage_ExistData.replace("{}",s.name()),cancel:!1,force:!1},c?s.pivotTables.jT(!1,{type:11,args:a}):s.jT(11,a),1}if(r&X.overlapCheck.value)for(f=s.Ut.W_(3).dataTable,h=0,v=[n,t];h<v.length;h++)for(d=v[h],p=0,m=[e,i];p<m.length;p++)if(N(f,d,b=m[p]))return!0;if(r&X.overlapCheck.table&&(a=s.tables&&s.tables.all())&&0<a.length)for(g=0,w=a;g<w.length;g++)if(At((y=w[g]).range(),e,i))return C=it().PivotTableErrorMessage_ExistTable,s.pivotTables.jT(!(C={message:C,cancel:!1,force:!0}),{type:11,args:C}),!0;return!1}function r(t){this.qK=[],this._Jt={fieldLevel:{},itemLevel:{}},this.LJt=t}function bt(t,i){return i.priority=t.priority&&t.priority(),i.scope=t.scope&&t.scope(),i.type=t.type&&t.type(),i}function gt(t){var i,n;if(!t)return 1;if(M(t))return 1;for(n in i=!0,t)if(t.hasOwnProperty(n)&&"_id"!==n){i=!1;break}return i}function wt(t,i,n){var e,r,o,a,s,c,e=i.row,r=i.col,o=i.rowCount,a=i.colCount;if(n.borderLeft)for(s=0;s<o;s++)t[e+s]||(t[e+s]={}),$(t[e+s][r])&&(t[e+s][r]={}),t[e+s][r].borderLeft=!0;if(n.borderRight)for(s=0;s<o;s++)t[e+s]||(t[e+s]={}),$(t[e+s][r+a-1])&&(t[e+s][r+a-1]={}),t[e+s][r+a-1].borderRight=!0;if(n.borderTop)for(t[e]||(t[e]={}),c=0;c<a;c++)$(t[e][r+c])&&(t[e][r+c]={}),t[e][r+c].borderTop=!0;if(n.borderBottom)for(t[e+o-1]||(t[e+o-1]={}),c=0;c<a;c++)$(t[e+o-1][r+c])&&(t[e+o-1][r+c]={}),t[e+o-1][r+c].borderBottom=!0}function yt(t,n){t.sort(function(t,i){return n?t.row-i.row:t.col-i.col})}function Ct(t){var i,n,e,r;if(!t)return[];for(i=[],n=0;n<t.length;n++)t[n]&&i.push(t[n]);if(i.length<=1)return i;if(e=[],i[0].row===i[1].row&&i[0].rowCount===i[1].rowCount)for(yt(i,!1),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].col+i[n].colCount!==i[r].col||i[n].row!==i[r].row||i[n].rowCount!==i[r].rowCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].colCount=i[n].colCount+i[r].colCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else if(i[0].col===i[1].col&&i[0].colCount===i[1].colCount)for(yt(i,!0),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].row+i[n].rowCount!==i[r].row||i[n].col!==i[r].col||i[n].colCount!==i[r].colCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].rowCount=i[n].rowCount+i[r].rowCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else e=i;return e}function Nt(t,i,n){var e;if(!$(i))switch(typeof i){case"boolean":t.b=i?1:0;break;case"string":t.v=n.getTextIndex(i);break;case"object":i instanceof Date?t.v=n.getTextIndex((0,K.kQt)(i)):t.v=i;break;default:t.n=i}}function _(t,i){t.value=i}function It(t,i){var n,i,t,n=new J.Style,i=P(i.numFmtId),t=t.Dd&&t.Dd.uv(i);return n.formatter=t,n}function L(t,i,n,e,r){var o,a,s,c,u;for(o in e)if(e.hasOwnProperty(o)&&(a=e[o],!$(a)))for(c in $(n[+o+t])&&(n[+o+t]={}),s=n[+o+t],a)!a.hasOwnProperty(c)||$(a[c])||(u=a[c],$(u))||$(u.value)||($(s[+c+i])&&(s[+c+i]={}),r(s[+c+i],u.value))}function c(t,i,n,e,r,o,a,s){var t,c,i,t=f.call(this,t,s)||this;return t.T$=0,(c=t).Xst=0,c.eZt={row:$(n)?0:n,col:$(e)?3:e},c.suspendLayout(),c.rZt=new v.PivotDataModel,c.Ti=i,c.eZt={row:$(n)?0:n,col:$(e)?3:e},i=c.refresh.bind(c),c.options=(0,q.b0)(H,t,i),c.EJt(a),s.Dpi=c.options.subTotalsPosition,c.BJt=o||V.PivotTableThemes.light16,c.HSt=[],c.zSt=[],$(r)?c.CWt=X.PivotTableLayoutType.outline:c.CWt=r,c.dh.setSigmaValuePosition(K.DataPosition.col,0),c.EZt={LZt:[],BZt:[],RJt:[],GJt:[]},c.VJt=[],c.lZt=[],c.UJt={},c.QJt={},c.WJt={},l&&(c.mJ=new l(c)),c.views=new et(c.deserialize.bind(c),c.serialize.bind(c)),c.zJt="",c.ZJt="",c.resumeLayout(),t}function At(t,i,n){var e=!1;return(e=i?t.intersect(i.row,i.col,i.rowCount,i.colCount):e)||t.intersect(n.row,n.col,n.rowCount,n.colCount)}a=this&&this.__extends||(ot=function(t,i){return(ot=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ot(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),D=this&&this.__assign||function(){return(D=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},w=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(x,"__esModule",{value:!0}),x.PivotTable=x.synchronizeDataTable=x.setDataForSJSPivotTable=x.PivotTableConditionalFormats=x.RYt=x.isSamePivotArea=x.BuiltInPivotTableThemeNames=void 0,J=t("Core"),i=t("Common"),q=t("./dist/plugins/pivot/pivot-util.js"),K=t("Pivot"),X=t("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),s=t("./dist/plugins/pivot/pivot-core/pivot-view.js"),v=t("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),G=t("SheetsCalc"),V=t("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),d=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),p=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),m=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),g=t("./dist/plugins/pivot/pivot.ns.js"),j=t("@grapecity/js-calc"),u=t("./dist/plugins/pivot/pivot-table-entry.js"),k=J.mt.xr,U=J.mt.vo,Q=J.NodeHelper.dr,z=J.mt.Pr,I=J.mt.Hue,A=J.mt.go,O=J.NodeHelper.ur,P=J.NodeHelper.sr,T=J.NodeHelper.ar,E=J.mt.St,t=i.Common.lt,$=t.ht,M=t._h,S=t.tv,B=i.Common.zf,t=i.Common.Uf,b=t.tR,R=i.Common.kh,tt=void 0,y=null,Z=i.Common.lt.tv,t=new i.Common.ResourceManager(g.SR,"PivotTables"),it=t.getResource.bind(t),H={allowMultipleFiltersPerField:!(F="subtotal"),fillDownLabels:!(Y="grandTotal"),insertBlankLineAfterEachItem:!1,grandTotalPosition:X.GrandTotalPosition.both,subTotalsPosition:X.SubtotalsPosition.bottom,subtotalsPosition:X.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:X.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:y,rowLabelIndent:1,printDrill:y,itemPrintTitles:y,fieldPrintTitles:y,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:y,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:X.CalcItemAggregation.include,enableDataValueEditing:!1,hideValuesRow:!0},C="4294967294",nt=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation","decoration","mask"],x.BuiltInPivotTableThemeNames=at(),e.prototype.save=function(t){var i,n,i=this;return!$(t)&&i.Hq(t)===y&&(n=i.jJt(),i.views.push({name:t,config:n}),!0)},e.prototype.add=function(t){var i=this;return!$(t.name)&&i.Hq(t.name)===y&&(i.views.push(t),!0)},e.prototype.remove=function(t){var i,t,i=this,t=i.Hq(t);t!==y&&i.views.splice(t,1)},e.prototype.get=function(t){var i,t,i=this,t=i.Hq(t);if(t!==y)return i.views[t]},e.prototype.all=function(){return this.views},e.prototype.apply=function(t){var i,t,i=this,t=i.Hq(t);null!==t&&i.kJt(i.views[t].config)},e.prototype.Hq=function(t){for(var i,n,e,i=this,n=0;n<i.views.length;n++)if((e=i.views[n]).name===t)return n;return null},e.prototype.toJson=function(){return(0,q.RF)(this.views)},e.prototype.fromJson=function(t){this.views=t},e.prototype.L0=function(){this.views=y},et=e,x.isSamePivotArea=h,x.RYt=mt,r.prototype.L0=function(){this.LJt=y,this.qK=y,this._Jt=y},r.prototype.YJt=function(t){for(var i,n,e,r,o,a,i,n=this.qK,e=[],r=$(t),o=0;o<n.length;o++)if(n[o].pivotAreas)for(a=0;a<n[o].pivotAreas.length;a++)if(r||h(t,n[o].pivotAreas[a])){e.push(n[o].conditionalRule);break}return e},r.prototype.HJt=function(t,i,n){var e;this.JJt(t,i,n)},r.prototype.JJt=function(t,i,n){var e,r,o,e,a,s,c,u;if(!($(t)||t.length<=0)&&i&&(r=(e=this).qK,e=(o=e.LJt).Ti,!$(e.conditionalFormats))&&(a={conditionalRule:i,pivotAreas:t},i.pivotTableAreas=t,i.pivotTableName=o.name(),r.push(a),!n)){for(s=[],u=0;u<t.length;u++)(c=o.getPivotAreaRanges(t[u]))&&0<c.length&&(s=s.concat(c));0<s.length&&(i.ranges(s),e.conditionalFormats.addRule(i))}},r.prototype.qJt=function(){var t,i,n,e,r,o,a,s,t=this,i=t.qK,n,e,r=t.LJt.Ti.conditionalFormats;if(!$(r)){for(t.qK=[],o=0,a=i.length;o<a;o++)s=i[o],r.removeRule(s.conditionalRule);for(o=0,a=i.length;o<a;o++)s=i[o],t.HJt(s.pivotAreas,s.conditionalRule)}},r.prototype.QP=function(){return this.qK},r.prototype.DJt=function(t){for(var i,n,i=this.qK,n=0;n<i.length;n++)i[n].conditionalRule&&i[n].conditionalRule.priority()===t&&i.splice(n,1)},r.prototype.KJt=function(t,i){for(var n,e,r,o,a,s,n=this,e=n.qK,r=n.LJt,o=0;o<e.length;o++){if(t===e[o].conditionalRule){for(a=[],s=0;s<i.length;s++)a=a.concat(r.getPivotAreaRanges(i[s]));t.ranges(a)}e[o].pivotAreas=i}},r.prototype.XJt=function(t){for(var i,n,e,r,o,i=this,n=i.qK,e,r=i.LJt.Ti,o=0;o<n.length;o++)t===n[o].conditionalRule&&r.conditionalFormats.removeRule(t)},r.prototype.$Jt=function(t){for(var i,n,e,r,o,a,s,c,i=this,n=i.qK,e,r=i.LJt.Ti,o=0;o<n.length;o++)if((a=n[o]).pivotAreas&&t.length===a.pivotAreas.length){for(s=!0,c=0;c<t.length;c++)if(!h(t[c],a.pivotAreas[c])){s=!1;break}s&&(r.conditionalFormats.removeRule(a.conditionalRule),n.splice(o,1))}},r.prototype.tqt=function(t,i,n,e,r){for(var o,a,s,c,u,l,f,h,v,d,p,m,o=this,a=o.LJt,s=a.Ti,c=s.conditionalFormats,u=[],l=c.GJ(t.ranges()),f=a.Zc,h=0,v=b(l);h<v;h++)(d=c.FX(l[h],i,n,e,r))&&(u=u.concat(d));if(0<b(u)){for(p=[],m=function(t){var i=s.pivotTables.getRangePivotAreas(u[t]);i&&Object.keys(i).forEach(function(t){t===f&&i[f]&&(p=w(w([],p,!0),i[f],!0))})},h=0;h<u.length;h++)m(h);o.KJt(t,p)}else o.XJt(t)},r.prototype.iqt=function(){this.qK.length=0,this._Jt={fieldLevel:{},itemLevel:{}}},r.prototype.count=function(){return b(this.qK)},l=r,x.PivotTableConditionalFormats=l,x.setDataForSJSPivotTable=Nt,x.synchronizeDataTable=L,f=s.PivotView,a(c,f),c.prototype.getFieldsModel=function(){return this.dh},c.prototype.showNoData=function(t,i){var n,e,r,n=this,e=n.dh;if(!(r=e&&!$(t)&&""!==t?e.a1(t,i):r)||$(i))return r;n.refresh(),n.DT({pivotTable:n,type:"showNoData",cacheFieldName:t,isShow:i})},c.prototype.updateCalcItem=function(t,i,n,e){var r,o,a,s,c,r=this,o=r.dh,a=r.Ti,s=o.up(t)[0];try{c=o.x1(t,i,n,e),r.refresh()}catch(t){return a.jT(10,t.message),!1}return c&&r.DT({pivotTable:r,type:"updateCalcItem",calcItemInfo:s}),c},c.prototype.getCalcItems=function(t){var i,n;return this.dh.up(t)||[]},c.prototype.removeCalcItem=function(t,i){var n,e,i,n=this,e,i=n.dh.Rp(t,i);i&&0<i.length&&n.DT({pivotTable:n,type:"removeCalcItem",sourceName:t,formulaInfos:i}),n.refresh()},c.prototype.addCalcItem=function(t,i,n){var e=this,r=e.dh,o=e.Ti,a;if(!$(t)&&!$(n)&&""!==n&&""!==i){try{a=r.Db(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}return a&&e.DT({pivotTable:e,type:"addCalcItem",sourceName:t,calcItemName:i}),a}},c.prototype.getPivotDetails=function(t){if($(t))throw new Error(it().param_error);var i=this;if(i.dh)return i.dh.KM(t)},c.prototype.getSource=function(){var t,t,t=this.dh;if(t&&"string"==typeof(t=t.LN()))return t},c.prototype.getSourceFields=function(){var t,t,i,n,e,r,o,t=this.dh,i=[];if(t&&(t=t.ky(),!$(t)))for(e=0,r=t;e<r.length;e++)n={name:(o=r[e]).name},(0,K.ht)(o.fieldType)||(n.fieldType=o.fieldType),i.push(n);return i},c.prototype.updateSource=function(){var t=this,i=t.dh;i&&i.kx(t.Ti)},c.prototype.serialize=function(){return this.nqt(134217727)},c.prototype.nqt=function(l){var f,t,i,h,n,v,e,r,d,o,t,a,s,c,e,u,p,f=this,t=f.layoutType(),i={},h=[],n=f.options,v=f.dh,e=f.eZt,r=f.dh.getSigmaValuePosition(),d={};if(l&X.SerializeIndex.options){for(o in n)n.hasOwnProperty(o)&&"object"!=typeof n[o]&&(i[o]=n[o]);d.options=i}if(l&X.SerializeIndex.layout&&(d.layoutType=t),l&X.SerializeIndex.position&&(d.pivotTablePosition=[e.row,e.col]),l&X.SerializeIndex.theme&&(t=f.theme().name(),$(V.PivotTableThemes[t.toLowerCase()])?f.theme()&&(d.theme=f.theme().toJSON()):d.theme=t),l&X.SerializeIndex.styles)for(a=d.styles=[],s=f.lZt,c=0;c<s.length;c++)a.push(pt(s[c]));if(l&X.SerializeIndex.showNoData&&(e=f.dh.ac)&&(d.showNoDataInfo=D({},e)),l&X.SerializeIndex.fields){for(u=function(t){var e,r,i,n,o,a,s,c,u,c,e=[];if(4===t&&l&X.SerializeIndex.filter)return r=f.getFieldsByArea().map(function(t){return t.sourceName}),i=v.getAllFieldNameList(),(0,K.o)(i,function(t){var i,n,t;!(-1<r.indexOf(t))&&v.isFilter(t)&&(i={sourceName:t},n=f.labelFilter(t),t=f.valueFilter(t),n&&(i.labelFilter=n),t&&t.conditionByName&&(i.valueFilter=t),i.labelFilter||i.valueFilter)&&e.push(i)}),0<e.length&&(h[t]=e),"break";for(n=v.nw(t),o=0;o<n.length;o++)s={sourceName:(a=n[o]).a,displayName:a.Zc},(0,K.ht)(a.Ar)||(s.subtotal=a.Ar),(0,K.ht)(a.Spi)||(s.isShowSubtotalTop=a.Spi),l&X.SerializeIndex.filter&&(c=f.labelFilter(a.Zc),u=f.valueFilter(a.Zc),c&&(s.labelFilter=c),u)&&u.conditionByName&&(s.valueFilter=u),l&X.SerializeIndex.sort&&a.nrt&&(s.sortInfo=a.nrt),3===t&&l&X.SerializeIndex.showValueAs&&f.eqt&&(c=f.showDataAs(a.Zc))&&(d.showDataAsList||(d.showDataAsList=[]),d.showDataAsList.push({valueFieldName:a.Zc,showDataAsInfo:c})),e.push(s);h[t]=e},c=0;c<5&&"break"!==(p=u(c));c++);r&&(d.valuePosition=r),l&X.SerializeIndex.collapse&&(d.collapseItems=(0,q.RF)(v.dv)||{}),d.fieldsInfo=h}return d},c.prototype.deserialize=function(t){this.tJt(t,134217727)},c.prototype.tJt=function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,n=this;n.Ti.suspendPaint(),n.suspendLayout();try{for(e=n.dh,r=0;r<4;r++)e.RM(r);if(o=e.getAllFieldNameList(),(0,K.o)(o,function(t){e.clearFilterInfo(t,0)}),i&X.SerializeIndex.position&&n.position(t.pivotTablePosition[0],t.pivotTablePosition[1]),i&X.SerializeIndex.layout&&n.layoutType(t.layoutType),i&X.SerializeIndex.options)for(a=Object.keys(t.options),r=0;r<a.length;r++)n.options[a[r]]!==t.options[a[r]]&&(n.options[a[r]]=t.options[a[r]]);if(i&X.SerializeIndex.theme&&t.theme&&("object"==typeof(s=t.theme)&&(s=new V.PivotTableTheme).fromJSON(t.theme),n.theme(s)),i&X.SerializeIndex.styles){for(n.rqt(),c=t.styles||[],r=0;r<c.length;r++)n.setStyle(c[r].pivotArea,c[r].style);n.uqt()}if(i&X.SerializeIndex.showNoData&&(t.showNoDataInfo?n.dh.ac=D({},t.showNoDataInfo):n.dh.ac=void 0),i&X.SerializeIndex.fields){for(r=0;r<4;r++)for(u=t.fieldsInfo[r],l=0;l<u.length;l++)(f=u[l])&&(h=f.sourceName,v=f.displayName,d=f.subtotal,p=f.isShowSubtotalTop,e.isFieldActualExist(h))&&(m=e.addFieldByName(h,v,r,d,void 0),$(m)||(m.Spi=p));t.valuePosition&&e.setSigmaValuePosition(t.valuePosition.positionType,t.valuePosition.positionIndex)}for(r=0;r<5;r++)if(u=t.fieldsInfo[r])for(l=0;l<u.length;l++)(f=u[l])&&(h=f.sourceName,b=f.valueFilter,g=f.labelFilter,w=f.sortInfo,i&X.SerializeIndex.filter&&(g&&e.isFieldActualExist(h)&&e.setLabelFilterInfo(h,g),b)&&e.isFieldActualExist(h)&&e.setValueFilterInfo(h,b),i&X.SerializeIndex.sort)&&w&&e.isFieldActualExist(h)&&e.setSortInfo(h,w);if(i&X.SerializeIndex.collapse&&(y=t.collapseItems))for(C=0,N=Object.keys(y);C<N.length;C++)for(m=y[I=N[C]],A=0,T=Object.keys(m);A<T.length;A++)M=T[A],n.collapse(I,M,m[M]);i&X.SerializeIndex.showValueAs&&(S=t.showDataAsList)&&(0,K.o)(S,function(t){n.showDataAs(t.valueFieldName,t.showDataAsInfo)})}catch(t){throw Error(t)}finally{n.resumeLayout(),n.Ti.resumePaint()}},c.prototype.EJt=function(t){var i,n,e,r,i,n=this.options,e=H;if(!$(t))for(r in t)R(t,r)&&R(e,r)&&(n[r]=t[r])},c.prototype.altText=function(t,i){if($(t)&&$(i))return{altText:this.zJt,altTextSummary:this.ZJt};$(t)||(this.zJt=t),$(i)||(this.ZJt=i)},c.prototype.name=function(t){var i,n;if(0===arguments.length)return this.Zc;if(this.Ti&&this.Ti.parent&&(i=this.Ti.parent.BYt(t)))throw new Error(it().RepeatName);n=this.Zc,this.Zc=t,this.Ti.parent.QYt(t,!0,n),this.DT({pivotTable:this,name:t,oldName:n,type:"name",pivotType:0})},c.prototype.position=function(t,i,n){var e,r,o,a,a,s,c,u,l,f,e=this;if(0===arguments.length)return{row:e.eZt.row,col:e.eZt.col,sheetName:e.Ti.name()};if(a=(r=e.Ti)&&r.parent,!$(e.Ti)&&"number"==typeof t&&"number"==typeof i){if(s=e.eZt.row,c=e.eZt.col,e.eZt.row=t,e.eZt.col=i,!$(n)&&n!==r.name()){if(o=a&&(0,J._f)(a,n),$(o))return;for(l=(u=(a=r.pivotTables)&&a.PYt).length,f=0;f<l;f++)if(u[f].name()===e.Zc){u.splice(f,1);break}o.pivotTables.PYt.push(e)}e.DT({pivotTable:e,row:t,col:i,oldCol:c,oldRow:s,sheetName:r.name(),type:"position",pivotType:0}),e.refresh(),o&&(e.Ti=o,e.qYt(o.pivotTables.FYt,o.pivotTables._Yt))}},c.prototype.sort=function(t,i){if(1===arguments.length)return this.dh.getSortInfo(t);var i;1<arguments.length&&(i=S(i),this.dh.setSortInfo(t,i)),this.refresh()},c.prototype.group=function(t){var i=this,n,e=i.Ti;try{n=this.dh.dy(t)}catch(t){return void e.jT(10,t.message)}"boolean"==typeof n?(i.dh.q1=!0,i.refresh()):i.Ti.jT(10,n)},c.prototype.getGroupInfo=function(t){var i,n,t;if(!$(t)&&""!==t)return t=(n=(i=this).dh).rC(t),$(t)?void 0:D({},t)},c.prototype.ungroup=function(t){var i,n,t,t,e,i=this,n=i.dh,t=n.getSourceNameByFieldName(t)||t;n.cy(t),n.q1=!0,(t=i.Ti)&&(e=t.getParent()).ok(),i.refresh()},c.prototype.add=function(t,i,n,e,r){var o,a,s,c,o=this,a=o.dh,s=o.Ti;if(!$(t)&&!$(i)&&$(a.Z[i])&&(c=o.dh.bl(t))){if(!$(c.D5)){if(n!==X.PivotTableFieldType.valueField)return void(0,u.throwError)(it().FieldAreaLimited);e=K.SubtotalType.sum}try{a.addFieldByName(t,i,n,e,r),o.refresh()}catch(t){s.jT(10,t.message)}}},c.prototype.remove=function(t){var i,n,e,i=this.dh,n=i.Z[t],e;i.removeFieldOrSigmaByName(t)instanceof u.PivotViewField&&(n===X.PivotTableFieldType.valueField?i.clearValueFilterOfValueField(t):i.y2(t,!1)),this.refresh()},c.prototype.theme=function(t){if(0===arguments.length)return this.BJt;var i=this.BJt&&this.BJt.name(),i=V.PivotTableThemes[i]?i:this.BJt;"string"==typeof t&&(t=V.PivotTableThemes[t.toLowerCase()]||V.PivotTableThemes.light0),this.DT({pivotTable:this,type:"changeTheme",oldTheme:i,pivotType:0}),this.BJt=t,this.refresh()},c.prototype.DT=function(t){var i,n,e,i=this.Ti;i&&(n=i.getParent(),(0,K.ht)(n.NVt)&&this.getRange&&(n.NVt={range:this.getRange()}),(e=i.Ut).WYt(this,t))},c.prototype.AP=function(t){var i,n,e,r,o,a,s,c,u,l,s,i=this,n;switch(t.type){case"changeTheme":i.theme(t.oldTheme);break;case"layoutType":i.layoutType(t.oldLayoutType);break;case"name":i.name(t.oldName);break;case"position":i.position(t.oldRow,t.oldCol,t.sheetName);break;case"setStyle":i.setStyle(t.pivotArea,t.oldStyle);break;case"options":i.options[t.pn]=t.old;break;case"addCalcField":i.removeCalcField(t.fieldName);break;case"removeCalcField":i.addCalcField(t.fieldName,t.formula);break;case"showDataAs":$(t.oldShowDataAs)?i.showDataAs(t.fieldName,{showDataAs:K.PivotShowDataAs.normal}):i.showDataAs(t.fieldName,t.oldShowDataAs);break;case"resetPivotStyle":i.rqt(t.areaModel,t.rangeModel);break;case"adjustRange":i.eZt.row=t.oldRow;break;case"conditionalRulesChange":i.mJ.qK=t.originalConditionalRules,i.mJ.qJt();break;case"addCalcItem":i.removeCalcItem(t.sourceName,t.calcItemName);break;case"removeCalcItem":for(r=0,o=e=t.formulaInfos;r<o.length;r++)a=o[r],i.addCalcItem(t.sourceName,a.calcItemName,a.formula);break;case"updateCalcItem":c=(s=t.calcItemInfo).sourceName,u=s.calcItemName,l=s.formula,s=s.priority,i.updateCalcItem(c,u,l,s);break;case"showNoData":i.showNoData(t.cacheFieldName,!t.isShow);break;case"setNodeValue":i.setNodeValue(t.nodeInfo,t.oldValue)}},c.prototype.updateField=function(t,i,n){var e=this,r=e.dh,o=e.Ti;if(t===it().sigmaValue)r.setSigmaValuePosition(i-1,n);else if(!$(t))try{r.changeFieldArea(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}},c.prototype.sq=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,e=this,r=e.dh,o=r.getFieldInfoByName(t),a=r.Z;if(i&&o){if(a[t]===X.PivotTableFieldType.valueField)(0,q.R$)(e,t,o.Or&&o.Or.showDataAs),e.showDataAs(t,{showDataAs:K.PivotShowDataAs.normal});else if(a[t]!==X.PivotTableFieldType.filterField)for(c=0,u=s=r.nw(X.PivotTableFieldType.valueField);c<u.length;c++)(l=u[c]).Or&&l.Or.baseFieldName===t&&(0,q.R$)(e,l.Zc,l.Or&&l.Or.showDataAs)}else if(o&&!i)if(a[t]===X.PivotTableFieldType.valueField&&n!==X.PivotTableFieldType.valueField)(0,q.R$)(e,t,o.Or&&o.Or.showDataAs),e.showDataAs(t,{showDataAs:K.PivotShowDataAs.normal});else if(!(a[t]!==X.PivotTableFieldType.rowField&&a[t]!==X.PivotTableFieldType.columnField||n!==X.PivotTableFieldType.filterField&&n!==X.PivotTableFieldType.valueField))for(f=0,h=s=r.nw(X.PivotTableFieldType.valueField);f<h.length;f++)(l=h[f]).Or&&l.Or.baseFieldName===t&&((0,q.R$)(e,t,l.Or&&l.Or.showDataAs),e.showDataAs(l.Zc,{showDataAs:K.PivotShowDataAs.normal}))},c.prototype.updateFieldName=function(t,i){var t=this.dh.getFieldInfoByName(t);"string"==typeof i&&(t&&this.dh.changeFieldName(t,i)?(this.dh.q1=!0,this.refresh()):this.Ti.jT(10,it().PivotTableErrorMessage_EmptyFieldName))},c.prototype.autoFitColumn=function(){var t,i,t=this.oqt(),i=this.Ti;i.suspendPaint(),(0,K.o)(t,function(t){(0,K.o)(t,function(t){i.setColumnWidth(t.col,t.width)})}),i.resumePaint()},c.prototype.oqt=function(){var t,i,n,e,r,o,a,s,c,i,u,l,f,h,v,d,p,m,b,m,g,t=this.eZt.col,i=this.rZt.HWt[2],n=i.jN,e=i.WWt,r=i.Tx,o,a=this.mZt().length,s=[],c=[],i=this.dh.getSigmaValuePosition(),u=!1,l=!1;for(i.display&&1===i.positionType&&(i.positionIndex===(a+=1)-2?u=!0:i.positionIndex!==a-1&&(l=!0)),f=this.eZt.row+this.eZt.rowCount,h=this.eZt.col;h<this.eZt.col+n;h++)v=J.mt.qf(h,this.Ti,3,1,f),s.push([{col:h,width:v}]);for(d=y,p=l?3:2,h=0;h<r;h++)m=e[h].path,b=e[h].isSubtotal,g=(m=m.split(K.Separator))[a-p],u&&(g=e[h].valueFieldName),v=J.mt.qf(t+n+h,this.Ti,3,1,f),null!==d&&d!==g?(this.aqt(c,s),(c=[]).push({col:t+n+h,width:v}),h===e.length-1&&s.push(w([],c,!0))):(b&&(this.aqt(c,s),c=[]),c.push({col:t+n+h,width:v}),h===e.length-1&&this.aqt(c,s)),d=m[a-p],u&&(d=e[h].valueFieldName);return s},c.prototype.aqt=function(t,i){var n,e,r,n=[];t.forEach(function(t){n.push(t.width)}),e=Math.max.apply(Math,n),r=[],t.forEach(function(t){r.push({col:t.col,width:e})}),i.push(w([],r,!0))},c.prototype.collapse=function(t,i,n){if(2===arguments.length)return this.dh.getCollapse(t,i);2<arguments.length&&(this.dh.setCollapse(t,i,n),this.refresh())},c.prototype.labelFilter=function(t,i){var n,e,n=this.dh,e=n.getSourceNameByFieldName(t)||t;if(1===arguments.length)return n.getLabelFilterInfo(t)||e&&n.getLabelFilterInfo(e);n.setLabelFilterInfo(e,i),this.refresh()},c.prototype.valueFilter=function(t,i){var n,e,n=this.dh,e=n.getSourceNameByFieldName(t);if(1===arguments.length)return n.getValueFilterInfo(t)||e&&n.getValueFilterInfo(e);n.setValueFilterInfo(e,i),this.refresh()},c.prototype.subtotalType=function(t,i){return this.subTotalType.apply(this,arguments)},c.prototype.subTotalType=function(t,i){var n=this,e=n.Ti;if(!$(n.dh)){if(1===arguments.length)return n.dh.xy(t);try{n.dh.xy(t,i)}catch(t){e.jT(10,t.message)}n.refresh()}},c.prototype.layoutType=function(t){var i,n,e,i=this,n=i.dh;if(0===arguments.length)return i.CWt;if(i.CWt!==t){switch(e=i.CWt,i.CWt=t){case X.PivotTableLayoutType.compact:i.outline=!0,i.outlineData=!0,i.compact=void 0,i.compactData=void 0;break;case X.PivotTableLayoutType.outline:i.outline=!0,i.outlineData=!0,i.compact=!1,i.compactData=!1;break;case X.PivotTableLayoutType.tabular:i.compact=!1,i.compactData=!1,i.outline=void 0,i.outlineData=void 0,i.options.subtotalsPosition===X.SubtotalsPosition.top&&(i.options.subtotalsPosition=X.SubtotalsPosition.bottom)}this.DT({pivotTable:this,layoutType:t,oldLayoutType:e,type:"layoutType",pivotType:0})}(0,q.updateRowFieldsIsShowSubtotalTop)(n.B,i.options.subtotalsPosition),this.refresh()},c.prototype.dataPosition=function(t,i){var n,e,n=this;if(0===arguments.length)return n.dh.getSigmaValuePosition();e=n.getFieldsByArea(t+1).length,i<0?i=0:e<i&&(i=e),n.dh.setSigmaValuePosition(t,i),n.refresh()},c.prototype.getItemsByField=function(t){return this.dh.Kz(t)},c.prototype.showDataAs=function(t,i){if(1===arguments.length)return this.dh.getFieldInfoByName(t).Or;var n=this.dh.getFieldInfoByName(t).Or;i.showDataAs===K.PivotShowDataAs.normal?this.eqt=!1:this.eqt=!0,this.dh.getFieldInfoByName(t).Or=i,n=n&&D({},n),this.DT({pivotTable:this,fieldName:t,oldShowDataAs:n,type:"showDataAs",pivotType:0}),this.refresh()},c.prototype.subtotalPosition=function(t,i){var n,e,r,n=this.dh.getFieldInfoByName(t),e=n&&n.Spi,r=$(e)?X.SubtotalsPosition.none:e?X.SubtotalsPosition.top:X.SubtotalsPosition.bottom;if(1===arguments.length)return r;r===i||!n||i!==X.SubtotalsPosition.top&&i!==X.SubtotalsPosition.bottom||(n.Spi=i===X.SubtotalsPosition.top,this.DT({pivotTable:this,fieldName:t,isShowSubtotalTop:e,type:"isShowSubtotalTop",pivotType:0}),this.refresh())},c.prototype.getFieldsByArea=function(i){var n,t,e,e,r,r,n=this.dh,t;return(this.dh.nw(i)||[]).map(function(t){return r=t.Zc,i=n.Z[r],e=n.nw(i),e=(0,u.in)(e,r),r={fieldName:r,sourceName:t.a,dataType:t.W5,pivotArea:i,pivotIndex:e},t.W5!==K.PivotDataType.string&&(r.start=t.DV,r.end=t.mn),r})},c.prototype.getField=function(t){var i,t,n,e,r,n,n,i,n=this.dh,e=n.getFieldInfoByName(t);return e?(r=n.Z[t],n=n.nw(r),n=(0,u.in)(n,t),t={fieldName:t,sourceName:e.a,dataType:e.W5,pivotArea:r,pivotIndex:n},e.W5!==K.PivotDataType.string&&(t.start=e.DV,t.end=e.mn),t):null},c.prototype.addCalcField=function(t,i){this.dh.QVt(t,i),this.dh.q1=!0,this.refresh(),this.DT({pivotTable:this,fieldName:t,formula:i,type:"addCalcField",pivotType:0})},c.prototype.getCalcFields=function(){return this.dh.WVt()},c.prototype.removeCalcField=function(t){var i,n,e,e,r,o,e,a,s,c,i=this,n=t,e=i.dh.getFieldInfoByName(t);for(e&&(n=e.a),e=this.dh.L,o=(r=this.dh.Ti).getCalcFields(e),i.dh.HVt(t),i.dh.fit(n),i.dh.q1=!0,(e=this.Ti)&&(a=e.getParent()).ok(),this.refresh(),s=0;s<o.length;s++)(c=o[s]).Zc===t&&this.DT({pivotTable:this,fieldName:t,formula:c.D5,type:"removeCalcField",pivotType:0})},c.prototype.adjustRange=function(){var t,i,n,e,r,t,i=this.rZt.HWt[0].Sx,n=this.eZt.row,e=n,r=this.eZt.col;0<i&&n-(i+1)<0&&(this.eZt.row=i+1,this.DT({pivotTable:this,oldRow:e,oldCol:r,type:"adjustRange",pivotType:0}))},c.prototype.Uct=function(){var t,i,n,e,r,o,a,n,e,r,n,o,a,r,s,n,t=this,i=t.Ti;i.suspendPaint(),t.adjustRange(),e=(n=this.rZt.HWt)[0],r=n[1],o=n[2],a=n[3],n=n[4],e.setStartInfo(0,0),t.LYt={row:this.eZt.row-(e.Sx+1),col:this.eZt.col,rowCount:e.Sx,colCount:e.Tx},t.eZt.rowCount=r.Sx+a.Sx,t.eZt.colCount=r.Tx+o.Tx,r.setStartInfo(0,0),o.setStartInfo(0,r.Tx),a.setStartInfo(o.Sx,0),n.setStartInfo(o.Sx,a.Tx),t.sqt(),t.uqt(),t.mJ.qJt(),(e=t.Ti&&t.Ti.getParent())&&e.NVt&&(r=e.NVt.range,n=t.getRange(),r&&(o=r.page,a=r.content,r=r.page?r.page.union(r.content):r.content,s=n.page,n=n.content,r.rowCount)&&r.colCount&&mt(a,n,t.Ti,t.Zc,!0,o,s)&&t.Ti.pivotTables.jT(!0),e.NVt=y),i.pivotTables.qYt(),i.resumePaint()},c.prototype.getValue=function(t,i){var n,e,r,o,n,a,s,c,u,n,l,f,h,v,d,p,m,b,g,i,l,a,f,n=this,e=n.dh,r=t-this.eZt.row,o=i-this.eZt.col,n=n.rZt.HWt,a=n[0],s=n[1],c=n[2],u=n[3],n=n[4],l=0<a.Sx&&0<a.Tx,f=t,h=i;return l&&(f=t-this.LYt.row,h=i-this.LYt.col),l&&a.Sx>f?a.Sl(f,h):s.Sx>r?s.Tx>o?s.Sl(r,o):(v=c.Sl(r,o-s.Tx),g=(m=e.nw(2)[r-1])&&m.W5,b=m&&e.cC(m.a),2===g&&!b&&(i=(0,K.parseStringToDate)(v))?i:v):u.Tx>o?(l=u.Sl(r-s.Sx,o),g=(m=e.nw(1)[o])&&m.W5,b=m&&e.cC(m.a),(0,K.ht)(l)?l:2===g&&!b&&(a=(0,K.parseStringToDate)(l))?a:this.CWt===X.PivotTableLayoutType.compact?l+"":l):0===e.nw(3).length||(v=n.Sl(r-s.Sx,o-s.Tx))===q.GC_EMPTY_VALUE?y:!this.cqt(u,t)||(this.isTitleRow(u,t)||this.isBlankRow(u,t))&&!this.isSubtotalRow(u,t)||(f=this.lqt(v),(0,K.ht)(f))?v:f},c.prototype.Kbt=function(t,i,n){var e,r,o,a,s,c,o,u,l,f,t,e=t-this.eZt.row,r=i-this.eZt.col,o=this.rZt.HWt,a=o[0],s=o[1],c=o[2],o=o[3],u=0<a.Sx&&0<a.Tx,l=t,f=i;u&&(l=t-this.LYt.row,f=i-this.LYt.col),u&&a.Sx>l&&a.Kbt(l,f,n),s.Sx>e&&(s.Tx>r?s.Kbt(e,r,n):c.Kbt(e,r-s.Tx,n)),o.Tx>r&&(t=this.CWt===X.PivotTableLayoutType.compact?n+"":n,o.Kbt(e-s.Sx,r,t))},c.prototype.lqt=function(t){var i,n,i=this;if($(t)){if(!i.eqt)if(i.options.showMissing){if(n=i.options.missingCaption,(0,q.kWt)(t)&&!(0,K.ht)(n))return n}else if((0,q.kWt)(t))return 0}else if(t instanceof j.CalcError||t===1/0)return i.options.isShowErrorValue&&!$(i.options.errorValueInfo)?i.options.errorValueInfo:t===1/0?j.Errors.Number:void 0},c.prototype.qYt=function(t,i){var n=this.getRange(),e=n.content,n=n.page;n&&this.fqt(t,i,n),this.fqt(t,i,e)},c.prototype.fqt=function(t,i,n){for(var e,e=n.row;e<n.row+n.rowCount;e++)t[e]=!0;for(e=n.col;e<n.col+n.colCount;e++)i[e]=!0},c.prototype.cqt=function(t,i){return 3===t.QWt&&this.eZt.rowCount+this.eZt.row>i},c.prototype.isSubtotalRow=function(t,i){var i=t.zWt[i-t.DQ-this.eZt.row];return i&&i.isSubtotal},c.prototype.isBlankRow=function(t,i){var i=t.zWt[i-t.DQ-this.eZt.row];return i&&i.isBlankRow},c.prototype.isTitleRow=function(t,i){var i;return this.CWt!==X.PivotTableLayoutType.tabular&&!(!(i=t.zWt[i-t.DQ-this.eZt.row])||void 0!==i.isValueFieldDim&&i.isValueFieldDim)},c.prototype.sJt=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m,e,b,b,b,b,g,e=this.getPivotInfoImp(t,i,!0);if(e){if(r=tt,s=a=o=void 0,c=e.value,u=e.area,l=e.menuArea,f=e.valueFieldName,h=e.rowInfos,v=e.colInfos,d=e.colHeadFieldInfo,p=e.activeRowFieldInfo,m=e.activeColFieldInfo,e=this.hqt(t,i)&&this.hqt(t,i).formatter,$(e)||(c=J.Be.Re(c,e)),3!==l){switch(this.options.showMissing&&(s=this.options.missingCaption),u){case 3:if(!$(h)){if(5===l||1===h.length&&h[0].fieldName===F){c=c||h[0].itemName||s,$(c)||(r=[c]);break}if(p){for(;0<=p.index&&h[p.index]&&$(h[p.index].itemName);)p.index=p.index-1;(b=h[p.index])&&(o=b.itemName+" ("+b.fieldName+")")}r=[o,a=it().toolTipContent_Row+N(h)]}break;case 2:if($(d)&&!$(v)){if(5===l||1===v.length&&v[0].fieldName===F){c=c||v[0].itemName||s,$(c)||(r=[c]);break}if(m){for(;0<=m.index&&v[m.index]&&$(v[m.index].itemName);)m.index=m.index-1;(b=v[m.index])&&(o=b.itemName+" ("+b.fieldName+")")}r=[o,a=it().toolTipContent_Column+N(v)]}break;case 4:$(f)||($(c=c||s)&&(c=it().toolTipContent_NoValue),r=[f,o=it().toolTipContent_Value+c],$(h)||(b=it().toolTipContent_Row+N(h),r.push(b)),$(v))||(b=it().toolTipContent_Column+N(v),r.push(b))}if(!$(r)){for(g=0;g<r.length;g++)r[g]=B.j0(r[g]);n?r.unshift(it().PivotTableForAccessibility+this.Zc):r[0]="<b>"+r[0]+"</b>",r=r.join("\r\n")}}return r}},c.prototype.getPivotInfo=function(t,i){var n,e,e,n=this,e=n.getRange();if((e.content.contains(t,i)||e.page&&e.page.contains(t,i))&&(e=n.getPivotInfoImp(t,i),!$(e)))return e.row=t,e.col=i,e},c.prototype.getPivotInfoImp=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,l,p,m,b,p,g,f,c,o=this,a=t-o.eZt.row,s=i-o.eZt.col;return o.Oy()?{menuArea:3}:(c=t-o.LYt.row,u=i-o.LYt.col,f=(l=o.rZt.HWt)[0],h=l[1],v=l[2],d=l[3],l=l[4],m=(p=o.dh).B,b=p.R,p=p.Q,f.Sx>c?((g=o.vqt(c,u,f)).row=t,g.col=i,(f=f.XWt(c,u))&&(g.pageFieldInfo={fieldName:f}),g.menuArea=0,g):h.Sx>a?h.Tx>s?((g=o.vqt(a,s,h)).row=t,g.col=i,c=h.ZWt[s],g.menuArea=3,a==h.Sx-1&&c?(g.cornerFieldInfo={fieldName:c.fieldName,isDim:c.isDim,isCompactRoot:c.isCompactRoot},c.isCompactRoot||(g.menuArea=2)):0==a&&0==s&&1===o.rot().length&&g.value&&(g.menuArea=1),g):o.dqt(a,s-h.Tx,v,b,!1,n,e,r):d.Tx>s?o.dqt(a-h.Sx,s,d,m,!0,n,e,r):o.pqt(a-h.Sx,s-h.Tx,[d,v,l],[m,b,p],n,e,r))},c.prototype.vqt=function(t,i,n){return{relativeRow:t,relativeColumn:i,value:n.Sl(t,i),area:n.QWt}},c.prototype.pqt=function(t,i,n,e,r,o,a){var s,c,u,n,l,f,e,h,f,v,d,d,p,c,l,u,s=this,c=n[0],u=n[1],n=n[2],l=e[0],f=e[1],e=e[2],h=s.IZt,d={},v=(d=1<s.dh.Q.length?s.dh.getSigmaValuePosition():d).positionType,d=d.positionIndex,p=s.CWt===X.PivotTableLayoutType.compact,c=ct(t,i,c,l,h,0===v?d:tt,!0,p,r,o,a),l=ut(t,i,u,f,h,1===v?d:tt,!0,p,r,o,a);return(u=s.vqt(t,i,n)).menuArea=4,!c||!1!==c.isValueFieldDim||$(v)&&!a||(u.menuArea=3),c&&c.isBlankRow&&(u.menuArea=3),c&&(u.rowInfos=c.PJt),l&&!l.isBlankColumn&&(u.colInfos=l.FJt),f=0===v?c&&c.OJt:l&&l.OJt,$(f)&&1===s.dh.Q.length&&(f=e[0].Zc),o&&1===s.dh.Q.length&&(f=this.dh.getFieldInfoByName(f).a),u.area=n.QWt,u.valueFieldName=f,u},c.prototype.dqt=function(t,i,n,e,r,o,a,s){var c,u,l,f,h,v,d,p,p,m,r,b,r,g,g,w,r,g,y,c=this,u=c.IZt,l=c.CWt===X.PivotTableLayoutType.compact,h=c.vqt(t,i,n),v,p={},d=(p=1<c.dh.Q.length?c.dh.getSigmaValuePosition():p).positionType,p=p.positionIndex;return r?(r=(m=n.zWt)[t])&&(h.menuArea=2,r.isBlankRow&&(h.menuArea=3),r.isGrandTotal&&(h.menuArea=5),b=0===d?p:tt,(!l&&!$(b)&&i===b&&r.valueFieldName||l&&r.isSigmaValue)&&(h.menuArea=4),a||(f=ct(t,i,n,e,u,b,!1,l,o,a,s))&&(h.activeRowFieldInfo=f.activeRowFieldInfo,h.rowInfos=f.PJt,f.OJt)&&(h.valueFieldName=f.OJt)):0===t?(r="",(g=n.ZWt[i])?(r=g.fieldName,g=g.isCompactRoot,r&&(h.colHeadFieldInfo={fieldName:r,itemName:"",isRootCell:!0,isCompactRoot:g},h.menuArea=l?3:2)):0===e.length&&h.value&&1<=c.dh.Q.length?h.menuArea=4:h.menuArea=3):(r=(w=n.WWt)[i])&&(h.menuArea=2,g=r.isGrandTotal,(y=r.isBlankColumn)||(g&&(h.menuArea=5),$(b=1===d?p:tt)||t-1!==b||(h.menuArea=4),a)||(f=ut(t,i,n,e,u,b,!1,l,o,a,s))&&(h.activeColFieldInfo=f.activeColFieldInfo,h.colInfos=f.FJt,f.OJt)&&(h.valueFieldName=f.OJt)),h},c.prototype.Oy=function(){var t=this.dh,i=t.G,n=t.B,e=t.R,t=t.Q;return!(0<i.length||0<n.length||0<e.length||0<t.length)},c.prototype.wZt=function(){return this.dh.queryItem()},c.prototype.Get=function(){return this.dh.Get()},c.prototype.bZt=function(){return this.dh.B},c.prototype.mZt=function(){return this.dh.R},c.prototype.gZt=function(){return this.dh.G},c.prototype.pZt=function(){return this.dh.Q},c.prototype.mqt=function(){return this.dh.getSigmaValuePosition().positionType},c.prototype.bit=function(){var t=this.dh;return[].concat(t.G,t.B,t.R)},c.prototype.rot=function(){var t=this.dh;return[].concat(t.Q)},c.prototype.getRange=function(){var t,i,n,e,r,i,n,e,r,i,t,e,r,t=this;return t.Oy()?{page:y,content:new J.Range(t.eZt.row,t.eZt.col,18,3)}:(n=(i=t.eZt).row,e=i.col,r=i.rowCount,i=i.colCount,n=new J.Range(n,e,r,i),t.LYt&&(r=(e=t.LYt).row,i=e.col,t=e.rowCount,e=e.colCount,(r=new J.Range(r,i,t,e)).colCount*r.rowCount)?{page:r,content:n}:{page:y,content:n})},c.prototype.clone=function(t,i,n,e){var r,o,a,r,t,s,r=this,o,a=r.Ti.parent;if(!$(t)&&0!==t.trim().length&&a&&(r=a.fMt.getPivotCacheByName(r.dh.L)))return new c(t=(0,q.fJt)(t,a),i,n,e,void 0,void 0,void 0,s=a.UYt(r.getName(),t))},c.prototype.suspendLayout=function(){this.Xst<=0&&(this.bqt=this.getRange()),this.Xst++},c.prototype.resumeLayout=function(){this.Xst--,this.refresh()},c.prototype.refresh=function(){this.iM(!1)},c.prototype.iM=function(t,i){var t;this.Xst<=0&&(this.Xst=0,this.dh.q3(tt,t,tt,i),this.bqt=y,t=this.Ti)&&t.hP()&&t.repaint()},c.prototype.updateDataModel=function(){var t=this;switch(t.rZt.c5(),t.CWt){case X.PivotTableLayoutType.outline:p.PivotTableOutlineLayout.render(t);break;case X.PivotTableLayoutType.tabular:m.PivotTableTabularLayout.render(t);break;case X.PivotTableLayoutType.compact:d.PivotTableCompactLayout.render(t)}},c.prototype.paint=function(t,i,n,e){var r,o,a,s,c,e;this.Ti.suspendPaint(),r=this.Ti,o=this.LYt,a=this.eZt,s=r.pivotTables.xJt,i||(r.suspendCalcService(),c=r.b3(),e=e?J.StorageType.data:J.StorageType.data|J.StorageType.style,o&&o.rowCount*o.colCount&&(s?c&&c.gF(o.row,o.col,o.rowCount,o.colCount):r.KI(o.row,o.col,o.rowCount,o.colCount,3,e,!1,!1,!0)),a&&(s?c&&c.gF(a.row,a.col,a.rowCount,a.colCount):r.KI(a.row,a.col,a.rowCount,a.colCount,3,e,!1,!1,!0,!!this.options.enableDataValueEditing))),n||this.updateDataModel(),i||r.resumeCalcService(!1),this.Ti.resumePaint()},c.prototype.gqt=function(t,i){var n,e,r,o,a,s,c,u,o,l,f,h,n=this,e=t-n.eZt.row,r=i-n.eZt.col,o=n.rZt.HWt,a=o[0],s=o[1],c=o[2],u=o[3],o=o[4],l=0<a.Sx&&0<a.Tx,f=t,h=i;return l&&(f=t-n.LYt.row,h=i-n.LYt.col),l&&a.Sx>f?a.ML(f,h):s.Sx>e?s.Tx>r?s.ML(e,r):c.ML(e,r-s.Tx):u.Tx>r?u.ML(e-s.Sx,r):o.ML(e-s.Sx,r-s.Tx)},c.prototype.wqt=function(t,i,n){var e=this,r=e.BJt;(r=r&&0!==Object.keys(r).length?r:new V.PivotTableTheme).h5(t,i,n,e)},c.prototype.hqt=function(t,i){var n,e,r,o,e,o,r,e,n,n=this,e=n.UJt,r=n.QJt,o=n.WJt,e=e[t]&&e[t][i],o=o[t]&&o[t][i],r=r[e],e=n.gqt(t,i);if(r||o||e)return n=new J.Style,$(r)||n.h5(r),$(o)||n.h5(o),$(e)||n.h5(e),n},c.prototype.getStyle=function(t){for(var i,n,e,r,o,i,n=this.lZt,e=!1,o=n.length-1;0<=o;o--)h(t,n[o].pivotArea)&&(e=!0,n[o].style)&&(r?r.compose(n[o].style):r=n[o].style.clone());if(e)return r},c.prototype.setStyle=function(t,i){var n,e,n=this;$(t)||(t.references&&0<t.references.length&&ft(t),e=(e=this.getStyle(t))&&e.clone(),n.yqt(t,i),this.DT({pivotTable:this,pivotArea:t,style:i,type:"setStyle",oldStyle:e,pivotType:0}),n.uqt(),n.refresh())},c.prototype.yqt=function(t,i,n,e){var n,r,o;$(t)||n&&!i||(n=this,i?i.clone?r=i.clone():(r=new J.Style).fromJSON(i,!1,tt):r=i,n.lZt.push(o={style:r,pivotArea:t,isFakeStyle:e}))},c.prototype.getHost=function(){return this.Ti},c.prototype.rqt=function(t,i){var n,e,r,n=this,e=[],r={};J.GC$.extend(e,n.lZt),J.GC$.extend(r,n.UJt),n.lZt=t||[],n.UJt=i||{},n.DT({type:"resetPivotStyle",areaModel:e,rangeModel:r,pivotTable:n,pivotType:0})},c.prototype.clearAll=function(){var t,i,n,e,r,o,o,a,s,t=this;for(t.suspendLayout(),n=(i=t.getFieldsByArea()).length,e=t.dh,r=n-1;0<=r;r--)o=i[r].fieldName,t.remove(i[r].fieldName),o=e.getSourceNameByFieldName(o),e.cC(o)&&e.cy(o,null,!0);for(t.rqt(),s=(a=t.mJ.QP()).length-1;-1<s;s--)t.mJ.XJt(a[s].conditionalRule);t.resumeLayout()},c.prototype.getConditionalRules=function(t){return this.mJ.YJt(t)},c.prototype.addConditionalRule=function(t,i){this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.HJt(t,i)},c.prototype.removeConditionalRule=function(t){this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.XJt(t)},c.prototype.tqt=function(t,i,n,e,r){this.mJ.tqt(t,i,n,e,r)},c.prototype.iqt=function(){this.mJ.iqt()},c.prototype.DJt=function(t){this.mJ.DJt(t)},c.prototype.Cqt=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D;if(t&&0<t.length&&n){for(r=(e=this).UJt,o=e.QJt,a=e.WJt,s=0,c=t.length;s<c;s++)for(u=t[s],l=W(n),f=u.row,h=u.col,v=u.rowCount,d=u.colCount,p=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom)&&wt(p={},u,l),m=l.borderLeft,b=l.borderRight,g=l.borderTop,w=l.borderBottom,l.borderLeft=tt,l.borderRight=tt,l.borderTop=tt,l.borderBottom=tt,y=0;y<v;y++)for(r[f+y]||(r[f+y]={}),p&&p[f+y]&&!a[f+y]&&(a[f+y]={}),C=0;C<d;C++)$(r[f+y][h+C])?(o[i]||(o[i]=W(l)),r[f+y][h+C]=i,p&&p[f+y]&&p[f+y][h+C]&&(N=new J.Style,I=p[f+y][h+C],N.borderLeft=I.borderLeft?m:tt,N.borderRight=I.borderRight?b:tt,N.borderTop=I.borderTop?g:tt,N.borderBottom=I.borderBottom?w:tt,a[f+y][h+C]=N)):(o[A=r[f+y][h+C]+"-"+i]||(T=W(o[r[f+y][h+C]]),(M=W(l)).h5(T),o[A]=M,p&&p[f+y]&&p[f+y][h+C]&&(N=new J.Style,I=p[f+y][h+C],N.borderLeft=I.borderLeft?m:tt,N.borderRight=I.borderRight?b:tt,N.borderTop=I.borderTop?g:tt,N.borderBottom=I.borderBottom?w:tt,a[f+y]&&a[f+y][h+C]&&N.h5(a[f+y][h+C]),a[f+y]||(a[f+y]={}),a[f+y][h+C]=N)),r[f+y][h+C]=A);if((S=n.formatter)&&"string"==typeof S&&E(S))for(x=0;x<t.length;x++)D=t[x],e.Ti.SL(D.row||0,D.col||0,S)}},c.prototype.Iqt=function(t){return!(!0===t.labelOnly&&!0===t.dataOnly||!0===t.labelOnly&&!t.references&&$(t.type)&&!t.grandRow&&!t.grandCol)},c.prototype.rJt=function(t,i){var n,e,r,n,r,o,n=this,e=n.eZt,r=n.rZt.HWt[4];return!n.Oy()&&0!==r.Sx&&0!==r.Tx&&(n=r.Sx,r=r.Tx,!!(o=new J.Range(e.row+e.rowCount-n,e.col+e.colCount-r,n,r)).contains(t,i))},c.prototype.setNodeValue=function(t,i){return this.oJt(t,i,!1)},c.prototype.oJt=function(t,i,n){var e,r,o,a,e=this,r=e.dh;if(!$(t))return"number"==typeof i?(t=e.Aqt(t),(0,K.ht)(t)||(a=r.tQt(t),o=r.XVt(t,i),e.DT({type:"setNodeValue",pivotTable:e,nodeInfo:t,oldValue:a}))):(0,K.ht)(i)&&(t=e.Aqt(t),(0,K.ht)(t)||(a=r.tQt(t),o=r.iQt(t),e.DT({type:"setNodeValue",pivotTable:e,nodeInfo:t,oldValue:a}))),e.iM(n),o},c.prototype.Aqt=function(t,e){var r,o,a,s,c,i,n,u,r=this.dh,o=r.getAllFieldNameList(),a=r.X;if(!((t=(0,q.RF)(t))&&t.fieldInfos&&0<t.fieldInfos.length&&(s=this.getCalcItems(),(c=!1,K.o)(t.fieldInfos,function(t){var i=t.fieldName,n;if(e){if(!(n=a[i]))return}else if(!(n=r.getSourceNameByFieldName(i))){if(-1===o.indexOf(i))return;n=i}s.some(function(t){return t.sourceName===n})?c=!0:t.fieldName=n}),c))){if(t.valueInfo){if(i=t.valueInfo.sourceName,e){if(!(n=a[i]))return}else if(!(n=r.getSourceNameByFieldName(i))){if(-1===o.indexOf(i))return;n=i}if((u=this.getCalcFields()).some(function(t){return t.fieldName===i||t.fieldName===n}))return;t.valueInfo.sourceName=n}return t}},c.prototype.getNodeValue=function(t){var i=this,n=i.dh;if(!$(t))return t=i.Aqt(t,!0),(0,K.ht)(t)?y:n.tQt(t)},c.prototype.getNodeInfo=function(t,i){var n,e,n,t,i,n,e,r,t,n=this,e=n.dh;if(n.rJt(t,i)&&(t=(n=n.getPivotInfoImp(t,i)).valueFieldName,i=n.rowInfos,n=n.colInfos,e=e.getFieldInfoByName(t),!$(e.a))&&!$(e.Ar))return r={fieldInfos:[],valueInfo:{sourceName:t,subtotalType:e.Ar}},t=function(t){var i=t.fieldName,t=t.itemName;(0,K.ht)(t)||i===it().sigmaValue||r.fieldInfos.push({fieldName:i,fieldItem:t})},i&&0<i.length&&(0,K.o)(i,t),n&&0<n.length&&(0,K.o)(n,t),r},c.prototype.getOverwriteList=function(){var n,t,n=this.dh,t=n.eQt();return t&&0<t.length&&(0,K.o)(t,function(t){var t=t.fieldInfos;t&&0<t.length&&(0,K.o)(t,function(t){var i=n.getFieldNameBySourceName(t.fieldName);i&&(t.fieldName=i)})}),t},c.prototype.clearOverwriteList=function(){this.dh.rQt(),this.refresh()},c.prototype.getPivotAreaRanges=function(t){var i,n,e;return $(t)||!this.Iqt(t)?[]:(i=this,t.grandRow||t.grandCol?i.Nqt(t):$(t.references)?$(t.type)?!0!==t.labelOnly?(n=i.rZt.HWt,e=i.eZt,[new J.Range(n[4].DQ+e.row,n[4].jN+e.col,n[3].Sx,n[2].Tx)]):[]:i.Tqt(t):i.Mqt(t))},c.prototype.Nqt=function(t){var i,n,e,n,r,o,a,s,o,c,u,l,f,l,a,s,f,l,o,h,o,v,d,p,m,b,g,w,y,C,N,i=this,n=i.options.grandTotalPosition,e=n===X.GrandTotalPosition.both||n===X.GrandTotalPosition.row,n=n===X.GrandTotalPosition.both||n===X.GrandTotalPosition.col;if(e||n){if(a=(o=i.rZt.HWt)[4],s=o[3],o=o[2],c=t.references,u=t.references&&0<t.references.length,f=(l=i.eZt).row,l=l.col,a=new J.Range(a.DQ+f,a.jN+l,s.Sx,o.Tx),s=new J.Range(s.DQ+f,s.jN+l,s.Sx,s.Tx),f=new J.Range(o.DQ+f+1,o.jN+l,o.Sx-1,o.Tx),l=i.dh.Q.length,h=(o=i.dh.getSigmaValuePosition()).positionType===K.DataPosition.row,o=o.display,v=new J.Range(a.row+a.rowCount-(o&&h?l:1),s.col,o&&h?l:1,s.colCount+a.colCount),d=new J.Range(f.row,a.col+a.colCount-(o&&!h?l:1),f.rowCount+a.rowCount,o&&!h?l:1),m=!0===t.grandRow&&e,b=!0===t.grandCol&&n,m)p=v;else{if(!b)return[];p=d}if(u&&(g={dataOnly:t.dataOnly,labelOnly:t.labelOnly,references:c},w=i.Mqt(g))&&0<w.length){for(y=[],C=0;C<w.length;C++)m&&(w[C]=v.getIntersect(w[C],0,0)),b&&w[C]&&(w[C]=d.getIntersect(w[C],0,0)),w[C]&&y.push(w[C]);return y}if(!0===t.grandRow&&!0===t.grandCol)return e&&n&&!t.references&&(r=v.getIntersect(d,0,0))?[r]:[];if(!u)return(r=p.getIntersect(t.labelOnly&&!t.dataOnly?t.grandRow?s:f:a,0,0))?[r]:[];if((g=Z(t)).dataOnly=!0,g.labelOnly=!1,(w=i.Mqt(g))&&0<w.length){for(y=[],N=0;N<w.length;N++)(r=p.getIntersect(w[N],0,0))&&y.push(r);return y=Ct(y)}}return[]},c.prototype.Tqt=function(t){var i,n,e,r,o,a,s,c,u,l,f,l,h,v,l,o,a,c,d,p,m,b,g,w,y,i=this,n=i.eZt,e=n.row,r=n.col,o=i.rZt.HWt[2],a=o.DQ,s=o.jN,c=o.Tx,u,l=i.rZt.HWt[3].DQ;if(t.type===X.PivotAreaType.corner){if($(t.offset))return[new J.Range(e,r,1,1)];if(f=G.formulaToRanges(i.Ti,t.offset,e,r,!0)[0].ranges,l=new J.Range(e,r,l-e,s-r),h=new J.Range(e+f.row,r+f.col,f.rowCount||1,f.colCount||1),v=l.getIntersect(h,0,0),!$(v))return[v]}else if(t.type===X.PivotAreaType.topRight){if(l=o.ZWt.length,$(t.offset))return[new J.Range(e+a,r+s+l,1,1)];if(f=G.formulaToRanges(i.Ti,t.offset,e+a,r+s+l,!0)[0].ranges,o=new J.Range(e+a,r+s+l,1,c-l),h=new J.Range(e+a+f.row,r+s+l+f.col,f.rowCount||1,f.colCount||1),v=o.getIntersect(h,0,0),!$(v))return[v]}else if(t.type!==X.PivotAreaType.button||$(t.fieldName)){if(t.type===X.PivotAreaType.all)return[new J.Range(n.row,n.col,n.rowCount,n.colCount)]}else{for(d=c=void 0,0===(a=i.dh.Z[t.fieldName])?d=i.LYt:1===a?d={row:e+(c=i.rZt.HWt[3]).DQ,col:r+c.jN}:2===a&&(d={row:e+(c=i.rZt.HWt[2]).DQ,col:r+c.jN}),p=void 0,m=[],1===a?m=i.rZt.HWt[3].WWt:2===a&&(m=i.rZt.HWt[2].zWt),b=0;b<m.length;b++)m[b]&&m[b].path===t.fieldName&&(p=b);if($(p)){if(0===a)for(g=i.dh.G,b=0;b<g.length;b++)if(g[b]&&g[b].Zc===t.fieldName)return w=i.options.displayFieldsInPageFilterArea,y=i.options.reportFilterFieldsPerColumn,w===X.DisplayFields.downThenOver?0===y?[new J.Range(d.row+b,d.col,1,1)]:[new J.Range(d.row+b%y,d.col+Math.floor(b/y),1,1)]:0===y?[new J.Range(d.row,d.col+3*b,1,1)]:[new J.Range(d.row+Math.floor(b/y),d.col+b%y,1,1)];return[]}if(1===a)return[new J.Range(d.row-1,d.col+ +p,1,1)];if(2===a)return[new J.Range(d.row,d.col+ +p-1,1,1)]}return[]},c.prototype.Mqt=function(t){for(var i,L,n,e,r,o,a,s,E,B,c,u,l,f,h,v,R,d,p,m,b,g,w,y,C,N,I,A,A,T,M,A,S,x,G,D,V,U,k,Q,j,O,A,P,W,z,Z,F,Y,_,H,i=this,L=i.rZt.HWt[4],n=i.eZt.row,e=i.eZt.col,r=L.DQ,o=L.jN,a=i.rZt.HWt[3].Sx,s=i.rZt.HWt[2].Tx,E=i.dh.Z,B=i.options.subTotalsPosition,c=i.dh.Q.length,u=[],l=1===t.references.length,h={},v=0,R=t.references.length;v<R;v++)h[p=(d=t.references[v]).fieldName]=d;for(m=!1,b=i.dh.B,g=i.dh.R,v=b.length-1;0<=v;v--)h[b[v].Zc]&&(!1===m?m=!0:h[b[v].Zc].xqt=!0);for(m=!1,v=g.length-1;0<=v;v--)h[g[v].Zc]&&(!1===m?m=!0:h[g[v].Zc].xqt=!0);for(v=0,R=t.references.length;v<R;v++){if(p=(d=t.references[v]).fieldName,w=d.items,y=t.labelOnly,C=t.dataOnly,N=d.subtotal,I=[],p===it().Values&&1<c)f=i.dh.getSigmaValuePosition().positionType===K.DataPosition.row?1:2;else{if(p===it().Values&&1===c&&($(w)||1===w.length&&w[0]===i.dh.Q[0].Zc)){I=[new J.Range(n+r,e+o,a,s)],u.push(I);continue}f=E[p]}if(A=(A=i.dh.getFieldInfoByName(p))&&A.Spi,T=(0,q.getActualSubtotalPosition)(B,A),A=M=void 0,1===f)A=i.rZt.HWt[3];else if(2===f)A=i.rZt.HWt[2];else{if(0!==f){u.push([]);continue}if(A=i.rZt.HWt[0],$(w)&&t.labelOnly){for(S=i.dh.G,x=0;x<S.length;x++)if(S[x]&&S[x].Zc===p){if(G=i.options.displayFieldsInPageFilterArea,D=i.options.reportFilterFieldsPerColumn,G===X.DisplayFields.downThenOver){if(0===D){I=[new J.Range(i.LYt.row+x,i.LYt.col,1,1)];break}I=[new J.Range(i.LYt.row+x%D,i.LYt.col+Math.floor(x/D)+1,1,1)];break}if(0===D){I=[new J.Range(i.LYt.row,i.LYt.col+3*x,1,1)];break}I=[new J.Range(i.LYt.row+Math.floor(x/D),i.LYt.col+x%D+1,1,1)];break}u.push(I);continue}}if(M=A&&A.YWt){if(!1===C&&$(y)?y=C=!0:(!1===C&&!1===y||C===tt&&y===tt)&&(C=!0),V=void 0,$(w))if((P=(A=i.dh.getFieldInfoByName(p))&&A._items)&&0<P.length){for(U=i.dh.Q,k={},x=0;x<c;x++)k[U[x].Zc]=x;for(x=0;x<P.length;x++)P[x]&&!$(P[x].value)&&(j=P[x].value,O=M[p]&&M[p][j],$(O)||(I=I.concat(i.Dqt(O,f,n,e,r,o,a,s,y,C,N,T,l,p===it().Values,j,k[j],d.xqt))))}else for(Z in z=0,W=M[p])W.hasOwnProperty(Z)&&(O=M[p]&&M[p][Z],$(O)||(I=I.concat(i.Dqt(O,f,n,e,r,o,a,s,y,C,N,T,l,p===it().Values,Z,0,d.xqt))));else{for(U=i.dh.Q,k={},x=0;x<c;x++)k[U[x].Zc]=x;for(x=0,Q=w.length;x<Q;x++)j=w[x],O=M[p]&&M[p][j],$(O)||(V=i.collapse(p,j),I=I.concat(i.Dqt(O,f,n,e,r,o,a,s,y,C,N,T,l,p===it().Values,w[x],k[w[x]],d.xqt,V)))}u.push(I)}}if(l)return u[0];for(F=u[0],v=1;v<u.length;v++){for(Y=[],x=0;x<F.length;x++)for(_=0;_<u[v].length;_++)(H=F[x]&&u[v][_]&&F[x].getIntersect(u[v][_]))&&Y.push(H);F=Y}return F=Ct(F)},c.prototype.Dqt=function(t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b){var g,w,y,t,C,y,N,I,A,T,T,g=this,w=[],y=t.ranges,t=t.level,C=f===X.SubtotalsPosition.top||f===X.SubtotalsPosition.bottom;return y&&(y=dt(y),I=N=void 0,A=g.dh.getSigmaValuePosition(),1===i?(T=g.dh.B.length,N=1<t&&C&&!(2===t&&A.display&&A.positionType===K.DataPosition.row&&T+1-A.positionIndex==1),I=A.display&&A.positionType===K.DataPosition.row&&T-A.positionIndex<t?g.dh.Q.length:1,g.Sqt(w,y,t,n+r,e+o,a,s,c,u,l,f,h,N,I,v,d,p,m)):2===i&&(T=g.dh.R.length,N=1<t&&C&&!(2===t&&A.display&&A.positionType===K.DataPosition.col&&T+1-A.positionIndex==1),I=A.display&&A.positionType===K.DataPosition.col&&T-A.positionIndex<t?g.dh.Q.length:1,g.kqt(w,y,t,n+r,e+o,a,s,c,u,l,f,h,N,I,v,d,p,b))),w},c.prototype.Sqt=function(t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b){for(var g,w,y,C,N,I,A,T,M,g,w=this.layoutType(),y=0,C=i.length;y<C;y++)$(i[y])||(!s||u&&!d||((N=new J.Range(0,0,0,0)).row=e+i[y].start,N.col=w===X.PivotTableLayoutType.compact?r-1:r-n,N.rowCount=w===X.PivotTableLayoutType.tabular||b?i[y].end-i[y].start+1:1,N.colCount=w!==X.PivotTableLayoutType.outline&&f?1:n,t.push(N)),!c||u&&!d||((I=new J.Range(0,0,0,0)).row=e+i[y].start,I.col=r,I.rowCount=d||b?i[y].end-i[y].start+1:1,I.colCount=a,t.push(I)),h&&u&&!d&&(A=l===X.SubtotalsPosition.top&&this.layoutType()!==X.PivotTableLayoutType.tabular?e+i[y].start:e+i[y].end+1,s&&l!==X.SubtotalsPosition.top?((N=new J.Range(0,0,0,0)).row=A,N.col=r-(w===X.PivotTableLayoutType.compact?1:n),N.rowCount=v,N.colCount=f||w===X.PivotTableLayoutType.compact?1:n,t.push(N)):((I=new J.Range(0,0,0,0)).row=A,I.col=r,I.rowCount=v,I.colCount=a,t.push(I))));c&&d&&(T=this.dh.Q.length,(M=new J.Range(0,0,0,0)).row=e+o-(T-m),M.col=r,M.rowCount=1,M.colCount=a,t.push(M))},c.prototype.kqt=function(t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b){for(var g,w,y,C,N,I,g=0,w=i.length;g<w;g++)$(i[g])||(!s||u&&!d||((y=new J.Range(0,0,0,0)).row=e-n,y.col=r+i[g].start,y.rowCount=f?1:n,y.colCount=i[g].end-i[g].start+1,t.push(y)),!c||u&&!d||((C=new J.Range(0,0,0,0)).row=e,C.col=r+i[g].start,C.rowCount=o,C.colCount=i[g].end-i[g].start+1,t.push(C)),h&&u&&!d&&(s?((y=new J.Range(0,0,0,0)).row=e-n,y.col=r+i[g].end+1,y.rowCount=f?1:n,y.colCount=v,t.push(y)):((C=new J.Range(0,0,0,0)).row=e,C.col=r+i[g].end+1,C.rowCount=o,C.colCount=v,t.push(C))));c&&d&&(N=this.dh.Q.length,(I=new J.Range(0,0,0,0)).row=e,I.col=r+a-(N-m),I.rowCount=o,I.colCount=1,t.push(I))},c.prototype.sqt=function(){var t,i,n,t=this,i=t.EZt,n=t.Ti;n.suspendPaint(),t.jqt(),t.options.mergeItem&&(t.Oqt(),t.Pqt()),n.resumePaint(),i.LZt=[],i.BZt=[]},c.prototype.jqt=function(){var t,i,n,e,r,t=this,i=t.EZt,n=t.Ti,e=i.GJt,r=i.RJt;0===r.length&&0===e.length||((0,K.o)(r,function(t){n.removeSpan(t.row,t.col)}),(0,K.o)(e,function(t){n.removeSpan(t.row,t.col)}),(0,K.o)(t.VJt,function(t){n.getRange(t.row,t.col,t.rowCount,t.colCount).vAlign(t.vAlign).hAlign(t.hAlign)}),i.GJt=[],i.RJt=[],t.VJt=[])},c.prototype.Pqt=function(){var t,r,i,n,e,o,o,a,s,c,u,l,f,t,o,h,v,t=this,r=t.Ti,i=t.rZt.HWt[3],n=t.rZt.HWt[2],e=t.EZt,o=n.isHideFirstRow?2:3;(!i||i.Tx<2)&&(!n||n.Sx<o)||(o=t.eZt,a=o.row,s=o.col,c=i.DQ,u=i.jN,l=n.DQ,f=n.jN,t=e.BZt,o=e.LZt,h=e.GJt,v=e.RJt,(0,K.o)(o,function(t){var i=t.row,n=t.col,e=t.rowCount,t=t.colCount;r.EL(i+=c+a,n+=u+s,e,t),h.push({row:i,col:n,rowCount:e,colCount:t})}),(0,K.o)(t,function(t){var i=t.row,n=t.col,e=t.rowCount,t=t.colCount;r.EL(i+=l+a,n+=f+s,e,t),v.push({row:i,col:n,rowCount:e,colCount:t})}))},c.prototype.Oqt=function(){var t,i,n,e,r,o,a,s,a,t=this,i=t.Ti,n=t.VJt,e=t.rZt.HWt[3].getRange(),r=t.rZt.HWt[2].getRange(),o=t.rZt.HWt[1].getRange(),a=t.eZt,s=a.row,a=a.col;t.layoutType()!==X.PivotTableLayoutType.compact&&n.push(t.Fqt(i.getRange(e.row+s,e.col+a,e.rowCount,e.colCount))),n.push(t.Fqt(i.getRange(r.row+s,r.col+a,r.rowCount,r.colCount))),n.push(t.Fqt(i.getRange(o.row+s,o.col+a,o.rowCount,o.colCount)))},c.prototype.Fqt=function(t){var i={row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount,vAlign:t.vAlign(),hAlign:t.hAlign()};return t.hAlign(1).vAlign(1),i},c.prototype.zRt=function(t){var i;return this.dh.getFieldInfoByName(t)},c.prototype.isSortValueField=function(t){var i,i,i,n,e,r,n,o;if(t)return 2!==(r=(e=this).mqt())&&(n=it(),((null==(i=t.cornerFieldInfo)?void 0:i.fieldName)||(null==(i=t.colHeadFieldInfo)?void 0:i.fieldName))===n.Values||(o=n.sigmaValue,0===r&&3===t.area?null==(i=t.rowInfos)?void 0:i.some(function(t){return t.fieldName===o}):r===K.DataPosition.col&&2===t.area&&(null==(n=t.colInfos)?void 0:n.some(function(t){return t.fieldName===o}))))},c.prototype.fromJson=function(t,i){var n,e,r,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,n=this;if(n._qt(t),$(t.multipleFieldFilters)?n.options.allowMultipleFiltersPerField=!0:n.options.allowMultipleFiltersPerField=t.multipleFieldFilters,$(t.styleName)?n.theme("light0"):(e=x.BuiltInPivotTableThemeNames[t.styleName.toUpperCase()])?(r=t.styleName.replace("PivotStyle","").toLowerCase(),n.theme(r)):(r=t.style,(o=new V.PivotTableTheme).fromJSON(r),n.theme(o)),!1===t.rowGrandTotals&&!1===t.colGrandTotals?n.options.grandTotalPosition=X.GrandTotalPosition.none:!1===t.rowGrandTotals?n.options.grandTotalPosition=X.GrandTotalPosition.row:!1===t.colGrandTotals?n.options.grandTotalPosition=X.GrandTotalPosition.col:n.options.grandTotalPosition=X.GrandTotalPosition.both,$(t.showRowHeaders)||(n.options.showRowHeader=t.showRowHeaders),$(t.showColHeaders)||(n.options.showColumnHeader=t.showColHeaders),$(t.showRowStripes)||(n.options.bandRows=t.showRowStripes),$(t.showColStripes)||(n.options.bandColumns=t.showColStripes),$(t.pageOverThenDown)||(n.options.displayFieldsInPageFilterArea=t.pageOverThenDown?X.DisplayFields.overThenDown:X.DisplayFields.downThenOver),$(t.pageWrap)||(n.options.reportFilterFieldsPerColumn=t.pageWrap),$(t.showFilter)||(n.options.showFilter=t.showFilter),$(t.showDrill)||(n.options.showDrill=t.showDrill),$(t.showToolTip)||(n.options.showToolTip=t.showToolTip),$(t.showMissing)||(n.options.showMissing=t.showMissing),$(t.missingCaption)||(n.options.missingCaption=t.missingCaption),$(t.indent)?n.options.rowLabelIndent=2:n.options.rowLabelIndent=t.indent+1,$(t.errorCaption)||(n.options.errorValueInfo=t.errorCaption),$(t.showError)||(n.options.isShowErrorValue=t.showError),$(t.showDataTips)||(n.options.showToolTip=t.showDataTips),$(t.showHeaders)||(n.options.showHeaders=t.showHeaders),$(t.mergeItem)||(n.options.mergeItem=t.mergeItem),$(t.dataCaption)||(n.cCi=t.dataCaption),$(t.fillDownLabels)||(n.options.fillDownLabels=t.fillDownLabels),$(t.printDrill)||(n.options.printDrill=t.printDrill),$(t.itemPrintTitles)||(n.options.itemPrintTitles=t.itemPrintTitles),$(t.fieldPrintTitles)||(n.options.fieldPrintTitles=t.fieldPrintTitles),$(t.rowHeaderCaption)||(n.options.rowHeaderCaption=t.rowHeaderCaption),$(t.colHeaderCaption)||(n.options.colHeaderCaption=t.colHeaderCaption),$(t.enableDataValueEditing)||(n.options.enableDataValueEditing=t.enableDataValueEditing),!$(t.formats))for(a=0;a<t.formats.length;a++)s=t.formats[a],$(s.style)||M(s.style)||(c=void 0,c=(u=s.pivotArea).missed?u.pivotArea:n.excelPivotAreaToSheetPivotArea(u),(l=new J.Style).fromJSON(s.style,!1,tt),n.yqt(c,l,!0));if(h=(f=n.Ti).conditionalFormats,!$(t.pivotTableConditionFormats)&&h){for(v=[],d=[],a=0;a<t.pivotTableConditionFormats.length;a++)t.pivotTableConditionFormats[a]&&t.pivotTableConditionFormats[a].rule&&(v[t.pivotTableConditionFormats[a].rule.priority-1]=t.pivotTableConditionFormats[a]);for(a=v.length-1;0<=a;a--)v[a]&&d.push(v[a]);for(t.pivotTableConditionFormats=d,a=0;a<t.pivotTableConditionFormats.length;a++){for(p=t.pivotTableConditionFormats[a],m=[],b=0;b<p.pivotAreas.length;b++)c=void 0,c=(u=p.pivotAreas[b]).missed?u.pivotArea:n.excelPivotAreaToSheetPivotArea(u),m.push(c);p.rule&&(g=void 0,p.rule.ruleType?g=h.pJ(p.rule,f,!1):p.rule.priority&&i.conditionalFormats&&i.conditionalFormats.rules&&(g=h.pJ(i.conditionalFormats.rules[p.rule.priority-1],f,!1)),n.mJ.HJt(m,g,!0))}}if($(t.views)||n.views.fromJson(t.views),$(t.altText)||(n.zJt=t.altText),$(t.altTextSummary)||(n.ZJt=t.altTextSummary),$(t.hideValuesRow)||(n.options.hideValuesRow=t.hideValuesRow),t.dataFields&&0<t.dataFields.length)for(y=0,C=w=t.dataFields;y<C.length;y++)N=C[y],$(N.showDataAs)||(n.eqt=!0)},c.prototype.yh=function(t,i,n){var e,r,o,a,a,s,c,c,a,c,o,u,l,f,h,v,d,v,p,m,b,g,w,a,y,C,N,c,I,o,A,T,M,S,e=this,r=i.styleManager;if(e.Lqt(t,r),$(t.multipleFieldFilters)?e.options.allowMultipleFiltersPerField=!0:e.options.allowMultipleFiltersPerField=O(t.multipleFieldFilters),a=(o=k(t,"pivotTableStyleInfo"))&&o.name,a=(a=$(a)?"PivotStyleLight0":a)||r.getDefaultStyleName("defaultPivotStyle"),(s=x.BuiltInPivotTableThemeNames[a.toUpperCase()])?(c=a.replace("PivotStyle","").toLowerCase(),e.theme(c)):(c=r.getPivotTableTheme(a),e.theme(c)),$(o)||(e.options.showRowHeader=O(o.showRowHeaders,!1),e.options.showColumnHeader=O(o.showColHeaders,!1),$(o.showRowStripes)||(e.options.bandRows=O(o.showRowStripes)),$(o.showColStripes))||(e.options.bandColumns=O(o.showColStripes)),a=O(t.rowGrandTotals),c=O(t.colGrandTotals),e.options.grandTotalPosition=!1===a&&!1===c?X.GrandTotalPosition.none:!1===a?X.GrandTotalPosition.row:!1===c?X.GrandTotalPosition.col:X.GrandTotalPosition.both,$(t.pageOverThenDown)||(e.options.displayFieldsInPageFilterArea=O(t.pageOverThenDown)?X.DisplayFields.overThenDown:X.DisplayFields.downThenOver),$(t.pageWrap)||(e.options.reportFilterFieldsPerColumn=P(t.pageWrap)),(o=t.lossless)&&($(o.showFilter)||(e.options.showFilter=o.showFilter),$(o.showToolTip)||(e.options.showToolTip=o.showToolTip),$(o.enableDataValueEditing)||(e.options.enableDataValueEditing=o.enableDataValueEditing),$(o.views)||e.views.fromJson(o.views)),$(t.showDrill)||(e.options.showDrill=O(t.showDrill)),$(t.showMissing)||(e.options.showMissing=O(t.showMissing)),$(t.missingCaption)||(e.options.missingCaption=t.missingCaption),$(t.indent)?e.options.rowLabelIndent=2:e.options.rowLabelIndent=P(t.indent)+1,$(t.errorCaption)||(e.options.errorValueInfo=t.errorCaption),$(t.showError)||(e.options.isShowErrorValue=O(t.showError)),$(t.showDataTips)||(e.options.showToolTip=O(t.showDataTips)),$(t.showHeaders)||(e.options.showHeaders=O(t.showHeaders)),$(t.mergeItem)||(e.options.mergeItem=O(t.mergeItem)),$(t.dataCaption)||(e.cCi=t.dataCaption),$(t.printDrill)||(e.options.printDrill=O(t.printDrill)),$(t.itemPrintTitles)||(e.options.itemPrintTitles=O(t.itemPrintTitles)),$(t.fieldPrintTitles)||(e.options.fieldPrintTitles=O(t.fieldPrintTitles)),$(t.rowHeaderCaption)||(e.options.rowHeaderCaption=t.rowHeaderCaption),$(t.colHeaderCaption)||(e.options.colHeaderCaption=t.colHeaderCaption),u=k(t,"formats"),l=o&&o.pivotStyles,!$(u)){for(u=u.c_||[],f=[],l&&Object.keys(l).forEach(function(t){var i=new J.Style;i.fromJSON(l[t].style,!1,tt),f[t]={pivotArea:l[t].pivotArea,style:i}}),h=0;h<u.length;h++)if(v=u[h],d=P(v.dxfId),v=e.excelPivotAreaSJSToSheetPivotArea(k(v,"pivotArea")),p=new J.Style,r.getDxf(d,p,tt,!0),p.fromJSON(p,!1,tt),f[h]){for(m=h+1;f[m];)m++;f[m]={pivotArea:v,style:p}}else f[h]={pivotArea:v,style:p};for(h=0;h<f.length;h++)e.yqt(f[h].pivotArea,f[h].style,!0)}if(b=e.Ti,g=b.conditionalFormats,w=!1,a=k(t,"conditionalFormats"),o&&o.conditionalFormats&&0<o.conditionalFormats.length)for(w=!0,y=o.conditionalFormats,h=0;h<y.length;h++)(C=y[h])&&(N=g.pJ(C.rule,b))&&e.mJ.HJt(C.pivotAreas,N,!0);else!$(a)&&a.c_&&0<a.c_.length&&e.tCi(n,a,g,i,r);if(c=k(t,"extLst"),e.options.hideValuesRow=!1,$(c)||(I=c.c_).forEach(function(t){var t,t,t=k(t,"pivotTableDefinition");$(t)||($(t.altText)||(e.zJt=t.altText),$(t.fillDownLabelsDefault)||(e.options.fillDownLabels=O(t.fillDownLabelsDefault)),$(t.altTextSummary)||(e.ZJt=t.altTextSummary),e.options.hideValuesRow=O(t.hideValuesRow,!1),t=k(t,"conditionalFormats"),!0!==w&&!$(t)&&t.c_&&0<t.c_.length&&e.tCi(n,t,g,i,r))}),o=k(t,"dataFields"))for(T=0,M=A=o.c_;T<M.length;T++)S=M[T],$(S.showDataAs)||(e.eqt=!0)},c.prototype.tCi=function(t,i,n,e,r){var o,a,s,c,u,l,i,t,i,f,h,v,d,p,m,b,g,w,y,y,w,o=this,a=[],s=[],c=o.Ti,u=i.c_,l=A(t,"conditionalFormatting").filter(function(t){return!0===J.NodeHelper.ur(t.pivot)}),i=k(t,"extLst");for(i&&(t=I(i,"conditionalFormattings"))&&0<(i=A(t,"conditionalFormatting")).length&&(l=l.concat(i.filter(function(t){return(t.isExtRule=!0)===J.NodeHelper.ur(t.pivot)}))),f=function(n){var e,r,e=P(u[n].priority);l&&((0,K.o)(l,function(i){var t=i.c_;if((0,K.o)(t,function(t){if(+t.priority===e)return u[n].rule=t,r=i,!0}),r)return!0}),u[n].rule)&&(a[u[n].rule.priority-1]={pivotCf:u[n],sheetCf:r})},h=0;h<u.length;h++)f(h);for(h=a.length-1;0<=h;h--)a[h]&&s.push(a[h]);for(h=0;h<s.length;h++){for(v=s[h].pivotCf,p=(d=s[h].sheetCf).isExtRule,m=[],b=k(v,"pivotAreas").c_,g=0;g<b.length;g++)m.push(o.excelPivotAreaSJSToSheetPivotArea(b[g]));v.rule&&(w=d.sqref,p&&(w=(y=k(d,"sqref"))&&y.c_[0]),y=J.range_parser.Dc(w),w=void 0,v.rule.type?w=n.xJ(v.rule,y,r,c,void 0,p):v.rule.priority&&d&&d.c_&&(w=n.xJ(d.c_[v.rule.priority-1],y,r,c,void 0,p)),w)&&o.mJ.HJt(m,w,!0)}},c.prototype._qt=function(t){for(var i,n,e,r,o,a,s,c,u,i=this,n=t.fields,e=0,r=n.length;e<r;e++)o=n[e],$(o.numberFormat)||(a={labelOnly:!0,references:[{fieldName:o.name}]},(s=new J.Style).formatter=o.numberFormat,i.yqt(a,s,!0,!0));if((c=t.dataFields)&&0<c.length)if(1!==(u=c.length)||$(c[0].numberFormat))for(e=0;e<u;e++)o=c[e],$(o.numberFormat)||(a={dataOnly:!0,references:[{fieldName:it().Values,items:[o.name]}]},(s=new J.Style).formatter=o.numberFormat,i.yqt(a,s,!0,!0));else a={dataOnly:!0},(s=new J.Style).formatter=c[0].numberFormat,i.yqt(a,s,!0,!0)},c.prototype.Lqt=function(t,i){var n,e,r,o,a,s,c,u,l,n=this,e=k(t,"pivotFields");if(e)for(r=0,o=e.c_.length;r<o;r++)a=e.c_[r],$(a.numFmtId)||(s={labelOnly:!0,references:[{fieldName:a.name}]},c=It(i,a),n.yqt(s,c,!0,!0));if(l=(u=k(t,"dataFields"))&&u.c_.length,u&&0<l)if(1!==l||$(u.c_[0].numFmtId))for(r=0;r<l;r++)a=u.c_[r],$(a.numFmtId)||(s={dataOnly:!0,references:[{fieldName:it().Values,items:[a.name]}]},c=It(i,a),n.yqt(s,c,!0,!0));else s={dataOnly:!0},c=It(i,u.c_[0]),n.yqt(s,c,!0,!0)},c.prototype.excelPivotAreaToSheetPivotArea=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,i=this,n=i.dh.Pq,e={};if($(t.labelOnly)||(e.labelOnly=t.labelOnly),$(t.dataOnly)||(e.dataOnly=t.dataOnly),$(t.grandCol)||(e.grandCol=t.grandCol),$(t.grandRow)||(e.grandRow=t.grandRow),"axisRow"===t.axis?e.axis=X.PivotAreaAxisType.row:"axisCol"===t.axis&&(e.axis=X.PivotAreaAxisType.col),!$(t.references)&&0<t.references.length){for(e.references=[],r=0;r<t.references.length;r++)if(a={},s=(o=t.references[r]).field===C||o.field===+C?{Zc:it().Values,_items:[]}:n[o.field]){if(c=s.Zc,o.indexes){for(u=[],l=0,f=o.indexes.length;l<f;l++)h=o.indexes[l],$(h)||u.push(c===it().Values?i.dh.Q[h].Zc:s._items[h]&&s._items[h].value);0<u.length&&(a.items=u)}a.fieldName=c,$(o.defaultSubtotal)||(a.subtotal=o.defaultSubtotal),e.references.push(a)}}else $(t.type)||(e.type=ht(t.type),e.fieldName=n&&n[t.field]&&n[t.field].Zc,e.offset=t.offset);return e},c.prototype.excelPivotAreaSJSToSheetPivotArea=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,i=this,n=i.dh.Pq,e={};if($(t.labelOnly)||(e.labelOnly=O(t.labelOnly)),$(t.dataOnly)||(e.dataOnly=O(t.dataOnly)),$(t.grandCol)||(e.grandCol=O(t.grandCol)),$(t.grandRow)||(e.grandRow=O(t.grandRow)),"axisRow"===t.axis?e.axis=X.PivotAreaAxisType.row:"axisCol"===t.axis&&(e.axis=X.PivotAreaAxisType.col),r=k(t,"references"),$(r))$(t.type)||(e.type=ht(t.type),s=P(t.field),e.fieldName=n&&n[s]&&n[s].Zc,e.offset=t.offset);else for(r=r.c_,e.references=[],o=0;o<r.length;o++)if(a=r[o],c={},u=(s=T(a.field))===C||s===+C?{Zc:it().Values,_items:[]}:n[s]){if(l=u.Zc,f=a.c_,!$(f)){for(h=[],v=0,d=f.length;v<d;v++)p=P(f[v].v),$(p)||h.push(l===it().Values?i.dh.Q[p].Zc:u._items[p]&&u._items[p].value);0<h.length&&(c.items=h)}c.fieldName=l,$(a.defaultSubtotal)||(c.subtotal=O(a.defaultSubtotal)),e.references.push(c)}return e},c.prototype.toJson=function(t,i){var n,e,r,o,a,i,s,r,c,u,a,l,f,o,o,o,r,h,r,o,r,o,r,v,d,p,m,b,g,w,y,C,N,I,A,g,T,M,S,x,D,k,j,O,P,j,F,n=this,e=n.getRange().content;if(!i||!i.ignoreStyle){switch(l=(a=n.dh)&&a.cft?a.cft:{},f=n.layoutType()){case X.PivotTableLayoutType.outline:l.compact=!1,l.compactData=!1,l.outline=!0,l.outlineData=!0;break;case X.PivotTableLayoutType.tabular:l.compact=!1,l.compactData=!1,l.outline=!1,l.outlineData=!1;break;default:l.outline=!0,l.outlineData=!0}if($(n.Zc)||(i&&i.newWorkSheetName&&n.Ti&&n.Ti.parent?(o=n.Ti.parent,l.name=n.Eqt=o.fJt(n.Zc)):l.name=n.Zc),$(n.options.allowMultipleFiltersPerField)||(l.multipleFieldFilters=n.options.allowMultipleFiltersPerField),(o=a.getSigmaValuePosition()).display&&o.positionType===K.DataPosition.row&&(l.dataOnRows=!0),r=(o=n.theme())&&o.name(),$(r)||((h=V.PivotTableThemes[r.toLowerCase()])?(r=r.replace(/^[a-z]{1}/g,function(t){return t.toUpperCase()}),l.styleName="PivotStyle"+r):(l.styleName=r,l.style=o.toJSON())),$(n.options.showRowHeader)||(l.showRowHeaders=n.options.showRowHeader),$(n.options.showColumnHeader)||(l.showColHeaders=n.options.showColumnHeader),$(n.options.bandRows)||(l.showRowStripes=n.options.bandRows),$(n.options.bandColumns)||(l.showColStripes=n.options.bandColumns),$(n.options.displayFieldsInPageFilterArea)||(l.pageOverThenDown=n.options.displayFieldsInPageFilterArea===X.DisplayFields.overThenDown),$(n.options.reportFilterFieldsPerColumn)||(l.pageWrap=n.options.reportFilterFieldsPerColumn),$(n.options.showFilter)||(l.showFilter=n.options.showFilter),$(n.options.showDrill)||(l.showDrill=n.options.showDrill),$(n.options.showMissing)||(l.showMissing=n.options.showMissing),$(n.options.showToolTip)||(l.showToolTip=n.options.showToolTip),$(n.options.missingCaption)||(l.missingCaption=n.options.missingCaption),$(n.options.fillDownLabels)||(l.fillDownLabels=n.options.fillDownLabels),$(n.options.rowLabelIndent)||2===n.options.rowLabelIndent||(l.indent=n.options.rowLabelIndent-1),$(n.options.printDrill)||(l.printDrill=n.options.printDrill),$(n.options.itemPrintTitles)||(l.itemPrintTitles=n.options.itemPrintTitles),$(n.options.fieldPrintTitles)||(l.fieldPrintTitles=n.options.fieldPrintTitles),$(n.options.mergeItem)||(l.mergeItem=n.options.mergeItem),$(n.options.grandTotalPosition)||((r=n.options.grandTotalPosition)!==X.GrandTotalPosition.none&&r!==X.GrandTotalPosition.col||(l.colGrandTotals=!1),r!==X.GrandTotalPosition.none&&r!==X.GrandTotalPosition.row)||(l.rowGrandTotals=!1),$(n.cCi)?l.dataCaption="Values":l.dataCaption=n.cCi,$(n.options.errorValueInfo)||(l.errorCaption=n.options.errorValueInfo),$(n.options.isShowErrorValue)||(l.showError=n.options.isShowErrorValue),$(n.options.showToolTip)||(l.showDataTips=n.options.showToolTip),$(n.options.showHeaders)||(l.showHeaders=n.options.showHeaders),$(n.options.rowHeaderCaption)||(l.rowHeaderCaption=n.options.rowHeaderCaption),$(n.options.colHeaderCaption)||(l.colHeaderCaption=n.options.colHeaderCaption),$(n.options.enableDataValueEditing)||(l.enableDataValueEditing=n.options.enableDataValueEditing),$(n.options.hideValuesRow)||(l.hideValuesRow=n.options.hideValuesRow),$(n.views)||(l.views=n.views.toJson()),$(n.zJt)||(l.altText=n.zJt),$(n.ZJt)||(l.altTextSummary=n.ZJt),$(l.createdVersion)&&(l.createdVersion=6),o=n.rZt&&n.rZt.HWt&&n.rZt.HWt&&n.rZt.HWt[4]&&n.rZt.HWt[4].DQ||0,r=n.rZt&&n.rZt.HWt&&n.rZt.HWt&&n.rZt.HWt[4]&&n.rZt.HWt[4].jN||0,n.pZt()&&0<n.pZt().length||n.bZt()&&0<n.bZt().length||n.mZt()&&0<n.mZt().length?l.firstHeaderRow=1:l.firstHeaderRow=0,l.firstDataRow=o,l.firstDataCol=r,o=n.dh.G&&n.dh.G.length,r=!$(n.options.reportFilterFieldsPerColumn),n.options.displayFieldsInPageFilterArea===X.DisplayFields.overThenDown?0===n.options.reportFilterFieldsPerColumn?(l.rowPageCount=1,l.colPageCount=o):(l.rowPageCount=r?Math.ceil(o/n.options.reportFilterFieldsPerColumn):1,l.colPageCount=r?Math.min(n.options.reportFilterFieldsPerColumn,o):o):0===n.options.reportFilterFieldsPerColumn?(l.rowPageCount=o,l.colPageCount=1):(l.rowPageCount=o&&Math.min(n.options.reportFilterFieldsPerColumn,o),l.colPageCount=o?Math.ceil(o/n.options.reportFilterFieldsPerColumn):1),l.ref=G.rangesToFormula([e],0,0,15,!1),a.PVt(),n.lZt&&0<n.lZt.length){for(l.formats=[],v=0;v<n.lZt.length;v++)if(p=(d=n.lZt[v]).pivotArea,!gt(m=d.style)&&!d.isFakeStyle&&(b=n.sheetPivotAreaToExcelPivotArea(p),l.formats.push({style:m,pivotArea:b=b||{pivotArea:p,missed:!0}}),p.references)&&1===p.references.length&&d.style&&!$(d.style.formatter))if(g=n.dh,p.references[0].fieldName===it().Values){for(y=(w=g.Q).length,C={},N=0;N<y;N++)C[w[N].Zc]=N;if(!(I=p.references[0].items))for(I=[],A=0;A<y;A++)I.push(w[A].Zc);for(A=0;A<I.length;A++)$(C[I[A]])||(w[C[I[A]]].bbt=d.style.formatter)}else!p.labelOnly||p.dataOnly||p.references[0].items&&0!==p.references[0].items.length||(g=g.DB(p.fieldName))&&(g.bbt=d.style.formatter);for(S in u=(t=t||{data:n.Ti.Ut.sheetModels[3].toJSON(3,i)}).data.dataTable,T=n.UJt,M=n.WJt,T)if(T.hasOwnProperty(S))for(D in x=T[S])x.hasOwnProperty(D)&&($(u[S])&&(u[S]={}),$(u[S][D])&&(u[S][D]={}),m=W(n.QJt[x[D]]),(k=M[S]&&M[S][D])&&m.h5(k),u[S][D].style&&m.h5(u[S][D].style),u[S][D].style=m)}if(n.mJ.qK&&0<n.mJ.qK.length)for(l.pivotTableConditionFormats=[],v=0;v<n.mJ.qK.length;v++){for(O=(j=n.mJ.qK[v]).pivotAreas,P=[],A=0;A<O.length;A++)b=(b=n.sheetPivotAreaToExcelPivotArea(O[A]))||{pivotArea:O[A],missed:!0},P.push(b);j=bt(j.conditionalRule,j.conditionalRule.toJSON(n.Ti)),l.pivotTableConditionFormats.push(F={rule:j,pivotAreas:P})}return a.toJson(n,l),l.rowItems=n.Bqt(!0),l.columnItems=n.Bqt(!1),n.options.subtotalsPosition===X.SubtotalsPosition.none?(l.enabledSubtotalsDefault=!1,l.subtotalsOnTopDefault=!1):n.options.subtotalsPosition===X.SubtotalsPosition.bottom?(l.subtotalsOnTopDefault=!1,delete l.enabledSubtotalsDefault):n.options.subtotalsPosition===X.SubtotalsPosition.top&&(delete l.subtotalsOnTopDefault,delete l.enabledSubtotalsDefault),l.insertBlankRowDefault=!!n.options.insertBlankLineAfterEachItem,l}t=t||{data:n.Ti.Ut.sheetModels[3].toJSON(3,i)},o=(r=n.rZt.HWt)[0],a=r[1],i=r[2],s=r[3],r=r[4],c=n.LYt,u=t.data.dataTable,L(c.row+o.DQ,c.col+o.jN,u,o.dataTable,_),L(e.row+a.DQ,e.col+a.jN,u,a.dataTable,_),L(e.row+i.DQ,e.col+i.jN,u,i.dataTable,_),L(e.row+s.DQ,e.col+s.jN,u,s.dataTable,_),L(e.row+r.DQ,e.col+r.jN,u,r.dataTable,_)},c.prototype.wh=function(t,i,n){var e,r,o,a,s,s,n,s,c,n,i,u,L,n,u,n,l,u,i,n,f,h,v,h,v,d,p,m,b,g,w,y,w,C,N,I,A,T,M,b,S,x,r,D,k,j,E,O,P,F,B,_,R,u,i,n,f,h,e=this,r=e.getRange().content;switch($(t)&&(t={n_:"sheetData"}),a=(o=e.dh).sc||{n_:"pivotTableDefinition"},s=e.layoutType(),a.xmlns=tt,a["xmlns:mc"]=tt,a["mc:Ignorable"]=tt,a["xmlns:xr"]=tt,a.r_=[13,14,15,16],s){case X.PivotTableLayoutType.outline:a.compact="0",a.compactData="0",a.outline="1",a.outlineData="1";break;case X.PivotTableLayoutType.tabular:a.compact="0",a.compactData="0",a.outline="0",a.outlineData="0";break;default:a.outline="1",a.outlineData="1"}if($(e.Zc)||(n&&n.newWorkSheetName&&e.Ti&&e.Ti.parent?(s=e.Ti.parent,e.Eqt=s.fJt(e.Zc),a.name=U(e.Eqt)):a.name=U(e.Zc)),!1===e.options.allowMultipleFiltersPerField&&(a.multipleFieldFilters=Q(e.options.allowMultipleFiltersPerField)),(n=o.getSigmaValuePosition()).display&&n.positionType===K.DataPosition.row&&(a.dataOnRows="1"),s=a.c_=[],c=i.styleManager,(n=e.theme())?(i={n_:"pivotTableStyleInfo"},u=n.name(),$(u)||((L=V.PivotTableThemes[u.toLowerCase()])?(u=u.replace(/^[a-z]{1}/g,function(t){return t.toUpperCase()}),i.name="PivotStyle"+u):(i.name=u,(n=n.wh(c))&&0<n.length&&(u={n_:"tableStyle",name:u,table:0,count:n.length,c_:n},c.addTableStyle(u)))),e.options.showRowHeader&&(i.showRowHeaders="1"),e.options.showColumnHeader&&(i.showColHeaders="1"),i.showRowStripes=Q(e.options.bandRows,1),i.showColStripes=Q(e.options.bandColumns,1),s.push(i)):s.push({n_:"pivotTableStyleInfo",showRowStripes:"1",showColStripes:"1"}),e.options.displayFieldsInPageFilterArea===X.DisplayFields.overThenDown&&(a.pageOverThenDown="1"),0<e.options.reportFilterFieldsPerColumn&&(a.pageWrap=""+e.options.reportFilterFieldsPerColumn),!1===e.options.showMissing&&(a.showMissing="0"),$(e.options.missingCaption)||(a.missingCaption=e.options.missingCaption),!$(e.options.rowLabelIndent)&&2!==e.options.rowLabelIndent&&0<=e.options.rowLabelIndent-1&&(a.indent=""+(e.options.rowLabelIndent-1)),e.options.printDrill&&(a.printDrill="1"),e.options.itemPrintTitles&&(a.itemPrintTitles="1"),e.options.fieldPrintTitles&&(a.fieldPrintTitles="1"),e.options.mergeItem&&(a.mergeItem="1"),$(e.options.grandTotalPosition)||((n=e.options.grandTotalPosition)!==X.GrandTotalPosition.none&&n!==X.GrandTotalPosition.col||(a.colGrandTotals="0"),n!==X.GrandTotalPosition.none&&n!==X.GrandTotalPosition.row)||(a.rowGrandTotals="0"),$(e.cCi)?a.dataCaption="Values":a.dataCaption=e.cCi,$(e.options.errorValueInfo)||(a.errorCaption=e.options.errorValueInfo),e.options.isShowErrorValue&&(a.showError="1"),!1===e.options.showHeaders&&(a.showHeaders="0"),$(e.options.colHeaderCaption)||(a.colHeaderCaption=e.options.colHeaderCaption),$(e.options.rowHeaderCaption)||(a.rowHeaderCaption=e.options.rowHeaderCaption),$(a.createdVersion)&&(a.createdVersion="7"),$(a.updatedVersion)&&(a.updatedVersion="7"),!1===e.options.showToolTip&&(a.showDataTips="0"),!1===e.options.showFilter&&(a.showHeaders="0"),!1===e.options.showDrill&&(a.showDrill="0"),l=a.lossless={},$(e.options.fillDownLabels)||(a.lossless.fillDownLabels=e.options.fillDownLabels),$(e.options.enableDataValueEditing)||(a.lossless.enableDataValueEditing=e.options.enableDataValueEditing),$(e.views)||(a.lossless.views=e.views.toJson()),u=e.rZt&&e.rZt.HWt&&e.rZt.HWt&&e.rZt.HWt[4]&&e.rZt.HWt[4].DQ||0,i=e.rZt&&e.rZt.HWt&&e.rZt.HWt&&e.rZt.HWt[4]&&e.rZt.HWt[4].jN||0,n=e.pZt()&&0<e.pZt().length||e.bZt()&&0<e.bZt().length||e.mZt()&&0<e.mZt().length?1:0,v=e.dh.G&&e.dh.G.length,h=!$(e.options.reportFilterFieldsPerColumn),h=e.options.displayFieldsInPageFilterArea===X.DisplayFields.overThenDown?0===e.options.reportFilterFieldsPerColumn?(f=1,v):(f=h?Math.ceil(v/e.options.reportFilterFieldsPerColumn):1,h?Math.min(e.options.reportFilterFieldsPerColumn,v):v):0===e.options.reportFilterFieldsPerColumn?(f=v,1):(f=v&&Math.min(e.options.reportFilterFieldsPerColumn,v),v?Math.ceil(v/e.options.reportFilterFieldsPerColumn):1),v={n_:"location",ref:G.rangesToFormula([r],0,0,15,!1)},0<=u&&(v.firstDataRow=""+u),0<=i&&(v.firstDataCol=""+i),0<=n&&(v.firstHeaderRow=""+n),0<f&&(v.rowPageCount=""+f),0<h&&(v.colPageCount=""+h),s.push(v),o.PVt(),e.lZt&&0<e.lZt.length){for(d=[],p=0;p<e.lZt.length;p++)if(b=(m=e.lZt[p]).pivotArea,!gt(g=m.style)&&!m.isFakeStyle&&((w=c.getDxfIndex(g,tt,!0))!==tt&&((y=e.sheetPivotAreaToSJSPivotArea(b,!0))?d.push({n_:"format",dxfId:w,c_:[y]}):(l.pivotStyles||(l.pivotStyles={}),l.pivotStyles[p]=m)),b.references)&&1===b.references.length&&m.style&&!$(m.style.formatter))if(w=e.dh,b.references[0].fieldName===it().Values){for(N=(C=w.Q).length,I={},A=0;A<N;A++)I[C[A].Zc]=A;if(!(T=b.references[0].items))for(T=[],M=0;M<N;M++)T.push(C[M].Zc);for(M=0;M<T.length;M++)$(I[T[M]])||(C[I[T[M]]].bbt=m.style.formatter)}else!b.labelOnly||b.dataOnly||b.references[0].items&&0!==b.references[0].items.length||(b=w.DB(b.fieldName))&&(b.bbt=m.style.formatter);for(D in S=e.UJt,x=e.WJt,d.length&&((r={n_:"formats",c_:d}).count=""+d.length,s.push(r)),S)if(S.hasOwnProperty(D))for(j in k=S[D])k.hasOwnProperty(j)&&($(t[D])&&(t[D]={}),$(t[D][j])&&(t[D][j]={}),g=W(e.QJt[k[j]]),(E=x[D]&&x[D][j])&&g.h5(E),t[D][j].style&&g.h5(t[D][j].style),t[D][j].s=c.getStyleIndex(g))}if(o.wh(e,a),e.mJ.qK&&0<e.mJ.qK.length){for(P=!(O=[]),p=0;p<e.mJ.qK.length;p++){for(B=(F=e.mJ.qK[p]).pivotAreas,_=[],M=0;M<B.length;M++)(y=e.sheetPivotAreaToSJSPivotArea(B[M],!1))?_.push(y):P=!0;_.length<=0||(bt(F.conditionalRule,R={n_:"conditionalFormat",c_:[{n_:"pivotAreas",count:""+_.length,c_:_}]}),O.push(R))}if(s.push({n_:"conditionalFormats",count:""+O.length,c_:O}),!0===P)for(l.conditionalFormats||(l.conditionalFormats=[]),p=0;p<e.mJ.qK.length;p++)F=e.mJ.qK[p],l.conditionalFormats[p]={pivotAreas:F.pivotAreas,rule:F.conditionalRule.toJSON(e.Ti)}}return(u=e.mc(!0))&&0<u.length&&s.push({n_:"rowItems",c_:u,count:u.length}),(i=e.mc(!1))&&0<i.length&&s.push({n_:"colItems",c_:i,count:i.length}),delete(n={n_:"pivotTableDefinition",r_:[2]}).c_,e.zJt&&(n.altText=e.zJt),e.ZJt&&(n.altTextSummary=e.ZJt),e.options.hideValuesRow&&(n.hideValuesRow="1"),f={n_:"pivotTableDefinition16"},e.options.subtotalsPosition===X.SubtotalsPosition.none?(f.EnabledSubtotalsDefault="0",f.SubtotalsOnTopDefault="0"):e.options.subtotalsPosition===X.SubtotalsPosition.bottom?f.SubtotalsOnTopDefault="0":e.options.subtotalsPosition===X.SubtotalsPosition.top&&delete f.SubtotalsOnTopDefault,e.options.insertBlankLineAfterEachItem&&(f.InsertBlankRowDefault="1"),h=[],(e.zJt||e.ZJt||e.options.hideValuesRow)&&h.push({n_:"ext",r_:[49,1],c_:[n]}),h.push({n_:"ext",r_:[51,52],c_:[f]}),a.c_.push({n_:"extLst",c_:h}),z(a,["location","pivotFields","rowFields","rowItems","colFields","colItems","pageFields","dataFields","formats","conditionalFormats","pivotTableStyleInfo","filters","extLst"]),a},c.prototype.sheetPivotAreaToExcelPivotArea=function(t){var i,n,e,r,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,i=this,n={},e=i.dh;if(n.type=vt(t.type),n.offset=t.offset,r=e.DB(t.fieldName))for(n.field=r.lp,o=[],0===(r=i.dh.Z[t.fieldName])?(n.axis="axisPage",o=i.dh.G):1===r?(n.axis="axisRow",o=i.dh.B):2===r&&(n.axis="axisCol",o=i.dh.R),a=0;a<o.length;a++)o[a]&&o[a].Zc===t.fieldName&&(n.fieldPosition=a);if(n.dataOnly=t.dataOnly,n.labelOnly=t.labelOnly,!0===t.labelOnly&&n.dataOnly===tt&&(n.dataOnly=!1),!0===t.labelOnly&&!0===n.dataOnly&&(n.dataOnly=!1,n.labelOnly=!1),n.grandRow=t.grandRow,n.grandCol=t.grandCol,$(t.axis)||(n.axis=t.axis===X.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&0<t.references.length){for(s=[],c=0;c<t.references.length;c++){if(u={},f=void 0,(l=t.references[c]).fieldName===it().Values){for(u.field=C,v=(h=e.Q).length,d={},p=0;p<v;p++)d[h[p].Zc]=p;if(l.items&&0<l.items.length){for(m=[],p=0;p<l.items.length;p++){if(d[l.items[p]]===tt)return;m.push(d[l.items[p]])}u.indexes=m}}else{if(f=e.DB(l.fieldName),$(f))continue;if(b=f.tl(e),u.field=f.lp,l.items&&0<l.items.length){for(m=[],p=0;p<l.items.length;p++)g=f.cs(l.items[p],b),$(g)||m.push(g);u.indexes=m}}u.defaultSubtotal=l.subtotal,s.push(u)}0<s.length&&(n.references=s)}return n},c.prototype.sheetPivotAreaToSJSPivotArea=function(t,i){var n,e,r,o,o,o,a,s,i,o,c,u,l,f,h,v,d,p,m,b,g,n=this,e={n_:"pivotArea"},r=n.dh,o=vt(t.type);if(o&&"normal"!==o&&(e.type=o),e.offset=t.offset,o=r.DB(t.fieldName))for(-1!==o.lp&&(e.field=""+o.lp),o=n.dh.Z[t.fieldName],a=[],i&&(0===o?(e.axis="axisPage",a=n.dh.G):1===o?(e.axis="axisRow",a=n.dh.B):2===o&&(e.axis="axisCol",a=n.dh.R)),s=0;s<a.length;s++)a[s]&&a[s].Zc===t.fieldName&&(e.fieldPosition=""+s);if(i=t.dataOnly,!0===(o=t.labelOnly)&&i===tt&&(i=!1),!0===o&&!0===i&&(o=i=!1),e.dataOnly=Q(i,tt),!0===o&&(e.labelOnly="1"),!0===t.grandRow&&(e.grandRow="1"),!0===t.grandCol&&(e.grandCol="1"),$(t.axis)||(e.axis=t.axis===X.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&0<t.references.length){for(c=[],u=0;u<t.references.length;u++){if(l={n_:"reference"},h=void 0,(f=t.references[u]).fieldName===it().Values){for(l.field=C,d=(v=r.Q).length,p={},m=0;m<d;m++)p[v[m].Zc]=m;if(f.items&&0<f.items.length)for(l.count=""+f.items.length,l.c_=[],m=0;m<f.items.length;m++){if(p[f.items[m]]===tt)return;l.c_.push({n_:"x",v:p[f.items[m]]})}}else{if(h=r.DB(f.fieldName),$(h))continue;if(b=h.tl(r),l.field=h.lp,f.items&&0<f.items.length){for(l.c_=[],m=0;m<f.items.length;m++)g=h.cs(f.items[m],b),$(g)||l.c_.push({n_:"x",v:g+""});l.count=""+l.c_.length}else l.count="0"}!0===f.subtotal&&(l.defaultSubtotal="1"),c.push(l)}0<c.length&&(e.c_=[{n_:"references",count:c.length+"",c_:c}])}return e},c.prototype.Bqt=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,i=this;if(i.Oy())return[];if(n=i.rZt.HWt,e=t?n[3].zWt:n[2].WWt,r=[],o=[],a=i.dh,s=i.layoutType()===X.PivotTableLayoutType.tabular,c=i.options.subtotalsPosition===X.SubtotalsPosition.top,t&&0===a.B.length||!t&&0===a.R.length)for(u=0;u<e.length;u++)(l={pivotItemIndexes:[]}).pivotItemIndexes.push(u),r.push(l);else for(f={},h=i.dh.getLabelSortMap(),u=0;u<e.length;u++)if(l={},v=e[u],!$(v)){for(d=v.path.split(K.Separator),l.pivotItemIndexes=[],p=0;p<d.length;p++)m=f[p]||i.lCi(p,t,h),f[p]=f[p]||m,d[p]===o[p]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(m?m[d[p]]:+d[p]);o=d,0===v.grandTotalLevel?l.type="grand":t&&v.isBlankRow?(l.type="blank",delete l.repeatCount):!v.isSubtotal||0===v.collapseIndex||c&&!s||(l.type="default"),v.valueFieldName&&(l.dataFieldIndex=a.RVt(v.valueFieldName)),r.push(l)}return r},c.prototype.mc=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,p,i=this;if(!i.Oy()){if(n=i.rZt.HWt,e=t?n[3].zWt:n[2].WWt,r=[],o=i.dh,a=i.layoutType()===X.PivotTableLayoutType.tabular,s=i.options.subtotalsPosition===X.SubtotalsPosition.top,c=[],t&&0===o.B.length||!t&&0===o.R.length)for(u=0;u<e.length;u++)l={n_:"x"},0!==u&&(l.v=u),c.push({n_:"i",c_:[l]});else for(f={},h=i.dh.getLabelSortMap(),v=0,d=e;v<d.length;v++)if(p=d[v],m={n_:"i"},!$(p)){for(b=p.path.split(K.Separator),m.c_=[],g=void 0,w=0;w<b.length;w++)y=f[w]||i.lCi(w,t,h),f[w]=f[w]||y,b[w]===r[w]?g=g?g+1:1:0<+b[w]?m.c_.push({n_:"x",v:y?y[b[w]]:b[w]}):0==+b[w]&&m.c_.push({n_:"x"});r=b,m.r=0<g?g:tt,0===p.grandTotalLevel?m.t="grand":t&&p.isBlankRow?(m.t="blank",delete m.r):!p.isSubtotal||0===p.collapseIndex||s&&!a||(m.t="default"),p.valueFieldName&&0<(p=o.RVt(p.valueFieldName))&&(m.i=""+p),c.push(m)}return c}},c.prototype.lCi=function(t,i,n){var e,r,i,t,n,e,r=this.dh,i=(i?r.B:r.R)[t].a,t=null==n?void 0:n.customSortMap[i];return t||((n=r.bl(i)).uQt(),t=n.sf()),t},c.prototype.Rqt=function(){var n,t,n={},t=this.dh.bit();return(0,K.o)(t,function(t,i){var t=t.Zc;n[t]=i}),n},c.prototype.evaluateGetPivotDataFunction=function(t,i){for(var n,e,r,o,a,s,c,u,l,f,h,f,v,d,p,m,b,g,w,c,y,C,N,I,A,T,M,T,S,S,x,D,x,D,k,n=this,e=[],r=n.IZt,o=n.Rqt(),a=n.dh,s=a.getSigmaValuePosition().positionType,c=a.B.length,u=a.Q.length,l=0;l<i.length;l++){if(h=(f=i[l]).fieldName,f=f.itemName,v=o[h],$(v))return j.Errors.Reference;if(d=void 0,!r[h])return j.Errors.Reference;if(p=a.FC(h),f instanceof Date&&(f=(0,q.formatDateToString)(f)),(d=2===p.W5&&p.cC()&&"number"==typeof f?(m=p.Rs)===K.DateGroupType.years?p.AQt&&p.AQt[f]:f:r[h].indexOf(f))<0)return j.Errors.Reference;e[v]=d}for(l=(b=e.slice(0,c)).length-1;0<=l&&b[l]===tt;l--)b.pop();for(g=b.join(K.Separator),l=(w=e.slice(c)).length-1;0<=l&&w[l]===tt;l--)w.pop();for(c=w.join(K.Separator),y={},C={},N=n.rZt.HWt[3].zWt,I=n.rZt.HWt[2].WWt,A=n.rZt.HWt[4].dataTable,l=0;l<N.length;l++)M=(T=N[l]).path,T=T.valueFieldName,0===s&&1<u?($(y[M])&&(y[M]={}),y[M][T]=l):y[M]=l;for(l=0;l<I.length;l++)M=(S=I[l]).path,S=S.valueFieldName,1===s&&1<u?($(C[M])&&(C[M]={}),C[M][S]=l):C[M]=l;if(0<a.Q.length&&(x=a.v_(t),D=a.getFieldInfoByName(t),t=x&&x.Zc||D&&D.Zc),$(t))return j.Errors.Reference;if(x=y[g]instanceof Object?y[g][t]:y[g],D=C[c]instanceof Object?C[c][t]:C[c],$(x)||$(D))return j.Errors.Reference;try{k=A[x][D],n.options.showMissing&&$(k)&&(k={value:n.options.missingCaption})}catch(t){return j.Errors.Reference}return k&&void 0!==k.value?k&&k.value:null},c.prototype.uqt=function(){var t,i,n,e,r,o,a,s,t=this;if(!(0<t.Xst)){for(i=t.lZt.concat([]),t.UJt={},t.WJt=[],t.lZt=[],t.QJt={},n={},e=[],r=i.length-1;0<=r;r--)(o=i[r])&&o.pivotArea&&(a=st(o.pivotArea),o.style||(n[a]=!0),n[a]||e.push(o));for(r=e.length-1;0<=r;r--)t.yqt((o=e[r]).pivotArea,o.style,tt,o.isFakeStyle);for(r=0;r<t.lZt.length;r++)o=t.lZt[r],s=t.getPivotAreaRanges(o.pivotArea),t.Cqt(s,r,o.style)}},c.prototype.getAllFields=function(t){return this.dh.getAllFieldNameListWithoutCalcField(t)},c.prototype.Gqt=function(){var e,t,e=this,t=e.getFieldsByArea();(0,K.o)(t,function(t){var t,i,n,i,t=t.sourceName;e.dh.isFilter(t)&&(n=(i=e.dh.getFilterInfo(t)).labelFilter,i=i.valueFilter,[null==n?void 0:n.condition,null==n?void 0:n.textItem,i].some(Boolean))&&e.dh.clearFilterInfo(t,0)})},c.prototype.dispose=function(){f.prototype.dispose.call(this);var t=this;t.Ti=y,t.rZt=y,t.lZt=y,t.WJt=y,t.UJt=y,t.QJt=y,t.options=y,t.eZt=y,t.LYt=y,t.HSt=y,t.zSt=y,t.IZt=y,t.EZt=y,t.VJt=y,t.BJt=y,t.bqt=y,$(t.mJ)||(t.mJ.L0(),t.mJ=y),$(t.views)||(t.views.L0(),t.views=y)},x.PivotTable=c},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(L,t,i){"use strict";var n,e,r,h,c,i,u,o,E,B,a,R,l,s,f,v,d,G,V,U,Q,W,z,p,m,b,g,w,y,C,N,Z,I,A,Y,H,J,q,K,X,$,tt,it,nt,et,r,rt,ot,at,st,ct,ut,lt,ft,e,ht,vt,T,dt,pt,mt,bt,gt,wt,yt;function M(t,i,n,e,r,o,a){var t=T.call(this,t,0)||this;return t.dh=i,t.Vqt=n,t.rYt=e,t.Uqt=r,t.RPt=o,t.Cut=a,t}function S(t,i,n,e,r,o,a){var t=dt.call(this,t,i,n,e,r,o)||this;return t.Qqt=a,t.Wqt="244px",t}function x(t,i,n,e,r,o,a){var t=pt.call(this,t,i,n,e,r,o)||this;return t.Wqt="95px",t.Qqt=a,t}function D(t,i,n,e,r,o,a){var t=mt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function k(t,i,n,e,r,o,a){return bt.call(this,t,i,n,e,r,o,a)||this}function j(t,i,n,e,r,o,a){var t=gt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function O(t,i,n,e,r,o,a){var t=wt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function P(t,i,n,e,r,o,a){var t=yt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function F(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=Ct(t.child[n]);return'<div class="'.concat(t.className,'" height="21px">\n            ').concat(i,'\n            <span class="').concat(t.ListSpan,'"></span>\n            </div>')}function Ct(t){return'<div class="'.concat(t.class,'" command="').concat(t.command,'">\n                <div class="').concat(t.iconClass,'"></div>\n                <div class="').concat(t.linkClass,'">').concat(t.text,"</div>\n            </div>")}function _(t,i){var n,e,r,n=0;switch(t){case 0:n=i.G.length;break;case 1:n=i.B.length;break;case 2:n=i.R.length;break;case 3:n=i.Q.length;break;default:return 0}return e=0,(r=i.getSigmaValuePosition()).display&&r.positionType===t-1&&e++,n+e}function Nt(t,i){var n,e,r,o,t,n=i.dh,e=i.rYt,r=i,o=i.Vqt,t=(0,h.GC$)(t).attr("command");"ClearFilter"===t?(n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:o,command:t,clearType:1}}),i.Cut.close(),i.close()):isNaN(+t)?(i.Cut.close(),i.close()):(i.Cut.close(),i.close(),n.wVt({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:o,host:r,command:t}}))}n=this&&this.__extends||(ft=function(t,i){return(ft=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ft(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.PivotNumberFilter=t.PivotDateSecondaryFilterDialog=t.PivotDateFilterDialog=t.PivotStringFilterDialog=t.PivotValuesDialog=t.PivotCacheFieldsDropdownDialog=t.PivotDropDown=void 0,e=i("Common"),r=i("./dist/plugins/pivot/pivot.ns.js"),h=i("Core"),c=i("Pivot"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),u=i.getResource.bind(i),a=(o="gc-drop-down-list")+"-block",l=o+"-icon",s=o+"-link",f=(R=o+"-item")+" "+(B=o+"-item-noHover"),v=o+"-span",d=R+" "+(E=o+"-link-hover"),G="icon-Move-Report",V="icon-Move-Row",U="icon-Move-Col",Q="icon-Move-Value",W="icon-Move-Remove",z="icon-Move-Setting",p="icon-Be-Used",m="clear-filter-icon-default",b="clear-filter-icon",g="label-of-string",w="valueFilter",y="label-of-number",C="label-of-date",N="sub-label-of-date",Z="all-date",I=null,A=void 0,H=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_DropDownList_Up,command:"moveUp",class:d,iconClass:l,linkClass:s},{text:u().PivotPanel_DropDownList_Down,command:"moveDown",class:d,iconClass:l,linkClass:s},{text:u().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:d,iconClass:l,linkClass:s},{text:u().PivotPanel_DropDownList_End,command:"moveEnd",class:d,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:d,iconClass:l+" "+G,linkClass:s},{text:u().PivotPanel_DropDownList_Row,command:"moveRow",class:d,iconClass:l+" "+V,linkClass:s},{text:u().PivotPanel_DropDownList_Col,command:"moveCol",class:d,iconClass:l+" "+U,linkClass:s},{text:u().PivotPanel_DropDownList_Values,command:"moveValue",class:d,iconClass:l+" "+Q,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_DropDownList_Remove,command:"removeField",class:d,iconClass:l+" "+W,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_DropDownList_Set,command:"fieldSet",class:d,iconClass:l+" "+z,linkClass:s}]}]},J=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:d,iconClass:l+" "+G,linkClass:s},{text:u().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:d,iconClass:l+" "+V,linkClass:s},{text:u().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:d,iconClass:l+" "+U,linkClass:s},{text:u().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:d,iconClass:l+" "+Q,linkClass:s}]}]},q=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+g,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Equals,command:c.PivotCaptionFilterOperator.equalsTo,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotEqual,command:c.PivotCaptionFilterOperator.notEqualsTo,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:c.PivotCaptionFilterOperator.beginsWith,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotBegin,command:c.PivotCaptionFilterOperator.doesNotBeginWith,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_End,command:c.PivotCaptionFilterOperator.endsWith,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotEndWith,command:c.PivotCaptionFilterOperator.doesNotEndWith,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Contain,command:c.PivotCaptionFilterOperator.contains,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotContain,command:c.PivotCaptionFilterOperator.doesNotContain,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_GreaterThan,command:c.PivotCaptionFilterOperator.greaterThan,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:c.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessThan,command:c.PivotCaptionFilterOperator.lessThan,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessOrTo,command:c.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Between,command:c.PivotCaptionFilterOperator.between,class:d+" "+g,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotBetween,command:c.PivotCaptionFilterOperator.notBetween,class:d+" "+g,iconClass:l,linkClass:s}]}]},K=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+C,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Equals,command:c.PivotDateFilterOperator.equalsTo,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Before,command:c.PivotDateFilterOperator.before,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_After,command:c.PivotDateFilterOperator.after,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_Between,command:c.PivotDateFilterOperator.Between,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Tomorrow,command:c.PivotDateFilterOperator.tomorrow,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_Today,command:c.PivotDateFilterOperator.today,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_Yesterday,command:c.PivotDateFilterOperator.yesterday,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_NextWeek,command:c.PivotDateFilterOperator.nextWeek,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ThisWeek,command:c.PivotDateFilterOperator.thisWeek,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LastWeek,command:c.PivotDateFilterOperator.lastWeek,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_NextMonth,command:c.PivotDateFilterOperator.nextMonth,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ThisMonth,command:c.PivotDateFilterOperator.thisMonth,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LastMonth,command:c.PivotDateFilterOperator.lastMonth,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_NextQuarter,command:c.PivotDateFilterOperator.nextQuarter,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:c.PivotDateFilterOperator.thisQuarter,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LastQuarter,command:c.PivotDateFilterOperator.lastQuarter,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_NextYear,command:c.PivotDateFilterOperator.nextYear,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ThisYear,command:c.PivotDateFilterOperator.thisYear,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LastYear,command:c.PivotDateFilterOperator.lastYear,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_YearToDate,command:c.PivotDateFilterOperator.yearToDate,class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:c.PivotDateFilterOperator.dateToDate+"-1",class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_MonthToDate,command:c.PivotDateFilterOperator.dateToDate+"-2",class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:c.PivotDateFilterOperator.dateToDate+"-3",class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:c.PivotDateFilterOperator.dateToDate+"-4",class:d+" "+C,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:c.PivotDateFilterOperator.dateToDate+"-5",class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:d+" "+Z,iconClass:l,linkClass:s}]}]},X=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+y,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Equals,command:c.PivotCaptionFilterOperator.equalsTo,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotEqual,command:c.PivotCaptionFilterOperator.notEqualsTo,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:c.PivotCaptionFilterOperator.beginsWith,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotBegin,command:c.PivotCaptionFilterOperator.doesNotBeginWith,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_End,command:c.PivotCaptionFilterOperator.endsWith,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotEndWith,command:c.PivotCaptionFilterOperator.doesNotEndWith,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Contain,command:c.PivotCaptionFilterOperator.contains,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotContain,command:c.PivotCaptionFilterOperator.doesNotContain,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_GreaterThan,command:c.PivotCaptionFilterOperator.greaterThan,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:c.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessThan,command:c.PivotCaptionFilterOperator.lessThan,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessOrTo,command:c.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Between,command:c.PivotCaptionFilterOperator.between,class:d+" "+y,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotBetween,command:c.PivotCaptionFilterOperator.notBetween,class:d+" "+y,iconClass:l,linkClass:s}]}]},$=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+w,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Equals,command:c.PivotValueFilterOperator.equalsTo,class:d+" "+w,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotEqual,command:c.PivotValueFilterOperator.notEqualsTo,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_GreaterThan,command:c.PivotValueFilterOperator.greaterThan,class:d+" "+w,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:c.PivotValueFilterOperator.greaterThanOrEqualsTo,class:d+" "+w,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessThan,command:c.PivotValueFilterOperator.lessThan,class:d+" "+w,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_LessOrTo,command:c.PivotValueFilterOperator.lessThanOrEqualsTo,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilterOrLabel_Between,command:c.PivotValueFilterOperator.between,class:d+" "+w,iconClass:l,linkClass:s},{text:u().PivotPanel_ValueFilterOrLabel_NotBetween,command:c.PivotValueFilterOperator.notBetween,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().PivotPanel_ValueFilter_Top10,command:"Top10",class:d+" "+w,iconClass:l,linkClass:s}]}]},tt=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:u().Q1,command:c.PivotDateFilterOperator.Q1,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Q2,command:c.PivotDateFilterOperator.Q2,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Q3,command:c.PivotDateFilterOperator.Q3,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Q4,command:c.PivotDateFilterOperator.Q4,class:d+" "+N,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:u().Jan,command:c.PivotDateFilterOperator.M1,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Feb,command:c.PivotDateFilterOperator.M2,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Mar,command:c.PivotDateFilterOperator.M3,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Apr,command:c.PivotDateFilterOperator.M4,class:d+" "+N,iconClass:l,linkClass:s},{text:u().May,command:c.PivotDateFilterOperator.M5,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Jun,command:c.PivotDateFilterOperator.M6,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Jul,command:c.PivotDateFilterOperator.M7,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Aug,command:c.PivotDateFilterOperator.M8,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Sep,command:c.PivotDateFilterOperator.M9,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Oct,command:c.PivotDateFilterOperator.M10,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Nov,command:c.PivotDateFilterOperator.M11,class:d+" "+N,iconClass:l,linkClass:s},{text:u().Dec,command:c.PivotDateFilterOperator.M12,class:d+" "+N,iconClass:l,linkClass:s}]}]},(e=it=it||{})[e.teamLeader=1]="teamLeader",e[e.teamMiddle=2]="teamMiddle",e[e.teamTail=3]="teamTail",ht=nt={filters:0,0:"filters",rows:1,1:"rows",columns:2,2:"columns",values:3,3:"values"},vt=et={string:1,1:"string",number:2,2:"number",date:3,3:"date"},T=h.zc,n(M,T),M.prototype.rQ=function(t,i){var n,e,n=this;n.u_=t,n.LEt=i,(e=n.WX(t.x,t.y)).html(this.zqt(this.Zqt(i))),this.$c()},M.prototype.$c=function(){T.prototype.$c.call(this),this.Yqt(),this.aY(),this.Hqt()&&this.uf()},M.prototype.Hqt=function(){return!1},M.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top","height"],[t,i,this.Wqt]),n.css("position","fixed"),n.addClass(o+" gc-no-user-select"),n},M.prototype.Yqt=function(){var t,i,n,e,r,o,a,s,c,i,u,l,u,n,o,f,t=this,i=t.Wc,n=(0,h.GC$)(t.Ti);n.hasClass("filter-condition")&&(e=t.Cut.qc().getBoundingClientRect(),r=(0,h.GC$)(t.Cut.Wc),o=n.position(),a=r.position(),s=r[0].getBoundingClientRect(),c=(0,h.GC$)(i).width(),i=(0,h.GC$)(i).height(),l=(u=document.documentElement).clientWidth,u=u.clientHeight,n=n.width(),o=o.top,e.left+n+a.left+c>=l?t.u_.x=-c+s.left:t.u_.x=n+s.left,e.top+o+a.top+i>=u?(t.u_.y=r.height()-i+s.top,Math.abs(r.height()-i)>a.top&&((f=t.Xc()).css(["height","overflow-y","overflow-x"],[r.height()+"px","scroll","hidden"]),t.u_.y=s.top)):t.u_.y=o+s.top,t.WX(t.u_.x,t.u_.y))},M.prototype.close=function(){this.KX(),this.eG(),T.prototype.close.call(this)},M.prototype.eG=function(){this.Vqt=A,this.rYt=A,this.Uqt=A,this.RPt=A,this.Cut=I,this.Ti=I,this.dh=I},n(S,dt=r=M),S.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},S.prototype.Zqt=function(t){return this.rT=h.GC$.extend(!0,[],H()),this.initSeatData(t,this.rT[0].child),this.initAreaData(t,this.rT[1].child),this.initSettingData(t,this.rT[3].child),this.rT},S.prototype.aY=function(){var i=this;(0,h.GC$)("."+R).bind("click",function(t){(0,h.GC$)(this).hasClass(B)||(i.uf(),i.sendCommand(this),i.close())})},S.prototype.KX=function(){(0,h.GC$)("."+R).unbind("click")},S.prototype.sendCommand=function(t){var i,n,e,r,o,i=this,n=i.Uqt,e=i.RPt,r=i.dh,o=(0,h.GC$)(t).attr("command");switch(o){case"moveUp":o="moveField",e--;break;case"moveDown":o="moveField",e++;break;case"moveBeginning":o="moveField",e=0;break;case"moveEnd":o="moveField",e=_(n,r)+1;break;case"moveReportFilter":o="moveField",e=_(n=0,r);break;case"moveRow":o="moveField",e=_(n=1,r);break;case"moveCol":o="moveField",e=_(n=2,r);break;case"moveValue":o="moveField",e=_(n=3,r)}i.dh.wVt({cmd:o,sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,targetIndex:e,pivotName:i.Vqt,isSusPaint:i.Qqt}})},S.prototype.initSeatData=function(t,i){if(t.isAlone)for(var n=0;n<i.length;n++)i[n].class=f;else t.location!==it.teamMiddle&&(t.location===it.teamLeader?(i[0].class=f,i[2].class=f):(i[1].class=f,i[3].class=f))},S.prototype.initAreaData=function(t,i){switch(t.area){case 0:i[0].class=f;break;case 1:i[1].class=f;break;case 2:i[2].class=f;break;case 3:i[3].class=f}t.isSigma&&(i[0].class=f,i[3].class=f)},S.prototype.initSettingData=function(t,i){3===t.area&&(i[0].text=u().PivotPanel_DropDownList_ValueSet,i[0].command="openValueFieldSettingDialogCmd",i[0].class=d),t.isSigma&&(i[0].class=f)},t.PivotDropDown=S,n(x,pt=r),x.prototype.zqt=function(t){return F(t[0])},x.prototype.Zqt=function(){return this.rT=h.GC$.extend(!0,[],J()),this.rT},x.prototype.aY=function(){var i=this;(0,h.GC$)("."+E).bind("click",function(t){i.sendCommand(this),i.close()})},x.prototype.KX=function(){(0,h.GC$)("."+E).unbind("click")},x.prototype.sendCommand=function(t){var i,n,e,i=this,n=i.Uqt||-1,e;switch((0,h.GC$)(t).attr("command")){case"AddToReportField":n=0;break;case"AddToRowLabel":n=1;break;case"AddToColLabel":n=2;break;case"AddToValue":n=3}i.dh.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,pivotName:i.Vqt,isSusPaint:i.Qqt}})},t.PivotCacheFieldsDropdownDialog=x,n(D,mt=r),D.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},D.prototype.Hqt=function(){return!0},D.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],$()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},D.prototype.aY=function(){var s=this;(0,h.GC$)(s.Ti).bind("mouseleave",function(t){s.close()}),(0,h.GC$)("."+w).bind("click",function(t){var i,n,e,r,o,a,i=s.dh,n=s.rYt,e=this,r=s.Vqt,o=(0,h.GC$)(this).attr("command");"ClearFilter"===o?(i.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:n,pivotName:r,command:o,clearType:2}}),s.Cut.close(),s.close()):isNaN(+o)&&"Top10"!==o?(s.Cut.close(),s.close()):(a=u().getValueFilterItemText(),s.Cut.close(),s.close(),i.wVt({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:n,pivotName:r,host:e,content:a,command:o}}))})},D.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+w).unbind("click")},D.prototype.sendCommand=function(){},t.PivotValuesDialog=D,n(k,bt=r),k.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},k.prototype.Hqt=function(){return!0},k.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],q()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},k.prototype.aY=function(){var i=this;(0,h.GC$)("."+g).bind("click",function(t){Nt(this,i)}),(0,h.GC$)(i.Ti).bind("mouseleave",function(t){i.close()})},k.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+g).unbind("click")},k.prototype.sendCommand=function(){},t.PivotStringFilterDialog=k,n(j,gt=r),j.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},j.prototype.Hqt=function(){return!0},j.prototype.Zqt=function(t){var i,n,e,r,o,a,s;for(this.rT=h.GC$.extend(!0,[],K()),i=t.existed,n=this.rT,i&&0!==i.length?this.rT[0].child[0].iconClass=b+" "+l:n[0].child[0].class=f,o=1;o<n.length;o++)for(r=n[o].child,a=0;a<r.length;a++)for(e=+r[a].command,s=0;s<i.length;s++)if(i[s]>c.PivotDateFilterOperator.Q1&&i[s]<=c.PivotDateFilterOperator.M12&&(n[9].child[0].iconClass=l+" "+p),i[s]===e){n[o].child[a].iconClass+=" "+p,i.splice(s,1);break}return this.rT},j.prototype.aY=function(){var c=this;(0,h.GC$)(c.Ti).bind("mouseleave",function(t){c.close()}),(0,h.GC$)("."+C).bind("click",function(t){var i,n,e,r,o,a,i=u().getDateLabelFilterItemText(),n=c.dh,e=c.rYt,r=document.body,o=c.Vqt,a=(0,h.GC$)(this).attr("command");"ClearFilter"===a?(n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:o,clearType:1}}),c.Cut.close(),c.close()):(c.Cut.close(),c.close(),n.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:o,host:r,command:a,dateLabel:i,isWholeDay:!1}}))}),(0,h.GC$)("."+Z).bind("mouseenter",function(t){var i,n,e,r,o,a,o,n,s,i=this,n=c.dh,e=c.Vqt,r=c.rYt,o=c.LEt,a=[];o.existed.forEach(function(t){24<=t&&t<=39&&a.push(t)}),o=new ut(i,n,e,r,I,I,c),n=i.getBoundingClientRect(),o.rQ(s={x:0,y:0},{existed:a,dataType:2}),o.Wc.css(["position","left","top"],["fixed",n.right+"px",n.bottom-(0,h.GC$)(o.Wc).height()+"px"])})},j.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+C).unbind("click"),(0,h.GC$)("."+Z).unbind("mouseenter")},j.prototype.sendCommand=function(){},t.PivotDateFilterDialog=j,n(O,wt=r),O.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},O.prototype.Hqt=function(){return!0},O.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],tt()),n=i=0;n<t.existed.length;n++)for(i=t.existed[n]-24,e=0;e<this.rT.length;e++){if(this.rT[e].child[i]){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},O.prototype.aY=function(){var s=this;(0,h.GC$)(s.Ti).bind("mouseleave",function(t){s.close()}),(0,h.GC$)("."+N).bind("click",function(t){var i,n,e,r,o,a,i=s.dh,n=s.rYt,e=this,r=s.Vqt,o=(0,h.GC$)(this).attr("command"),a=s.Cut;a.Cut.close(),a.close(),s.close(),i.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:n,pivotName:r,host:e,command:o,isWholeDay:!1}})})},O.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+N).unbind("click")},O.prototype.sendCommand=function(){},ut=O,t.PivotDateSecondaryFilterDialog=ut,n(P,yt=r),P.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},P.prototype.Hqt=function(){return!0},P.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],X()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},P.prototype.aY=function(){var i=this;(0,h.GC$)(i.Ti).bind("mouseleave",function(t){i.close()}),(0,h.GC$)("."+y).bind("click",function(t){Nt(this,i)})},P.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+y).unbind("click")},P.prototype.sendCommand=function(){},t.PivotNumberFilter=P},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(L,t,i){"use strict";var n,e,r,u,s,i,c,l,E,B,R,G,f,h,v,d,V,o,p,m,a,b,g,w,y,C,U,Q,W,z,Z,Y,N,I,H,J,q,K,A,T,X,$,tt,M,it,nt,et,rt,S,ot,x,D,r,at,st,ct,ut,k,lt,ft,ht;function j(t,i,n){return k.call(this,t,i,n)||this}function O(t,i,n,e,r,o){var t=lt.call(this,t,2e3,!0)||this;return t.Jqt=i,t.dh=n,t.rYt=e,t.Vqt=r,t.qqt=o,t.uf(),t.$c(),t}function P(t,i,n,e,r,o,a,s){var t=ft.call(this,t,2e3,!0)||this;return t.Kqt=i,t.dh=e,t.rYt=r,t.Vqt=o,t.Xqt=n,t.qqt=a,t.$qt=s,t.uf(),t.$c(),t}function F(t,i,n,e,r,o){var t=ht.call(this,t,2e3,!0)||this;return t.Jqt=i,t.dh=n,t.rYt=e,t.Vqt=r,t.qqt=o,t.uf(),t.$c(),t}function _(t,i){var n="",e="";return i&&(n="type = 'number'",e=H),t?'<input class="'.concat(C+" "+w+" "+e,'" ').concat(n,' width=100px></input>\n                    <div class="').concat(U,'">').concat(l().AndJoiner,'</div>\n                <input class="').concat(C+" "+w+" "+e,'" ').concat(n," width=100px></input>"):'<input class="'.concat(b+" "+w+" "+e,'" ').concat(n,"></input>")}n=this&&this.__extends||(ut=function(t,i){return(ut=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ut(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.DateFilterDialog=t.ValueFilter=t.LabelFilter=t.opi=void 0,e=i("Common"),r=i("./dist/plugins/pivot/pivot.ns.js"),u=i("Core"),s=i("Pivot"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),c=e.Common.zf.j0,l=i.getResource.bind(i),E=e.Formatter.GeneralFormatter,B="filter-dialog-container",R="label-title-class",G="label-filter-body",f="label-title",h="cancel-icon",v="cancel-class",d="label-show",V="split-line",o="prompt-info",p="ok-label",m="filter-confirm",a="label-select",b="label-input",g="confirm-class",w="label_input",y="input-between-container",C="input-between",U="and-joiner",Q="top-ten-content",W="filter-value-dialog-container",z="value-title-class",Z="split-line-class",Y="value-filter-body",N="value-select",I="field-value",H="value-filter",J="filter-top-ten-container",q="top-ten-filter-body",K="split-line-of-top-ten",A="value-of-top-ten",T="top-ten-select",X="top-ten-title-class",$="close-dialog",tt="by-joiner-class",M="top-ten",it="filter-date-dialog-container",nt="date-title-class",et="date-filter-body",rt="date-split-line",S="date-select",ot="is-whole-days",x=null,D=void 0,k=u.Ase,n(j,k),j.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(t-n)/2+"px"])},j.prototype.api=function(t){var i=this;!t&&i.rf()&&(i.Wc.css("display","none"),i.uf()),t&&(i.Wc.css("display","block"),i.tf()||i.nf())},j.prototype.$c=function(){var t=this;t.Wc.html(t.tKt()),k.prototype.$c.call(this),t.Eot(),t.aY()},j.prototype.lQ=function(){this.KX(),this.eG(),k.prototype.close.call(this)},t.opi=r=j,n(O,lt=r),O.prototype.$c=function(){var t=this;lt.prototype.$c.call(this),t.iKt()},O.prototype.eG=function(){this.Jqt=x,this.rYt=D,this.Vqt=D,this.qqt=D,this.Ti=x,this.dh=x},O.prototype.tKt=function(){for(var t,i,n,n,e,r,t="",i=this.Jqt,n=this.qqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);return n=n>=s.PivotCaptionFilterOperator.between?_(!0):_(!1),r=c(this.rYt),'<div class="'.concat(B,'">\n                    <div class="').concat(R,'">\n                        <span class="').concat(f,'">').concat(l().Label_Title+"("+r+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(G,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().Label_Show,'</span>\n                            <span class="').concat(V,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(a,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div class="').concat(g,'">\n                            <span class="').concat(o,'">').concat(l().Use_Single_Character,'</span>\n                            <span class="').concat(o,'">').concat(l().Use_Series_Characters,'</span>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},O.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},O.prototype.aY=function(){var s,t,s=this,t=s.Wc[0];(0,u.GC$)("."+v,t).bind("click",function(t){s.lQ()}),(0,u.GC$)("."+p,t).bind("click",function(t){var i,n,e,e,i,n,r,o,a,i=(0,u.GC$)("."+b)[0],n=x,e=(0,u.GC$)("."+C);0<e.length&&(i=e[0],n=e[1]),e=i?i.value:x,i=n?n.value:x,n=s.qqt,r=s.dh,o=s.rYt,a=s.Vqt,r.wVt({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:r,fieldName:o,pivotName:a,selectValue:n,inputValue:e,inputValueEnd:i}}),s.lQ()}),(0,u.GC$)("."+a,t).bind("change",function(t){var i=(0,u.GC$)(this.options[this.selectedIndex]).attr("command");s.nKt(i)})},O.prototype.KX=function(){var t=this.Wc[0];(0,u.GC$)("."+v,t).unbind("click"),(0,u.GC$)("."+p,t).unbind("click"),(0,u.GC$)("."+a,t).unbind("change")},O.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotCaptionFilterOperator.between&&i.qqt<s.PivotCaptionFilterOperator.between||t<s.PivotCaptionFilterOperator.between&&i.qqt>=s.PivotCaptionFilterOperator.between)&&(n=t>=s.PivotCaptionFilterOperator.between?_(!0):_(!1),(0,u.GC$)("."+y).html(n)),i.qqt=t},O.prototype.iKt=function(){var t,i,n,t,i,n,i,n,e,i,n,t,n,t=this,i=t.dh,n=t.rYt,t=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.labelFilter&&i.labelFilter.condition&&(i=(n=i.labelFilter.condition.toJSON()).val,n=n.operator,e=i[0],i=i[1],n===t)&&(t=(n=(0,u.GC$)("."+w))[0],n=n[1],t.value=e,n)&&(n.value=i)},t.LabelFilter=O,n(P,ft=r),P.prototype.$c=function(){var t=this;ft.prototype.$c.call(this),t.eKt()},P.prototype.eG=function(){this.Kqt=x,this.rYt=D,this.Vqt=D,this.qqt=D,this.Ti=x,this.dh=x},P.prototype.eKt=function(){var t=this;t.$qt?t.rKt():t.iKt()},P.prototype.tKt=function(){return this.$qt?this.oKt():this.aKt()},P.prototype.oKt=function(){for(var t,i,n,e,t="",i=this.Xqt,n=0;n<i.length;n++)t+=this.b0(i[n],n);return e=c(this.rYt),'<div class="'.concat(J,'">\n                    <div class="').concat(X,'">\n                        <span class="').concat(f,'">').concat(l().Top_Ten_Filter+"("+e+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(q,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().TopTenShow,'</span>\n                            <span class="').concat(K,'"></span>\n                        </div>\n                        <div class="').concat(g+" "+Q,'">\n                            <select class="').concat(T,'">\n                                <option>').concat(l().Top,"</option>\n                                <option>").concat(l().Bottom,'</option>\n                            </select>\n                            <input class="').concat(A,'" type="number" value=10 min=1></input>\n                            <select class="').concat(T,'">\n                                <option>').concat(l().Top_Item,"</option>\n                                <option>").concat(l().Top_Percent,"</option>\n                                <option>").concat(l().Top_Sum,'</option>\n                            </select>\n                            <div class="').concat(tt,'">').concat(l().ByJoiner,'</div>\n                            <select class="').concat(T,'">').concat(t,'</select>\n                        </div>\n                        <div class="').concat($,'">\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m+" "+M,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},P.prototype.aKt=function(){for(var t,i,n,n,e,r,o,a,t="",i=this.Kqt,n=this.qqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);for(r="",o=this.Xqt,e=0;e<o.length;e++)r+=this.b0(o[e],e);return n=n===s.PivotValueFilterOperator.between||n===s.PivotValueFilterOperator.notBetween?_(!0,!0):_(!1,!0),a=c(this.rYt),'<div class="'.concat(W,'">\n                    <div class="').concat(z,'">\n                        <span class="').concat(f,'">').concat(l().Value_Title+"("+a+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(Y,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().Value_Show,'</span>\n                            <span class="').concat(Z,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(N,'">').concat(r,'</select>\n                            <select class="').concat(N+" "+I,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},P.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},P.prototype.aY=function(){var n,t,n=this,t=n.Wc[0];(0,u.GC$)("."+v,t).bind("click",function(t){n.lQ()}),(0,u.GC$)("."+p,t).bind("click",function(t){(0,u.GC$)(this).hasClass(M)?n.sKt():n.uKt(),n.lQ()}),(0,u.GC$)("."+I).bind("change",function(t){var i=(0,u.GC$)(this.options[this.selectedIndex]).attr("command");n.nKt(i)})},P.prototype.rKt=function(){var t,i,n,t,n,t,t,e,r,t,t=this,i=t.Xqt,n=t.dh,t=t.rYt,n=n.getFilterInfo(n.getSourceNameByFieldName(t));n&&n.valueFilter&&n.valueFilter.conditionByName&&(t=n.valueFilter.condition).getConditionType()===s.PivotConditionType.top10&&(e=(t=t.toJSON()).val,r=t.type,t=t.operator,(0,u.GC$)("."+T)[2].selectedIndex=i.indexOf(n.valueFilter.conditionByName),(0,u.GC$)("."+T)[0].selectedIndex=0<t?0:1,(0,u.GC$)("."+T)[1].selectedIndex=r,(0,u.GC$)("."+A).attr("value",e))},P.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotValueFilterOperator.between&&i.qqt<s.PivotValueFilterOperator.between||t<s.PivotValueFilterOperator.between&&i.qqt>=s.PivotValueFilterOperator.between)&&(n=t>=s.PivotValueFilterOperator.between?_(!0,!0):_(!1,!0),(0,u.GC$)("."+y).html(n)),i.qqt=t},P.prototype.iKt=function(){var t,i,n,t,i,n,i,n,e,i,n,t,n,t=this,i=t.dh,n=t.rYt,t=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.valueFilter&&i.valueFilter.condition&&(i=(n=i.valueFilter.condition.toJSON()).val,n=n.operator,e=i[0],i=i[1],n===t)&&(t=(n=(0,u.GC$)("."+w))[0],n=n[1],t.value=e,n)&&(n.value=i)},P.prototype.KX=function(){var t=this.Wc[0];(0,u.GC$)("."+v,t).unbind("click"),(0,u.GC$)("."+p,t).unbind("click"),(0,u.GC$)("."+I).unbind("change")},P.prototype.uKt=function(){var t,i,n,i,e,r,o,o,n,i,e,r,a,t,t=this,i=(0,u.GC$)("."+N),n=i[0],i=i[1],e=(0,u.GC$)("."+b)[0],r=x,o=(0,u.GC$)("."+C);0<o.length&&(e=o[0],r=o[1]),o=(0,u.GC$)(n.options[n.selectedIndex]).text(),n=(0,u.GC$)(i.options[i.selectedIndex]).attr("command"),i=e?e.value:x,e=r?r.value:x,r=t.dh,a=t.rYt,t=t.Vqt,r.wVt({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:r,fieldName:a,pivotName:t,valueOfField:o,valueOfFieldValue:n,inputValue:i,inputValueEnd:e}})},P.prototype.sKt=function(){var t,i,n,e,r,o,a,e,r,o,a,e,t=this,i=t.dh,n=t.Vqt,e=(0,u.GC$)("."+T),r=e[0],o=(0,u.GC$)("."+A)[0],a=e[1],e=e[2],r=(0,u.GC$)(r.options[r.selectedIndex]).text(),o=o.value,a=(0,u.GC$)(a.options[a.selectedIndex]).text(),e=(0,u.GC$)(e.options[e.selectedIndex]).text();i.wVt({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:i,fieldName:t.rYt,valueFieldName:e,pivotName:n,TopOrBottomValue:r,inputValue:o,selectTypeValue:a}})},t.ValueFilter=P,n(F,ht=r),F.prototype.$c=function(){var t=this;ht.prototype.$c.call(this),t.iKt()},F.prototype.eG=function(){this.rYt=D,this.Vqt=D,this.qqt=D,this.Jqt=x,this.Ti=x,this.dh=x},F.prototype.tKt=function(){for(var t,i,n,e,r,t="",i=this.Jqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);return n=this.qqt>=s.PivotDateFilterOperator.Between?_(!0):_(!1),r=c(this.rYt),'<div class="'.concat(it,'">\n                    <div class="').concat(nt,'">\n                        <span class="').concat(f,'">').concat(l().DateFilterTitle+"("+r+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(et,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().DateShow,'</span>\n                            <span class="').concat(rt,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(S,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="').concat(ot,'">\n                            <label for="WholeDays">').concat(l().WholeDays,'</label>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},F.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},F.prototype.aY=function(){var c,t,c=this,t=c.Wc[0];(0,u.GC$)("."+v,t).bind("click",function(t){c.lQ()}),(0,u.GC$)("."+p,t).bind("click",function(t){var i,n,e,r,o,r,i,n,e,a,s,i=(0,u.GC$)("."+S)[0],n=(0,u.GC$)("."+b)[0],e=x,r=(0,u.GC$)("."+C),o=(0,u.GC$)("."+ot)[0].checked;0<r.length&&(n=r[0],e=r[1]),r=(0,u.GC$)(i.options[i.selectedIndex]).attr("command"),i=n?n.value:x,n=e?e.value:x,e=c.dh,a=c.rYt,s=c.Vqt,e.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:a,pivotName:s,command:r,isWholeDay:o,value1:i,value2:n}}),c.lQ()}),(0,u.GC$)("."+S).bind("change",function(t){var i=(0,u.GC$)(this.options[this.selectedIndex]).attr("command");c.nKt(i)})},F.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotDateFilterOperator.Between&&i.qqt<s.PivotDateFilterOperator.Between||t<s.PivotDateFilterOperator.Between&&i.qqt>=s.PivotDateFilterOperator.Between)&&(n=t>=s.PivotDateFilterOperator.Between?_(!0):_(!1),(0,u.GC$)("."+y).html(n)),i.qqt=t},F.prototype.iKt=function(){var t,i,n,e,i,n,i,r,n,r,e,n,t,n,o,t,t=this,i=t.dh,n=t.rYt,e=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.labelFilter&&i.labelFilter.condition&&(i=(n=i.labelFilter.condition.toJSON()).isWholeDay,r=n.operator,n=n.val,r===e)&&(r=n[0],e=n[1],r=(n=t.formatDate(r,e)).value1,e=n.value2,t=(0,u.GC$)("."+w),n=(0,u.GC$)("#WholeDays"),o=t[0],t=t[1],o.value=r,t&&e&&0<e.length&&(t.value=e),n.attr("checked",i))},F.prototype.formatDate=function(t,i){var n,e,n,n=new E,e=n.getPreferredEditingFormatter(t),n=n.getPreferredEditingFormatter(i);return{value1:e.format(t),value2:n.format(i)}},F.prototype.KX=function(){var t=this.Wc[0];(0,u.GC$)("."+v,t).unbind("click"),(0,u.GC$)("."+p,t).unbind("click"),(0,u.GC$)("."+S).unbind("change")},t.DateFilterDialog=F},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(t,i,n){"use strict";var e,h,r,s,n,r,c,o,u,l,f,v,d,p,m,b,a,g,w,y,C,N,I,A,T,M;function S(t,i,n,e,r,o,a,s,c,u,l){var t,f;return void 0===l&&(l="m/d/yyyy"),(f=t=M.call(this,t,0,!0)||this).cKt=i,f.rYt=n,f.dh=e,f.T=o&&h.Be.Re(o,l)||"",f.lKt=r&&h.Be.Re(r,l),f.fKt=f.lKt===f.T,f.gd=s&&h.Be.Re(s,l)||"",f.hKt=a&&h.Be.Re(a,l),f.vKt=f.hKt===f.gd,f.dKt=c,f.W3=u,f.uf(),t}e=this&&this.__extends||(T=function(t,i){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}T(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDateGroupDialog=void 0,h=n("Core"),r=n("Common"),s=n("Pivot"),n=n("./dist/plugins/pivot/pivot.ns.js"),r=new r.Common.ResourceManager(n.SR,"PivotTables"),c=r.getResource.bind(r),o=h.mt.En,u="cancel-icon",l="cancel-class",f="ok-label",v="filter-confirm",d="date-group-startingAt-isActive",p="date-group-startingAt-value",m="date-group-endingAt-isActive",b="date-group-endingAt-value",a="date-group-by-value",g="date-group-dialog-sub-container",w="date_group_dialog_group-by-subContainer",y="date-group-by",C="date-group-by-selected",N="click",I="change",M=h.zc,e(S,M),S.prototype.$c=function(){this.pKt(),M.prototype.$c.call(this),this.Eot(),this.Fz()},S.prototype.pKt=function(){var t=(0,h.GC$)(o("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},S.prototype.Fz=function(){var a=this;(0,h.GC$)("."+l).bind(N,function(t){a.lQ()}),(0,h.GC$)("."+f).bind(N,function(t){var i,n,e,r,o,i=a.cKt,n=a.rYt,e=(0,h.GC$)("."+p).val().trim(),r=(0,h.GC$)("."+b).val().trim(),o=a.dKt;a.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:s.PivotDataType.date,fieldName:n,pivotName:i,startingAtValue:e,endingAtValue:r,groupByValueArray:o,selections:a.W3}}),a.lQ()}),(0,h.GC$)("."+y).bind(N,function(t){var i=parseInt((0,h.GC$)(this).attr("value"),10);-1<a.dKt.indexOf(i)?((0,h.GC$)("."+y).css("border","initial"),(0,h.GC$)(this).removeClass(C),a.dKt.splice(a.dKt.indexOf(i),1)):((0,h.GC$)("."+y).css("border","initial"),(0,h.GC$)(this).addClass(C),(0,h.GC$)(this).css("border","1px dotted rgb(255,135,34)"),a.dKt.push(i))}),(0,h.GC$)("."+p).bind(I,function(t){(a.fKt=!1,h.GC$)("."+d)[0].checked=!1}),(0,h.GC$)("."+b).bind(I,function(t){(a.vKt=!1,h.GC$)("."+m)[0].checked=!1}),(0,h.GC$)("."+d).bind(N,function(t){this.checked&&(0,h.GC$)("."+p).val(a.lKt)}),(0,h.GC$)("."+m).bind(N,function(t){this.checked&&(0,h.GC$)("."+b).val(a.hKt)})},S.prototype.mKt=function(){var t,i,n,e,r,o,a,t=y+(-1<this.dKt.indexOf(s.DateGroupType.seconds)?" "+C:""),i=y+(-1<this.dKt.indexOf(s.DateGroupType.minutes)?" "+C:""),n=y+(-1<this.dKt.indexOf(s.DateGroupType.hours)?" "+C:""),e=y+(-1<this.dKt.indexOf(s.DateGroupType.days)?" "+C:""),r=y+(-1<this.dKt.indexOf(s.DateGroupType.months)?" "+C:""),o=y+(-1<this.dKt.indexOf(s.DateGroupType.quarters)?" "+C:""),a=y+(-1<this.dKt.indexOf(s.DateGroupType.years)?" "+C:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'.concat(c().grouping,'</span>\n                        <span class="').concat(l+" "+u,'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>').concat(c().auto,'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" class="').concat(d,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(c().startingAt,'</span>\n                            <input class="').concat(p,'" value = "').concat(this.T,'"></input>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" class="').concat(m,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(c().endingAt,'</span>\n                            <input class="').concat(b,'" value = "').concat(this.gd,'"></input>\n                        </div>\n                        <div class="').concat(g,'">\n                            <span style = "display: inline-block;">').concat(c().groupBy,'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="').concat(w,'">\n                                <span value = ').concat(s.DateGroupType.seconds,' class="').concat(t,'">').concat(c().seconds,"</span>\n                                <span value = ").concat(s.DateGroupType.minutes,' class="').concat(i,'">').concat(c().minutes,"</span>\n                                <span value = ").concat(s.DateGroupType.hours,' class="').concat(n,'">').concat(c().hours,"</span>\n                                <span value = ").concat(s.DateGroupType.days,' class="').concat(e,'">').concat(c().days,"</span>\n                                <span value = ").concat(s.DateGroupType.months,' class="').concat(r,'">').concat(c().months,"</span>\n                                <span value = ").concat(s.DateGroupType.quarters,' class="').concat(o,'">').concat(c().quarters,"</span>\n                                <span value = ").concat(s.DateGroupType.years,' class="').concat(a,'">').concat(c().years,'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="').concat(l+" "+v,'">').concat(c().Cancel,'</span>\n                            <span class="').concat(f+" "+v,'">').concat(c().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},S.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},S.prototype.eG=function(){this.dh=null},S.prototype.KX=function(){(0,h.GC$)("."+l).unbind(N),(0,h.GC$)("."+f).unbind(N)},S.prototype.lQ=function(){this.eG(),this.KX(),M.prototype.close.call(this)},i.PivotDateGroupDialog=S},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(L,t,i){"use strict";var n,a,s,E,c,e,r,B,i,o,u,R,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,k,r,e,G,V,j,O,U,Q;function W(t){var i,t,i,t=new B.PivotFieldSettingNumberFormatDialog(t,t.bKt,t.gKt,t.bbt);return t.$c(),t}function P(t,i,n,e,r){var o,i,o=O.call(this,document.body,999,!0)||this;return o.YC=374,o.ZC=317.5,o.k1=!1,o.bbt="",o.wKt=[],o.yKt=i,o.dh=t,o.rYt=n,o.CKt=n,o.Vqt=e,o.RN=r,i=o.dh.getFieldInfoByName(n),o.IKt=i.a,o.AKt=i.getSubTotalType(),o.NKt(r),o.uf(),o}function F(t,i,n,e){var t=U.call(this,t,u().ValueSetting,i,n,e)||this;return t.TKt(),t.Dn(),t.MKt(),t.Fz(),t}function _(t,i,n,e,r,o,a){var t=Q.call(this,t,u().FieldSetting,i,n,e)||this;return t.xKt=r,t.Opi=o,t.Ppi=a,t.TKt(),t.Dn(),t.Fz(),t}n=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),t.PivotDimFieldSettingDialog=t.PivotValuesFieldSettingDialog=t.PivotSettingBaseDialog=void 0,s=i("Core"),E=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),c=i("Pivot"),e=i("Common"),r=i("./dist/plugins/pivot/pivot.ns.js"),B=i("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),o=e.Common.zf.j0,u=i.getResource.bind(i),R=s.mt.En,l=".pivot-field-content-base-field-item.active",f=".pivot-field-content-base-item-item.active",h="pivot-field-content-hide",v="pivot-field-content-base-item-item",d=".pivot-field-show-value-as-content-base-item",p=".pivot-field-show-value-as-content-base-field",m=".pivot-field-show-value-as-content-type-list",b=".pivot-field-setting-control-format",g=".pivot-field-setting-control-ok",w=".pivot-field-setting-control-cancel",y=".gc-filter-dialog-close",C=".pivot-field-custom-name",N="gc-sjs-field-settings-layout-showNoData",I="gc-sjs-field-settings-layout-showSubtotalTop",A="click",T="change",M="active",S="disable",x="pivot-field-content-item",D="pivot-field-summarize-item",k="pivot-field-summarize-content",r=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'.concat(D," ").concat(M,'">').concat(u().SummarizeValue,'</div>\n            <div id="ShowValueAs" class="').concat(D,'">').concat(u().ShowValueAs,"</div>\n        </div>\n    ")},O=s.zc,n(P,O),P.prototype.NKt=function(t){var i,n,e,r,o,a,s,a,s,i=this;if(t)for(n=0;n<t.length;n++)if((e=t[n]&&t[n].pivotArea)&&(r=e.references))for(o=0;o<r.length;o++)if(s=(a=r[o]).items,a=a.fieldName,s&&-1<s.indexOf(i.rYt)||a===i.rYt){(s=t[n].style)&&s.formatter&&(i.bbt=s.formatter);break}},P.prototype.$c=function(){O.prototype.$c.call(this),this.Eot()},P.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.bKt=(e-i)/2+"px",this.gKt=(t-n)/2+"px",this.Wc.css(["position","left","top","z-index"],["absolute",this.bKt,this.gKt,1001])},P.prototype.dialogHeader=function(t){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '.concat(t,'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        ')},P.prototype.dialogFieldNameArea=function(t,i){var n="pivot-field-row-wrap";return t=o(t),i=o(i),'\n            <div class ="pivot-field-setting-name-area">\n                <div class='.concat(n,">\n                    <label>").concat(u().SourceName," </label> <span>").concat(t,"</span>\n                </div>\n                <div class=").concat(n,">\n                    <label>").concat(u().CustomName,' </label> <span><input class="pivot-field-custom-name" type="text" value="').concat(i,'"></span>\n                </div>\n            </div>\n        ')},P.prototype.dialogFooter=function(t){var t=t===c.PivotDataType.number||t===c.PivotDataType.date?u().NumberFormat:u().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'.concat(t,'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "').concat(u().Ok,'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "').concat(u().Cancel,'">\n                </div>\n            </div>\n        ')},P.prototype.Dn=function(){var t=(0,s.GC$)(R("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML="".concat(this.dialogHeader(this.yKt),'\n                <div class="gc-pivot-field-setting-content">\n                    ').concat(this.dialogFieldNameArea(this.IKt,this.rYt),"\n                    ").concat(this.wKt.join("\n"),"\n                </div>\n            ").concat(this.dialogFooter(this.dh.rBt(this.rYt))),this.Wc.append(t),(0,s.GC$)(".pivot-field-content-item[data-subtype='"+this.AKt+"']",this.Wc[0]).addClass(M),this.Wc.width(this.YC),this.Wc.height(this.ZC)},P.prototype.eG=function(){this.dh=null,this.rYt=void 0},P.prototype.lQ=function(){this.eG(),O.prototype.close.call(this)},P.prototype.lf=function(t){var i;return!(!this.Wc||!O.prototype.hf.call(this,this.Wc.get(0),t))||this.DKt&&O.prototype.hf.call(this,this.DKt.get(0),t)},t.PivotSettingBaseDialog=e=P,n(F,U=e),F.prototype.TKt=function(){this.SKt()},F.prototype.MKt=function(){var t,i,n,e,r,o,t=this,i=this.dh.getFieldInfoByName(t.rYt).Or;if(i&&(t.kKt=i.showDataAs,t.jKt=i.baseFieldName,t.OKt=i.baseFieldItem,n=i.showDataAs+"",(0,s.GC$)(m,this.Wc[0]).value=n,-1<["4","7","8","9","10","11","12","13"].indexOf(n))){for((0,s.GC$)(p).removeClass(S),e=a(a([],t.dh.nw(1),!0),t.dh.nw(2),!0),r=0;r<e.length;r++)if(e[r].Zc===i.baseFieldName){t.PKt=r;break}if(-1<["4","8","9"].indexOf(n))if((0,s.GC$)(d).removeClass(S),1===i.baseFieldItemType)t.FKt=1,t._Kt=1,t.OKt=u().BaseItemNext;else if(2===i.baseFieldItemType)t.FKt=0,t._Kt=0,t.OKt=u().BaseItemPrevious;else for(o=a([],t.dh.Kz(i.baseFieldName),!0),r=0;r<o.length;r++)if(o[r]+""===i.baseFieldItem){t.FKt=r+2;break}}},F.prototype.SKt=function(){var t,i,n,t=this.LKt(),i=this.EKt(),n=this.BKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n            '.concat(t,"\n            ").concat(i,"\n            ").concat(n,"\n            </div>\n        "))},F.prototype.LKt=r,F.prototype.EKt=function(){return'\n        <div class="'.concat(k,'">\n            <div class="').concat(k,'-header">').concat(u().SummarizeValueField,'</div>\n            <div class="').concat(k,'-desc">').concat(u().ChooseType,'</div>\n            <ul class="').concat(k,'-list">\n                <li data-subtype="8" class="').concat(x,'">').concat(u().Sum,'</li>\n                <li data-subtype="1" class="').concat(x,'">').concat(u().Count,'</li>\n                <li data-subtype="0" class="').concat(x,'">').concat(u().Average,'</li>\n                <li data-subtype="3" class="').concat(x,'">').concat(u().Max,'</li>\n                <li data-subtype="4" class="').concat(x,'">').concat(u().Min,'</li>\n                <li data-subtype="5" class="').concat(x,'">').concat(u().Product,'</li>\n                <li data-subtype="2" class="').concat(x,'">').concat(u().CountNumbers,'</li>\n                <li data-subtype="6" class="').concat(x,'">').concat(u().StdDev,'</li>\n                <li data-subtype="7" class="').concat(x,'">').concat(u().StdDevp,'</li>\n                <li data-subtype="9" class="').concat(x,'">').concat(u().Var,'</li>\n                <li data-subtype="10" class="').concat(x,'">').concat(u().Varp,"</li>\n            </ul>\n        </div>\n        ")},F.prototype.BKt=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'.concat(u().ShowValueAsField,'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">').concat(u().noCalculation,'</option>\n                <option value="1">').concat(u().percentGrandTotal,'</option>\n                <option value="3">').concat(u().percentColumnTotal,'</option>\n                <option value="2">').concat(u().percentRowTotal,'</option>\n                <option value="4">').concat(u().percentEllipsis,'</option>\n                <option value="5">').concat(u().percentParentRowTotal,'</option>\n                <option value="6">').concat(u().percentParentColumnTotal,'</option>\n                <option value="7">').concat(u().percentParentTotal,'</option>\n                <option value="8">').concat(u().difference,'</option>\n                <option value="9">').concat(u().percentDifference,'</option>\n                <option value="10">').concat(u().runningTotal,'</option>\n                <option value="11">').concat(u().percentRunningTotal,'</option>\n                <option value="12">').concat(u().rankSmallestLargest,'</option>\n                <option value="13">').concat(u().rankLargestSmallest,'</option>\n                <option value="14">').concat(u().index,'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>').concat(u().baseField,'</div>\n                <ul class="pivot-field-show-value-as-content-base-field ').concat(S,'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>').concat(u().baseItem,'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  ').concat(S,'">\n                </ul>\n            </div>\n        </div>\n        ')},F.prototype.Fz=function(){var o=this;(0,s.GC$)(y,this.Wc[0]).bind(A,function(){o.lQ()}),(0,s.GC$)(w,this.Wc[0]).bind(A,function(){o.lQ()}),(0,s.GC$)(C,this.Wc[0]).bind(T,function(){o.k1=!0,o.rYt=(0,s.GC$)(this).val()}),(0,s.GC$)(".".concat(x),this.Wc[0]).bind(A,function(){(0,s.GC$)(".".concat(x,".").concat(M)).removeClass(M),o.k1=!0,o.AKt=+(0,s.GC$)(this).addClass(M).attr("data-subtype");var t=o.dh.getFieldInfoByName(o.CKt).a,t=o.dh.FG(t,t,o.AKt);(0,s.GC$)(C).val(t),o.rYt=t}),(0,s.GC$)(g,this.Wc[0]).bind(A,function(){var t=(0,c.ht)(o.kKt)?"0":o.kKt+"",i,n=o.jKt,e=o.OKt,r=o._Kt;-1<["4","7","8","9","10","11","12","13"].indexOf(t)&&-1<["4","8","9"].indexOf(t)&&(i={value:e,index:r}),o.dh.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:o.Vqt,oldFieldName:o.CKt,subtotalType:o.AKt,fieldName:o.rYt,showValueAsType:parseInt(t,10),baseField:n,baseItem:i},formatter:o.bbt}),o.bbt="",o.lQ()}),(0,s.GC$)(".".concat(D),this.Wc[0]).bind(A,function(){var t,t;(0,s.GC$)(".".concat(D,".").concat(M)).removeClass(M),(0,s.GC$)(".pivot-field-content-hide").removeClass(h),(0,s.GC$)(this).addClass(M),(0,s.GC$)(p).empty(),"SummarizeValue"===this.id?(0,s.GC$)(".pivot-field-show-value-as-content").addClass(h):(-1<o.kKt&&((0,s.GC$)(m)[0].value=o.kKt,-1<o.PKt)&&((0,s.GC$)(p).removeClass(S),-1<o.FKt)&&(0,s.GC$)(d).removeClass(S),(0,s.GC$)(".".concat(k)).addClass(h),o.RKt=a(a([],o.dh.nw(1),!0),o.dh.nw(2),!0),o.RKt.forEach(function(t,i){var n=document.createElement("li");n.className="pivot-field-content-base-field-item",n.value=i,-1<o.PKt&&o.PKt===i&&n.classList.add(M),n.innerText=t.Zc,(0,s.GC$)(p)[0].appendChild(n)}),-1<o.FKt&&(t=o.dh.getFieldInfoByName(o.rYt).Or,(t=a([],o.dh.Kz(t.baseFieldName),!0)).unshift(u().BaseItemNext),t.unshift(u().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,n.value=i,n.innerText=t,i===o.FKt&&n.classList.add(M),(0,s.GC$)(d)[0].appendChild(n)})))}),(0,s.GC$)(p,this.Wc[0]).bind(A,function(t){var t,t;this.classList.contains(S)||"LI"!==t.target.tagName||((0,s.GC$)(l).removeClass(M),(0,s.GC$)(d).empty(),t.target.classList.add(M),t=t.target.textContent,o.jKt=t,["4","8","9"].indexOf(o.kKt+"")<0)||((t=a([],o.dh.Kz(t),!0)).unshift(u().BaseItemNext),t.unshift(u().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,n.value=i,n.innerText=t,0===i&&n.classList.add(M),(0,s.GC$)(d)[0].appendChild(n)}))}),(0,s.GC$)(d,this.Wc[0]).bind(A,function(t){this.classList.contains(S)||"LI"!==t.target.tagName||((0,s.GC$)(f).removeClass(M),t.target.classList.add(M),o.OKt=t.target.textContent,o._Kt=t.target.value)}),(0,s.GC$)(m,this.Wc[0]).bind(T,function(t){var t,i,t,t=t.target.value;(0,s.GC$)(d).empty(),o.bbt=void 0,o.kKt=parseInt(t,10),-1<["4","7","8","9","10","11","12","13"].indexOf(t)?((0,s.GC$)(p).removeClass(S),0<(0,s.GC$)(".pivot-field-content-base-field-item").length&&((0,s.GC$)(".pivot-field-content-base-field-item")[0].classList.add(M),i=o.RKt[0].Zc,o.jKt=i,-1<["4","8","9"].indexOf(t))&&((0,s.GC$)(d).removeClass(S),(t=a([],o.dh.Kz(i),!0)).unshift(u().BaseItemNext),t.unshift(u().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,0===(n.value=i)&&(n.classList.add(M),o._Kt=0),n.innerText=t,(0,s.GC$)(d)[0].appendChild(n)}))):((0,s.GC$)(d).addClass(S),(0,s.GC$)(p).addClass(S),(0,s.GC$)(l).removeClass(M),(0,s.GC$)(f).removeClass(M))}),(0,s.GC$)(b,this.Wc[0]).bind(A,function(){var t=W(o);o.DKt=t.Xc()})},F.prototype.KX=function(){(0,s.GC$)(y).unbind(A),(0,s.GC$)(p).unbind(A),(0,s.GC$)(d).unbind(A),(0,s.GC$)(m).unbind(T),(0,s.GC$)(b).unbind(A)},F.prototype.lQ=function(){this.KX(),U.prototype.lQ.call(this)},t.PivotValuesFieldSettingDialog=F,n(_,Q=e),_.prototype.TKt=function(){this.SKt()},_.prototype.GKt=r,_.prototype.VKt=function(){return'\n        <div class="field-settings-layout-container">\n                <span class="gc-sjs-field-settings-layout-style">'.concat(u().Layout,'</span>\n                <div class="gc-sjs-field-settings-layout-line"></div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.xKt?"checked":""," class=").concat(N,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(u().showNoData,'</span>\n                </div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.Ppi===E.PivotTableLayoutType.tabular?"disabled":""," ").concat(this.Opi?"checked":""," class=").concat(I,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(u().showSubtotalTop,"</span>\n                </div>\n        </div>")},_.prototype.SKt=function(){var t=this.VKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n                '.concat(t,"\n            </div>\n        "))},_.prototype.Fz=function(){var i=this;(0,s.GC$)(y,this.Wc[0]).bind(A,function(){i.lQ()}),(0,s.GC$)(w,this.Wc[0]).bind(A,function(){i.lQ()}),(0,s.GC$)(C,this.Wc[0]).bind(T,function(){i.k1=!0,i.rYt=(0,s.GC$)(this).val()}),(0,s.GC$)("."+N,this.Wc[0]).bind(A,function(){i.xKt=this.checked}),(0,s.GC$)("."+I,this.Wc[0]).bind(A,function(){i.Opi=this.checked}),(0,s.GC$)(b,this.Wc[0]).bind(A,function(){var t=W(i);i.DKt=t.Xc()}),(0,s.GC$)(g,this.Wc[0]).bind(A,function(){i.dh.wVt({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:i.Vqt,oldFieldName:i.CKt,fieldName:i.rYt,showNoData:i.xKt,showSubtotalTop:i.Opi},formatter:i.bbt}),i.bbt="",i.lQ()})},_.prototype.KX=function(){(0,s.GC$)(y).unbind(A),(0,s.GC$)(w).unbind(A),(0,s.GC$)(C).unbind(T),(0,s.GC$)(b).unbind(A),(0,s.GC$)(g).unbind(A)},_.prototype.lQ=function(){this.KX(),Q.prototype.lQ.call(this)},t.PivotDimFieldSettingDialog=_},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(t,i,n){"use strict";var e,o,r,a,n,a,s,c,u,l,f,h,v,d,p,m,b;function g(t,i,n,e){var r=b.call(this,null,1e4)||this;return r.Pc=!0,r.A0=n,r.I0=i,r.UKt=t,r.bbt=e,r.pKt(),r}e=this&&this.__extends||(m=function(t,i){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}m(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFieldSettingNumberFormatDialog=void 0,o=n("Core"),r=o.mt.En,a=n("Common"),n=n("./dist/plugins/pivot/pivot.ns.js"),a=new a.Common.ResourceManager(n.SR,"PivotTables"),s=a.getResource.bind(a),c=".pivot-field-number-format-show-value",u=".pivot-field-number-format-sample-value",l=o.mt.St,f=null,h=void 0,v="click",d="active",b=o.zc,e(g,b),g.prototype.Eot=function(){this.Wc.css(["position","left","top"],["absolute",this.I0,this.A0])},g.prototype.eG=function(){this.UKt=f,this.bbt=h},g.prototype.lQ=function(){this.KX(),this.eG(),b.prototype.close.call(this)},g.prototype.KX=function(){(0,o.GC$)(".pivot-field-content-number-format-item").unbind(v),(0,o.GC$)(".pivot-field-setting-number-format-control-ok").unbind(v),(0,o.GC$)(".gc-filter-dialog-close",this.Wc[0]).unbind(v),(0,o.GC$)(".pivot-field-setting-number-format-control-cancel").unbind(v),(0,o.GC$)(c).unbind(v)},g.prototype.$c=function(){b.prototype.$c.call(this),this.QKt(),this.Fz(),this.Eot()},g.prototype.Fz=function(){var n=this;(0,o.GC$)(".pivot-field-content-number-format-item",this.Wc[0]).bind(v,function(t){(0,o.GC$)(".pivot-field-content-number-format-item.active").removeClass(d),this.classList.add(d),(0,o.GC$)(c)[0].value=this.innerText,l(this.innerText)||((0,o.GC$)(u)[0].value=o.Be.Re(12345,this.innerText))}),(0,o.GC$)(".pivot-field-setting-number-format-control-ok",this.Wc[0]).bind(v,function(){var t,i,t=(0,o.GC$)(c)[0].value,i=s().CustomFormats;i.indexOf(t)<0&&i.push(t),n.UKt.bbt=(0,o.GC$)(c)[0].value,n.lQ()}),(0,o.GC$)(".gc-filter-dialog-close",this.Wc[0]).bind(v,function(){n.lQ()}),(0,o.GC$)(".pivot-field-setting-number-format-control-cancel",this.Wc[0]).bind(v,function(){n.lQ()}),(0,o.GC$)(c,this.Wc[0]).bind("input",function(){if(!l(this.value))try{(0,o.GC$)(u)[0].value=o.Be.Re(12345,this.value)}catch(t){}})},g.prototype.pKt=function(){var t=(0,o.GC$)(r("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML=this.WKt()+'<div class="gc-pivot-field-setting-content">'+this.zKt()+"</div>"+this.ZKt(),this.Wc.append(t)},g.prototype.WKt=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'.concat(s().FormatCells,'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>')},g.prototype.ZKt=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'.concat(s().Ok,'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "').concat(s().Cancel,'">\n            </div>\n        </div>')},g.prototype.zKt=function(){var t=this.YKt();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'.concat(s().Number,"</div>\n            </div>\n            ").concat(t,"\n        </div>\n        ")},g.prototype.YKt=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'.concat(s().Sample,'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">').concat(s().Type,'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        ')},g.prototype.QKt=function(){var t,e,r,t=s().CustomFormats,e=this;e.bbt&&t.indexOf(e.bbt)<0&&t.push(e.bbt),r=null,t.forEach(function(t,i){var n=document.createElement("li");n.className="pivot-field-content-number-format-item",n.value=i,n.innerText=t,e.bbt||0!==i?e.bbt===t&&(n.classList.add(d),(0,o.GC$)(c)[0].value=t,l(t)||((0,o.GC$)(u)[0].value=o.Be.Re(12345,t),r=n)):(n.classList.add(d),(0,o.GC$)(c)[0].value=t),(0,o.GC$)(".pivot-field-number-format-content-list")[0].appendChild(n)}),r&&r.scrollIntoView()},i.PivotFieldSettingNumberFormatDialog=g},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(L,t,i){"use strict";var E,n,B,v,R,d,i,G,s,V,o,e,U,r,Q,a,c,u,W,l,f,h,p,z,m,b,g,Z,w,y,Y,C,N,H,J,q,K,X,$,tt,it,nt,et,I,A,rt,T,M,S,x,ot,D,at,st,k,j,ct,ut,lt,O,ft,ht,vt,dt,pt,mt,bt,gt,wt,yt,P;function F(){}function _(t,i,n,e){var t=P.call(this,t,1e3)||this;return t.dh=i,t.Vqt=n,t.Zue=e,t}E=this&&this.__extends||(wt=function(t,i){return(wt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}wt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.PivotFilterDialog=void 0,n=i("Common"),B=i("./dist/plugins/pivot/pivot.ns.js"),v=i("Core"),R=i("CellTypes"),d=i("Pivot"),i=new n.Common.ResourceManager(B.SR,"PivotTables"),G=n.Common.zf.j0,s=i.getResource.bind(i),V=v.mt.En,o=n.Common.$T,e=n.Common.zf,U="gc-Filter-list",r="gc-Filter-list-block",Q="gc-Filter-list-select-block",a="gc-Filter-list-icon",c="gc-Filter-list-link",u="gc-Filter-list-item",W="gc-Filter-list-link-arrow",l="gc-Filter-list-sort-item",h="item-hover",p="item-noHover",z="clear-filter-icon-default",m="clear-filter-icon",b="gc-Filter-list-span",g="filter-list-box",Z="filter-confirm",w="filter-dialog-confirm",y="filter-confirm-enable",Y="filter-bottom-line",C="filter-sort-icon-one",N="filter-sort-icon-two",H="filter-list-box-icon",J="filter-list-box-container",q="filter-search",K="filter-list-box-host",X="filter-search-input",$="filter-select-all-container",tt="filter-select-icon",it="filter-select-all-link",nt="filter-check-all-icon",et="filter-uncheck-all-icon",I="check-all",A="uncheck-all",rt=f="gc-Filter-list-icon-selected",T="select-class",M="ok-class",S="cancel-class",x="filter-sort",ot="filter-sort-dialog",D="filter-condition",at="gc-pivot-search-box",st="gc-pivot-search-box-input-container",k="gc-pivot-search-box-input",j="gc-pivot-search-box-icon",ct="gc-pivot-search-box-icon-background-clear",ut="gc-Filter-list-resizable",lt="gc-Filter-list-button-container",O=null,ft=void 0,ht="px",vt=function(){return{type:2,child:[{text:s().PivotPanel_Sort_A_Z,className:l+" "+x,iconClass:a+" "+C,commandName:"asc"},{text:s().PivotPanel_Sort_Z_A,className:l+" "+x,iconClass:a+" "+N,commandName:"desc"},{text:s().PivotPanel_Sort_More,className:l+" "+ot,iconClass:a}]}},dt=function(){return{type:3,child:[{text:s().PivotPanel_Filter_Clear,className:l+" "+D,iconClass:a+" "+z,commandName:"ClearFilter"},{text:s().PivotPanel_Filter_Label,className:l+" "+h+" "+D,iconClass:a,commandName:"LabelFilter",rightArrow:!0},{text:s().PivotPanel_Filter_Value,className:l+" "+h+" "+D,iconClass:a,commandName:"ValueFilter",rightArrow:!0}]}},pt=function(){return{type:5,child:[{text:s().Cancel,className:"".concat(w," ").concat(y),commandName:"Cancel"},{text:s().Ok,className:"".concat(w," ").concat(y),commandName:"OK"}]}},yt=mt={selectFields:1,1:"selectFields",sortArea:2,2:"sortArea",filters:3,3:"filters",listBox:4,4:"listBox",confirmButton:5,5:"confirmButton"},F.getData=function(t,i,n){return F.getDataModel(t,i,n)},F.getDataModel=function(t,i,n){var e=[];return 1&t&&e.push(F.getSelectData(n)),2&t&&e.push(F.getSortSData(n)),4&t&&e.push(F.getFilterData(n,i)),8&t&&e.push(F.getListBoxData(n)),16&t&&e.push(F.getConfirmData()),e},F.getSelectData=function(t){var i,n,i={type:1,child:[]};if(t.areaFieldName)for(n=0;n<t.areaFieldName.length;n++)i.child.push({text:""}),i.child[n].text=t.areaFieldName[n];return i},F.getSortSData=function(t){var i,t,i=v.GC$.extend(!0,{},vt());return t.fieldIsNumber&&(i.child[0].text=s().PivotPanel_Sort_Smallest_Largest,i.child[1].text=s().PivotPanel_Sort_Largest_Smallest),t.isColOrRow?(i.child[0].className+=" "+h,i.child[1].className+=" "+h,i.child[2].className+=" "+h):(i.child[0].className+=" "+p,i.child[1].className+=" "+p,i.child[2].className+=" "+p),(0,d.ht)(t.sortInfo)||(t=i.child[t.sortInfo],(0,d.ht)(t))||(~t.iconClass.indexOf(C)?t.iconClass=t.iconClass.replace(C,f):~t.iconClass.indexOf(N)&&(t.iconClass=t.iconClass.replace(N,f))),i},F.getFilterData=function(t,i){var n=v.GC$.extend(!0,{},dt());return n.child[0].text=n.child[0].text.replace("{0}",'"'.concat(i,'"')),t.hasLabelCondition||t.hasValueCondition||t.hasLabelManual?n.child[0].className+=" "+h:n.child[0].className+=" "+p,t.hasLabelCondition&&(n.child[1].iconClass+=" "+rt,n.child[0].iconClass=a+" "+m),t.isDateType&&(n.child[1].text=s().PivotPanel_Date_Filter),t.hasValueCondition&&(n.child[2].iconClass+=" "+rt,n.child[0].iconClass=a+" "+m),n},F.getListBoxData=function(t){var i={type:4,child:[]};return i.child=t.fields,i},F.updateListBoxData=function(t,i,n){var e,r;if(t&&0!==t.child.length){if(e=t.child,0===i)for(r=0;r<e.length;r++)e[r].status=n;else e[i].status=n;return t}},F.getConfirmData=function(){return v.GC$.extend(!0,{},pt())},bt=F,P=v.zc,E(_,P),_.prototype.init=function(t,i,n,e){this.c5(),this.rYt=i,this.HKt=t,this.u_=n,this.LEt=e,this.JKt=!1,this.qKt=0,this.KKt=!1,this.XKt="",P.prototype.Hc.call(this),this.dh.getFieldInfoByName(i)?e.isDateType=2===this.dh.getFieldInfoByName(i).W5:e.isDateType=2===this.dh.hr(i);var t=bt.getData(t,i,e);this.open(t,n)},_.prototype.c5=function(){this.Vv&&(this.Vv.L0(),this.Vv=null)},_.prototype.open=function(t,i){for(var n,e,e,r,o,i,e,e,n=this,r="",o=0;o<t.length;o++)switch(t[o].type){case 1:r+=this.renderSelectField(t[o]);break;case 2:r+=this.renderSort(t[o]);break;case 3:r+=this.renderFilters(t[o]);break;case 4:r+=this.renderListBox(t[o]);break;case 5:r+=this.renderConfirm(t[o])}(i=this.WX(i.x,i.y)).html(r),e=this.rf(),this.$c(),e&&window.Vc.cf(),this.$Kt(),this.tpi=i.width(),this.ipi=i.height(),null!=(e=this.Zue)&&e.allowResize&&(i.addClass(ut),this.Wue=new v.Ose(i[0],function(){n.Vv.Cg(),n.Vv.repaint()},40)),null!=(e=this.Zue)&&e.keepDialogSize&&(e=this.dh.npi)&&(i.width(e.width),i.height(e.height)),this.epi(),this.if()},_.prototype.epi=function(){var t=this.Xc();t.css(["minWidth","minHeight"],[this.tpi+ht,this.ipi+ht]),this.ipi=t.height(),this.tpi=t.width()},_.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n.addClass(U),n},_.prototype.$c=function(){P.prototype.$c.call(this)},_.prototype.close=function(){var t,i,i=this.Xc();null==(t=this.Zue)||!t.keepDialogSize||this.ipi===i.height()&&this.tpi===i.width()||(this.dh.npi={width:i.width(),height:i.height()}),this.KX(),this.eG(),P.prototype.close.call(this)},_.prototype.eG=function(){this.Wue&&this.Wue.disconnect(),this.Wue=O,this.tXt=O,this.iXt=O,this.dh=O,this.u_=O,this.LEt=O,this.Vv=O},_.prototype.aY=function(o){var a,s,a=this,s=this;o.bind(v.Events.CellClick,function(t,i){var n,e,n,n=a.tXt,e=i.sheet;e.Oi&&e.aR("transparent"),i.row>=n.length||(0===i.row?(s.KKt=!s.KKt,e.setValue(0,0,s.KKt)):(n=e.getValue(i.row,0),e.setValue(i.row,0,!n),n?s.qKt--:s.qKt++),s.nXt())}),o.bind(v.Events.TouchToolStripOpening,function(t,i){i.handled=!0}),o.bind(v.Events.ButtonClicked,function(t,i){var n,e,n,n=a.tXt,e=i.sheet;i.row>=n.length||(0===i.row?(s.KKt=!s.KKt,e.setValue(0,0,s.KKt)):(n=e.getValue(i.row,0),e.setValue(i.row,0,!n),n?s.qKt--:s.qKt++),s.nXt())}),(0,v.GC$)("."+I).bind("click",function(t){var i,n,e,r,i=a.tXt,n=o&&(0,v.jf)(o);if(!(i.length<=0)){if(n){for(n.suspendPaint(),e=0,r=1;r<i.length;r++)n.getRowVisible(r)&&(n.setValue(r,0,!0),e++);n.resumePaint(),s.qKt=e}(0,v.GC$)("."+M).addClass(y)}}),(0,v.GC$)("."+A).bind("click",function(t){var i,n,e,i=a.tXt,n=o&&(0,v.jf)(o);if(!(i.length<=0)){if(n){for(n.suspendPaint(),e=1;e<i.length;e++)n.getRowVisible(e)&&n.setValue(e,0,!1);n.resumePaint(),s.qKt=0}(0,v.GC$)("."+M).removeClass(y)}}),(0,v.GC$)("."+T).bind("change",function(t){var i,n,e,r,o,i=this.options[this.selectedIndex].value,n=s.dh,e=s.Vqt,r=s.u_,o=s.HKt;n.wVt({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:i,pivotName:e,configurationNumber:o,position:r,filterDialog:s}})}),(0,v.GC$)("."+M).bind("click",function(t){var i,n,e,r;(0,v.GC$)(this).hasClass(y)&&(i=s.rYt,n=s.dh,e=s.Vqt,r=s.eXt(),n.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:i,pivotName:e,dataOfListBox:r}}),s.close())}),(0,v.GC$)("."+S).bind("click",function(t){s.close()}),(0,v.GC$)("."+x).bind("click",function(t){var i,n,e,r;(0,v.GC$)(this).hasClass(p)||(i=(0,v.GC$)(this).attr("command"),n=s.dh,e=s.rYt,r=s.Vqt,n.wVt({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:i}}),s.close())}),(0,v.GC$)("."+ot).bind("click",function(t){var i,n,e;(0,v.GC$)(this).hasClass(p)||(i=s.dh,n=s.rYt,e=s.Vqt,s.close(),i.wVt({cmd:"createDialogForPivotSort",sheetName:"",cmdOption:{fieldName:n,pivotName:e}}))}),(0,v.GC$)("."+D).bind("click",function(t){var i,n,e,r,i=(0,v.GC$)(this).attr("command");(0,v.GC$)(this).hasClass(p)||"ClearFilter"!==i||(n=s.dh,e=s.rYt,r=s.Vqt,n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:i,clearType:0}}),s.close())}),(0,v.GC$)("."+D).bind("mouseenter",function(t){var i,n,i,e,r,o,a,i=(0,v.GC$)(this),n=i.attr("command");i.hasClass(p)||"ClearFilter"===i.attr("command")||(i=s.dh,e=s.rYt,r=s.Vqt,a={x:s.u_.x,y:s.u_.y},i.wVt({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:n,host:o=this,position:a,filterDialog:s}}))}),(0,v.GC$)("."+k).bind("input",function(t){s.JKt=!0,s.XKt=this.value.toLocaleLowerCase(),s.rXt()}),(0,v.GC$)("."+j).bind("click",function(t){(0,v.GC$)("."+k).val(""),s.JKt=!1,s.XKt="",s.rXt()})},_.prototype.KX=function(){(0,v.GC$)("."+I).unbind("click"),(0,v.GC$)("."+A).unbind("click"),(0,v.GC$)("."+T).unbind("change"),(0,v.GC$)("."+M).unbind("click"),(0,v.GC$)("."+S).unbind("click"),(0,v.GC$)("."+x).unbind("click"),(0,v.GC$)("."+D).unbind("click"),(0,v.GC$)("."+D).unbind("mouseenter"),(0,v.GC$)("."+X).unbind("change"),(0,v.GC$)("."+k).unbind("input"),(0,v.GC$)("."+j).unbind("click")},_.prototype.renderSelectField=function(t){for(var i,n,i='<select class="'.concat(T,'" style="width:100%">'),n=0;n<t.child.length;n++)i+=this.renderDropDown(t.child[n].text);return"<div class='".concat(Q,"'>\n                    <div class='").concat(u,"'>\n                    ").concat(s().Select_Field,"\n                    </div>\n                    <div class='").concat(u,"'>\n                        ").concat(i,"\n                        </select>\n                    </div>\n                </div>")},_.prototype.renderSort=function(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=this.createItem(t.child[n]);return'<div class="'.concat(r,'">\n                    ').concat(i,'\n                    <div class="').concat(b,'"></div>\n                </div>')},_.prototype.renderFilters=function(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=this.createItem(t.child[n]);return'<div class="'.concat(r,'">\n                    ').concat(i,'\n                    <div class="').concat(b,'"></div>\n                </div>')},_.prototype.renderListBox=function(t){var i,n,e,t,r;for(this.iXt=J,this.tXt=t.child,i="",n=t.child,e=0;e<n.length;e++)if(!1===n[e].status){i=f+" "+a;break}return t=this.oXt(),r=this.aXt(),'<div class="'.concat(g,'">\n                    ').concat(t,"\n                    ").concat(r,'\n                    <div class="').concat(K,'">\n                    <div class="').concat(H,'">\n                        <div class="').concat(i,'"></div>\n                    </div>\n                    <div class="').concat(J,'"></div>\n                    </div>\n                <div>')},_.prototype.renderConfirm=function(t){return'<div class="'.concat(r,'">\n                    <div class="').concat(l," ").concat(lt,'">\n                        <div class="').concat(t.child[0].className+" "+S,'" command="').concat(t.child[0].commandName,'">').concat(t.child[0].text,'</div>\n                        <div class="').concat(t.child[1].className+" "+M,'" command="').concat(t.child[1].commandName,'">').concat(t.child[1].text,"</div>\n                    </div>\n                </div>")},_.prototype.renderDropDown=function(t){return t=G(t),"<option>".concat(t,"</option>")},_.prototype.createItem=function(t){return t.rightArrow?'<div class="'.concat(t.className,'" command="').concat(t.commandName,'">\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(c,'">').concat(e.j0(t.text),'</div>\n                        <div class="').concat(W,'"></div>\n                    </div>'):'<div class="'.concat(t.className,'" command="').concat(t.commandName,'">\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(c,'">').concat(e.j0(t.text),"</div>\n                    </div>")},_.prototype.$Kt=function(t){var i,i,n,e,r,e;t=t||this.tXt,i=this.iXt,(i=new v.Workbook(document.getElementsByClassName(i)[0],{sheetCount:1})).xU=!0,i.options.scrollByPixel=!0,n=(this.Vv=i).sheets[0],i.suspendEvent(),n.suspendPaint(),e=i.options,r=n.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor="transparent",r.selectionBorderColor="transparent",r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,n.defaults.rowHeight=21,n.defaults.colWidth=23,t.unshift({value:s().AddSearchResult,status:this.KKt,text:s().AddSearchResult}),this.sXt(),n.resumePaint(),i.resumeEvent(),this.aY(i),(e=(0,v.GC$)("."+g)).css("height","calc(100% - ".concat(this.Wc.height()-e.height(),"px)"))},_.prototype.uXt=function(){var t,i,n,t,t=this,i=t.Vv,n=t.qKt,t=t.JKt;(0,d.ht)(i)||(t&&n++,i.options.showVerticalScrollbar=8<n)},_.prototype.tst=function(t){var i,n,e,i,r,o,a,i=this,n=i.Vv,e=i.qKt,i=i.JKt;(0,d.ht)(n)||(r=(0,v.jf)(n),a=170,(o=n.options.showVerticalScrollbar)&&(a-=20),a<(t=i&&e&&t<v.q.Wt(s().AddSearchResult)?v.q.Wt(s().AddSearchResult):t)?(n.options.showHorizontalScrollbar=!0,r.autoFitColumn(1)):(n.options.showHorizontalScrollbar=!1,r.setColumnWidth(1,500)))},_.prototype.eXt=function(){var t,i,n,e,t,r,o,a,s,c,u,l,f,h,t=this,i=t.JKt,n=t.KKt,e=t.tXt,t=t.Vv,r=t&&(0,v.jf)(t),o={},a=!0;if(!(0,d.ht)(r)){if(i)if(n){for(c=1;c<e.length;c++)r.getRowVisible(c)&&((s=r.getValue(c,0))&&(a=!1),o[c]=e[c].status,e[c].status=s);if(a)for(l=0,f=u=Object.keys(o);l<f.length;l++)e[h=f[l]].status=o[h]}else for(c=1;c<e.length;c++)r.getRowVisible(c)&&r.getValue(c,0)?e[c].status=!0:e[c].status=!1;else for(c=1;c<e.length;c++)r.getValue(c,0)?e[c].status=!0:e[c].status=!1;e.shift()}return e},_.prototype.nXt=function(){var t=this;t.KKt||t.qKt?(0,v.GC$)("."+M).addClass(y):(0,v.GC$)("."+M).removeClass(y)},_.prototype.rXt=function(){var t,i,n,n,e,r,o,a,s,t=this,i=t.tXt,n=t.XKt;if(t.cXt(),(0,d.ht)(n)||n.length<1)t.JKt=!1,t.sXt();else if(e=(n=t.Vv)&&(0,v.jf)(n)){for(e.suspendPaint(),e.setRowVisible(0,!0),r=void(t.qKt=0),o=0,a=t.lXt(),s=1;s<i.length;s++)(r=i[s]).text&&a(r.text)?(e.setRowVisible(s,!0),e.setValue(s,0,!0),t.qKt++,o=r.textLength>o?r.textLength:o):e.setRowVisible(s,!1);0===t.qKt&&e.setRowVisible(0,!1),t.uXt(),t.tst(o),e.resumePaint()}},_.prototype.lXt=function(){var t,i,n,e,r,t,i=this.XKt,n=o.jJ(i);return n?(e=o.OJ(n),function(t){return r=e.exec(t),e.lastIndex=0,r&&0===r.index}):function(t){return-1<t.toLocaleLowerCase().indexOf(i)}},_.prototype.cXt=function(){var t,i,n,t,i=this.XKt,n=(0,v.GC$)("."+j);i?n.css("display","block"):n.css("display","none")},_.prototype.sXt=function(){var t,i,n,e,r,o,a,s,i,t=this,i=t.Vv,n=i&&(0,v.jf)(i),e=t.tXt,r=v.GC$.extend(!0,[],e);for(n.suspendPaint(),t.qKt=0,n.setRowVisible(0,!1),o=0,s=1;s<r.length;s++)(a=r[s]).status&&t.qKt++,n.setRowVisible(s,!0),(0,d.ht)(a.textLength)&&(e[s].textLength=v.q.Wt(a.text)),o=a.textLength>o?a.textLength:o;n.setDataSource(r),n.bindColumns([{name:"status",cellType:new R.CheckBox},{name:"text"}]),(i=n.getActualStyle(-1,2)).hAlign=0,n.setStyle(-1,2,i),t.uXt(),t.tst(o),n.resumePaint()},_.prototype.oXt=function(){return"<div class = '".concat(at,"'>\n            <div class = '").concat(st,"'>\n                <input class = '").concat(k,"' placeholder=\"").concat(s().search,"\"/>\n                <div class = '").concat(j,"'>\n                    <div class = '").concat(ct,"'></div>\n                </div>\n            </div>\n        </div>")},_.prototype.aXt=function(){var t=tt+" "+nt,i=tt+" "+et,n=it+" "+I,e=it+" "+A;return'<div class="'.concat($,'">\n                    <a class="').concat(n,'">\n                        <span class="').concat(t,'"></span>\n                        <span>').concat(s().PivotPanel_Filter_SelectAll,'</span>\n                    </a>\n                    <a class="').concat(e,'">\n                        <span class="').concat(i,'"></span>\n                        <span>').concat(s().PivotPanel_Filter_NoSelectAll,"</span>\n                    </a>\n                </div>")},_.prototype.if=function(){var t,i,i,n,e,r,o,a,s,c,u,c,l,t=(0,v.GC$)(this.Wc[0]),i=this.qc();0===t.length||(i=(0,v.GC$)(i).offset(),n=parseInt(t.css("left"),10)+i.left,e=parseInt(t.css("top"),10)+i.top,r=t.width(),o=t.height(),isNaN(n))||isNaN(e)||isNaN(r)||isNaN(o)||(s=a=0,u=(c=document.documentElement).clientWidth,c=c.clientHeight,(l=t[0].getBoundingClientRect()).left+r>u&&(s=l.left+r-u),l.top+o>c&&(a=l.top+o-c),(n<0||e<0||0<a||0<s)&&t.css({left:(n=(n-=s)<0?0:n)-i.left+"px",top:(e=(e-=a)<0?0:e)-i.top+"px"}))},t.PivotFilterDialog=_},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(t,i,n){"use strict";var e,s,r,o,c,n,a,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I;function A(t,i,n,e,r,o,a,s,c){var t=I.call(this,t,0,!0)||this;return t.cKt=i,t.rYt=n,t.dh=e,t.T=o||0,t.lKt=r,t.fKt=r===t.T,t.gd=s||0,t.hKt=a,t.vKt=a===t.gd,t.fXt=c,t.uf(),t}e=this&&this.__extends||(N=function(t,i){return(N=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}N(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotNumberGroupDialog=void 0,s=n("Core"),r=n("Common"),o=n("./dist/plugins/pivot/pivot.ns.js"),c=n("Pivot"),n=new r.Common.ResourceManager(o.SR,"PivotTables"),a=n.getResource.bind(n),u=r.Common.zf,l=s.mt.En,f="cancel-icon",h="cancel-class",v="ok-label",d="filter-confirm",p="number-group-startingAt-isActive",m="number-group-startingAt-value",b="number-group-endingAt-isActive",g="number-group-endingAt-value",w="number-group-by-value",y="number-group-dialog-sub-container",I=s.zc,e(A,I),A.prototype.$c=function(){this.pKt(),I.prototype.$c.call(this),this.Eot(),this.Fz()},A.prototype.pKt=function(){var t=(0,s.GC$)(l("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},A.prototype.Fz=function(){var a=this;(0,s.GC$)("."+h).bind("click",function(t){a.lQ()}),(0,s.GC$)("."+v).bind("click",function(t){var i,n,e,r,o,i=a.cKt,n=a.rYt,e=parseInt((0,s.GC$)("."+m).val().trim(),10),r=parseInt((0,s.GC$)("."+g).val().trim(),10),o=parseInt((0,s.GC$)("."+w).val().trim(),10);a.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:c.PivotDataType.number,fieldName:n,pivotName:i,startingAtValue:e,endingAtValue:r,groupByValue:o}}),a.lQ()}),(0,s.GC$)("."+m).bind("change",function(t){(a.fKt=!1,s.GC$)("."+p)[0].checked=!1}),(0,s.GC$)("."+g).bind("change",function(t){(a.vKt=!1,s.GC$)("."+b)[0].checked=!1}),(0,s.GC$)("."+p).bind("click",function(t){this.checked&&(0,s.GC$)("."+m).val(a.lKt)}),(0,s.GC$)("."+b).bind("click",function(t){this.checked&&(0,s.GC$)("."+g).val(a.hKt)})},A.prototype.mKt=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'.concat(a().grouping,'</span>\n                      <span class="').concat(h+" "+f,'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>').concat(a().auto,'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="').concat(y,'">\n                            <input type="checkbox" class="').concat(p,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(a().startingAt,'</span>\n                            <input class="').concat(m,'" value = ').concat(this.T,'></input>\n                        </div>\n                        <div class="').concat(y,'">\n                            <input type="checkbox" class="').concat(b,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(a().endingAt,'</span>\n                            <input class="').concat(g,'" value = ').concat(this.gd,'></input>\n                        </div>\n                        <div class="').concat(y,'">\n                            <span style = "margin-left: 24px">').concat(a().groupBy,'</span>\n                            <input class="').concat(w,'" value= ').concat(this.fXt,'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="').concat(h+" "+d,'">').concat(a().Cancel,'</span>\n                            <span class="').concat(v+" "+d,'">').concat(a().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},A.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},A.prototype.eG=function(){this.dh=null},A.prototype.KX=function(){(0,s.GC$)("."+h).unbind("click"),(0,s.GC$)("."+v).unbind("click")},A.prototype.lQ=function(){this.eG(),this.KX(),I.prototype.close.call(this)},i.PivotNumberGroupDialog=A},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(t,i,n){"use strict";var e,a,s,c,r,n,n,m,b,o,u,g,w,y,C,N,I,A,T,M,l,f,h,v,d;function p(t,i,n,e,r,o){var t,a,i,n,s,o,e,o,t=d.call(this,t,0,!0)||this;if(t.dh=i,t.rYt=n,t.Twt=o,t.Vqt=e,r){if(t.OJt=r.valueFieldName,a=void 0,i=t.dh.B,n=t.dh.R,4===r.menuArea)if(4===r.area){for(s=r.rowInfos&&r.rowInfos.length-1;0<=s;s--)if(r.rowInfos[s].fieldName!==b().sigmaValue){a=r.rowInfos[s];break}}else 3===r.area?(0===(o=r.activeRowFieldInfo&&r.activeRowFieldInfo.index)?o+=1:o===r.rowInfos&&r.rowInfos.length-1?o=r.rowInfos.length-2:o-=1,a=r.rowInfos[o]):2===r.area&&(o=e=void 0,i[0]?(e=i[0]&&i[0].Zc,o=i[0]._items[0].value):n[0]&&(e=n&&n[0].Zc,o=n[0]._items[0].value),a={fieldNameTemp:e,itemNameTemp:o});t.hXt=a.fieldName,t.vXt=a.itemName}return t.uf(),t.$c(),t}e=this&&this.__extends||(v=function(t,i){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(i,"__esModule",{value:!0}),i.PivotShowValueAsDialog=void 0,s=n("Core"),c=n("Pivot"),r=n("Common"),n=n("./dist/plugins/pivot/pivot.ns.js"),n=new r.Common.ResourceManager(n.SR,"PivotTables"),m=r.Common.zf.j0,b=n.getResource.bind(n),o=r.Common.zf,u=s.mt.En,g="show-value-as-dialog-container",w="show-value-as-dialog-header",y="show-value-as-dialog-content",C="cancel-icon",N="cancel-class",I="ok-label",A="filter-confirm",T="show-value-as-dialog-content-item",M="show-value-as-dialog-content-select",l=".baseFieldList",f=".baseFieldItem",d=s.zc,e(p,d),p.prototype.$c=function(){this.pKt(this.Twt,this.OJt,this.dXt()),d.prototype.$c.call(this),this.Eot(),this.Fz()},p.prototype.dXt=function(){return a(a([],this.dh.nw(1),!0),this.dh.nw(2),!0)},p.prototype.getBaseItemList=function(t){return a([],this.dh.Kz(t),!0)},p.prototype.pKt=function(t,i,n){var e=(0,s.GC$)(u("div"));e[0].innerHTML=this.mKt(t,i,n),this.Wc.append(e)},p.prototype.b0=function(t,i,n){var n=n?"selected":"";return'<option value="'.concat(i,'" ').concat(n,">").concat(m(t),"</option>")},p.prototype.Fz=function(){var o=this;(0,s.GC$)("."+N).bind("click",function(t){o.lQ()}),(0,s.GC$)("."+I).bind("click",function(t){var i,n,e,n,r,i=o.dh,n=(0,s.GC$)(l)[0],e=(0,s.GC$)(f)[0],n=n&&n.options[n.selectedIndex].text;e&&(r={index:e.selectedIndex,value:e.options[e.selectedIndex].text}),i.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:o.Twt,pivotName:o.Vqt,fieldName:o.rYt,baseField:n,baseItem:r}}),o.lQ()}),(0,s.GC$)(l).bind("change",function(t){var i,n,e,r;if(!(0,c.ht)((0,s.GC$)(f)[0])){for(i=(0,s.GC$)(this.options[this.selectedIndex]).text(),e="",(n=a([],o.dh.Kz(i),!0))&&0<n.length&&(n.unshift(b().BaseItemNext),n.unshift(b().BaseItemPrevious)),r=0;r<n.length;r++)e+=o.b0(n[r],r);(0,s.GC$)(f)[0].innerHTML=e}})},p.prototype.mKt=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,a,e=[4,8,9],r="",o="",a=this.dh.getFieldInfoByName(this.OJt).Or;for(a&&(c=a.showDataAs,u=a.baseFieldName,l=a.baseFieldItem,f=a.baseFieldItemType),h=t===c&&u||this.hXt,v=0;v<n.length;v++)s=h===n[v].Zc,r+=this.b0(n[v].Zc,v,s);if((d=this.getBaseItemList(h))&&0<d.length)for(d.unshift(b().BaseItemNext),d.unshift(b().BaseItemPrevious),p=this.pXt(d,l,f),v=0;v<d.length;v++)o+=this.b0(d[v],v,p===v);return a=-1<e.indexOf(t)?' <div class="'.concat(T,'">\n                <span>').concat(b().BaseItemForDialog,'</span>\n                <select class="').concat(M,' baseFieldItem">').concat(o,"</select>\n               </div>"):"",'<div class="'.concat(g,'">\n                    <div class="').concat(w,'">\n                        <span>').concat(b().ShowValueAs+"("+m(i)+")",'</span>\n                        <span class="').concat(N+" "+C,'">\xd7</span>\n                    </div>\n                    <div class="').concat(y,'">\n                        <div>\n                            <span>').concat(b().CalculationForDialog,"</span>\n                            <span>").concat(b().showValueAsDialog[t],'</span>\n                        </div>\n\n                        <div class="').concat(T,'">\n                            <span>').concat(b().BaseFieldForDialog,'</span>\n                            <select class="').concat(M,' baseFieldList">').concat(r,"</select>\n                        </div>\n                        ").concat(a,'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="').concat(N+" "+A,'">').concat(b().Cancel,'</span>\n                            <span class="').concat(I+" "+A,'">').concat(b().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},p.prototype.pXt=function(t,i,n){var e,r,o,a,e,r=this.vXt;if(n===c.PivotShowDataAsBaseItemType.previous)return 0;if(n===c.PivotShowDataAsBaseItemType.next)return 1;if(!(o=0,c.ht)(i)||!(0,c.ht)(r))for(a=2;a<t.length;a++){if(i===t[a])return a;t[a]===r&&(o=a)}return o},p.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},p.prototype.eG=function(){this.dh=null},p.prototype.KX=function(){(0,s.GC$)("."+N).unbind("click"),(0,s.GC$)("."+I).unbind("click"),(0,s.GC$)(l).unbind("change")},p.prototype.lQ=function(){this.eG(),this.KX(),d.prototype.close.call(this)},i.PivotShowValueAsDialog=p},"./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js":function(L,t,i){"use strict";var n,h,E,B,R,G,V,U,Q,i,v,f,e,d,W,z,p,m,b,g,w,y,C,N,Z,I,Y,H,J,A,c,q,K,T,M,X,$,tt,S,x,D,u,l,k,j,it,nt,et,O,rt,ot,P,F,_,at,st,ct,ut,lt,ft,ht,vt,dt,pt,mt;function r(t,i,n,e,r){var o=vt.call(this,t,2e3,!0)||this;return o.Ise=function(){(0,h.GC$)(".rangeSelectFocusItem",o.Wc[0]).focus(),window.removeEventListener("mousemove",o.Sse),o.Mse=!1},o.spi=e,o.rYt=n,o.Mf=i,o.hce=r,o.$c(),o.uf(),o}function o(t,i,n,e,r){var t=dt.call(this,t,2e3,!0)||this;return t.cpi=e,t.dh=n,t.Mf=i,t.hce=r,t.LJt=n.z.filter(function(t){return t instanceof Q.PivotTable})[0],t.uf(),t.$c(),t}function a(t,i,n,e,r,o){var t,r,t=pt.call(this,t,2e3,!0)||this;return t.dh=n,t.rYt=e,t.Vqt=r,t.Mf=o,t.Xqt=i,(r=n.getSortInfo(e))&&r.sortValueFieldName?t.upi=r.sortValueFieldName:t.upi=e,t.nrt=r,t.uf(),t.$c(),t}function s(t,i,n,e,r){var t,n,i,r,t=mt.call(this,t,2e3,!0)||this;return t.LJt=n,t.lpi=e,t.Mf=i,t.fpi=!!r,r||(n=e.rowInfos,i=e.colInfos,r=v().sigmaValue,n&&1===n.length&&n[0].fieldName===r&&(t.fpi=!0),i&&1===i.length&&i[0].fieldName===r&&(t.fpi=!0)),t.uf(),t.$c(),t}function bt(t,i){var n,e;t&&0<t.length&&((n=t.some(function(t){return t.isGrandTotal}))||(-1!==(e=t.findIndex(function(t){return t.fieldName===v().sigmaValue}))&&(i.sortValueFieldName=t[e].itemName,t.splice(e,1)),i.sortByPivotReferences=t.map(function(t){return{fieldName:t.fieldName,items:[t.itemName]}})))}function gt(t,i,n){var e,r,n,o,a,t,n=3===t.options.grandTotalPosition||t.options.grandTotalPosition===n,o,a=t.rZt.HWt[4].getRange(),t=t.getRange().content;return n?i?(e=t.row+a.row,r=t.col+a.col+a.colCount-1):(r=t.col+a.col,e=t.row+a.row+a.rowCount-1):(e=t.row+a.row,r=t.col+a.col),{resultRow:e,resultCol:r}}n=this&&this.__extends||(ht=function(t,i){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ht(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.SortValueDialog=t.SortFieldDialog=void 0,h=i("Core"),E=i("Common"),B=i("FormulaTextBox"),R=i("SheetsCalc"),G=i("./dist/plugins/pivot/pivot.ns.js"),V=i("Pivot"),U=i("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),Q=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=new E.Common.ResourceManager(G.SR,"PivotTables"),v=i.getResource.bind(i),f=E.Common.zf.j0,e=null,d=void 0,W=R.formulaToRanges,z=R.rangeToFormula,p="label-title",m="cancel-icon",b="cancel-class",g="label-show",w="split-line",y="ok-label",C="filter-confirm",N="confirm-class",Z="gc-pivot-sort-dialog-container",I="gc-sort-dialog-title",Y="gc-sort-dialog-body",H="gc-sort-more-options",J="gc-sort-close-dialog",A="gc-sort-summary",c="gc-sort-select",q="gc-sort-range-select",K="gc-sort-range-selector",T="gc-sort-range-input",M="gc-sort-disabled",X="gc-sort-range-select-button",$="gc-sort-range-select-container",tt="gc-sort-range-select-body",S="gc-pivot-sort-option",x="gc-pivot-sort-options-asc",D="gc-pivot-sort-options-desc",u="gc-pivot-sort-label-asc",l="gc-pivot-sort-label-desc",k="gc-pivot-sort-by-total",j="gc-pivot-sort-by-value",it="gc-pivot-sort-value-dialog-container",nt="gc-sort-value-dialog-body",et="gc-pivot-sort-half-split-area",O="gc-pivot-sort-direction-top-to-bottom",rt="gc-pivot-sort-direction-left-to-right",ot="gc-pivot-sort-direction",P="{{FIELD_NAME}}",F="{{SELECTED_FIELD_NAME}}",_="{{ORDER}}",at="{{ROW_COLUMN}}",st="{{AREA}}",vt=h.Ase,n(r,vt),r.prototype.$c=function(){var t=this;t.Wc.html(this.tKt()),vt.prototype.$c.call(this),t.lgi(),t.Eot(),t.aY()},r.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(t-n)/2+"px"])},r.prototype.lQ=function(){this.KX(),this.eG(),vt.prototype.close.call(this),this.hpi()},r.prototype.eG=function(){var t;this.vpi&&(this.vpi.endSelectMode(),this.vpi.workbook(e),this.vpi=e,this.Mf.parent.setActiveSheetIndex(this.dpi)),this.dpi=e,this.Ti=e,this.Mf=e},r.prototype.tKt=function(){var t,i,t,i=f(this.rYt);return'\n            <div class="'.concat($,'">\n                <div class="').concat(I,'">\n                    <span class="').concat(p,'">').concat(v().Sort_Field_Dialog_Title+" ("+i+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(tt,'">\n                    <div class="').concat(N,'">\n                        <div class=').concat(K,"></div>\n                    </div>\n                </div>\n            </div>")},r.prototype.aY=function(){var i=this;(0,h.GC$)("."+b,i.Wc[0]).bind("click",function(t){i.lQ()}),i.bindMoveEvent((0,h.GC$)("."+I,i.Wc[0])[0])},r.prototype.KX=function(){var t=this;(0,h.GC$)("."+b,t.Wc[0]).unbind("click"),t.Mf.parent.unbind("RangeSelectEnding",t.ppi),window.removeEventListener("keydown",t.mpi,!0)},r.prototype.bpi=function(t){var i,n;return 1<t.length&&"="===(i=t.slice(0,1))&&(n=t.slice(1,t.length),isFinite(n))?n:t},r.prototype.mpi=function(t){"Enter"!==t.key&&"Escape"!==t.key||(this.spi=this.bpi(this.vpi.text()),this.lQ())},r.prototype.ppi=function(){this.spi=this.bpi(this.vpi.text()),this.lQ()},r.prototype.lgi=function(){var t,i,n,t=this,i=t.Mf.parent;t.dpi=i.getActiveSheetIndex(),n=(0,h.GC$)("."+K)[0],t.vpi=new B.FormulaTextBox(n,{rangeSelectMode:!0,absoluteReference:!0,needSheetName:!0},i),t.ppi=t.ppi.bind(t),i.bind("RangeSelectEnding",t,t.ppi),t.mpi=t.mpi.bind(t),window.addEventListener("keydown",t.mpi,!0),t.vpi.workbook(i),t.vpi.startSelectMode(t.spi),(0,h.GC$)("div[gcuielement$='gcAttachedFormulaTextBox']",n)[0].classList.add("rangeSelectFocusItem")},r.prototype.hpi=function(){var t=this;t.hce(t.spi)},ct=r,dt=U.opi,n(o,dt),o.prototype.$c=function(){var t=this;dt.prototype.$c.call(this),t.gpi(),t.wpi()},o.prototype.eG=function(){this.cpi=d,this.dh=d,this.LJt=d,this.spi=d,this.Mf=e,this.nrt=d,this.Ti=e},o.prototype.tKt=function(){var t,i,n,e,r,o,a,t,s,r,s,n,t=this,i=v(),n=t.cpi,e=f(n.fieldName),r=t.dh,o,a=1===r.Z[e]?i.Sort_In_Column:i.Sort_In_Row,t=t.spi||"",s=n.selectedFieldName,r=3===r.Z[s],s=n.sortInfo,n=!0;return s&&s.sortValueFieldName&&s.sortByPivotReferences&&(n=!1),'\n            <div class="'.concat(Z,'">\n                <div class="').concat(I,'">\n                    <span class="').concat(p,'">').concat(i.Sort_Field_Dialog_Title+" ("+e+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(Y,'">\n                    <div class="').concat(N,'">\n                        <span class="').concat(g,'">').concat(i.Sort_Field_More_Dialog_Sort_By,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(N,'">\n                        <div class="').concat(r?"":M,'">\n                            <input type="radio" id="').concat(k,'" ').concat(n?"checked":"",' name="gc-pivot-sort-by">\n                            <label for="').concat(k,'">').concat(i.GrandTotal,'</label>\n                        </div>\n                        <div class="').concat(r?"":M,'">\n                            <input type="radio" id="').concat(j,'" ').concat(n?"":"checked",' name="gc-pivot-sort-by">\n                            <label for="').concat(j,'">').concat(i.Sort_Field_More_Dialog_Values_In_Selected_Area.replace(st,a),'</label>\n                        </div>\n                        <div class="').concat(q+(r&&!n?"":" "+M),'">\n                            <input class="').concat(T,'" value="').concat(t,'">\n                            <div class="').concat(X,'">\n                                <span></span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(N,'">\n                        <span class="').concat(g,'">').concat(i.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(N,'">\n                        <div class="').concat(A,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(b+" "+C,'">').concat(i.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(i.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},o.prototype.aY=function(){var n,e,n=this,e=n.Wc[0];(0,h.GC$)("."+b,e).bind("click",function(t){n.hpi(!1),n.lQ()}),(0,h.GC$)("."+y,e).bind("click",function(t){n.hpi(!0),n.lQ()}),(0,h.GC$)("."+X,e).bind("click",function(t){n.api(!1),new ct(n.qc(),n.Mf,n.cpi.fieldName,n.spi,function(t){n.spi=t,(0,h.GC$)("."+T)[0].value=t,n.api(!0),n.wpi()})}),(0,h.GC$)("#"+j,e).bind("change",function(t){var t,i,t=t.target.checked,i=(0,h.GC$)("."+q,e);t&&i.hasClass(M)&&i.removeClass(M),n.wpi()}),(0,h.GC$)("#"+k,e).bind("change",function(t){var t,i,t=t.target.checked,i=(0,h.GC$)("."+q,e);t&&!i.hasClass(M)&&i.addClass(M),n.wpi()}),(0,h.GC$)("."+T,e).bind("change",function(t){n.spi=t.target.value,n.wpi()}),n.bindMoveEvent((0,h.GC$)("."+I,n.Wc[0])[0])},o.prototype.KX=function(){var t=this.Wc[0];(0,h.GC$)("."+b,t).unbind("click"),(0,h.GC$)("."+y,t).unbind("click"),(0,h.GC$)("."+X,t).unbind("click"),(0,h.GC$)("#"+j,t).unbind("change"),(0,h.GC$)("#"+k,t).unbind("change"),(0,h.GC$)("."+T,t).unbind("change")},o.prototype.gpi=function(){var t,i,n,e,r,i,o,a,s,r,c,u,a,l,a,u,l,a,i,f,i,f,u,i,f,t=this,i=t.cpi,n=t.LJt,e=t.dh,r=i.fieldName,i=i.sortInfo,s=1===e.Z[r],r=e.Z[r],a=i&&i.sortValueFieldName&&i.sortByPivotReferences&&(u=(c=n.rZt.HWt[4]).getRange(),l=(a=n.getRange().content).row+u.row,a=a.col+u.col,u=n.getPivotInfo(l,a),l={},a=i.sortByPivotReferences.map(function(t){return{fieldName:e.getFieldNameBySourceName(t.fieldName),items:t.items}}),s?(f={fieldName:(i=u.rowInfos[0]).fieldName,items:[i.itemName]},i.isSubtotal&&(f.subtotal=!0),l.references=[f].concat(a)):(f={fieldName:(i=u.colInfos[0]).fieldName,items:[i.itemName]},i.isSubtotal&&(f.subtotal=!0),l.references=a.concat(f)),u=n.getPivotAreaRanges(l)[0])?(o=u.row,u.col):(o=(i=gt(n,s,r)).resultRow,i.resultCol),f=z(new h.Range(o,a,1,1),d,d,d);(0,h.GC$)("."+T,t.Wc[0]).val(f),t.spi=f},o.prototype.ypi=function(){var t,i,n,e,r,o,i,r,i,a,i,a,i,s,t=this,i=t.cpi,n=t.dh,e=t.Mf,r=i.isAsc,o=i.fieldName,i=i.selectedFieldName,r={sortType:r?0:1};if(o!==i&&(r.sortValueFieldName=i),!(0,h.GC$)("#"+k,t.Wc[0])[0].checked){if(!t.spi)return!1;if(0===(i=W(e,t.spi)).length||0<i.filter(function(t){return t.sheetName!==e.name()}).length)return!1;if(a=t.LJt,i=i[0].ranges[0],!(a=a.getPivotInfo(i.row,i.col))||4!==a.area)return!1;1===(i=n.Z[o])&&(s=a.colInfos),bt(s=2===i?a.rowInfos:s,r),t.nrt=r}return r},o.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];(0,h.GC$)("."+A,i)[0].innerText=t.Cpi()},o.prototype.Cpi=function(){var t,i,n,e,t,r,o,a,e,s,t,c,u,l,f,t=this,i=v(),n=t.ypi();if(!n)return t.nrt=d,i.Invalid_Sort_Range;if(e=t.dh,r=(t=t.cpi).fieldName,o=(null==n?void 0:n.sortValueFieldName)||t.selectedFieldName||r,a=e.Z[r],e=e.Z[o],s=t.isAsc,t=t.isDesc,!s&&!t)return i.Custom_Sort_Summary;if(r===o)return i.Sort_Summary_Pattern.replace(P,r).replace(_,s?i.Sort_Order_ASC:i.Sort_Order_DESC);if(c=i.Sort_Value_Summary_Pattern.replace(P,r).replace(F,o).replace(_,s?i.Sort_Order_ASC:i.Sort_Order_DESC),3===e)if(n&&n.sortValueFieldName&&n.sortByPivotReferences&&0<n.sortByPivotReferences.length)for(u=n.sortByPivotReferences,c=i.Sort_More_Summary_Pattern.replace(P,r).replace(F,o).replace(_,s?i.Sort_Order_ASC:i.Sort_Order_DESC).replace(at,1===a?i.Sort_In_Column:i.Sort_In_Row),l=0;l<u.length;l++)c+=(f=u[l]).items[0],l!==u.length-1&&(c+=":");else(0,h.GC$)("#"+j)[0].checked&&(c=i.Sort_More_Summary_Pattern.replace(P,r).replace(F,o).replace(_,s?i.Sort_Order_ASC:i.Sort_Order_DESC).replace(at,1===a?i.Sort_In_Column:i.Sort_In_Row),c+=i.GrandTotal);return c},o.prototype.hpi=function(t){var i,n,i=this,n=(0,h.GC$)("."+A,i.Wc[0])[0].innerText;t?(i.ypi(),i.hce(n,i.nrt)):i.hce(n)},ut=o,pt=U.opi,n(a,pt),a.prototype.$c=function(){var t=this;pt.prototype.$c.call(this),t.wpi()},a.prototype.eG=function(){this.dh=e,this.rYt=d,this.Vqt=d,this.upi=d,this.Xqt=d,this.nrt=d,this.Ti=e,this.Mf=e},a.prototype.Ipi=function(t){var i="";return t===this.upi&&(i="selected"),'<option value="'.concat(t,'" ').concat(i,">").concat(t,"</option>")},a.prototype.tKt=function(){for(var t,i,n,e,r,o,a,o,s,t=this,i=f(t.rYt),n="",e=0;e<t.Xqt.length;e++)n+=t.Ipi(t.Xqt[e]);return a=(o=(r=t.dh).getSortInfo(t.rYt))&&0===o.sortType,o=o&&1===o.sortType,a||o||(a=!0),s=v(),'\n            <div class="'.concat(Z,'">\n                <div class="').concat(I,'">\n                    <span class="').concat(p,'">').concat(s.Sort_Field_Dialog_Title+" ("+i+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(Y,'">\n                    <div class="').concat(N,'">\n                        <span class="').concat(g,'">').concat(s.Sort_Field_Dialog_Sort_Options,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(N,'">\n                        <div>\n                            <input type="radio" id="').concat(x,'" ').concat(a?"checked":"",' name="').concat(S,'">\n                            <label for="').concat(x,'">').concat(s.Sort_Field_Dialog_Ascending_Sort,'</label>\n                            <select id="').concat(u,'" class="').concat(c+(a?"":" "+M),'">').concat(n,'</select>\n                        </div>\n                        <div>\n                            <input type="radio" id="').concat(D,'" ').concat(o?"checked":"",' name="').concat(S,'">\n                            <label for="').concat(D,'">').concat(s.Sort_Field_Dialog_Descending_Sort,'</label>\n                            <select id="').concat(l,'" class="').concat(c+(o?"":" "+M),'">').concat(n,'</select>\n                        </div>\n                    </div>\n                    <div class="').concat(N,'">\n                        <span class="').concat(g,'">').concat(s.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(N,'">\n                        <div class="').concat(A,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(H+" "+C,'">').concat(s.Sort_Field_Dialog_More_Options,'</span>\n                        <span class= "').concat(b+" "+C,'">').concat(s.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(s.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},a.prototype.aY=function(){var e,r,e=this,r=this.Wc[0];(0,h.GC$)("."+c,r).bind("change",function(t){e.nrt&&(e.nrt=d),e.upi=t.target.value,e.wpi()}),(0,h.GC$)("#"+x,r).bind("change",function(t){var t,i,n,t=t.target.checked,i=(0,h.GC$)("#"+l,r),n=(0,h.GC$)("#"+u,r);t&&(n.hasClass(M)&&n.removeClass(M),i.hasClass(M)||i.addClass(M),e.nrt&&(e.nrt=d),e.upi=(0,h.GC$)("#"+u,r).val(),e.wpi())}),(0,h.GC$)("#"+D,r).bind("change",function(t){var t,i,n,t=t.target.checked,i=(0,h.GC$)("#"+l,r),n=(0,h.GC$)("#"+u,r);t&&(i.hasClass(M)&&i.removeClass(M),n.hasClass(M)||n.addClass(M),e.nrt&&(e.nrt=d),e.upi=(0,h.GC$)("#"+l,r).val(),e.wpi())}),(0,h.GC$)("."+H,r).bind("click",function(t){var i=!!(0,h.GC$)("#"+x,r)[0].checked,n=!!(0,h.GC$)("#"+D,r)[0].checked;e.api(!1),new ut(e.qc(),e.Mf,e.dh,{isAsc:i,isDesc:n,fieldName:e.rYt,pivotName:e.Vqt,selectedFieldName:e.upi,sortInfo:e.nrt},function(t,i){i&&(e.nrt=i),e.api(!0),e.Npi=t,(0,h.GC$)("."+A,r)[0].innerText=t})}),(0,h.GC$)("."+b,r).bind("click",function(t){e.lQ()}),(0,h.GC$)("."+y,r).bind("click",function(t){e.hpi(),e.lQ()}),e.bindMoveEvent((0,h.GC$)("."+I,e.Wc[0])[0])},a.prototype.KX=function(){var t=this.Wc[0];(0,h.GC$)("."+c,t).unbind("change"),(0,h.GC$)("#"+x,t).unbind("change"),(0,h.GC$)("#"+D,t).unbind("change"),(0,h.GC$)("."+H,t).unbind("click"),(0,h.GC$)("."+b,t).unbind("click"),(0,h.GC$)("."+y,t).unbind("click")},a.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];t.Npi=t.Cpi(),(0,h.GC$)("."+A,i)[0].innerText=t.Npi},a.prototype.Cpi=function(){var t,i,n,e,r,i,o,a,s,c,a,u,l,f,t=this,i=t.dh,n=t.rYt,e=t.upi||n,r=i.Z[n],i=i.Z[e],o=!(0,h.GC$)("#"+x).length||(0,h.GC$)("#"+x)[0].checked,a=!!(0,h.GC$)("#"+D).length&&(0,h.GC$)("#"+D)[0].checked,s=v();if(!o&&!a)return s.Custom_Sort_Summary;if(n===e)return s.Sort_Summary_Pattern.replace(P,n).replace(_,o?s.Sort_Order_ASC:s.Sort_Order_DESC);if(c=s.Sort_Value_Summary_Pattern.replace(P,n).replace(F,e).replace(_,o?s.Sort_Order_ASC:s.Sort_Order_DESC),u=null==(a=t.nrt)?void 0:a.sortByPivotReferences,3===i&&u&&0<u.length)for(c=s.Sort_More_Summary_Pattern.replace(P,n).replace(F,e).replace(_,o?s.Sort_Order_ASC:s.Sort_Order_DESC).replace(at,1===r?s.Sort_In_Column:s.Sort_In_Row),l=0;l<u.length;l++)c+=(f=u[l]).items[0],l!==u.length-1&&(c+=":");return c},a.prototype.hpi=function(){var t,i,n,e,r,o,a,s,c,c,a,a,o,t=this,i=t.dh,n=t.rYt,e=t.Vqt,r=t.nrt,o=t.Wc[0],a=v();if(t.Npi===a.Invalid_Sort_Range)(c=(s=i.z.filter(function(t){return t.Zc===e})[0]).Ti)&&c.jT(10,a.Invalid_Sort_Range);else{if(!r){if(c=!!(0,h.GC$)("#"+x,o)[0].checked,a=!!(0,h.GC$)("#"+D,o)[0].checked,!c&&!a)return;o=c?0:1,r=n===(a=t.upi)?{sortType:o}:{sortType:o,sortValueFieldName:a}}i.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:r,fieldName:n,pivotName:e}})}},t.SortFieldDialog=a,mt=U.opi,n(s,mt),s.prototype.$c=function(){var t=this;mt.prototype.$c.call(this),t.wpi()},s.prototype.eG=function(){this.LJt=d,this.lpi=d,this.Ti=e,this.Mf=e},s.prototype.tKt=function(){var t,i,n,e,r,o,a,s,c,u,i,c,i,u,c,u,u,a,s,r,l,o,t=this,i=t.LJt,n=t.lpi,e=v(),r=n.rowInfos,o=n.colInfos,a=r&&r.length,s=o&&o.length,c=f(r&&r[a-1]&&r[a-1].fieldName),u=f(o&&o[s-1]&&o[s-1].fieldName),i=i.dh,c=i.getSortInfo(c),i=i.getSortInfo(u),u=c||i,c=u&&0===u.sortType,u=u&&1===u.sortType;if(c||u||(c=!0),u=0===a||r&&0<r.filter(function(t){return t.isGrandTotal}).length,a=0===s||o&&0<o.filter(function(t){return t.isGrandTotal}).length,s=(r=t.fpi)?l=!!n.cornerFieldInfo:!(u||!a&&i),u&&a||!n.valueFieldName&&!r)throw new Error(e.Invalid_Field_Sort_By);return o=u||a||r,'\n            <div class="'.concat(it,'">\n                <div class="').concat(I,'">\n                    <span class="').concat(p,'">').concat(e.Sort_Value_Dialog_Title,'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(nt,'">\n                    <div class="').concat(N,'">\n                        <div class="').concat(N+" "+et,'">\n                            <div class="').concat(N,'">\n                                <span class="').concat(g,'">').concat(e.Sort_Field_Dialog_Sort_Options,'</span>\n                                <span class="').concat(w,'"></span>\n                            </div>\n                            <div class="').concat(N,'">\n                                <div>\n                                    <input type="radio" id="').concat(x,'" ').concat(c?"checked":"",' name="').concat(S,'">\n                                    <label for="').concat(x,'">').concat(e.Sort_Value_Dialog_Asc,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat(D,'" ').concat(c?"":"checked",' name="').concat(S,'">\n                                    <label for="').concat(D,'">').concat(e.Sort_Value_Dialog_Desc,'</label>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="').concat(N+" "+et+(o?" "+M:""),'">\n                            <div class="').concat(N,'">\n                                <span class="').concat(g,'">').concat(e.Sort_Value_Dialog_Sort_Direction,'</span>\n                                <span class="').concat(w,'"></span>\n                            </div>\n                            <div class="').concat(N,'">\n                                <div>\n                                    <input type="radio" id="').concat(O,'" ').concat(s?"checked":"",' name="').concat(ot,'">\n                                    <label for="').concat(O,'">').concat(e.Sort_Value_Dialog_Top_To_Bottom,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat(rt,'" ').concat(s?"":"checked",' name="').concat(ot,'">\n                                    <label for="').concat(rt,'">').concat(e.Sort_Value_Dialog_Left_To_Right,'</label>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(N,'">\n                        <span class="').concat(g,'">').concat(e.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(N,'">\n                        <div class="').concat(A,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(b+" "+C,'">').concat(e.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(e.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},s.prototype.aY=function(){var n,i,n=this,i=this.Wc[0];[x,D,O,rt].forEach(function(t){(0,h.GC$)("#"+t,i).bind("change",function(t){var i;t.target.checked&&n.wpi()})}),(0,h.GC$)("."+b,i).bind("click",function(t){n.lQ()}),(0,h.GC$)("."+y,i).bind("click",function(t){n.hpi(),n.lQ()}),n.bindMoveEvent((0,h.GC$)("."+I,n.Wc[0])[0])},s.prototype.KX=function(){var i=this.Wc[0];[x,D,O,rt].forEach(function(t){(0,h.GC$)("#"+t,i).unbind("change")}),(0,h.GC$)("."+b,i).unbind("click"),(0,h.GC$)("."+y,i).unbind("click")},s.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];(0,h.GC$)("."+A,i)[0].innerText=t.Cpi()},s.prototype.Cpi=function(){var t,i,n,i,e,r,o,r,a,t,n,s,i,c,r,n,u,l,f,t=this,i=t.LJt,n=t.lpi,i=i.dh,e=n.valueFieldName,r=t.Wc[0],o=(0,h.GC$)("#"+x,r)[0].checked,r=(0,h.GC$)("#"+O,r)[0].checked,a=v();if(t.fpi)return a.Sort_Summary_Pattern.replace(P,a.Values).replace(_,o?a.Sort_Order_ASC:a.Sort_Order_DESC);if(t=n.rowInfos,n=n.colInfos,s=(r?t[t.length-1]:n[n.length-1]).fieldName,i=i.Z[s],!t||0===t.length||!n||0===n.length)return a.Sort_Value_Summary_Pattern.replace(P,s).replace(F,e).replace(_,o?a.Sort_Order_ASC:a.Sort_Order_DESC);if((r=(c=r?n:t)&&0<c.length)&&-1!==(n=c.findIndex(function(t){return t.fieldName===a.sigmaValue}))&&(e=c[n].itemName,c.splice(n,1)),u=a.Sort_More_Summary_Pattern.replace(P,s).replace(F,e).replace(_,o?a.Sort_Order_ASC:a.Sort_Order_DESC).replace(at,1===i?a.Sort_In_Column:a.Sort_In_Row),r)for(l=0;l<c.length;l++){if((f=c[l]).isGrandTotal){u+=a.GrandTotal;break}u+=f.itemName,l!==c.length-1&&(u+=":")}return u},s.prototype.ypi=function(){var t,i,t,n,t,e,r,n,o,i,a,t=this,i=t.lpi,t=t.Wc[0],n=!!(0,h.GC$)("#"+x,t)[0].checked,t=(0,h.GC$)("#"+O,t)[0].checked,e,r,n={sortType:n?0:1,sortValueFieldName:i.valueFieldName},o=i.rowInfos,i=i.colInfos,a;return bt(t?i:o,n),n},s.prototype.hpi=function(){var t,i,n,e,i,r,t,t,o,n,t,t=this,i=t.LJt,n=t.lpi,e=i.dh,i=i.Zc;t.fpi?t.Api():(r=t.ypi())&&(t=t.Wc[0],t=(0,h.GC$)("#"+O,t)[0].checked,o=n.rowInfos,n=n.colInfos,t=(t?o[o.length-1]:n[n.length-1]).fieldName,e.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:r,fieldName:t,pivotName:i}}))},s.prototype.Api=function(){var t,i,n,i,t,e,t,t=this,i=t.LJt,n=i.dh,i=i.Zc,t=t.Wc[0],e=!!(0,h.GC$)("#"+D,t)[0].checked,t=n.Q.map(function(t){return t.Zc});t.sort(function(t,i){var t=t.localeCompare(i);return e?-1*t:t}),n.wVt({cmd:"sortPivotValueField",sheetName:"",cmdOption:{sortedFieldNames:t,pivotName:i,sortType:e?V.SortType.desc:V.SortType.asc}})},t.SortValueDialog=s},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(t,i,n){"use strict";var e,s,r,n,o,a,c,u,l,f,h;function v(t,i,n){var t=h.call(this,t,0)||this;return t.views=i,t.currentViewName="",t.width=n,t}e=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotViewListDialog=void 0,s=n("Core"),r=n("Pivot"),n=n("Common"),o="gc-panel-button-delete",a="gc-panel-view-name",c="gc-panel-selected-view",u=n.Common.zf.j0,h=s.zc,e(v,h),v.prototype.init=function(t){h.prototype.Hc.call(this),this.open(t)},v.prototype.open=function(t){var i,n,n,e,i="<ul>";(0,r.o)(this.views.all(),function(t){i+='<li>\n                        <span class="'.concat(a,'">').concat(u(t.name),'</span>\n                        <input type="button" class="gc-panel-button ').concat(o,'" value="\xd7"/>\n                    </li>')}),i+="</ul>",n=this.width||250,n='\n                <div class="gc-panel-viewList" style="width: '.concat(n,'px"">\n                    ').concat(i,"\n                </div>\n                "),(e=this.WX(t.x,t.y)).html(n),this.$c(),this.aY()},v.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n},v.prototype.$c=function(){h.prototype.$c.call(this)},v.prototype.close=function(){this.KX(),this.eG(),h.prototype.close.call(this)},v.prototype.eG=function(){this.Ti=null,this.views=null},v.prototype.if=function(){var t,i,n,e,r,o,a,t,t=(0,s.GC$)(this.Wc.get(0).firstElementChild),i=(0,s.GC$)(this.Wc);0!==t.length&&(n=t.width(),e=parseInt(i.css("left"),10),!isNaN(e))&&!isNaN(n)&&(r=0,a=(o=document.documentElement).clientWidth,(t=t[0].getBoundingClientRect()).left+n>a&&(r=t.left+n-a),e<0||0<r)&&i.css({left:(e=(e-=r)<0?0:e)+"px"})},v.prototype.aY=function(){var n=this;(0,s.GC$)("."+o).bind("click",function(t){var i,t,i=t.target.previousElementSibling.textContent,t=t.target.parentElement;n.views.remove(i),t.remove()}),(0,s.GC$)("."+a).bind("click",function(t){var t=t.target.textContent;(0,s.GC$)("#"+c).val(t),n.close()})},v.prototype.KX=function(){(0,s.GC$)("."+o).unbind("click"),(0,s.GC$)("."+a).unbind("click")},i.PivotViewListDialog=v},"./dist/plugins/pivot/pivot-util.js":function(t,r,i){"use strict";var n,a,e,o,s,c,u,l,f,h,v,i,d,p,m;function b(t,i,n){var t=t[i];return t&&0<t.length?t[n]:n}function g(t){var i,n,e,r,i=Array.isArray(t),n="[object Object]"===Object.prototype.toString.call(t);if(i){for(e=[],r=0;r<t.length;r++)e[r]=g(t[r]);return e}if(n){for(r in e=void 0,t)l(t[r])||((e=void 0===e?{}:e)[r]=g(t[r]));return e}return t}function w(t){return l(t)||""===t}function y(t,i,n){var e,r,e={_ps:{}};for(r in t)v(t,r)&&(N(e,r,i,n),e[r]=t[r]);return e}function C(t,i){t.forEach(function(t){i===o.SubtotalsPosition.top?t.Spi=!0:i===o.SubtotalsPosition.bottom?t.Spi=!1:delete t.Spi})}function N(t,r,o,a){Object.defineProperty(t,r,{get:function(){var t,i;return"calcItemAggregation"===r?(i=(t=o.dh).lw(),this._ps[r]=i=i?0:1):this._ps[r]},set:function(t){var i,n,e,n,i=this._ps[r],n=o.dh;i!==t?(o.DT({pivotTable:this,pn:r,old:i,value:t,type:"options"}),this._ps[r]=t,"calcItemAggregation"===r&&n.lw(t),"subTotalsPosition"===r&&(this._ps[e="subtotalsPosition"]=t,n.Dpi=t,C(n.B,t)),"subtotalsPosition"===r&&(this._ps[e="subTotalsPosition"]=t,n.Dpi=t,C(n.B,t))):"subTotalsPosition"!==r&&"subtotalsPosition"!==r||(n.Dpi=t,C(n.B,t)),"missingCaption"!==r||l(t)||"TRUE"!==(n=(t+"").toUpperCase())&&"FALSE"!==n||(this._ps.missingCaption="'"+t),"allowMultipleFiltersPerField"===r&&(!0==!!i&&!1==!!t&&o.Gqt(),o.dh)&&o.dh.DVt(!!t),"printDrill"!==r&&"itemPrintTitles"!==r&&"fieldPrintTitles"!==r&&"function"==typeof a&&a()},enumerable:!0})}function I(t,i){var n,e,n=t.split(r.nameSeparator);return isNaN(parseInt(n[n.length-1],10))?t+=r.nameSeparator+"1":(e=n[n.length-1],n.splice(n.length-1,1,r.nameSeparator+(parseInt(e,10)+1)),t=n.join("")),t=i.BQt[t]?I(t,i):t}function A(t,i){var n,e,r,o,a,s,a,s,a,c,n=[];if(i)for(e=t.pivotTables.all(),r=0;r<e.length;r++)s=(a=(o=e[r]).getRange()).page,a=a.content,s=s?s.union(a):a,a=-1===i.row?s.row:s.row-i.row,c=-1===i.col?s.col:s.col-i.col,i.containsRange(s)&&n.push({name:o.Zc,sheetName:t.name(),startPoint:[a,c]});return n}function T(t,o){var t,a,t=t.pivotTables.all(),a=[];return(0,s.o)(t,function(t){var i,n,i,e,r;!t.Oy()&&(n=(i=t.getRange()).page,i=i.content,n&&(e=n.intersect(o.row,o.col,o.rowCount,o.colCount))&&(a[t.Zc]?a[t.Zc].push(o.getIntersect(n,0,0)):a[t.Zc]=[o.getIntersect(n,0,0)]),r=i.intersect(o.row,o.col,o.rowCount,o.colCount))&&(a[t.Zc]?a[t.Zc].push(o.getIntersect(i,0,0)):a[t.Zc]=[o.getIntersect(i,0,0)])}),a}function M(t){return-1<[s.PivotShowDataAs.percentOfTotal,s.PivotShowDataAs.percentOfRow,s.PivotShowDataAs.percentOfCol,s.PivotShowDataAs.percent,s.PivotShowDataAs.percentOfParentRow,s.PivotShowDataAs.percentOfParentCol,s.PivotShowDataAs.percentOfParent,s.PivotShowDataAs.percentDiff,s.PivotShowDataAs.percentOfRunningTotal].indexOf(t)}function S(t){for(var i,n,e,i=0,n=u;i<n.length;i++)if(!l(t[e=n[i]]))return!1;return!0}function x(t,i){if(l(t)||l(i)||""===i||!t[i])return i;for(var n=2;t[i+n];)n++;return i+n}function D(t){var i=f.Fe(f.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),h.Pe(t,n)}function k(t){return(0,c.Cmt)(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}function j(t){var i,n,i=t.type;if(!l(i))return(n={}).type=i&&"null"!==i?i:"null",l(t.value)||(n.val=t.value),l(t.maxValue)||(n.maxVal=t.maxValue),n}function O(t,i){return l(i)?t:t===o.SubtotalsPosition.top&&i||t===o.SubtotalsPosition.bottom&&i?o.SubtotalsPosition.top:t===o.SubtotalsPosition.bottom&&!i||t===o.SubtotalsPosition.top&&!i?o.SubtotalsPosition.bottom:t===o.SubtotalsPosition.none?o.SubtotalsPosition.none:void 0}Object.defineProperty(r,"__esModule",{value:!0}),r.iJt=r.$Yt=r.fJt=r.RF=r.kWt=r.b0=r.FZt=r.getActualSubtotalPosition=r.writePivotDynamicFilter=r.PivotComparisonOperators=r.getSheetNameForFormula=r.formatDateToString=r.R$=r.applyShowDataAsStyle=r.dz=r.cZt=r.nameSeparator=r.updateRowFieldsIsShowSubtotalTop=r.GC_EMPTY_VALUE=void 0,n=i("Common"),a=i("Core"),e=i("./dist/plugins/pivot/pivot.ns.js"),o=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),s=i("Pivot"),c=i("@grapecity/js-calc"),u=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],l=n.Common.lt.ht,f=n.Common.CultureManager,h=n.Common.ct,v=n.Common.kh,i=new n.Common.ResourceManager(e.SR,"PivotTables"),d=i.getResource.bind(i),r.GC_EMPTY_VALUE="gc-empty-value",r.FZt=b,r.RF=g,r.kWt=w,r.b0=y,r.updateRowFieldsIsShowSubtotalTop=C,r.nameSeparator="_",r.fJt=I,r.$Yt=A,r.iJt=T,r.cZt=S,r.dz=x,r.applyShowDataAsStyle=p=function(t,i,n,e){var r,i,o,i={dataOnly:!0,references:[{fieldName:d().Values,items:[i]}]},o=t.getStyle(i),r=(r=o?g(o):r)||new a.Style;e?r.formatter=e:M(n)?r.formatter="0.00%":(delete r.formatter,S(r)&&(r=null)),t.setStyle(i,r)},r.R$=m=function(t,i,n){var e,i,r,i={dataOnly:!0,references:[{fieldName:d().Values,items:[i]}]},r=t.getStyle(i);(e=r?g(r):e)&&"0.00%"===e.formatter&&M(n)&&(delete e.formatter,t.setStyle(i,e))},r.formatDateToString=D,r.getSheetNameForFormula=k,r.PivotComparisonOperators={"-1":"none",0:"equal",4:"lessThan",3:"lessThanOrEqual",1:"notEqual",2:"greaterThan",5:"greaterThanOrEqual"},r.writePivotDynamicFilter=j,r.getActualSubtotalPosition=O},"./dist/plugins/pivot/pivot.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/pivot/pivot.res.en.js");i.SR={en:n}},"./dist/plugins/pivot/pivot.res.en.js":function(t,i){"use strict";function n(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabel_IsBeginWith,i.ValueFilterOrLabel_NotBegin,i.ValueFilterOrLabel_End,i.ValueFilterOrLabel_NotEndWith,i.ValueFilterOrLabel_Contain,i.ValueFilterOrLabel_NotContain,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}function e(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.IsBefore,i.IsBeforeOrEqual,i.IsAfter,i.IsAfterOrEqual,i.IsBetween,i.IsNotBetween]}function r(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotPanel_ValueFilterOrLabel_NotEqual=i.PivotPanel_ValueFilterOrLabel_Equals=i.PivotPanel_LabelOrValue_ClearFilter=i.PivotPanel_Fields_MoveTo_Value=i.PivotPanel_Fields_MoveTo_ColLabel=i.PivotPanel_Fields_MoveTo_RowLabel=i.PivotPanel_Fields_MoveTo_ReportField=i.PivotPanel_DropDownList_ValueSet=i.PivotPanel_DropDownList_Set=i.PivotPanel_DropDownList_Remove=i.PivotPanel_DropDownList_Values=i.PivotPanel_DropDownList_Col=i.PivotPanel_DropDownList_Row=i.PivotPanel_DropDownList_ReportFilter=i.PivotPanel_DropDownList_End=i.PivotPanel_DropDownList_Beginning=i.PivotPanel_DropDownList_Down=i.PivotPanel_DropDownList_Up=i.PivotPanel_Update=i.EmptyPivotTable_PromptMessage2=i.EmptyPivotTable_PromptMessage1=i.PivotPanel_DeferUpdateText=i.PivotPanel_ValuesItemsTitle=i.PivotPanel_ColumnsItemsTitle=i.PivotPanel_RowsItemsTitle=i.PivotPanel_FiltersItemsTitle=i.PivotPanel_FieldAreaText=i.PivotPanel_SearchPlaceholder=i.PivotPanel_ReportText=i.PivotPanel_Title=i.Values=i.GrandTotal=i.RowLabels=i.MultipleItems=i.All=i.Total=i.ColumnLabels=i.SubtotalType_Prefix_10=i.SubtotalType_Prefix_9=i.SubtotalType_Prefix_8=i.SubtotalType_Prefix_7=i.SubtotalType_Prefix_6=i.SubtotalType_Prefix_5=i.SubtotalType_Prefix_4=i.SubtotalType_Prefix_3=i.SubtotalType_Prefix_2=i.SubtotalType_Prefix_1=i.SubtotalType_Prefix_0=i.NotExist=i.RepeatName=void 0,i.PivotPanel_ValueFilterOrLabel_LastYear=i.PivotPanel_ValueFilterOrLabel_ThisYear=i.PivotPanel_ValueFilterOrLabel_NextYear=i.PivotPanel_ValueFilterOrLabel_LastQuarter=i.PivotPanel_ValueFilterOrLabel_ThisQuarter=i.PivotPanel_ValueFilterOrLabel_NextQuarter=i.PivotPanel_ValueFilterOrLabel_LastMonth=i.PivotPanel_ValueFilterOrLabel_ThisMonth=i.PivotPanel_ValueFilterOrLabel_NextMonth=i.PivotPanel_ValueFilterOrLabel_LastWeek=i.PivotPanel_ValueFilterOrLabel_ThisWeek=i.PivotPanel_ValueFilterOrLabel_NextWeek=i.PivotPanel_ValueFilterOrLabel_Yesterday=i.PivotPanel_ValueFilterOrLabel_Today=i.PivotPanel_ValueFilterOrLabel_Tomorrow=i.PivotPanel_ValueFilterOrLabel_After=i.PivotPanel_ValueFilterOrLabel_Before=i.ValueFilterOrLabel_NotContain=i.ValueFilterOrLabel_Contain=i.ValueFilterOrLabel_NotEndWith=i.ValueFilterOrLabel_End=i.ValueFilterOrLabel_NotBegin=i.ValueFilterOrLabel_IsBeginWith=i.ValueFilterOrLabelSelect_NotBetween=i.ValueFilterOrLabelSelect_Between=i.ValueFilterOrLabelSelect_LessOrTo=i.ValueFilterOrLabelSelect_LessThan=i.ValueFilterOrLabelSelect_GreaterOrTo=i.ValueFilterOrLabelSelect_GreaterThan=i.ValueFilterOrLabel_NotBetween=i.ValueFilterOrLabel_Between=i.ValueFilterOrLabel_LessOrTo=i.ValueFilterOrLabel_LessThan=i.ValueFilterOrLabel_GreaterOrTo=i.ValueFilterOrLabel_GreaterThan=i.ValueFilterOrLabel_NotEqual=i.ValueFilterOrLabel_Equals=i.PivotPanel_ValueFilterOrLabel_NotContain=i.PivotPanel_ValueFilterOrLabel_Contain=i.PivotPanel_ValueFilterOrLabel_NotEndWith=i.PivotPanel_ValueFilterOrLabel_End=i.PivotPanel_ValueFilterOrLabel_NotBegin=i.PivotPanel_ValueFilterOrLabel_IsBeginWith=i.PivotPanel_ValueFilter_Top10=i.PivotPanel_ValueFilterOrLabel_NotBetween=i.PivotPanel_ValueFilterOrLabel_Between=i.PivotPanel_ValueFilterOrLabel_LessOrTo=i.PivotPanel_ValueFilterOrLabel_LessThan=i.PivotPanel_ValueFilterOrLabel_GreaterOrTo=i.PivotPanel_ValueFilterOrLabel_GreaterThan=void 0,i.Sort_Value_Dialog_Asc=i.Sort_Value_Dialog_Sort_Direction=i.Sort_Value_Dialog_Title=i.Sort_Field_More_Dialog_Values_In_Selected_Area=i.Sort_Field_More_Dialog_Sort_By=i.Sort_Field_More_Dialog_Title=i.Sort_Field_Dialog_More_Options=i.Sort_Field_Dialog_Descending_Sort=i.Sort_Field_Dialog_Ascending_Sort=i.Sort_Field_Dialog_Summary=i.Sort_Field_Dialog_Sort_Options=i.Sort_Field_Dialog_Title=i.TopTenShow=i.Top_Ten_Filter=i.Value_Title=i.Value_Show=i.Use_Series_Characters=i.Use_Single_Character=i.Label_Show=i.Label_Title=i.PivotPanel_Filter_Search=i.PivotPanel_Filter_NoSelectAll=i.PivotPanel_Filter_SelectAll=i.Select_Field=i.CustomFormats=i.Type=i.Sample=i.FormatCells=i.Number=i.LabelFormat=i.NumberFormat=i.Cancel=i.Ok=i.PivotPanel_Date_Filter=i.PivotPanel_Filter_Value=i.PivotPanel_Filter_Label=i.PivotPanel_Filter_Clear=i.PivotPanel_Sort_More=i.PivotPanel_Sort_Largest_Smallest=i.PivotPanel_Sort_Smallest_Largest=i.PivotPanel_Sort_Z_A=i.PivotPanel_Sort_A_Z=i.PivotPanel_ValueFilterOrLabel_Custom=i.PivotPanel_ValueFilterOrLabel_AllDates=i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate=i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate=i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate=i.PivotPanel_ValueFilterOrLabel_QuarterToDate=i.PivotPanel_ValueFilterOrLabel_MonthToDate=i.PivotPanel_ValueFilterOrLabel_YearToDate=void 0,i.SourceName=i.ValueSetting=i.FieldSetting=i.wmk2=i.wmk1=i.WholeDays=i.DateShow=i.DateFilterTitle=i.IsNotBetween=i.IsBetween=i.IsAfterOrEqual=i.IsAfter=i.IsBeforeOrEqual=i.IsBefore=i.Dec=i.Nov=i.Oct=i.Sep=i.Aug=i.Jul=i.Jun=i.May=i.Apr=i.Mar=i.Feb=i.Jan=i.Q4=i.Q3=i.Q2=i.Q1=i.AndJoiner=i.ByJoiner=i.Top_Sum=i.Top_Percent=i.Top_Item=i.Bottom=i.Top=i.Invalid_Field_Sort_By=i.Invalid_Sort_Range=i.Sort_More_Summary_Pattern=i.Sort_Value_Summary_Pattern=i.Sort_Summary_Pattern=i.Sort_In_Column=i.Sort_In_Row=i.Sort_Order_DESC=i.Sort_Order_ASC=i.Custom_Sort_Summary=i.Sort_Value_Dialog_Left_To_Right=i.Sort_Value_Dialog_Top_To_Bottom=i.Sort_Value_Dialog_Desc=void 0,i.minutes=i.seconds=i.groupBy=i.endingAt=i.startingAt=i.auto=i.grouping=i.baseItem=i.baseField=i.showValueAsDialog=i.index=i.rankLargestSmallest=i.rankSmallestLargest=i.percentRunningTotal=i.runningTotal=i.percentDifference=i.difference=i.percentParentTotal=i.percentParentColumnTotal=i.percentParentRowTotal=i.percentEllipsis=i.percentRowTotal=i.percentColumnTotal=i.percentGrandTotal=i.noCalculation=i.DateFormatError=i.sigmaValueTemp=i.sigmaValue=i.Varp=i.Var=i.StdDevp=i.StdDev=i.CountNumbers=i.Product=i.Min=i.Max=i.Average=i.Count=i.Sum=i.ChooseType=i.ShowValueAsField=i.SummarizeValueField=i.BaseItemPrevious=i.BaseItemNext=i.BaseItemForDialog=i.BaseFieldForDialog=i.CalculationForDialog=i.ShowValueAs=i.SummarizeValue=i.CustomName=void 0,i.showSubtotalTop=i.showNoData=i.Layout=i.AddSearchResult=i.search=i.SlicerNameInFormula=i.PivotTableErrorFormula=i.PivotTableMoveCalcItemFieldToReport=i.PivotTableCalcItemHasMultipleDataField=i.PivotTableHasSameItemName=i.PivotTableSubtotalType=i.PivotTableHasNumberOrDateGroup=i.PivotTableCalcItemHasTowCacheField=i.PivotTableForAccessibility=i.PivotTableErrorMessage_InvalidReference=i.PivotTableErrorMessage_InvalidGroup=i.PivotTableErrorMessage_InvalidChange=i.PivotTableErrorMessage_Overlap=i.PivotTableErrorMessage_EmptySourceFieldName=i.PivotTableErrorMessage_Protect=i.PivotTableErrorMessage_EmptyFieldName=i.PivotTableErrorMessage_DuplicatedFieldName=i.PivotTableErrorMessage_EditWhenDefer=i.PivotTableErrorMessage_ExistData=i.PivotTableErrorMessage_MakeChange=i.PivotTableErrorMessage_ShowDetail=i.getValueFilterItemText=i.getDateLabelFilterItemText=i.getStringLabelFilterItemText=i.deferLayoutUpdate=i.toolTipContent_NoValue=i.toolTipContent_Value=i.toolTipContent_Column=i.toolTipContent_Row=i.DefaultPivotTableViewName=i.EmptyValueFieldError=i.param_error=i.Group=i.Views=i.FieldAreaLimited=i.SourceDataOnlyOne=i.SourceNotIsTableNameOrFormula=i.SourceError=i.NoHaveSpread=i.numberOfDays=i.years=i.quarters=i.months=i.days=i.hours=void 0,i.PivotTableErrorMessage_ExistTable=i.TIME_LEVEL_DAYS=i.TIME_LEVEL_MONTHS=i.TIME_LEVEL_QUARTERS=i.TIME_LEVEL_YEARS=i.AllDatesIn_December=i.AllDatesIn_November=i.AllDatesIn_October=i.AllDatesIn_September=i.AllDatesIn_August=i.AllDatesIn_July=i.AllDatesIn_June=i.AllDatesIn_May=i.AllDatesIn_April=i.AllDatesIn_March=i.AllDatesIn_February=i.AllDatesIn_January=i.AllDatesIn_Quarter4=i.AllDatesIn_Quarter3=i.AllDatesIn_Quarter2=i.AllDatesIn_Quarter1=i.DateNotBetween=i.DateOlderThanOrEqual=i.DateOlderThan=i.DateNewerThanOrEqual=i.DateNewerThan=i.DateNotEqual=i.QUARTER_MAP=i.INVALID_DATE_SELECTION=i.ALL_PERIODS=i.ALL_DATES_IN=i.TIMELINE_PLACE_HOLDER=void 0,i.RepeatName="Repeat Name",i.NotExist="Not Exist",i.SubtotalType_Prefix_0="Average of ",i.SubtotalType_Prefix_1="Count of ",i.SubtotalType_Prefix_2="CountNums of ",i.SubtotalType_Prefix_3="Max of ",i.SubtotalType_Prefix_4="Min of ",i.SubtotalType_Prefix_5="Product of ",i.SubtotalType_Prefix_6="StdDev of ",i.SubtotalType_Prefix_7="StdDevp of ",i.SubtotalType_Prefix_8="Sum of ",i.SubtotalType_Prefix_9="Var of ",i.SubtotalType_Prefix_10="Varp of ",i.ColumnLabels="Column Labels",i.Total=" Total",i.All="All",i.MultipleItems="Multiple Items",i.RowLabels="Row Labels",i.GrandTotal="Grand Total",i.Values="Values",i.PivotPanel_Title="PivotTable Fields",i.PivotPanel_ReportText="Choose fields to add to report",i.PivotPanel_SearchPlaceholder="Search",i.PivotPanel_FieldAreaText="Drag fields between areas below:",i.PivotPanel_FiltersItemsTitle="Filters",i.PivotPanel_RowsItemsTitle="Rows",i.PivotPanel_ColumnsItemsTitle="Columns",i.PivotPanel_ValuesItemsTitle="Values",i.PivotPanel_DeferUpdateText="Defer Layout Update",i.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",i.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",i.PivotPanel_Update="Update",i.PivotPanel_DropDownList_Up="Move Up",i.PivotPanel_DropDownList_Down="Move Down",i.PivotPanel_DropDownList_Beginning="Move to Beginning",i.PivotPanel_DropDownList_End="Move to End",i.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",i.PivotPanel_DropDownList_Row="Move to Row Labels",i.PivotPanel_DropDownList_Col="Move to Column Labels",i.PivotPanel_DropDownList_Values="Move to Values",i.PivotPanel_DropDownList_Remove="Remove Field",i.PivotPanel_DropDownList_Set="Field Settings...",i.PivotPanel_DropDownList_ValueSet="Value Field Settings...",i.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",i.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",i.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",i.PivotPanel_Fields_MoveTo_Value="Add to Values",i.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",i.PivotPanel_ValueFilterOrLabel_Equals="Equals...",i.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",i.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",i.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",i.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_Between="Between...",i.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",i.PivotPanel_ValueFilter_Top10="Top 10...",i.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",i.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",i.PivotPanel_ValueFilterOrLabel_End="Ends With...",i.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",i.PivotPanel_ValueFilterOrLabel_Contain="Contains...",i.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",i.ValueFilterOrLabel_Equals="equals",i.ValueFilterOrLabel_NotEqual="does not equal",i.ValueFilterOrLabel_GreaterThan="greater than",i.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",i.ValueFilterOrLabel_LessThan="less than",i.ValueFilterOrLabel_LessOrTo="less than or equal to",i.ValueFilterOrLabel_Between="between",i.ValueFilterOrLabel_NotBetween="not between",i.ValueFilterOrLabelSelect_GreaterThan="is greater than",i.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",i.ValueFilterOrLabelSelect_LessThan="is less than",i.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",i.ValueFilterOrLabelSelect_Between="is between",i.ValueFilterOrLabelSelect_NotBetween="is not between",i.ValueFilterOrLabel_IsBeginWith="begins with",i.ValueFilterOrLabel_NotBegin="does not begin with",i.ValueFilterOrLabel_End="ends with",i.ValueFilterOrLabel_NotEndWith="does not end with",i.ValueFilterOrLabel_Contain="contains",i.ValueFilterOrLabel_NotContain="does not contain",i.PivotPanel_ValueFilterOrLabel_Before="Before...",i.PivotPanel_ValueFilterOrLabel_After="After...",i.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",i.PivotPanel_ValueFilterOrLabel_Today="Today",i.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",i.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",i.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",i.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",i.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",i.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",i.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",i.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",i.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",i.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",i.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",i.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",i.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",i.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",i.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",i.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",i.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",i.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",i.PivotPanel_Sort_A_Z="Sort A to Z",i.PivotPanel_Sort_Z_A="Sort Z to A",i.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",i.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",i.PivotPanel_Sort_More="More Sort Options...",i.PivotPanel_Filter_Clear="Clear Filter From {0}",i.PivotPanel_Filter_Label="Label Filters",i.PivotPanel_Filter_Value="Value Filters",i.PivotPanel_Date_Filter="Date Filters",i.Ok="OK",i.Cancel="Cancel",i.NumberFormat="Number Format",i.LabelFormat="Label Format",i.Number="Number",i.FormatCells="Format Cells",i.Sample="Sample",i.Type="Type",i.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],i.Select_Field="Select field",i.PivotPanel_Filter_SelectAll="Check All",i.PivotPanel_Filter_NoSelectAll="Uncheck All",i.PivotPanel_Filter_Search="search",i.Label_Title="Label Filter",i.Label_Show="Show items for which the label",i.Use_Single_Character="Use ? to represent any single character",i.Use_Series_Characters="Use * to represent any series characters",i.Value_Show="Show items for which",i.Value_Title="Value Filter",i.Top_Ten_Filter="Top 10 Filter ",i.TopTenShow="show",i.Sort_Field_Dialog_Title="Sort",i.Sort_Field_Dialog_Sort_Options="Sort options",i.Sort_Field_Dialog_Summary="Summary",i.Sort_Field_Dialog_Ascending_Sort="Ascending (A to Z) by:",i.Sort_Field_Dialog_Descending_Sort="Descending (Z to A) by:",i.Sort_Field_Dialog_More_Options="More Options...",i.Sort_Field_More_Dialog_Title="More Sort Options",i.Sort_Field_More_Dialog_Sort_By="Sort By",i.Sort_Field_More_Dialog_Values_In_Selected_Area="Values in selected {{AREA}}",i.Sort_Value_Dialog_Title="Sort By Value",i.Sort_Value_Dialog_Sort_Direction="Sort direction",i.Sort_Value_Dialog_Asc="Smallest to Largest",i.Sort_Value_Dialog_Desc="Largest to Smallest",i.Sort_Value_Dialog_Top_To_Bottom="Top to Bottom",i.Sort_Value_Dialog_Left_To_Right="Left to Right",i.Custom_Sort_Summary="Custom Sort",i.Sort_Order_ASC="ascending order",i.Sort_Order_DESC="descending order",i.Sort_In_Row="row",i.Sort_In_Column="column",i.Sort_Summary_Pattern="Sort {{FIELD_NAME}} in {{ORDER}}",i.Sort_Value_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}}",i.Sort_More_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}} using values in this {{ROW_COLUMN}}:\r\n",i.Invalid_Sort_Range="The Sort Reference is not valid. Make sure that it's within the data you want to sort, and the first Sort By box isn't the same or blank.",i.Invalid_Field_Sort_By="Cannot determine which PivotTable field to sort by.",i.Top="Top",i.Bottom="Bottom",i.Top_Item="Items",i.Top_Percent="Percent",i.Top_Sum="Sum",i.ByJoiner="by",i.AndJoiner="and",i.Q1="Quarter 1",i.Q2="Quarter 2",i.Q3="Quarter 3",i.Q4="Quarter 4",i.Jan="January",i.Feb="February",i.Mar="March",i.Apr="April",i.May="May",i.Jun="June",i.Jul="July",i.Aug="August",i.Sep="September",i.Oct="October",i.Nov="November",i.Dec="December",i.IsBefore="is before",i.IsBeforeOrEqual="is before or equal to",i.IsAfter="is after",i.IsAfterOrEqual="is after or equal to",i.IsBetween="is between",i.IsNotBetween="is not between",i.DateFilterTitle="Date Filter",i.DateShow="Show items for which the date",i.WholeDays="Whole Days",i.wmk1="5069766f745461626c65",i.wmk2="5069766f745461626c65",i.FieldSetting="Field Settings",i.ValueSetting="Value Field Settings",i.SourceName="Source Name:",i.CustomName="Custom Name:",i.SummarizeValue="Summarize Values By",i.ShowValueAs="Show Value As",i.CalculationForDialog="Calculation: ",i.BaseFieldForDialog="Base Field: ",i.BaseItemForDialog="Base Item: ",i.BaseItemNext="(next)",i.BaseItemPrevious="(previous)",i.SummarizeValueField="Summarize values field by",i.ShowValueAsField="Show value as",i.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",i.Sum="Sum",i.Count="Count",i.Average="Average",i.Max="Max",i.Min="Min",i.Product="Product",i.CountNumbers="Count Numbers",i.StdDev="StdDev",i.StdDevp="StdDevp",i.Var="Var",i.Varp="Varp",i.sigmaValue="\u2211 Values",i.sigmaValueTemp="Values",i.DateFormatError="This isn't a valid date",i.noCalculation="No Calculation",i.percentGrandTotal="% of Grand Total",i.percentColumnTotal="% of Column Total",i.percentRowTotal="% of Row Total",i.percentEllipsis="% Of ...",i.percentParentRowTotal="% of Parent Row Total",i.percentParentColumnTotal="% of Parent Column Total",i.percentParentTotal="% of Parent Total ...",i.difference="Difference From ...",i.percentDifference="% Difference From ...",i.runningTotal="Running Total In ...",i.percentRunningTotal="% Running Total In ...",i.rankSmallestLargest="Rank Smallest to Largest ...",i.rankLargestSmallest="Rank Largest to Smallest ...",i.index="Index",i.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","% Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],i.baseField="Base field:",i.baseItem="Base item:",i.grouping="Grouping",i.auto="Auto",i.startingAt="Starting at:",i.endingAt="Ending at:",i.groupBy="By:",i.seconds="Seconds",i.minutes="Minutes",i.hours="Hours",i.days="Days",i.months="Months",i.quarters="Quarters",i.years="Years",i.numberOfDays="Number of days",i.NoHaveSpread="workbook exception",i.SourceError="Source data exception, cannot create PivotTable report",i.SourceNotIsTableNameOrFormula="source data not is table name and formula",i.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",i.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",i.Views="Views",i.Group="Group",i.param_error="the param is null or undefine",i.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",i.DefaultPivotTableViewName="PivotView",i.toolTipContent_Row="Row: ",i.toolTipContent_Column="Column: ",i.toolTipContent_Value="Value: ",i.toolTipContent_NoValue="No value",i.deferLayoutUpdate="Defer Layout Update",i.getStringLabelFilterItemText=n,i.getDateLabelFilterItemText=e,i.getValueFilterItemText=r,i.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",i.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",i.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",i.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",i.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",i.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",i.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",i.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",i.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",i.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",i.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",i.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",i.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",i.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",i.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",i.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",i.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",i.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",i.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",i.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",i.SlicerNameInFormula="Slicer",i.search="Search",i.AddSearchResult="Add current selection to filter",i.Layout="Layout",i.showNoData="Show items with no data",i.showSubtotalTop="Display subtotals at the top of each group",i.TIMELINE_PLACE_HOLDER="{TL}",i.ALL_DATES_IN="All dates in ",i.ALL_PERIODS="All Periods",i.INVALID_DATE_SELECTION="Invalid Date Selection!",i.QUARTER_MAP=["","Q1","Q2","Q3","Q4"],i.DateNotEqual="Not "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThan="After "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThanOrEqual="After or on "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThan="Before "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThanOrEqual="Before or on"+i.TIMELINE_PLACE_HOLDER,i.DateNotBetween="Not Between "+i.TIMELINE_PLACE_HOLDER,i.AllDatesIn_Quarter1=i.ALL_DATES_IN+i.QUARTER_MAP[1],i.AllDatesIn_Quarter2=i.ALL_DATES_IN+i.QUARTER_MAP[2],i.AllDatesIn_Quarter3=i.ALL_DATES_IN+i.QUARTER_MAP[3],i.AllDatesIn_Quarter4=i.ALL_DATES_IN+i.QUARTER_MAP[4],i.AllDatesIn_January=i.ALL_DATES_IN+i.Jan,i.AllDatesIn_February=i.ALL_DATES_IN+i.Feb,i.AllDatesIn_March=i.ALL_DATES_IN+i.Mar,i.AllDatesIn_April=i.ALL_DATES_IN+i.Apr,i.AllDatesIn_May=i.ALL_DATES_IN+i.May,i.AllDatesIn_June=i.ALL_DATES_IN+i.Jun,i.AllDatesIn_July=i.ALL_DATES_IN+i.Jul,i.AllDatesIn_August=i.ALL_DATES_IN+i.Aug,i.AllDatesIn_September=i.ALL_DATES_IN+i.Sep,i.AllDatesIn_October=i.ALL_DATES_IN+i.Oct,i.AllDatesIn_November=i.ALL_DATES_IN+i.Nov,i.AllDatesIn_December=i.ALL_DATES_IN+i.Dec,i.TIME_LEVEL_YEARS="YEARS",i.TIME_LEVEL_QUARTERS="QUARTERS",i.TIME_LEVEL_MONTHS="MONTHS",i.TIME_LEVEL_DAYS="DAYS",i.PivotTableErrorMessage_ExistTable="A PivotTable report cannot overlap a table."},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(o,t,i){"use strict";var v,n,l,s,a,c,e,u,i,f,h,d,p,m,b,g,r,w,y,C,N,I,A,T,M,S,x,n;function D(t,i,n){return t.getPivotInfoImp(i,n)}function E(t,i){var n,e,r,o,a,n,s,c,u,l,f,h,v,d;if(t&&i){for(n=i.row,e=i.col,r=i.rowCount,o=i.colCount,a=D(t,n,e),n=D(t,n+r-1,e+o-1),l=[],-1!==(u=z(s=a.area,c=n.area)).indexOf(0)&&(f=F(0,t),l=G(t,h=i.getIntersect(f,0,0))),v=1;v<5;v++)-1!==u.indexOf(v)&&(f=F(v,t),d=[],(h=i.getIntersect(f,0,0))&&k(h,h.row,h.col,t,d,t.rZt.HWt[v]),l=l.concat(R(d,v,t)));return l=B(l)}}function k(t,i,n,e,r,o){var a,s,c,u,l,f,h,a=i,s=n,c=D(e,i,n),u=j(c),l=o.QWt;if(1===l||2===l&&0===c.relativeRow)(1===l&&!c.cornerFieldInfo||2===l&&!c.colHeadFieldInfo)&&(s=t.col+t.colCount-1,1===l)&&i===t.row&&(a=t.row+t.rowCount-(1===t.rowCount?1:2));else{for(h=n+1;h<n+t.colCount;h++){if(P(f=c,c=D(e,a,h),a,h,t,u,o,!1)){s=h-1;break}h===n+t.colCount-1&&(s=h)}for(h=i+1;h<i+t.rowCount;h++){if(P(f=c?c:f,c=D(e,h,s),h,s,t,u,o,!0)){a=h-1;break}h===i+t.rowCount-1&&(a=h)}}r.push(new v.Range(i,n,a-i+1,s-n+1)),a===t.row+t.rowCount-1&&s===t.col+t.colCount-1||(s===t.col+t.colCount-1?k(t,a+1,t.col,e,r,o):k(t,i,s+1,e,r,o))}function B(t){for(var i,n,e,r,o,a,s,c,i=[],n=0,e=t;n<e.length;n++){for(r=e[n],o=!1,a=0,s=i;a<s.length;a++)if(c=s[a],(0,u.isSamePivotArea)(r,c,!1)){o=!0;break}o||i.push(r)}return i}function j(t,i,n){var e,r,o,a,e=t.rowInfos,r=t.colInfos,o=x.none;if(e&&!n)for(a=0;a<e.length;a++)(e[a].isSubtotal||e[a].isGrandTotal)&&(o+=x.row);if(r&&!i)for(a=0;a<r.length;a++)(r[a].isSubtotal||r[a].isGrandTotal)&&(o+=x.col);return o}function O(t,i){var n,e,r;if(t&&i){if((n=t.length)!==(e=i.length))return 1;for(r=n-2;-1<r;r--)if(t[r].itemName!==i[r].itemName)return 1}}function P(t,i,n,e,r,o,a,s){var c,n,e,r,u,l,c=a.QWt;if(n>r.row+r.rowCount-1||e>r.col+r.colCount-1)return 1;if(t&&i)if(s){if(3===a.QWt){if((n=a.zWt)&&(e=n[t.relativeRow],r=n[i.relativeRow],e)&&r&&e.YAt!==r.YAt)return 1}else if(O(t.rowInfos,i.rowInfos))return 1}else if(O(t.colInfos,i.colInfos))return 1;if(4===c&&o){if(s&&o===x.col&&j(i,!0)||!s&&o===x.row&&j(i,void 0,!0))return 1}else if(j(i))return 1;if(3===c&&!o&&!s)return 1;if(2===c&&!o&&s)return 1;if(o)if(3===c&&s){if(u=a.zWt[i.relativeRow],l=a.zWt[i.relativeRow-1],u.path!==l.path)return 1}else if(2!==c||s){if(4===c&&(o&x.row&&s||o&x.col&&!s))return 1}else if(u=a.WWt[i.relativeColumn],l=a.WWt[i.relativeColumn-1],u.path!==l.path)return 1}function R(t,i,n){switch(i){case 1:return V(n,t);case 2:return U(n,t);case 3:return Q(n,t);case 4:return W(n,t)}}function G(t,i){for(var n,e,r,o,n=[],e=i.row;e<i.row+i.rowCount;e++)for(r=i.col;r<i.col+i.colCount;r++)(o=D(t,e,r)).relativeColumn%3==1?n.push({labelOnly:!0,references:[{fieldName:o.pageFieldInfo.fieldName}]}):o.relativeColumn%3==0&&n.push({labelOnly:!0,type:a.PivotAreaType.button,fieldName:o.pageFieldInfo.fieldName});return n}function V(o,t){var a,s,i,c,u,a=[],s=o.rZt.HWt[1].getRange(),i=o.getRange().content,c=i.row,u=i.col;return(0,l.o)(t,function(t){var i,n,e,r,i,n,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,i={row:i-s.row-c,col:n-s.col-u,rowCount:e,colCount:r},n=_(y,C,i,t,s,o,1);n!==w&&a.push(n)}),a}function U(o,t){var a,s,i,c,u,a=[],s=o.rZt.HWt[2].getRange(),i=o.getRange().content,c=i.row,u=i.col;return(0,l.o)(t,function(t){var i,n,e,r,i,n,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,i={row:i-s.row-c,col:n-s.col-u,rowCount:e,colCount:r},n=_(N,I,i,t,s,o,2);n!==w&&a.push(n)}),a}function Q(o,t){var a,s,i,c,u,a=[],s=o.rZt.HWt[3].getRange(),i=o.getRange().content,c=i.row,u=i.col;return(0,l.o)(t,function(t){var i,n,e,r,i,n,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,i={row:i-s.row-c,col:n-s.col-u,rowCount:e,colCount:r},n=_(A,T,i,t,s,o,3);n!==w&&a.push(n)}),a}function W(o,t){var a,s,i,c,u,a=[],s=o.rZt.HWt[4].getRange(),i=o.getRange().content,c=i.row,u=i.col;return(0,l.o)(t,function(t){var i,n,e,r,i,n,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,i={row:i-s.row-c,col:n-s.col-u,rowCount:e,colCount:r},n=_(M,S,i,t,s,o,3);n!==w&&a.push(n)}),a}function z(t,i){return 0===i?[0]:1===i?[1]:3===i?1===t?[1,3]:[3]:2===i?1===t?[1,2]:[2]:4===i?1===t?[1,2,3,4]:2===t?[2,4]:3===t?[3,4]:4===t?[4]:void 0:void 0}function F(t,i){var n,t;return i.Oy()||(0,l.ht)(t)?w:0===t?i.getRange().page:((t=(n=i.rZt.HWt)[t].getRange()).row+=i.eZt.row,t.col+=i.eZt.col,t)}function _(t,i,n,e,r,o,a){for(var s,c,u,s=0;s<t.length;s++)if(X(c=Z(t[s],r,o),n,u=D(o,e.row,e.col),o))return Y(i[s],n,e,u,o,a);return w}function Z(t,i,n){var e=(0,c.RF)(t)||{};return-1===t.row&&(e.row=i.rowCount-1),-1===t.col&&(e.col=i.colCount-1),t.col===r&&(e.col=n.rZt.HWt[2].ZWt.length),e}function L(t){return t===f().sigmaValue?f().Values:t}function Y(t,i,n,e,r,o){var a,i,a=(0,c.RF)(t)||{};if(t.offset===d&&(a.offset=s.rangeToFormula(i,0,0,s.RangeReferenceRelative.allRelative,!1)),t.fieldName===p){if(!(i=H(e,n,o)))return w;a.fieldName=L(i)}return t.references===m&&(a.references=J(n,r)),t.references===b&&(a.references=q(n,r)),t.references===b+m&&(a.references=K(n,r)),t.references===g&&(a.references=[{fieldName:f().Values}]),a.references&&0===a.references.length&&delete a.references,a}function H(t,i,n){var e;switch(n){case 1:return(e=t.cornerFieldInfo).fieldName||w;case 2:if(e=t.colHeadFieldInfo)return e.fieldName;e=t.activeColFieldInfo;break;case 3:e=t.activeRowFieldInfo}return e?e.name:w}function J(o,i){for(var a,n,t,e,r,a=[],n=o.row,t=function(e){var t,r,t=D(i,n,e);if(t.value===w)return"break";(r=t.colInfos)&&(0,l.o)(r,function(t,i){var n;e===o.col?(n={fieldName:L(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===h&&(n.subtotal=!0),a[i]=n):i!==r.length-1||a[i].items.includes(t.itemName)||a[i].items.push(t.itemName)})},e=o.col;e<o.col+o.colCount&&"break"!==(r=t(e));e++);return a}function q(o,i){for(var a,n,t,e,r,a=[],n=o.col,t=function(e){var t,r,t=D(i,e,n);if(t.value===w)return"break";(r=t.rowInfos)&&(0,l.o)(r,function(t,i){var n;e===o.row?(n={fieldName:L(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===h&&(n.subtotal=!0),a[i]=n):i!==r.length-1||a[i].items.includes(t.itemName)||a[i].items.push(t.itemName)})},e=o.row;e<o.row+o.rowCount&&"break"!==(r=t(e));e++);return a}function K(o,i){for(var a,s,c,u,t,n,e,a=[],s=[],c=o.row,u=o.col,t=function(n){var t,e,r,t,e=D(i,n,u).rowInfos;e&&(r=0,l.o)(e,function(t){var i;n===o.row?t.fieldName&&t.itemName&&(i={fieldName:L(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===h&&(i.subtotal=!0),a[r]&&(r+=1),a[r]=i):(r!==e.length-1||(0,l.ht)(t.itemName)||(a[r].items?a[r].items.includes(t.itemName)||a[r].items.push(t.itemName):a[r].items=[t.itemName]),r+=1)})},n=o.row;n<o.row+o.rowCount;n++)t(n);for(e=function(n){var t,e,r,t,e=D(i,c,n).colInfos;e&&(r=0,l.o)(e,function(t){var i;n===o.col?t.fieldName&&t.itemName&&(i={fieldName:L(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===h&&(i.subtotal=!0),s[r]&&(r+=1),s[r]=i):(r!==e.length-1||(0,l.ht)(t.itemName)||(s[r].items?s[r].items.push(t.itemName):s[r].items=[t.itemName]),r+=1)})},n=o.col;n<o.col+o.colCount;n++)e(n);return a.concat(s)}function X(t,i,n,e){var r=t.row,o=t.col,a=t.rowCount,s=t.colCount,c=t.nullValue;if(void 0!==t.nullInfo){if(n.rowInfos&&0<n.rowInfos.length)return;if(n.colInfos&&0<n.colInfos.length)return}return!(void 0!==r&&i.row!==r||void 0!==o&&i.col!==o||void 0!==a&&i.rowCount!==a||void 0!==s&&i.colCount!==s||void 0!==c&&(c&&n.value!==w||!c&&n.value===w)||t.needGrandCol&&!$(n,!1,!0)||t.needGrandRow&&!$(n,!0,!1))}function $(t,i,n){var e,t,r,e=t.rowInfos,t=t.colInfos,r=!1;return i&&e&&0<e.length&&(0,l.o)(e,function(t){t.isGrandTotal&&(r=!0)}),n&&t&&0<t.length&&(0,l.o)(t,function(t){t.isGrandTotal&&(r=!0)}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.rangeToAreas=void 0,v=i("Core"),n=i("Common"),l=i("Pivot"),s=i("SheetsCalc"),a=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),c=i("./dist/plugins/pivot/pivot-util.js"),e=i("./dist/plugins/pivot/pivot.ns.js"),u=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=new n.Common.ResourceManager(e.SR,"PivotTables"),f=i.getResource.bind(i),h=void 0,d="__RangeFormula__",p="__FieldName__",m="__ColInfo__",b="__RowInfo__",g="__Values__",r="__TopRight__",w=null,y=[{row:-1,rowCount:1,colCount:1},{}],C=[{type:a.PivotAreaType.button,labelOnly:!0,fieldName:p},{type:a.PivotAreaType.corner,labelOnly:!0}],N=[{row:0,col:r,rowCount:1,colCount:1},{colCount:1,needGrandCol:!0,nullValue:!1},{row:0,rowCount:1,colCount:1,nullValue:!1},{rowCount:1,nullValue:!1}],I=[{labelOnly:!0,type:a.PivotAreaType.topRight},{labelOnly:!0,grandCol:!0},{type:a.PivotAreaType.button,labelOnly:!0,fieldName:p},{labelOnly:!0,references:m}],A=[{rowCount:1,needGrandRow:!0,nullValue:!1},{colCount:1,nullValue:!1}],M=[{rowCount:1,colCount:1,row:0,col:0,nullInfo:!0},{nullValue:!(T=[{labelOnly:!0,grandRow:!0},{labelOnly:!0,references:b}]),needGrandRow:!0,needGrandCol:!0},{rowCount:1,needGrandRow:!0},{colCount:1,needGrandCol:!0},{}],S=[{dataOnly:!0,references:g},{grandRow:!0,grandCol:!0,references:b+m},{grandRow:!0,references:b+m},{grandCol:!0,references:b+m},{references:b+m}],t.rangeToAreas=E,(n=x=x||{})[n.none=0]="none",n[n.row=1]="row",n[n.col=2]="col"},"./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js":function(t,i,o){var n,i,a,e;!function(){"use strict";var n,e,t;function r(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,r)),i.exports}n={"./pivot-entry.ts":function(t,i,n){var e,r,o,a,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.mXt=i.SR=void 0,o=n("./src/pivotEngine.res.en.ts"),i.SR={en:o.resource},r(n("./src/pivot-interface.ts"),i),r(n("./src/pivot-util.ts"),i),r(n("./src/pivot-condition.ts"),i),r(n("./src/pivot-cache.ts"),i),r(n("./src/data-analyzer.ts"),i),r(n("./src/pivot-engine.ts"),i),r(n("./src/pivot-calc-engine.ts"),i),a=n("./src/pivot-sort.ts"),Object.defineProperty(i,"mXt",{enumerable:!0,get:function(){return a.mXt}})},"./src/data-analyzer.ts":function(a,K,t){var A,Y,H,X,S,J,i,t,i,u,z,h,s,c,f,x,D,r,d,p,b,y,C,N,I,m,T,M,P,l,$,tt,W,Z,g,w,F,_,L,Q,q;function it(t,i,n){if((0,X.ht)(t)&&(0,X.ht)(i))return z;if((0,X.ht)(t))return i;if((0,X.ht)(i)&&4!==n)return t;if(t instanceof S.CalcError)return t;if(i instanceof S.CalcError)return i;switch(n){case 0:return t+i;case 1:return t-i;case 2:var e;return 0===t||0===i?0:0*(e=t*i)!=0?S.Errors.Number:e;case 3:return 0===i?S.Errors.DivideByZero:t/i;case 5:return c(t,i);case 6:return s(t,i);case 4:return f(t)}}function k(t){return!(0,X.ht)(t)&&x(+t)}function st(t,i,n,e){var r,o,a,s,i,c,u,l,f,h,r=[],o=[],a=[],s=0;for(""!==i&&(s=(i=i.split(K.Separator)).length,r=r.concat(i)),u=0,l=c=Object.keys(n);u<l.length;u++)f=l[u],o.push({fieldInfo:""===f?r:r.concat(f.split(K.Separator)),calcIndex:n[f]});return h=t.bXt,e.forEach(function(t,i){a[i]=h[t]}),E(t,o,a=a.splice(t.gXt,s).concat(a.splice(0,t.gXt)))}function E(t,i,r){for(var o,n,e,a,s,c,o=t.wXt,n=[],e=function(t){var e={fieldInfos:[],calcIndex:t.calcIndex};t.fieldInfo.forEach(function(t,i){var n=o.getField(r[i]);e.fieldInfos.push({fieldName:r[i],fieldItem:n.getFieldsItemList()[t]})}),n.push(e)},a=0,s=i;a<s.length;a++)e(c=s[a]);return n}function n(t,i){this.yXt={},this.CXt={},this.IXt={},this.CZt={},this.AXt={},this.NXt={},this.TXt={},this.MXt=!1,this.wY=[],this.DU=t,this.wXt=i}function B(t,i){var i=i.getField(t);return!(!i||(0,X.ht)(i.D5))}function e(t,i,n,e,r){var c,u;this.xXt={},this.sx={},c=this,u=[],(0,X.o)(t,function(t,i){var n=t.index,e=t.displayName,r=t.isDim,o=t.isGroupField,a=t.getGroupItem,s=t.databaseField,t=t.dataFieldIndex;r&&(u.push({index:n,fieldName:e,isGroupField:o,getGroupItem:a,databaseField:s,dataFieldIndex:t}),c.xXt[e]=i,c.sx[e]=i)}),c.DXt=u,c.SXt=c.kXt(i,n),c.jXt=c.OXt(c.SXt),c.PXt=c.kXt(e,n),c.FXt=c.kXt(r,n,!0),c._Xt={},c.LXt={},c.tx=[],c.EXt=[]}function R(t,i){var d;(0,X.ht)(i)||i.length<1||(d=t.wY,(0,X.o)(i,function(t){for(var i,n,e,r,o,a,s,c,u,l,f,h,v,s,i=t.cacheName,n=t.subTotalTypes,e=t.isCalculatedField,r=0,o=d;r<o.length;r++)c=(s=(a=o[r])[i].calc).count,u=s.sum,l=s.max,f=s.min,h=s.sumx2,v=s.product,s=s.len,a[i].calcResult=(0,K.BXt)({count:c,sum:u,max:l,min:f,sumx2:h,product:v,len:s},n)}))}function G(t,i,n,e,r,o,a,s,c,u,l,f,h){var v,d,p,m,b,g,w,y,C,N,I,A,T,M,S;if(!(t.YAt>=s||0===t.oYt.length)){if(v=i.wXt,p=(d=t.oYt)[0].rYt,m=n[t.YAt].sourceName,b={},g=i.gXt,c[p])for(w=void 0,t.YAt<g&&(w=i.RXt.columnNodeInfo),C=0,N=y=V(v,m,a,f,r,g);C<N.length;C++)I=N[C],o.itemKeys&&(0,X.ht)(o.itemKeys[I])&&(0,X.ht)(b[I])&&(a.push({pathStr:I,dimName:p}),b[I]=1,j(i,n,e,r,a,s,t.YAt<i.gXt,w,u,l,f,h),a.pop());for(A=0,T=d;A<T.length;A++)M=T[A],(S=void 0,X.ht)(b[M.pathStr])&&(a.push({pathStr:M.pathStr,dimName:M.rYt}),G(M,i,n,e,r,S=M.YAt===i.gXt?i.RXt.columnNodeInfo:o.itemKeys[M.pathStr],a,s,c,u,l,f,h),a.pop())}}function j(t,i,n,e,r,o,a,s,c,u,l,f){var h,v,d,p,m,b,g,w,y,h,C,N,I,v,d,m,h,A,T,h=r.length,v=t.wXt;if(h<o){if(d=i[h].sourceName,p=i[h].displayName,m=t.gXt,a===h<t.gXt)for(g=0,w=b=V(v,d,r,l,e,m);g<w.length;g++)y=w[g],r.push({pathStr:y,dimName:p}),j(t,i,n,e,r,o,a,s,c,u,l,f),r.pop();else if(h=s&&s.itemKeys,!(0,X.ht)(h))for(N=0,I=C=Object.keys(h);N<I.length;N++)y=I[N],r.push({pathStr:y,dimName:p}),j(t,i,n,e,r,o,a,s.itemKeys[y],c,u,l,f),r.pop()}else v=t.Nkt,d=t.yZt,m=(0,K.GXt)(),h=t.nv(),A=o-t.gXt,T=t.RXt,v.addChildItem(r,m,h,t,f,i,n,u.rootPosition,t.gXt,!1,"",!1,0,v.UZt,c,!1,T.rowNodeInfo),d.addChildItem(rt(r,t.gXt),m,h,t,f,i,n,u.headerPosition,A,!0,"",!1,0,d.UZt,c,!1,T.columnNodeInfo)}function V(t,i,n,e,r,o){for(var a,s,c,u,l,L,f,h,v,d,p,m,b,g,w,y,C,N,I,A,E,T,M,S,x,D,k,j,O,P,o,F,_,a=t.getField(i),s=a.y1||i,l=n.length,L,f=l<o?0:o,h=r[i],v=l-1;f<=v;v--)if(s===(c=(u=t.getField(e[v])).y1||e[v])){if(d=n[v].pathStr,p=u.Rs,m=a.Rs,b={3:H.DateGroupType.days,4:H.DateGroupType.months,5:H.DateGroupType.quarters},!(g=void 0,X.ht)(m)&&!(0,X.ht)(p)&&b[m]&&b[p])g=U(p,m,d);else if((0,X.ht)(m)&&(0,X.ht)(p))g=ht(t,i,e[v],d,r[i]);else if(0===d)g=[0];else if(u.DH().length-1===d)g=[a.DH().length-1];else{for(w=a.DH(),y=a.M(),C=[],N=0,I=w;N<I.length;N++)A=I[N],C.push(y[A]);C.pop(),C.shift(),g=C}if(h.isAll)return g;for(T={},M=[],S=0,x=E=h.items;S<x.length;S++)T[A=x[S]]=!0;for(D=0,k=g;D<k.length;D++)T[j=k[D]]&&M.push(j);return M}if(h.isAll){for(w=a.DH(),y=a.M(),g=[],O=0,P=w;O<P.length;O++)A=P[O],g.push(y[A]);return g}if(o=Object.keys(h.items),a.cC()){for(y=[],F=0,_=o;F<_.length;F++)A=_[F],y.push(a.AQt[A]);return y}return o}function U(t,i,n){var e,r,o,a,s;if(i<t){if(t!==H.DateGroupType.quarters)return lt(n);if(e=ft(n),i!==H.DateGroupType.days)return e;for(r=[],o=0,a=e;o<a.length;o++)s=a[o],r=r.concat(lt(s));return r}return t===H.DateGroupType.days?(s=ct(n),i===H.DateGroupType.quarters?ut(s[0]):s):ut(n)}function ct(t){for(var i,n,i=r.length,n=0;n<i;n++)if(r[n]<=t&&r[n+1]>t)return[n]}function ut(t){return 0===t?[0]:13===t?[5]:[Math.floor((t-1)/3)+1]}function lt(t){var i,n,e,i=[];for((0,X.ht)(r[t])||(n=r[t],e=r[t+1]);n<e;n++)i.push(n);return i}function ft(t){var i,n,e,r,i=[],r=[0,1,4,7,10,13,14];for((0,X.ht)(r[t])||(n=r[t],e=r[t+1]);n<e;n++)i.push(n);return i}function ht(t,i,n,e,r){var i,t,o,a,n,s,c,u,l,f,c,h,v,d,p,i=t.getField(i),t=t.getField(n),a=[];if(i.cC())n=t.DH()[+e],s=i.VXt,c=i.AQt,o=s&&c&&c[s[n]],(0,X.ht)(o)||a.push(o);else for(c=(u=t.N)[f=(l=t.cx)[+e]],h=i.P,v=0,d=c;v<d.length;v++)o=h[p=d[v]],a.push(o);return a}function vt(t){var i,n,e;if(!(0,X.ht)(t))for(i=0,n=t;i<n.length;i++)if((e=n[i]).showDataAs!==H.PivotShowDataAs.normal)return 1}function dt(t,i,n,e,r,o,a,s){var c,u,l,f,h,v,c=t.Nkt,u=t.gXt;if(0!==u&&a-u!=0)for(l=[],f=0,h=s;f<h.length;f++)pt(c,t,i,n,e,l,a,r,o,(v=h[f]).cacheName)}function pt(t,i,n,e,r,o,a,s,c,u){var l,f,h,v,d;for(t.YAt===i.gXt&&O(t,i,n,e,r,l=i.RXt.columnNodeInfo.itemKeys,o,a,s,c,!1,u),h=0,v=f=t.oYt;h<v.length;h++)d=v[h],o.push({pathStr:d.pathStr,dimName:d.rYt}),pt(d,i,n,e,r,o,a,s,c,u),o.pop()}function O(t,i,n,e,r,o,a,s,c,u,l,f){var h,v,d,p,m,b,h,g,w,y,C,N,I,A,T,h,v,M,S,x,D,h=a.length;if(h<s)if(v=Object.keys(o),l)for(d=n[h],p=0,m=v;p<m.length;p++)b=m[p],a.push({pathStr:b,dimName:d.displayName}),O(null,i,n,e,r,o[b].itemKeys,a,s,c,u,l,f),a.pop();else{for(g={},w=(h=t.oYt)[0].rYt,y=h[0].kYt,C=0,N=h;C<N.length;C++)g[(I=N[C]).pathStr]=1,y||(a.push({pathStr:I.pathStr,dimName:w}),O(I,i,n,e,r,o[I.pathStr].itemKeys,a,s,c,u,l,f),a.pop());for(A=0,T=v;A<T.length;A++)b=T[A],(0,X.ht)(g[b])&&(a.push({pathStr:b,dimName:w}),O(t,i,n,e,r,o[b].itemKeys,a,s,c,u,!0,f),a.pop())}else h=i.Nkt,v=i.yZt,M=(0,K.GXt)(),S=i.nv(),x=s-i.gXt,D=i.RXt,h.addChildItem(a,M,S,i,f,n,e,u.rootPosition,i.gXt,!1,"",!1,0,h.UZt,c,!1,D.rowNodeInfo),v.addChildItem(rt(a,i.gXt),M,S,i,f,n,e,u.headerPosition,x,!0,"",!1,0,v.UZt,c,!1,D.columnNodeInfo)}function mt(t,i,n,e,r,o,a,s){for(var c,u,l,f,c={subtotalManager:t,queryItems:i,positionInfo:e,contextList:r,rowDeep:o,pathInfo:[],cacheName:null,filedShowSubtotalTopInfo:n,itemsMap:s,measure:null,currentNode:t.UXt(),level:0,parentField:{}},u=0,l=a;u<l.length;u++)f=l[u],c.cacheName=f.cacheName,c.measure=f,c.level=0,nt(c)}function nt(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,n,g,w,y,C,N,I,C,A,T,M,L,S,x,D,E,k,j,B,O,C,R,P,G,V,F,U,Q,W,z,_,Z,Y,i=t.subtotalManager,n=t.currentNode,e=t.queryItems,r=t.filedShowSubtotalTopInfo,o=t.positionInfo,a=t.contextList,s=t.rowDeep,c=t.pathInfo,u=t.cacheName,l=t.itemsMap,f=t.measure,h=t.level,v=t.parentField,d=i.UXt(),m=n&&n.oYt||[],n=i.wXt,y=!0;if(!(h>=i.fieldNameOrders.length)){if(b=i.originOrders[h],N=(C=i.QXt)[b],(g=n.getField(N)).cC()){if(p=g.y1,C=i.originOrders.indexOf(C[p]),i.originOrders.indexOf(b)>C&&0<=C)return;for(I=(A=n.getField(p)).ty,T=0;T<m.length;)w=m[T],v[p]=g.DH()[w.pathStr],c.push({pathStr:w.pathStr,dimName:b}),t.currentNode=w,t.level=h+1,nt(t),delete v[p],c.pop(),T++;for(M=0,L=I;M<L.length;M++)S=L[M],x=g.AQt[g.VXt[S]],(0,X.ht)(x)||(l[N].isAll||l[N].items[x])&&(v[p]=S,c.push({pathStr:x,dimName:b}),et(d,h+1,e,r,i,c,u,o,a,s,l,{fieldName:p,calcItem:S,calcLevel:A.WXt[A.M()[S]]},f,v),c.pop())}else for(I=g.ty,T=0;T<m.length;)if((w=m[T]).zXt&&!y)T+=1;else{if(I&&0<I.length&&y){for(D=0,E=I;D<E.length;D++)S=E[D],k=g.M()[S],!l[N].isAll&&!l[N].items[k]||v[N]&&v[N].indexOf(S)<0||(c.push({pathStr:k,dimName:b}),et(d,w.YAt,e,r,i,c,u,o,a,s,l,{fieldName:N,calcItem:S,calcLevel:g.WXt[k]},f,v),c.pop());y=!1}c.push({pathStr:w.pathStr,dimName:b}),t.currentNode=w,t.level=h+1,nt(t),c.pop(),T++}if(!m.length){for(j=0,B=I;j<B.length;j++)S=B[j],O=g.M()[S],(l[N].isAll||l[N].items[O])&&(c.push({pathStr:O,dimName:b}),et(d,h+1,e,r,i,c,u,o,a,s,l,{fieldName:N,calcItem:S,calcLevel:g.WXt[O]},f,v),c.pop());if(k=[],l[N].isAll)for(C=g.DH(),R=g.M(),P=0,G=C;P<G.length;P++)V=G[P],k.push(R[V]);else k=k.concat(Object.keys(l[N].items));for(F=0,U=k;F<U.length;F++){if(O=U[F],c.push({pathStr:O,dimName:b}),t.currentNode=null,t.level=h+1,g.cC()&&(p=g.y1,Q=g.cx[O],x=g.AQt[Q],!(0,X.ht)(x)))for(v[p]=[],W=g.VXt,_=0,Z=z=Object.keys(W);_<Z.length;_++)W[Y=Z[_]]===Q&&v[p].push(Y);nt(t),delete v[p],c.pop()}}delete v[p]}}function et(t,i,n,e,r,o,a,s,c,u,l,f,h,v){var d,L,p,m,E,b,g,w,y,C,B,N,I,A,T,M,R,S,x,G,V,D,p,U,k,j,O,Q,W,P,z,F,_,Z,d=r.wXt,L=r.QXt;if(i<n.length)if((p=n[i]).isDim){if(m=p.sourceName,E=p.displayName,g=b=void 0,y=(w=d.getField(m)).DH(),C=!1,w.cC()){for(b=w.y1,B=d.getField(b),N=0,I=o;N<I.length;N++)if(L[(A=I[N]).dimName]===b){g=B.D[A.pathStr],C=!0;break}y=C?(v[b]=g,[w.VXt[g]]):w.DH()}else if((0,X.ht)(v[m])){for(T=void 0,M=0,R=o;M<R.length;M++)if(A=R[M],(T=d.getField(r.QXt[A.dimName])).cC()&&T.y1===m){y=Y([],T.N[T.cx[A.pathStr]],!0);break}}else y=[v[m]];for(S=void 0,x=0,G=y;x<G.length;x++)V=G[x],D=w.M()[V],(l[m].isAll||l[m].items[D])&&(w.WXt[D]&&w.WXt[D]>f.calcLevel&&(S={fieldName:m,calcItem:V,calcLevel:w.WXt[D]}),o.push({pathStr:D,dimName:E}),et(t,i+1,n,e,r,o,a,s,c,u,l,S||f,h,v),S=void 0,o.pop());delete v[b]}else et(t,i+1,n,e,r,o,a,s,c,u,l,f,h,v);else if(p=r.ZXt(),U=o.length-u,k=r.nv(),j=yt(o),D=(0,J.getPathStr)(j,r.fieldNameOrders),O=void 0,W=(Q=gt(r,j,f,h,k)).value,wt((O=(0,K.YXt)(0)).calc,W),O.calcResult=Q.calcResult,(0,X.ht)(r.pathPool[D])||(k=r.pathPool[D],(0,X.ht)(r.wY[k][a])))for(t.addChildItem(o,O,k,r,a,n,e,s.rootPosition,u,!1,"",!1,0,t.UZt,c,!0),p.addChildItem(rt(o,u),O,k,r,a,n,e,s.headerPosition,U,!0,"",!1,0,p.UZt,c,!0),r.pathPool[D]=k,r.wY[k][a]=O,_=0,Z=h.subTotalTypes;_<Z.length;_++)F=Z[_],ot(r,j,H.SubtotalType[F],h.cacheName);else for(bt(r.wY[k][a],O.calc,h.subTotalTypes),P=0,z=h.subTotalTypes;P<z.length;P++)F=z[P],ot(r,j,H.SubtotalType[F],h.cacheName)}function bt(t,i,n){var e=t.calc,r=e.count,o=e.sum,a=e.product,s=e.max,c=e.min,u=e.sumx2,e=e.len,r=it(r,i.count,0),o=it(o,i.sum,0),a=it(a,i.product,2),s=it(s,i.max,5),c=it(c,i.min,6),u=it(u,i.sumx2,0),e=it(e,i.len,0);t.calc={count:r,sum:o,max:s,min:c,sumx2:u,product:a,len:e},t.calcResult=(0,K.BXt)(t.calc,n)}function rt(t,i){var t,i,t=Y([],t,!0),i=t.splice(0,i);return t.push.apply(t,i),t}function gt(t,i,n,e,r){for(var o,a,n,s,c,u,l,f,h,v,d,p,m,b,o=t.wXt,a=n.fieldName,n=n.calcItem,s={},c={},u=o.HXt,l=u.calcService,f=u.calcSource,h,v=o.zRt(a).sh[n].calcExpression,m=0,b=e.subTotalTypes;m<b.length;m++){d=b[m];try{p=H.SubtotalType[d],f.setCalcInfo(p,t,i,e.cacheName,v,r),c[p]=l.MX.evaluateExpression(v,f.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+c[p])&&(c[p]=0)}catch(t){c[p]=S.Errors.Reference}finally{s[p]=c[p]}}return{calcResult:s,value:c}}function wt(t,i){t&&(t.count=i.countNums,t.len=i.count,t.max=i.max,t.min=i.min,t.product=i.product,t.sum=i.sum,t.sumx2=i.sum2)}function ot(t,i,n,e){var i,r,o,i,a,o,r,i,r,i,i,r=t.wXt,o=t.fieldNameOrders,i=(0,J.getPathStr)(i,o),a,o=r.JXt[i];o&&(r=(i=r.HXt).calcService,(i=i.calcSource).setCalcInfo(n,t,o.pathInfo,e,o.expression),r=r.MX.evaluateExpression(o.expression,i.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+r)&&(r=0),(i=t.wY[o.calcResultIndex])&&i[e]&&(t.wY[o.calcResultIndex][e].calcResult[n]=r,wt(t.wY[o.calcResultIndex][e].calc,((i={})[n]=r,i))),ot(t,o.pathInfo,n,e))}function yt(t){for(var i,n,e,r,i={},n=0,e=t;n<e.length;n++)i[(r=e[n]).dimName]=r.pathStr;return i}function at(t){for(var i,n,e,r,o,a,s,c,u,i={},r=0,o=t;r<o.length;r++)if(n=(a=o[r]).isALL)i[a.sourceName]={isAll:a.isALL,items:null};else{for(e={},s=0,c=a.items;s<c.length;s++)e[u=c[s]]=1;i[a.sourceName]={isAll:a.isALL,items:e}}return i}function Ct(r,t){(0,X.o)(t,function(t){var i,n,e,i=r.Pq[t.sourceName],n=i;!1===i.qXt&&(t.databaseField=!1,t.dataFieldIndex=i.l,n=r.KXt(i.l)),i.cx&&(t.isGroupField=!0,e=(0,X.isEmptyObject)(n.P),t.getGroupItem=function(t){var t=e?t:n.D[t];return i.AQt[i.S(t)]})})}function Nt(t,i){for(var n,e,r,o,a,n=[],e=t.Pq,r=0,o=i.length;r<o;r++)(a=e[i[r].sourceName])&&(0,X.ht)(a.P)&&n.push(a.Zc);t.dot(n)}function It(t,i,n,e,r,o){var i,t,i=t.r$t(i,e,r),t=t.r$t(n,e,r);return o===H.SortType.desc?t-i:i-t}function At(t,i){this.NQt={},this.XXt=t,this.lp=i,this.NQt={}}function o(){}function v(t,i,n,e,r,o,a,s){this.QZt=0,this.$Xt=0,this._Xt={},this.oYt=[],this.lYt=i,this.nodeName=t,this.rYt=a,this.zZt=r,this.SYt=o,this.zXt=s,e||(this.HZt=n.nv())}A=this&&this.__assign||function(){return(A=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},Y=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(K,"__esModule",{value:!0}),K.QueryNode=K.DataAnalyzer=K.PivotSlicerCache=K.PivotQueryList=K.PivotSubtotalManager=K.BXt=K.t$t=K.YXt=K.GXt=K.i$t=K.ErrorsMap=K.EmptyValue=K.Separator=void 0,H=t("./src/pivot-interface.ts"),X=t("./src/pivot-util.ts"),S=t("CalcEngine"),J=t("./src/pivot-cache.ts"),i=t("Common"),t=t("./pivot-entry.ts"),i=new i.Common.ResourceManager(t.SR),u=i.getResource.bind(i),z=null,h=void 0,s=Math.min,c=Math.max,f=Math.sqrt,x=isNaN,K.Separator="-&-",K.EmptyValue=S.Errors.Null,D="gc-empty-value",r=[0,1,32,61,92,122,153,183,214,245,275,306,336,367,368],K.ErrorsMap={100:S.Errors.Calc,7:S.Errors.DivideByZero,29:S.Errors.Name,42:S.Errors.NotAvailable,0:S.Errors.Null,36:S.Errors.Number,23:S.Errors.Reference,99:S.Errors.Spill,15:S.Errors.Value},d=14,K.i$t=p=function(t,i){var n,e,r,o,a,s,c,n,n=i.calc;!(0,X.ht)(t)&&(0,X.jh)(t)?(e=n.count,r=n.sum,o=n.max,a=n.min,s=n.sumx2,c=n.product,n=n.len,e=it(e,1,0),r=it(r,t,0),o=it(o,t,5),a=it(a,t,6),s=it(s,it(t,t,2),0),c=it(c,t,2),n=it(n,t===u().blank?h:1,0),i.calc={count:e,sum:r,max:o,min:a,sumx2:s,product:c,len:n}):i.calc.len=it(i.calc.len,t===u().blank?h:1,0)},K.GXt=b=function(){return{calc:{len:z,count:z,sum:z,max:z,min:z,sumx2:z,product:z}}},K.YXt=y=function(t){if(!(0,X.ht)(t))return(0,X.jh)(t)?{calc:{len:1,count:1,sum:t,max:t,min:t,sumx2:t*t,product:t}}:t instanceof S.CalcError?{calc:{len:1,count:h,sum:t,max:t,min:t,sumx2:t,product:t}}:t===u().blank?{calc:{len:h,count:h,sum:h,max:h,min:h,sumx2:h,product:h}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},C=function(t,i){var i,n,e,r,o,a,s,c,i=i.calc,n,e,r,o,a,s,c;return t({sum:i.sum,count:i.count,max:i.max,min:i.min,sumx2:i.sumx2,product:i.product,len:i.len})},K.t$t=N=function(t){switch(t){case H.SubtotalType.average:return function(t){var i=t.sum,t=t.count;return i instanceof S.CalcError?i:it(i,t,3)};case H.SubtotalType.count:return function(t){var i;return t.len};case H.SubtotalType.countNums:return function(t){var i;return t.count};case H.SubtotalType.max:return function(t){var i;return t.max};case H.SubtotalType.min:return function(t){var i;return t.min};case H.SubtotalType.product:return function(t){var i;return t.product};case H.SubtotalType.stdDev:return function(t){var i,n,t,n,t,i,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,it(i,1,1),2),i=it(0,it(n,t,3),5),it(i,null,4))};case H.SubtotalType.stdDevp:return function(t){var i,n,t,n,t,i,i=t.count,n=t.sumx2,t=t.sum,n=it(it(i,n,2),it(t,t,2),1),t=it(i,i,2);if(!(0,X.ht)(n)||!(0,X.ht)(t))return i=it(0,it(n,t,3),5),it(i,null,4)};case H.SubtotalType.sum:return function(t){return t&&t.sum};case H.SubtotalType.varr:return function(t){var i,n,t,n,t,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,it(i,1,1),2),it(0,it(n,t,3),5))};case H.SubtotalType.varp:return function(t){var i,n,t,n,t,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,i,2),it(0,it(n,t,3),5))}}},I=function(t,i){return i(t)},m=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,a=t.showDataAs,s=o.baseMinorPath,c=o.baseMajorPath,u=o.percentOfBasePath,l=o.baseIndex;switch(a){case H.PivotShowDataAs.normal:return{baseIndex:-1};case H.PivotShowDataAs.percentOfTotal:return{baseIndex:n.n$t};case H.PivotShowDataAs.percentOfRow:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.zZt,!1)};case H.PivotShowDataAs.percentOfCol:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.SYt,!0)};case H.PivotShowDataAs.percent:case H.PivotShowDataAs.difference:case H.PivotShowDataAs.percentDiff:return{baseMinorPath:s,baseMajorPath:c};case H.PivotShowDataAs.percentOfParentRow:return{parentPath:r,minorPath:i.SYt};case H.PivotShowDataAs.percentOfParentCol:return{baseIndex:i.YAt>e?i.e$t:i.HZt};case H.PivotShowDataAs.percentOfParent:return-1<t.baseRootLevel?{percentOfBasePath:u,minorPath:i.SYt}:{baseIndex:l,percentOfBasePath:u};case H.PivotShowDataAs.runTotal:case H.PivotShowDataAs.percentOfRunningTotal:case H.PivotShowDataAs.rankAscending:case H.PivotShowDataAs.rankDescending:return{baseMinorPath:s,baseMajorPath:c};case H.PivotShowDataAs.index:return h=f=void 0,i.zEt?(f=n.n$t,h=n.n$t):(f=n.JZt(i.zZt,!1),h=n.JZt(i.SYt,!0),(0,X.ht)(f)&&(f=n.n$t),(0,X.ht)(h)&&(h=n.n$t)),{rowTotalIndex:f,colTotalIndex:h}}},T=function(t,i,n,e,r,o,a){var r,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,I,y,C,N,I,A,y,C,T,I,N,C,y,I,C,N,I,M,y,r=r.indexInfo,s=t.CZt[a];if(r&&(c=r.baseIndex,u=r.parentPath,l=r.minorPath,f=r.rowTotalIndex,h=r.colTotalIndex,v=r.baseMinorPath,d=r.baseMajorPath,p=r.percentOfBasePath,m=!1,s))switch(w=g=void 0,b=s.showDataAs){case H.PivotShowDataAs.normal:return t.r$t(n,i,e);case H.PivotShowDataAs.percentOfTotal:return g=t.r$t(n,i,e),w=t.r$t(t.n$t,i,e),x(+g)?g:x(+w)?w:0===w?S.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percentOfRow:case H.PivotShowDataAs.percentOfCol:return g=t.r$t(n,i,e),w=t.r$t(c,i,e),(0,X.ht)(g)&&(g=0),(0,X.ht)(w)||0===w?S.Errors.DivideByZero:x(+g)?g:x(+w)?w:g/w;case H.PivotShowDataAs.percentOfParentCol:return g=t.r$t(n,i,e),w=t.r$t(c,i,e),x(+g)?S.Errors.Value:x(+w)?w:0===w?S.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percent:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:(N=C=!(y=void 0),s.baseRootLevel>o?D:(I=t.WZt(v))?0===I.level&&s.isHeaderOfPercentOrDiff?D:(y=I.indexList[d],k(g=t.r$t(n,i,e))?g:(m=(0,X.ht)(g),y===n?m?D:1:(m&&(C=!1),(0,X.ht)(y)?K.EmptyValue:!s.isNextOrPrevious&&t.o$t(y,i)?S.Errors.NotAvailable:k(w=t.r$t(y,i,e))?w:((0,X.ht)(w)&&(N=!1),C?N?0===w?S.Errors.DivideByZero:g/w:D:K.EmptyValue)))):S.Errors.NotAvailable);case H.PivotShowDataAs.percentOfParentRow:return I=t.WZt(l).indexList[u],g=t.r$t(n,i,e)||0,w=t.r$t(I,i,e),k(g)||k(w)?S.Errors.Value:(0,X.ht)(w)?D:0===w?S.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percentOfParent:if((0,X.ht)(t.bXt[t.CZt[a].baseFieldName]))return S.Errors.NotAvailable;if(-1<s.baseRootLevel){if(!(y=t.WZt(l)))return S.Errors.NotAvailable;if(C=y.indexList[p],k(g=t.r$t(n,i,e)))return g;if(s.baseRootLevel+1>=o)return(0,X.ht)(g)?D:1;if(k(w=t.r$t(C,i,e)))return S.Errors.Value;if((0,X.ht)(w))return D}else if(g=t.r$t(n,i,e),w=t.r$t(c,i,e),(0,X.ht)(c))return x(+w)?D:S.Errors.Value;return 0===w?S.Errors.DivideByZero:g/w;case H.PivotShowDataAs.difference:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:(N=void 0,s.baseRootLevel>o?D:(I=t.WZt(v))?0===I.level&&s.isHeaderOfPercentOrDiff?D:(N=I.indexList[d],(g=t.r$t(n,i,e))instanceof S.CalcError?g:(0,X.ht)(N)||(A=t.o$t(N,i))&&!s.isNextOrPrevious?S.Errors.NotAvailable:(w=t.r$t(N,i,e))instanceof S.CalcError?w:(g=0*g!=0?0:g)-(w=0*w!=0?0:w)):S.Errors.NotAvailable);case H.PivotShowDataAs.percentDiff:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:(y=void 0,s.baseRootLevel>o?D:(C=t.WZt(v))?0===C.level&&s.isHeaderOfPercentOrDiff||(y=C.indexList[d])===n?D:k(g=t.r$t(n,i,e))?g:(0,X.ht)(g)?K.EmptyValue:(0,X.ht)(y)||!s.isNextOrPrevious&&t.o$t(y,i)?S.Errors.NotAvailable:k(w=t.r$t(y,i,e))?w:(0,X.ht)(w)?D:0===w?S.Errors.DivideByZero:(g-w)/w:S.Errors.NotAvailable);case H.PivotShowDataAs.runTotal:if((0,X.ht)(t.bXt[t.CZt[a].baseFieldName]))return S.Errors.NotAvailable;if(g=t.r$t(n,i,e),-1<s.baseRootLevel){if(o<s.baseRootLevel+1)return D}else if((T=t.WZt(l)).level>s.baseHeaderLevel+1)return g;return(0,X.ht)(g)&&(g=0),w=t.a$t(a,d,v),x(+w)||(x(+g)?w=g:w+=g,t.s$t(a,d,v,w)),w;case H.PivotShowDataAs.percentOfRunningTotal:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:-1<s.baseRootLevel&&o<s.baseRootLevel+1?D:(g=t.r$t(n,i,e),(0,X.ht)(g)&&(g=0),w=t.a$t(a,d,v),x(+w)?w:(x(+g)?w=g:w+=g,t.s$t(a,d,v,w),0===(I=t.u$t(a,d,v))||x(+I)?(t.s$t(a,d,v,S.Errors.DivideByZero),S.Errors.DivideByZero):w/I));case H.PivotShowDataAs.rankAscending:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:!(-1<s.baseRootLevel&&o<s.baseRootLevel+1)&&(N=t.r$t(n,i,e),C=t.c$t(a,d,v))?C[N]:D;case H.PivotShowDataAs.rankDescending:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?S.Errors.NotAvailable:!(-1<s.baseRootLevel&&o<s.baseRootLevel+1)&&(y=t.r$t(n,i,e),I=t.c$t(a,d,v))?I[y]:D;case H.PivotShowDataAs.index:return(g=t.r$t(n,i,e),C=t.r$t(t.n$t,i,e),N=t.r$t(f,i,e),I=t.r$t(h,i,e),0===g)?0:x(+g)?g:x(+C)?C:x(+N)?N:x(+I)?I:0==(y=N*I)?S.Errors.DivideByZero:(M=g*C)/y}},K.BXt=M=function(i,t){var n={};return(0,X.o)(t,function(t){n[H.SubtotalType[t]]=(0,K.t$t)(t)(i)}),n},P=function(t){return t===H.PivotShowDataAs.percentOfRunningTotal||t===H.PivotShowDataAs.rankAscending||t===H.PivotShowDataAs.rankDescending},l=function(t,i,n,e,r){var o,a,s,c,o=t.oYt,a=t.nodeName,s=r=void 0===r?"":r;if(n||(""!==s&&(s+=K.Separator),s+=a),(0,X.o)(o,function(t){l(t,i,!1,e,s)}),i[s]=t.HZt,!t.kYt&&e.MXt&&t.UZt)for(c in t.UZt)P(e.CZt[c].showDataAs)&&e.l$t(c,s,t.UZt[c].baseMinorPath)},$=function(t,i,n){var e,r,o,a,a,t,e=[];if(t.YAt<i&&0<t.oYt.length)for(r=0,o=t.oYt;r<o.length;r++)a=o[r],a=$(a,i,n).slice(0),e.push.apply(e,a);else if(t.YAt===i)return l(t,t={},!0,n),[t];return e},tt=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,o=t.f$t;for(a in o)if(o.hasOwnProperty(a))for(v in c=(s=t.CZt[a]).cacheName,u=s.subtotalText,l=s.showDataAs,f=o[a],h=e?n:f)h.hasOwnProperty(v)&&(d=void 0,p=i[a].baseMajorPath,d=e?f[v]||v:f[v],m=n[v],(0,X.ht)(m)||(l===H.PivotShowDataAs.percentOfRunningTotal?t.h$t(a,d,p,m,c,u):t.v$t(a,d,p,m,c,u)))},W=function(t,i,n,e,L,E,r,B,o){var n,R,a,s,c,u,G,l,f,h,v,d,p,m,b,g,w,y,C,V,U,N,Q,I,A,T,W,M,S,x,D,x,k,z,Z,j,O,Y,P,H,F,J,_,q,_,n,o,n=$(i,n,t),R=t.MXt;if(n&&1===n.length){if(o)for(a=st(t,i.zZt,n[0],B),s=0,c=e;s<c.length;s++)for(l=0,f=G=(u=c[s]).subTotalTypes;l<f.length;l++)for(h=f[l],v=0,d=a;v<d.length;v++)m={fieldInfos:(p=d[v]).fieldInfos,valueInfo:{sourceName:u.cacheName,subtotalType:h}},b=r.tQt(m),g=t.d$t(p.calcIndex),(0,X.ht)(b)||(i.p$t(h,g[u.cacheName].calc,b),i.p$t(h,g[u.cacheName].calcResult,b));t.m$t(i.zZt,{indexList:n[0],level:i.YAt,visible:i.jft,collapse:i.b$t,baseSubtotalInfo:i.UZt,parentPath:L}),R&&tt(t,i.UZt,n[0],!1,!1)}else{for(w={},V=[],U={},(0,X.o)(e,function(t){V.push(t.cacheName),U[t.cacheName]=t.isCalculatedField}),N=0,Q=n;N<Q.length;N++)for(A in I=Q[N])if(I.hasOwnProperty(A))for(w[A]||(w[A]={}),T=0,W=V;T<W.length;T++)M=W[T],y=(y=(S=(S=t.d$t(w[A]))||{})[M])||{},(C=t.d$t(I[A])&&t.d$t(I[A])[M])&&C.calc&&(y.calc?U[M]?(E.g$t(r,S,M),y.calc=S[M].calc):(x=y.calc,D=C.calc,y.calc={count:it(x.count,D.count,0),sum:it(x.sum,D.sum,0),max:it(x.max,D.max,5),min:it(x.min,D.min,6),sumx2:it(x.sumx2,D.sumx2,0),product:it(x.product,D.product,2),len:it(x.len,D.len,0)}):y.calc=C.calc),x=t.nv(),w[A]=x,S[M]=y,t.w$t(x,i.zZt,S);if(o)for(a=st(t,i.zZt,w,B),k=0,z=e;k<z.length;k++)for(j=(Z=z[k]).subTotalTypes,M=Z.cacheName,O=0,Y=j;O<Y.length;O++)for(h=Y[O],P=0,H=a;P<H.length;P++)m={fieldInfos:(p=H[P]).fieldInfos,valueInfo:{sourceName:M,subtotalType:h}},b=r.tQt(m),g=t.d$t(p.calcIndex),(0,X.ht)(b)||i.p$t(h,g[M].calc,b);for(A in w)if(w.hasOwnProperty(A))for(F=0,J=e;F<J.length;F++)j=(_=J[F]).subTotalTypes,M=_.cacheName,(_=(q=(q=t.d$t(w[A]))||{})[M]).collapse=t.o$t(t.yXt[A],M),_.calcResult=(0,K.BXt)(_.calc,j),_.hasEffectChild=!0;R&&tt(t,i.UZt,w,!0,i.zEt),n=i.jft,o=i.b$t,t.m$t(i.zZt,{indexList:w,level:i.YAt,visible:n,collapse:o,baseSubtotalInfo:i.UZt,parentPath:L})}},n.prototype.getFieldCalcItem=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,A,M,S,v,x,v,x,a=this,c=a.fieldNameOrders;if(!a.checkCalcInfo(t,n))throw new Error;for(l={},f=0,h=a.wXt,v=Object.keys(n),m=[],b=a.QXt,g=p=0,w=v;g<w.length;g++)l[y=w[g]]=n[y],u=n[y],s=h.getField(b[y]),(0,X.ht)(t[b[y]])?s.cC()&&(C=s.y1,m.push({groupName:y,originName:C})):u=s.y$t(t[b[y]]),s.WXt[u]&&(f++,a.fieldLabelItems[b[y]])&&!a.fieldLabelItems[b[y]][u]&&s.WXt[u]>p&&(d=s.sh[t[b[y]]].calcExpression,p=s.WXt[u]),l[y]=u;for(N=0,I=m;N<I.length;N++)T=(A=I[N]).groupName,A=A.originName,M=h.getField(A),S=void 0,s=h.getField(T),S=(0,X.ht)(l[b[A]])?t[A]:M.DH()[l[b[A]]],l[T]=s.AQt[s.VXt[S]];return d?(x=(v=h.HXt).calcService,(v=v.calcSource).setCalcInfo(e,a,l,r,d,o),x.MX.evaluateExpression(d,v.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):void 0!==(x=a.getCalcValueImp(l,e,r))?x:0<f&&(0,J.getPathStr)(n,c)!==(0,J.getPathStr)(l,c)?void a.wXt.setUntreatedNodeInfo(l,n,a.fieldNameOrders,i,o):0},n.prototype.checkCalcInfo=function(t,i){for(var n,t,e,r,o,a,s,c,u,u,l,f,h,n=this,t=Object.keys(t),e=this.QXt,r=Object.keys(i),o=n.wXt,a={},s=0,c=r;s<c.length;s++)u=c[s],(u=o.getField(e[u]))&&!(0,X.ht)(u.y1)&&(a[u.y1]=!0);for(l=0,f=t;l<f.length;l++)if(h=f[l],(0,X.ht)(i[e[h]])&&(0,X.ht)(a[h]))return!1;return!0},n.prototype.getCalcValueImp=function(t,i,n){var e,t,r,r,t,o,a,o,t,s,c,u,l,f,o,e=this,r=e.fieldNameOrders,t=(0,J.getPathStr)(t,r),r=e.pathPool[t];return(0,X.ht)(r)?(o=e.LXt,a=e.EXt,r=o[t],(0,X.ht)(r)?void 0:(t=(o=a[r].subtotal[n].calc).count,s=o.sum,c=o.max,u=o.min,l=o.sumx2,f=o.product,o=o.len,a[r].subtotal[n].calcResult=(0,K.BXt)({count:t,sum:s,max:c,min:u,sumx2:l,product:f,len:o},[H.SubtotalType[i]]),a[r].subtotal[n].calcResult[i])):(t=e.wY[r]&&e.wY[r][n])&&t.calcResult[i]},n.prototype.buildCalcItemInfo=function(t,i,n,e,r){var o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,o=this;for(R(o,i),o.pathPool=A({},t._Xt),o.LXt=t.LXt,o.EXt=t.EXt,a=o.C$t||{},s=[],u=c=0,l=r;u<l.length;u++)s[f=l[u]]=n[c],c++;for(o.fieldNameOrders=s,o.originOrders=Y([],n,!0),o.wXt.JXt={},o.fieldLabelItems={},o.QXt={},h=0,v=e;h<v.length;h++)if(d=v[h],o.QXt[d.displayName]=d.sourceName,o.QXt[d.sourceName]=d.displayName,a[d.sourceName]=!d.isHeader,!d.isALL){for(m={},b=0,g=p=d.items;b<g.length;b++)m[w=g[b]]=!0;o.fieldLabelItems[d.sourceName]=m}o.C$t=a},n.prototype.destroyCalcItemInfo=function(){var t=this;t.pathPool=null,t.LXt=null,t.EXt=null,t.fieldNameOrders=null,t.originOrders=null,t.fieldLabelItems=null,t.wXt.JXt=null},n.prototype.sf=function(t,i){var t,n,t=this.bXt[t]||t,n;return i&&i[t]||this.wXt.zRt(t).sf()},n.prototype.I$t=function(t,i,n){for(var e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,l,C,A,T,M,S,x,D,D,e=!1,r=[],o={},a={},s=0,c=0,u=t;c<u.length;c++)f=!1,v=-1,d=(l=u[c]).showDataAs,p=l.baseFieldItemType,m=l.baseFieldName,b=l.baseFieldItem,g=l.baseFieldItemShared,w=l.fieldName,y=l.cacheName,C=l.subtotalType,e=!(h=void 0),N=n.indexOf(m),I=i.indexOf(m),m&&(h=-1<I,v=n.concat(i).indexOf(m)+1),f=this.A$t(l),l=H.SubtotalType[C],C=d===H.PivotShowDataAs.percentOfParent,A=d===H.PivotShowDataAs.rankAscending||d===H.PivotShowDataAs.rankDescending,M=(T=d===H.PivotShowDataAs.runTotal||d===H.PivotShowDataAs.percentOfRunningTotal)||A,S=this.N$t(d,p),x=d===H.PivotShowDataAs.difference||d===H.PivotShowDataAs.percentDiff||d===H.PivotShowDataAs.percent,D=Math.pow(2,0),r.push(D={showDataAsIndex:D,needBuildBasePath:f,showDataAs:d,baseFieldItemType:p,isNextOrPrevious:S,baseFieldName:m,baseFieldItem:b,baseFieldItemShared:g,isDifferenceOrPercent:x,isRankShowDataAs:A,cacheName:y,isHeaderOfPercentOrDiff:h,subtotalText:l,baseRootLevel:N,baseHeaderLevel:I,fieldName:w,needBuildPercentOfPath:C,actualBaseLevel:v,needBuildRunningTotalOrRankPath:M}),this.CZt[w]=D,T&&(this.AXt[w]={}),A&&(this.MXt=!0,this.f$t||(this.f$t={}),this.f$t[w]={},this.TXt[w]={},a[y]||(a[y]=[]),a[y].push(w)),S&&((0,X.ht)(this.T$t)&&(this.T$t=[]),this.T$t.push(w)),d===H.PivotShowDataAs.percentOfRunningTotal&&(this.f$t||(this.f$t={}),this.f$t[w]={},this.NXt[w]={},this.MXt=!0,a[y]||(a[y]=[]),a[y].push(w));return this.M$t=o,this.x$t=a,this.D$t=e,r},n.prototype.N$t=function(t,i){var n;return(t===H.PivotShowDataAs.difference||t===H.PivotShowDataAs.percentDiff||t===H.PivotShowDataAs.percent)&&i!==H.PivotShowDataAsBaseItemType.item},n.prototype.l$t=function(t,i,n){this.f$t[t][i]=n},n.prototype.a$t=function(t,i,n){var t,i,t=this.AXt[t],i=i+"||"+n;return t[i]||(t[i]={val:0}),t[i].val||0},n.prototype.u$t=function(t,i,n){var e;return this.NXt[t][i+"||"+n].cursor},n.prototype.h$t=function(t,i,n,e,r,o){var e,r;this.o$t(e,r)||(e=this.r$t(e,r,o),this.NXt[t][r=i+"||"+n]||(this.NXt[t][r]={cursor:0}),this.NXt[t][r].cursor+=e)},n.prototype.s$t=function(t,i,n,e){var r;this.AXt[t][i+"||"+n].val=e},n.prototype.c$t=function(t,i,n){var i,n,i=i+"||"+n,n=this.TXt[t];return n[i]||(n[i]=0),n[i]},n.prototype.v$t=function(t,i,n,e,r,o){var e,r;this.o$t(e,r)||(e=this.r$t(e,r,o),this.TXt[t][r=i+"||"+n]||(this.TXt[t][r]={}),this.TXt[t][r][e]=1)},n.prototype.S$t=function(){var t,i,n,e,r;for(t in this.TXt)if(this.TXt.hasOwnProperty(t))for(r in i=this.TXt[t],e=(n=this.CZt[t].showDataAs)===H.PivotShowDataAs.rankAscending?1:-1,i)i.hasOwnProperty(r)&&(i[r]=(0,X.k$t)(i[r],e))},n.prototype.A$t=function(t){var i,t,n,i=t.showDataAs,t=t.baseFieldItemType,n=!1;return n=i!==H.PivotShowDataAs.percent&&i!==H.PivotShowDataAs.difference&&i!==H.PivotShowDataAs.percentDiff?n:t===H.PivotShowDataAsBaseItemType.item},n.prototype.j$t=function(t){this.Nkt=t,this.n$t=t.HZt,t.e$t=t.HZt},n.prototype.UXt=function(){return this.Nkt},n.prototype.O$t=function(t){this.yZt=t,this.P$t=t.HZt,t.e$t=t.HZt},n.prototype.m$t=function(t,i){this.IXt[t]=i},n.prototype.F$t=function(t,i,n){var e,r,o,a,e=this;if(e.RXt={columnNodeInfo:null,rowNodeInfo:null},!(0,X.ht)(i)&&0<Object.keys(i).length||n)e.RXt.columnNodeInfo={},e.RXt.rowNodeInfo={};else if(!(0,X.ht)(t)&&0<t.length)for(r=0,o=t;r<o.length;r++)if((a=o[r]).showDataAs!==H.PivotShowDataAs.normal)return e.RXt.columnNodeInfo={},void(e.RXt.rowNodeInfo={})},n.prototype.WZt=function(t){return this.IXt[t]},n.prototype.ZXt=function(){return this.yZt},n.prototype.nv=function(){var t=this.DU;return this.DU=t+1,t},n.prototype._$t=function(t){return this.D$t[t]},n.prototype.d$t=function(t){return this.wY[t]},n.prototype.r$t=function(t,i,n){return this.d$t(t)&&this.d$t(t)[i].calcResult&&this.d$t(t)[i].calcResult[n]},n.prototype.o$t=function(t,i){return this.d$t(t)&&this.d$t(t)[i].collapse},n.prototype.vZt=function(t,i,n,e,r,o){var e,e=this.CZt[o]?T(this,i,t,n,e,r,o):this.r$t(t,i,n);return e},n.prototype.JZt=function(t,i){return(i?this.CXt:this.yXt)[t]},n.prototype.L$t=function(t,i,n,e){e?this.w$t(t,i,n):this.E$t(t,i,n)},n.prototype.E$t=function(t,i,n){this.wY[t]=n,this.yXt[i]=t},n.prototype.B$t=function(t,i){this.wY[t]=i},n.prototype.w$t=function(t,i,n){this.wY[t]=n,this.CXt[i]=t},n.prototype.L0=function(){var t=this;t.wY=z,t.DU=0,t.yXt=z,t.CXt=z,t.Nkt=z,t.yZt=z,t.CZt=z,t.wXt=z,t.D$t=!1,t.R$t=z,t.bXt=z,t.AXt=z,t.NXt=z,t.TXt=z,t.M$t=z,t.T$t=z,t.x$t=z,t.G$t=z,t.V$t=z,t.f$t=z},Z=n,K.PivotSubtotalManager=Z,e.prototype.kXt=function(t,o,a){var s,i,n,s={},i=[];for(n in(0,X.o)(t,function(t,i){var n,e,t,r,n=t.cacheName,e=t.index,t=t.subTotalType;B(n,o)&&(t=H.SubtotalType.sum),s[e]?s[e].subTotalTypes.push(t):(s[e]={cacheName:n,index:e,subTotalTypes:[t],isCalculatedField:a},(r=o.Pq[n]&&!(0,X.isEmptyObject)(o.Pq[n].P)&&o.Pq[n].D&&0<o.Pq[n].D.length)&&(s[e].itemsKeyList=o.Pq[n].D))}),s)s.hasOwnProperty(n)&&i.push(s[n]);return i},e.prototype.OXt=function(t){for(var i,n,e,i={},n=0,e=t.length;n<e;n++)i[t[n].cacheName]=n;return i},e.prototype.L0=function(){var t=this;t._Xt=z,t.SXt=z,t.jXt=z,t.PXt=z,t.FXt=z,t.tx=z,t.DXt=z,t.xXt=z,t.sx=z},e.prototype.U$t=function(t,i,n,e,r){for(var o,a,s,c,u,l,f,u,n,o,a={},s=0,c=this.PXt;s<c.length;s++)l=(u=c[s]).cacheName,f=u.index,u=u.itemsKeyList,a[l]||(a[l]=r?(0,K.GXt)():(0,K.YXt)(u?u[t[f]]:t[f]));return n=[n],e?this.EXt.push({path:i,indexes:n,subtotal:a})-1:this.tx.push({path:i,indexes:n,subtotal:a})-1},e.prototype.addItem=function(t,i,n,e){for(var r,e,o,a,s,c,u,l,f,h,v,d,p,l,p,r,m,e,r=this.DXt,e=e&&e.Q$t||{},o=[],a=[],s=n?this.LXt:this._Xt,c=0,u=r;c<u.length;c++)f=(l=u[c]).fieldName,h=l.index,v=l.isGroupField,d=l.getGroupItem,p=l.databaseField,l=l.dataFieldIndex,p=!1===p?t[l]:t[h],v&&(p=d(p)),o.push(f+"&"+p),a.push(p);m=s[r=o.join(K.Separator)],e=!!e[i],(0,X.ht)(m)?s[r]=this.U$t(t,a,i,n,e):this.dRt(m,t,i,n,e)},e.prototype.dRt=function(t,i,n,e,r){var o,a,e,s,c,u,l,f,u,o,a=(e?this.EXt:this.tx)[t];if(a.indexes.push(n),e=this.PXt,!r)for(s=0,c=e;s<c.length;s++)l=(u=c[s]).cacheName,f=u.index,u=u.itemsKeyList,(0,K.i$t)(u?u[i[f]]:i[f],a.subtotal[l])},e.prototype.W$t=function(t){for(var i,n,e,r,o,i=this.sx,n=[],e=0,r=t.length;e<r;e++)o=t[e],(0,X.ht)(i[o])||n.push(i[o]);return n},e.prototype.z$t=function(t,i){var n=this;return t.map(function(t){return{pathStr:i[t],dimName:n.DXt[t].fieldName}})},e.prototype.out=function(t,i,n,e,r,o,a,L,E,s,B,R,c,u){var l,f,h,v,d,p,m,b,g,w,y,C,N,I,o,A,w,T,M,S,S,G,x,D,k,V,U,j,O,P,F,Q,_,_,W,l=this,f=new Z(this.tx.length,t),h=t.Z$t&&!t.Z$t.isEmpty(),v=new q("","",f,!1,"","",""),d=new q("","",f,!1,"","","");if(f.j$t(v),f.O$t(d),f.F$t(s,c,h),f.collapseItems=a,p=f.I$t(s,n,e),m=e.length,f.gXt=m,d.YAt=0,v.YAt=0,v.zEt=!0,v.jft=!1,d.jft=!1,d.zEt=!0,s&&0<s.length&&v.Y$t(f,p,m,"",{},0),b=this.W$t(i),g=this.W$t(n.concat(e)),w=o.valuePositionInfo,y=o.insertBlankLineAfterEachItem,C=o.grandTotalPosition,N=o.subTotalsPosition,I=o.valueFieldLength,o=z,o=w.positionIndex,A=w.positionType,w=w.display,M=T=-1,(1<(S=this.SXt.length)||1===S&&1<this.SXt[0].subTotalTypes.length)&&w&&(A===H.DataPosition.col&&0===(M=o)&&(d.eYt=!0),A===H.DataPosition.row)&&0===(T=o)&&(v.eYt=!0),this.H$t(v,d,b,g,r,u,T,M,f,m,p,a),S=l.PXt.concat(l.FXt),f.wXt.hasCalcItem(r)&&(f.buildCalcItemInfo(this,S,i,r,b),mt(f,r,u,{rootPosition:T,headerPosition:M},p,m,S,at(r)),f.destroyCalcItemInfo()),0<S.length&&(c&&0<Object.keys(c).length&&this.J$t(f,r,u,at(r),c,p,{rootPosition:T,headerPosition:M},g.length,S),vt(s)||h)&&dt(f,r,u,at(r),p,{rootPosition:T,headerPosition:M},g.length,S),G=this.jXt,k={},V={},U={},(D=!(x={}),X.o)(r,function(t){var i,n,e,t,r,o,e,i=t.displayName,n=t.sourceName,e=t.valueFilter,t=t.sortInfo;e&&(r=e.conditionBySourceName,o=e.condition,e=L[e.conditionByName],x[i]={valueFieldName:r,condition:o,subTotalType:e},D=!0),t&&t.sortValueFieldName&&(k[i]={subtotalText:t.sortValueSubtotalText,cacheName:t.cacheName,sortByPivotReferences:t.sortByPivotReferences,sortByHeader:t.sortByHeader,sortType:t.sortType}),U[V[i]=n]=i}),r=z,f.R$t=k,f.bXt=V,f.G$t=B,f.V$t=R,j={},D)for(P=O=void 0,F=0,Q=E;F<Q.length;F++)_=Q[F],_=x[P=U[_]],W=this.SXt[G[_&&_.valueFieldName]],(0,X.ht)(W)||(-1<(O=n.indexOf(P))?d:(O=e.indexOf(P),v)).q$t(W,P,_,j,O,f);return v.K$t(S,j,f,!1,m,"",l,t,h?{}:z),d.K$t(S,j,f,!0,n.length,"",l,t,h?{}:z,i),f.S$t(),d.X$t(n.length,{},{insertBlankLineAfterEachItem:y,grandTotalPosition:C,subTotalsPosition:N,valueFieldLength:I,valuePosition:M},!0,a,f),0===n.length&&(d.KZt=0,d.vYt=-1!==M?I:1,d.wYt=0,d.yYt=-1!==M?I:1,d.XZt=-1!==M?I:1,d.$Zt=-1!==M?I:1),d.qZt=n.length,v.X$t(b.length-n.length,{},{insertBlankLineAfterEachItem:y,grandTotalPosition:C,subTotalsPosition:N,valueFieldLength:I,valuePosition:T},!1,a,f),b.length-n.length==0&&(v.KZt=0,v.vYt=-1!==T?I:0,v.wYt=-1!==T?I:1,v.yYt=-1!==T?I:0,v.XZt=-1!==T?I:0,v.$Zt=-1!==T?I:1,0===I)&&(v.$Zt=0,v.wYt=0),f},e.prototype.H$t=function(u,l,f,h,v,d,p,m,b,g,w,t){var y,i,n,C,N,I,y=this,i=this.SXt.length,n=this.tx,C=Math.max(h.length-g,0),N=b.RXt;0<i?(I=this.PXt.concat(this.FXt),(0,X.o)(n,function(t,i){for(var n,e,r,o,a,s,c,n=0,e=I;n<e.length;n++)r=e[n].cacheName,o=t.path,s=(a=t.subtotal)[r],c=y.z$t(h,o),l.addChildItem(c,s,i,b,r,v,d,m,C,!0,"",!1,0,l.UZt,w,!1,N.columnNodeInfo),u.addChildItem(y.z$t(f,o),s,i,b,r,v,d,p,g,!1,"",!1,0,u.UZt,w,!1,N.rowNodeInfo)})):(0,X.o)(n,function(t,i){var t=t.path;l.addChildItem(y.z$t(h,t),null,i,b,void 0,v,d,m,C,!0,"",!1,0),u.addChildItem(y.z$t(f,t),null,i,b,void 0,v,d,p,g,!1,"",!1,0)})},e.prototype.J$t=function(t,i,n,e,r,o,a,s,c){for(var u,l,f,h,v,d,p,m,b,g,w,u=t.Nkt,l=t.RXt,f=0<t.gXt?l.rowNodeInfo:l.columnNodeInfo,h=[],v=[],d=0,p=i;d<p.length;d++)m=p[d],v.push(m.sourceName);for(b=0,g=c;b<g.length;b++)G(u,t,i,n,e,f,h,s,r,o,a,v,(w=g[b]).cacheName)},e.prototype.$$t=function(t,i){for(var n,e,r,o,a,s,n=this,e=n.tx,r=0,o=e.length;r<o;r++)s=(a=e[r]).subtotal,n.tti(t,s,i)},e.prototype.tti=function(t,i,n){for(var e,r,o,e=this,r=0,o=n.length;r<o;r++)e.g$t(t,i,n[r].cacheName)},e.prototype.g$t=function(t,i,n){var e,r,e,t,n,o,e=t.HXt,r=e.calcService,e=e.calcSource;e.setMeasureNode(i),n=(t=t.zRt(n)).iti;try{o=r.MX.evaluateExpression(n,e.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(t){o=S.Errors.Reference}i[t.Zc]={calc:{sum:o},calcResult:o}},g=e,K.PivotQueryList=g,At.prototype.dU=function(t){var i=this.NQt;(0,X.ht)(i[t])&&(i[t]=1)},At.prototype.destroy=function(){this.NQt=null},w=At,K.PivotSlicerCache=w,o.prototype.Lh=function(e,t,r){var o,a,s,t,o=!0,a=[],s=[];return(0,X.o)(t,function(t){var i,n,i,i=!t.isALL;o&&i&&(o=!1),i&&(Array.isArray(t.items[0])?(n=[],(0,X.o)(t.items,function(t){n=n.concat(t)}),a.push(n)):(i=e.zRt(t.sourceName))&&(a.push(i.getIndexesList(t.items)),r)&&s.push(i.getFilterIndexesList()))}),t=(0,X.amt)(a),s=(0,X.amt)(s),{isALL:o,indexes:t,filterIndexes:s}},o.prototype.nti=function(t,i,n,e){var r,o,i,a,s,a,c,u,l,f,h,v,d,p,m,b,r=i.isALL,o=i.indexes,i=i.filterIndexes;if(Nt(t,n),Ct(t,n),s=(a=t.eti(e)).normalFieldsInfos,a=a.calcFieldsInfos,c=[],u=new g(n,e,t,s,a),(0,X.o)(e,function(t){var t=t.index;-1===c.indexOf(t)&&c.push(t)}),f=(l=t.oQt).length,r)for(h=0;h<f;h++)u.addItem(l[h],h,!1,t);else{for(v=0,d=o;v<d.length;v++)p=d[v],u.addItem(l[p],p,!1,t);if(i&&0<i.length)for(m=0,b=i;m<b.length;m++)p=b[m],u.addItem(l[p],p,!0,t)}return 0<a.length&&u.$$t(t,a),u},o.prototype.TQt=function(t,i,n){var e,i,r,o,a,s,c,u,l,f,h,v,d,p,e,m,b,g,e=i.isALL,i=i.indexes,r=t.getField(n),o=t.oQt,a=o.length,s=r.lp,u=r.cC();if(u&&(l=this.rti(r.Zc,t),s=t.getField(r.y1).lp),f=new w(n,s),e)for(h=0;h<a;h++)c=u?r.AQt[l[h+""]]:o[h][s],f.dU(c);else for(v=0,d=i;v<d.length;v++)p=d[v],c=u?r.AQt[l[p+""]]:o[p][s],f.dU(c);if(0<(e=t.getCalcItems(n)).length)for(m=0,b=e;m<b.length;m++)g=b[m],p=r.P[g.calcItemName],f.dU(p);return f},o.prototype.rti=function(t,i){var n,e,r,o,a,s,c,u,l,f,h,n={},e=i.getField(t),r=e.A;if(!(0,X.ht)(r))for(a=0,s=o=Object.keys(r);a<s.length;a++)for(l=0,f=u=r[c=s[a]];l<f.length;l++)n[(h=f[l])+""]=e.N?e.cx[+c]:c;return n},K.DataAnalyzer=o,_=function(t,i){for(var n=i+1;n<t.length;n++)if(!t[n].b$t)return t[n];return z},L=function(t,i){for(var n=i-1;n<i&&0<=n;n--)if(!t[n].b$t)return t[n];return z},Q=function(t){for(var i,n,e,r,o,a,s,i=[],n=[],e=t.length,r=z,o=z,a=0,s=e-1;a<e;a++,s--)n[a]=r,r=t[a].b$t?r:a,i[s]=o,o=t[s].b$t?o:s;return{preMap:n,nextMap:i}},v.prototype.oti=function(t,i){var t;return this.YAt+1<=t?(""!==(t=this.zZt)&&(t+=K.Separator),t+i||""):this.zZt},v.prototype.ati=function(t,i){var t;return this.YAt+1>t?(""!==(t=this.SYt)&&(t+=K.Separator),t+i||""):this.SYt},v.prototype.sti=function(t,i,n,e,r,o){var a,o,a=this.nodeName;return(0,X.ht)(r.baseFieldName)||this.rYt!==r.baseFieldName||(a=o?this.rYt:r.baseFieldItemShared),o=e&&e.baseMajorPath?e.baseMajorPath:"",this.YAt<=n?(""!==o&&(o+=K.Separator),o+a||""):o},v.prototype.uti=function(t,i,n,e,r){var o,a,e,s,c,u,o=this.YAt,s=this.rYt;return e&&(u=e.childMajorPath||"",c=e.baseMajorPath||""),o<=n?(u&&""!==u?u+=K.Separator:u="",this.rYt!==r.baseFieldName&&(s=this.nodeName),e=o>r.baseRootLevel?(a=u+s,u+this.rYt):a=u+s,{currentMajorPath:a,childMajorPath:e}):{currentMajorPath:c,childMajorPath:u}},v.prototype.cti=function(t,i){var i,i=i&&i.baseMajorPathList?[].concat(i.baseMajorPathList):[];return this.YAt<=t&&""!==this.nodeName&&i.push(this.nodeName),i},v.prototype.lti=function(t,i,n){return!(0,X.ht)(i)&&t.length>=n&&(t[n]=i),t.join(K.Separator)},v.prototype.fti=function(t,i,n){return!(0,X.ht)(i)&&t.length>=n&&(t[n]=i),t.join(K.Separator)},v.prototype.hti=function(t,i,n){var e,e,r,o;return-1<i.baseRootLevel?(e=i.baseRootLevel+1,this.YAt<=e?this.zZt:t.percentOfBasePath):(e=i.baseHeaderLevel+1,o=r=void 0,{baseIndex:r=this.YAt<=e+n?this.HZt:t.baseIndex,percentOfBasePath:o=this.YAt<=e?this.zZt:t.percentOfBasePath})},v.prototype.vti=function(t,i,n,e,r,o){var a,o,a=this.nodeName;return(0,X.ht)(r.baseFieldName)||this.rYt!==r.baseFieldName||(a=o?this.rYt:r.baseFieldItemShared),o=e&&e.baseMinorPath?e.baseMinorPath:"",this.YAt>n?(""!==o&&(o+=K.Separator),o+a||""):o},v.prototype.dti=function(t,i,n,e,r){var o,a,e,s,c,u,o=this.YAt,s=this.rYt;return e&&(u=e.childMinorPath||"",c=e.baseMinorPath||""),n<o?(u&&""!==u?u+=K.Separator:u="",this.rYt!==r.baseFieldName&&(s=this.nodeName),e=o>r.baseHeaderLevel?(a=u+s,u+this.rYt):a=u+s,{currentMinorPath:a,childMinorPath:e}):{currentMinorPath:c,childMinorPath:u}},v.prototype.pti=function(t,i){var i,i=i&&i.baseMinorPathList?[].concat(i.baseMinorPathList):[];return this.YAt>t&&""!==this.nodeName&&i.push(this.nodeName),i},v.prototype.Tpi=function(t,i){for(var n,e,r,o,a,s,a,c,u,n=t.wXt,e="",r=i.length,o=0;o<r;o++)s=(a=i[o]).fieldName,a=a.items[0]+"",e+=(u=(c=n.getField(s)).M())[a],o!==r-1&&(e+=K.Separator);return e},v.prototype.addChildItem=function(t,i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m){var b,t,g,b,w,y,C,N,I,I,b,N,I;0<t.length?(b=t[0],t=t.slice(1),g=b.pathStr,b=b.dimName,w=0===t.length,y=l,N=a[b],(C=void 0,X.ht)(this._Xt[g])&&(""!==(I=this.lYt)&&(I+=K.Separator),this._Xt[g]=this.mti(g,I+g,e,w,c,g,u,b,p,N)),(C=this.oYt[this._Xt[g]]).pathStr=g,C.e$t=this.HZt,m&&C.YAt<=c&&((0,X.ht)(m.fieldName)&&(m.fieldName=C.rYt,m.level=C.YAt),m.itemKeys=m.itemKeys||{},I=m.itemKeys,(0,X.ht)(I[g])&&(I[g]={}),m=I[g]),C.YAt===s&&(C.eYt=!0),C.jft=f,C.b$t=C.bti(e.collapseItems,f),w?(C.kYt=!0,C.HZt=n,i&&void 0!==r&&(b=e.d$t(C.HZt),(0,X.ht)(b)&&(b={}),(0,X.ht)(b[r]))&&(b[r]={calc:A({},i.calc),calcResult:i.calcResult},e.B$t(C.HZt,b)),C.gti=n,d&&0<d.length&&(N=void 0,N=C.YAt<c||C.YAt===c&&(!C.oYt||C.oYt.length<1)?this.zZt:l,this.wti(e,c,d,u),C.wti(e,c,d,u),u?C.yti(e,d,c,N,v,this.QZt):C.Y$t(e,d,c,N,v,this.QZt))):(this.wti(e,c,d,u),C.wti(e,c,d,u),u||this.YAt<c&&(y=this.zZt),!u&&d?(this.Y$t(e,d,c,l,v,h),C.Y$t(e,d,c,y,v,this.QZt)):d&&u&&(this.yti(e,d,c,l,v,h),C.yti(e,d,c,y,v,this.QZt)),C.addChildItem(t,i,n,e,r,o,a,s,c,u,y,C.YAt!==c&&C.bti(e.collapseItems,f),this.QZt,C.UZt,d,p,m))):(this.kYt=!0,i&&void 0!==r&&(I=e.d$t(n),(0,X.ht)(I)&&(I={}),this.gti=n,I[r]={calc:i.calc,calcResult:i.calcResult},e.L$t(n,this.zZt,I,u)),this.gti=n,this.HZt=n),d&&0<d.length&&(u?this.yti(e,d,c,l,v,h):this.Y$t(e,d,c,l,v,h))},v.prototype.wti=function(t,i,n,e){n&&n.length&&this.YAt<=i&&(e?t.CXt[this.zZt]=this.HZt:t.yXt[this.zZt]=this.HZt)},v.prototype.Y$t=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,v,d,p,l,f,l,l,f,h,l,f,h;if(!this.UZt)for(this.UZt={},a=0,s=i;a<s.length;a++)u=(c=s[a]).fieldName,l=c.needBuildBasePath,f=c.needBuildPercentOfPath,h=c.needBuildRunningTotalOrRankPath,v=c.isNextOrPrevious,this.UZt[u]||(this.UZt[u]={}),d=this.UZt[u],p=r?r[u]:{},l&&(d.baseMajorPath=this.sti(t,u,n,p,c),d.baseMinorPath=this.vti(t,u,n,p,c),(0,X.ht)(c.baseFieldName)||this.rYt!==c.baseFieldName||c.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|o:this.QZt=this.QZt|c.showDataAsIndex),v&&(d.baseMajorPathList=this.cti(n,p),d.baseMinorPathList=this.pti(n,p)),f&&(-1<c.baseRootLevel?d.percentOfBasePath=this.hti(p,c,n):(f=(l=this.hti(p,c,n)).percentOfBasePath,l=l.baseIndex,d.baseIndex=l,d.percentOfBasePath=f)),h&&(c.showDataAs===H.PivotShowDataAs.rankAscending||c.showDataAs===H.PivotShowDataAs.rankDescending?(f=(l=this.uti(t,u,n,p,c)).currentMajorPath,h=l.childMajorPath,d.baseMajorPath=f,d.childMajorPath=h,f=(l=this.dti(t,u,n,p,c)).currentMinorPath,h=l.childMinorPath,d.baseMinorPath=f,d.childMinorPath=h):(d.baseMinorPath=this.vti(t,u,n,p,c,!0),d.baseMajorPath=this.sti(t,u,n,p,c,!0))),v||(d.indexInfo=m(c,this,t,n,e,d))},v.prototype.bti=function(t,i){var i;return!!i||(i=this,!!(t&&t[i.rYt]&&t[i.rYt][i.nodeName]))},v.prototype.yti=function(t,i,n,e,r,o){var a,s,c,u,l,f,h,v,d,p,v,d,l;if(!this.UZt)for(this.UZt={},a=0,s=i;a<s.length;a++)u=(c=s[a]).fieldName,l=c.needBuildRunningTotalOrRankPath,f=c.needBuildPercentOfPath,h=c.isNextOrPrevious,v=c.needBuildBasePath,this.UZt[u]||(this.UZt[u]={}),d=this.UZt[u],p=r?r[u]:{},v&&(d.baseMajorPath=this.sti(t,u,n,p,c),d.baseMinorPath=this.vti(t,u,n,p,c),(0,X.ht)(c.baseFieldName)||this.rYt!==c.baseFieldName||c.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|o:this.QZt=this.QZt|c.showDataAsIndex),l&&(this.UZt[u].baseMajorPath=this.sti(t,u,n,p,c,!0),this.UZt[u].baseMinorPath=this.vti(t,u,n,p,c,!0)),h&&(this.UZt[u].baseMajorPathList=this.cti(n,p),this.UZt[u].baseMinorPathList=this.pti(n,p)),f&&(-1<c.baseRootLevel?this.UZt[u].percentOfBasePath=this.hti(p,c,n):(d=(v=this.hti(p,c,n)).percentOfBasePath,l=v.baseIndex,this.UZt[u].baseIndex=l,this.UZt[u].percentOfBasePath=d)),h||(this.UZt[u].indexInfo=m(c,this,t,n,e,this.UZt[u]))},v.prototype.X$t=function(t,i,n,e,r,o,a,s,c,u,L,E){var l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,a,s,M,S,x,D,k,B,D,k,j,O,P,F,_,R,G,V,U,l=this,f=n.valuePosition,h=n.valueFieldLength;if(-1===f&&(h=1),l.Mpi(o,e),v=n.subTotalsPosition,d=this.Iti(o,e,a,s,c,u,L,E||0),0<l.oYt.length){for(A=I=N=C=y=w=g=b=m=p=0,T=l.oYt,a=l.Spi,M=(s=Q(l.oYt)).preMap,S=s.nextMap,x=T.length-1;0<=x;x--)D=T[M[x]],k=T[S[x]],D=(B=l.oYt[x]).X$t(t,i,n,e,r,o,D,k,l.oYt[x-1]||null,l.oYt[x+1]||null,d,this.QZt),(0,X.ht)(D)||(k=D.volume,j=D.subtotalVolume,O=D.blankRowVolume,P=D.topBlankRowVolume,F=D.titleRowCount,_=D.topSubtotalVolume,p+=k,b+=O,g+=P,w+=F,N+=R=D.tabularSubtotalVolume,I+=G=D.tabularTitleRowCount,C+=_,m+=j,y+=V=D.specialSubtotalVolume,A+=U=D.specialTopBlankVolume,D=z);l.YAt===t?(l.vYt=0,l.yYt=0,l.AYt=0,l.IYt=0,l.eYt?(l.KZt=h,l.wYt=1,l.AYt=1,l.IYt=1):(l.zEt?l.KZt=0:l.KZt=1,l.wYt=0,l.XZt=0,l.$Zt=0)):l.eYt?(l.yYt=h,l.KZt=p*h,l.vYt=(m+1)*h,l.AYt=(0===b?1:b)*h+(l.zEt?0:1),l.IYt=(0===g?1:g)*h,l.$Zt=I*h,l.XZt=(N+1)*h,l.wYt=(w+1)*h+(l.zEt?0:1)):f>l.YAt?(l.KZt=p,l.kpi=y,l.jpi=A,l.$Zt=I,l.yYt=C+h,l.vYt=m+h,l.AYt=b+(l.zEt?0:1),l.IYt=g,l.XZt=N+h,l.wYt=w+(l.zEt?0:1)):(l.KZt=p,l.AYt=b+(l.zEt?0:1),l.vYt=m+1,l.kpi=y,l.jpi=A,l.zEt||(1!==v||a?2===v&&a&&(l.vYt=m,l.YAt!==t-1)&&(l.AYt=b):(l.kpi=y+1,2<=t-l.YAt&&(l.jpi=A+1))),l.$Zt=I,l.XZt=N+1,l.wYt=w+(l.zEt?0:1),l.YAt===t-1?l.IYt=g+(l.zEt?0:1):l.IYt=g,-1===f&&l.zEt?l.yYt=C+1:l.yYt=0)}else l.zEt?l.KZt=0:f===t?(l.KZt=h,l.wYt=1):l.KZt=0===h?0:1,l.vYt=0,l.kpi=0,l.jpi=0,l.AYt=l.eYt?1:0,l.IYt=l.eYt?1:0,l.XZt=0,l.wYt=l.wYt||0,l.$Zt=0,l.yYt=0;return r&&r[l.rYt]&&r[l.rYt][this.nodeName]&&(l.KZt=0,l.vYt=0,l.AYt=f<t&&l.YAt<=f?h:1,l.IYt=f<t&&l.YAt<=f?h:1,l.$Zt=l.YAt<=f?h:1,l.wYt=l.YAt<=f?h+1:1,l.yYt=0,l.XZt=0,l.kpi=0,l.jpi=0),{volume:l.KZt||0,subtotalVolume:l.vYt,blankRowVolume:l.AYt,topBlankRowVolume:l.IYt||0,titleRowCount:l.wYt||0,topSubtotalVolume:l.yYt||0,tabularSubtotalVolume:l.XZt||0,tabularTitleRowCount:l.$Zt||0,specialSubtotalVolume:l.kpi||0,specialTopBlankVolume:l.jpi||0}},v.prototype.mti=function(t,i,n,e,r,o,a,s,c,u){var l,f,t,l,f,t=new v(t,i,n,e,this.oti(r,o),this.ati(r,o),s,c);return t.YAt=this.YAt+1,t.Spi=!!u,this.oYt.push(t)-1},v.prototype.p$t=function(t,i,n){switch(t){case H.SubtotalType.sum:i.sum=n;break;case H.SubtotalType.count:i.len=n;break;case H.SubtotalType.countNums:i.count=n;break;case H.SubtotalType.min:i.min=n;break;case H.SubtotalType.max:i.max=n}},v.prototype.K$t=function(O,P,F,_,L,t,E,B,R,G){var V,U,Q,V=this,U=this,Q=F.d$t(U.HZt);return U.Ati||(Q=Q||{},(0,X.o)(O,function(t){var i,n,t,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,T,S,x,D,k,j,i=t.cacheName,n=t.subTotalTypes,t=t.isCalculatedField,e=U.Nti(i,U.lYt,F,_).calc,r={};if(R)for(o=0,a=n;o<a.length;o++){for(s=a[o],c=[],u=0,l=Object.keys(R);u<l.length;u++)f=l[u],c.push({fieldName:f,fieldItem:R[f]});v=B.tQt(h={fieldInfos:c,valueInfo:{sourceName:i,subtotalType:s}}),(0,X.ht)(v)||(r[s]=v,U.p$t(s,e,v))}if(d=e.count,p=e.sum,m=e.max,b=e.min,g=e.sumx2,w=e.product,y=e.len,0<U.oYt.length){if(C=!1,t)E.g$t(B,Q,i),C=!!U.kYt,p=Q[i].calc.sum;else{for(N=F.bXt[U.oYt[0].rYt],I=U.oYt.length-1;-1<I;I--)(A=U.oYt[I]).Tti=I,A.kYt&&1===P[A.gti]?U.oYt.splice(I,1):(R&&(R[N]=B.getField(N).DH()[+A.pathStr]),M=(T=A.K$t(O,P,F,_,L,U.lYt,E,B,R,G)[i]).calc,T=T.hasEffectChild,C=C||T,!M||A.zXt&&!B.aggregateCalcItem()||(d=it(d,M.count,0),p=it(p,M.sum,0),w=it(w,M.product,2),m=it(m,M.max,5),b=it(b,M.min,6),g=it(g,M.sumx2,0),y=it(y,M.len,0)));R&&delete R[N]}if(_||V.xti(F,i,L,U.oYt),S=(0,K.BXt)({count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y},n),0<Object.keys(r).length)for(x=0,D=Object.keys(r);x<D.length;x++){switch(f=D[x],U.p$t(+f,e,v=r[f]),+f){case H.SubtotalType.sum:p=v;break;case H.SubtotalType.count:y=v;break;case H.SubtotalType.countNums:d=v;break;case H.SubtotalType.min:b=v;break;case H.SubtotalType.max:m=v}S[H.SubtotalType[+f]]=v}Q[i]={collapse:V.jft,hasEffectChild:C,calcResult:S,calc:{count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y}}}else{if(Q[i]=Q[i]||{},Q[i].collapse=V.jft,S=(0,K.BXt)({count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y},n),0<Object.keys(r).length)for(k=0,j=Object.keys(r);k<j.length;k++)f=j[k],S[H.SubtotalType[+f]]=r[f];Q[i].calcResult=S,Q[i].hasEffectChild=!!U.kYt}F.L$t(U.HZt,U.lYt,Q,_)}),_&&this.YAt<=L&&W(F,U,L,O,t,E,B,G,!!R),U.Ati=!0),Q},v.prototype.xti=function(t,i,n,e){0<e.length&&this.Dti(t,i,e)},v.prototype.Iti=function(t,i,n,e,r,o,a,s){var c,u,l,f,h,v,d,p,m,b,d,g,w,y,b,d,v;if(t){if(c=t.T$t){for(u={},l=0,f=c;l<f.length;l++)h=f[l],d=(v=t.CZt[h]).baseFieldItemType,p=v.baseHeaderLevel,m=v.baseRootLevel,b=v.actualBaseLevel,d!==H.PivotShowDataAsBaseItemType.item&&(d=d===H.PivotShowDataAsBaseItemType.next,w=g=void 0,y=i?p:b,i&&p+1===this.YAt||!i&&b===this.YAt?(d?(g=e&&e.nodeName,w=o&&o.nodeName,e?this.QZt=this.QZt|s:(this.QZt=this.QZt|v.showDataAsIndex,this.$Xt=this.$Xt|v.showDataAsIndex)):(g=n&&n.nodeName,w=r&&r.nodeName,n?this.QZt=this.QZt|s:(this.QZt=this.QZt|v.showDataAsIndex,this.$Xt=this.$Xt|v.showDataAsIndex)),u[h]=g):y<this.YAt&&a&&(g=a[h],u=a,this.QZt=this.QZt|s),b=g,(0,X.ht)(w)||(b=w),d=this.lti(this.UZt[h].baseMajorPathList||[],b,i?p:m),v=this.fti(this.UZt[h].baseMinorPathList||[],b,i?m:p),this.UZt[h].baseMajorPath=d,this.UZt[h].baseMinorPath=v,delete this.UZt[h].baseMajorPathList,delete this.UZt[h].baseMajorPathList,this.UZt[h].indexInfo={baseMajorPath:d,baseMinorPath:v});return u}return a}},v.prototype.Sti=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,f,e=t.M$t[i];if(e)for(r=0,o=e;r<o.length;r++)for(a=o[r],s=t.CZt[a].subtotalText,c=0,u=n;c<u.length;c++)h=(f=(l=u[c]).UZt[a]).baseMinorPath,f=f.baseMajorPath,t.v$t(a,f,h,l.HZt,i,s)},v.prototype.Dti=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m,p;if(0!==n.length&&(e=n[0].kYt,r=t.x$t[i]))for(o=0,a=r;o<a.length;o++)if(s=a[o],u=(c=t.CZt[s]).subtotalText,l=c.baseHeaderLevel,f=c.showDataAs,(e||!(-1<l))&&!(n[0].YAt<t.gXt))for(h=0,v=n;h<v.length;h++)m=(p=(d=v[h]).UZt[s]).baseMajorPath,p=p.baseMinorPath,f===H.PivotShowDataAs.percentOfRunningTotal?t.h$t(s,m,p,d.HZt,i,u):t.v$t(s,m,p,d.HZt,i,u)},v.prototype.Mpi=function(t,i){var n,e,r,o,a,s,c,u,r,l,f,h,v,n=this;if(n._Xt&&0!==n.oYt.length){if(e=[],r=n.oYt[0].rYt,o=t.R$t[r],a=t.G$t,s=t.V$t,c=t.bXt[r]||r,u=t.sf(r,a),r=s[c],o)return n.Mti(o,t,i,r);if(u){for(l=0,f=n.oYt;l<f.length;l++)e[u[v=(h=f[l]).nodeName]]=h;return r===H.SortType.desc&&e.reverse(),n.oYt=e.filter(function(t){return t}),e=null,delete n._Xt,!0}return!1}},v.prototype.Mti=function(t,r,o,a){var i,s,c,n,e,u,l,f,i=this,s=t.subtotalText;if(!s)return!1;if(c=t.cacheName,e=!1,(n=t.sortByPivotReferences)&&t.sortByHeader===o){u=a===H.SortType.asc;try{l=i.Tpi(r,n),o||(f=r.WZt(l).indexList),i.oYt.sort(function(t,i){var n,e,e=o?(n=r.WZt(t.zZt).indexList[l],r.WZt(i.zZt).indexList[l]):(n=f[t.zZt],f[i.zZt]);return n===h&&e===h?It(r,t.HZt,i.HZt,c,s,a):n===h?u?-1:1:e===h?u?1:-1:It(r,n,e,c,s,a)}),e=!0}catch(t){}}return e||i.oYt.sort(function(t,i){return It(r,t.HZt,i.HZt,c,s,a)}),delete i._Xt,!0},v.prototype.q$t=function(r,o,a,s,c,u){var t,i,l,n,e,f,h,v,d,p,m,b,g,w,y,C,N,I,A,T,M,S,x,D,D,x,k,j,O,P,e,f,t=this,n=null,e=!1,f=r.cacheName,h=0,v=0,d=[],p=0,m=-1/0,b=1/0,g=0,w=1;if(0<t.oYt.length)if(t.oYt[0].rYt===o&&(n=(i=a).condition,l=i.subTotalType,e=n.sn===H.PivotConditionType.top10),e){for(y=[],N=[],(C=void 0,X.o)(t.oYt,function(t,i){var t,n,t,e,t,t=t.q$t(r,o,a,s,c,u),n=t.calc,t=t.indexList;N.push({calc:n,indexList:t}),t=(e=(0,K.BXt)(n,[l]))[H.SubtotalType[l]],y.push({index:i,value:t})}),C=n.evaluate(y),I=t.oYt.length-1;-1<I;I--)if(C[I])h+=(A=N[I].calc).count,p=it(p,A.sum,0),w=it(w,A.product,2),m=it(m,A.max,5),b=it(b,A.min,6),g=it(g,A.sumx2,0),v+=A.len;else{for(T=0,M=N[I].indexList;T<M.length;T++)S=M[T],s[S]=1;t.oYt.splice(I,1)}N=z}else for(I=t.oYt.length-1;-1<I;I--)if((x=t.oYt[I]).kYt&&1===s[x.gti])t.oYt.splice(I,1);else if(A=(D=x.q$t(r,o,a,s,c,u)).calc,D=D.indexList,0!==x.oYt.length||x.kYt){if(!(t.YAt<c)&&D&&A){if(x=!0,n&&(j=(k=(0,K.BXt)(A,[l]))[H.SubtotalType[l]],x=i.condition.evaluate(j),k=z),x)h+=A.count,p=it(p,A.sum,0),w=it(w,A.product,2),m=it(m,A.max,5),b=it(b,A.min,6),g=it(g,A.sumx2,0),v+=A.len,d=d.concat(D);else{for(O=0,P=D;O<P.length;O++)S=P[O],s[S]=1;t.oYt.splice(I,1)}A=D=z}}else t.oYt.splice(I,1);else if(t.kYt)return e=u.d$t(t.HZt)[f].calc,f=!0,n&&(j=(k=(0,K.BXt)(e,[l]))[H.SubtotalType[l]],f=i.condition.evaluate(j),k=z),f?{calc:e,indexList:[t.gti]}:(s[t.gti]=1,z);return{calc:{count:h,sum:p,product:w,max:m,min:b,sumx2:g,len:v},indexList:d}},v.prototype.Nti=function(t,i,n,e){var r,o,a,s,c,u,l,f,r=n.d$t(this.HZt);return(r=r||{})[t]&&this.kYt||(f=l=u=c=s=a=o=z,r[t]={calc:{count:o,sum:s,max:u,min:u,sumx2:f,product:o,len:s}}),n.L$t(this.HZt,i,r,e),r[t]},v.prototype.kti=function(t,i,n){var e,i,r,o,a,e=z,i=i[t.rYt];return e=i?{valueFieldName:r=i.conditionBySourceName,condition:o=i.condition,subTotalType:a=n[i.conditionByName]}:e},v.prototype.jti=function(){var n={};(0,X.o)(this.oYt,function(t,i){n[t.nodeName]=i}),this._Xt=n},q=v,K.QueryNode=q},"./src/overwrite-list.ts":function(t,i,n){var a,e;function r(){var t=this;t.Oti=[],t.Pti=[]}Object.defineProperty(i,"__esModule",{value:!0}),i.OverwriteList=void 0,a=n("./pivot-entry.ts"),r.prototype.setOverwriteNode=function(t,i){var n,e,t,n=this;"number"==typeof i&&(e=n.getOverwriteNode(t),(0,a.ht)(e)?(n.Oti.push((0,a.RF)(t)),n.Pti.push(i)):(t=n.Oti.indexOf(e),n.Pti[t]=i))},r.prototype.getOverwriteValue=function(t){var n,e,r,o,n=this,e=t.fieldInfos,r=t.valueInfo;return(0,a.o)(n.Oti,function(t,i){if(n.Fti(e,t.fieldInfos)&&n._ti(r,t.valueInfo))return o=n.Pti[i],!0}),o},r.prototype.getOverwriteNode=function(t){var i,n,e,r,i=this,n=t.fieldInfos,e=t.valueInfo;return(0,a.o)(i.Oti,function(t){if(i.Fti(n,t.fieldInfos)&&i._ti(e,t.valueInfo))return r=t,!0}),r},r.prototype.removeOverwriteNode=function(t){var i,t,t,i=this,t=i.getOverwriteNode(t);(0,a.ht)(t)||(t=i.Oti.indexOf(t),i.Oti.splice(t,1),i.Pti.splice(t,1))},r.prototype.getOverwriteList=function(){for(var t,i,n,e,r,t=this,i=[],n=t.Oti,e=0;e<n.length;e++)r=(0,a.RF)(n[e]),i.push({fieldInfos:r.fieldInfos,valueInfo:r.valueInfo,value:t.Pti[e]});return i},r.prototype.toJSON=function(){return this.isEmpty()?null:this.getOverwriteList()},r.prototype.fromJSON=function(t){var e=this;e.reset(),t&&0<t.length&&(0,a.o)(t,function(t){var i=t.fieldInfos,n=t.valueInfo,t=t.value;e.setOverwriteNode({fieldInfos:i,valueInfo:n},t)})},r.prototype.isEmpty=function(){return!this.Pti||0===this.Pti.length},r.prototype.reset=function(){this.Oti=[],this.Pti=[]},r.prototype.dispose=function(){this.Oti=null,this.Pti=null},r.prototype.Lti=function(t){return t&&t.sort(function(t,i){return t.fieldName===i.fieldName?t.fieldItem>i.fieldItem?1:-1:t.fieldName>i.fieldName?1:-1})},r.prototype.Fti=function(t,i){var n,e,r,o,a,n=this.Lti(t),e=this.Lti(i);if(!n||!e||n.length!==e.length)return!1;for(r=0;r<n.length;r++)if(o=n[r],a=e[r],o.fieldName!==a.fieldName||o.fieldItem!==a.fieldItem)return!1;return!0},r.prototype._ti=function(t,i){return t&&i&&t.sourceName===i.sourceName&&t.subtotalType===i.subtotalType},i.OverwriteList=r},"./src/pivot-cache.ts":function(p,t,i){var M,z,n,T,Z,S,c,e,Y,g,H,i,x,r,h,b,k,w;function o(t){return t instanceof Date?(0,Z.formatDateToString)(t):isNaN(t)?t:""+t}function y(t,i){var n;switch(t){case"b":n=i?"1":"0";break;case"d":n=(0,Z.kQt)(new Date(i));break;case"e":n=i._calcError;break;default:n=i}return(0,Z.xmlEncode)(n)}function a(t){var i=this;i.W5=t.dataType,i.Zc=o(t.name),i.k={},i.W5!==T.PivotDataType.number&&(i.P={}),i.ty=[],i.Eti={},i.sh={},i.D=[],i.lp=t.index,i.WXt={},i.Bti={}}function d(t,i,n){var e=[];for(e.push({type:"s",value:"&lt;"+t});t-1+n<=i;)e.push({type:"s",value:t+Z.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({type:"s",value:t+Z.NUMBER_GROUP_SEPARATOR+(t-1+n)}),e.push({type:"s",value:"&gt;"+(t+=n)}),e}function j(t,i,n,e){var r,o;for(n&&n[0]===z.LESS+(0,Z.formatDateToString)(t)?(n[0]="&lt;"+(0,Z.formatDateToString)(t),e.autoStart=!1):n.unshift("&lt;"+(0,Z.formatDateToString)(t)),n&&n[n.length-1]===z.MORE+(0,Z.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,Z.formatDateToString)(i),e.autoEnd=!1):n.push("&gt;"+(0,Z.formatDateToString)(i)),r=[],o=0;o<n.length;o++)r.push({type:"s",value:n[o]});return r}function O(t,i,n){var e,r,o,a,s,c,u,e=t.N,r=n.fieldGroup.groupItems=[],o={},a=n.fieldGroup.discreteGroup=[];for(s in e)e.hasOwnProperty(s)&&(r.push({type:"s",value:s}),o[s]=r.length-1);for(c=0;c<i.D.length;c++)u=i.D[c],a.push(o[t.VXt[u]])}function P(t,i,n){var e=[];for(e.push({n_:"s",v:"&lt;"+t});t-1+n<=i;)e.push({n_:"s",v:t+Z.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({n_:"s",v:t+Z.NUMBER_GROUP_SEPARATOR+(t-1+n)}),e.push({n_:"s",v:"&gt;"+(t+=n)}),e}function F(t,i,n,e){var r,o;for(n&&n[0]===z.LESS+(0,Z.formatDateToString)(t)?(n[0]="&lt;"+(0,Z.formatDateToString)(t),e.autoStart="0"):n.unshift("&lt;"+(0,Z.formatDateToString)(t)),n&&n[n.length-1]===z.MORE+(0,Z.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,Z.formatDateToString)(i),e.autoEnd="0"):n.push("&gt;"+(0,Z.formatDateToString)(i)),r=[],o=0;o<n.length;o++)r.push({n_:"s",v:n[o]});return r}function _(t,i){var n,e,r,o,a,s,c,n=t.N,e=[],r={},o=[];for(a in n)n.hasOwnProperty(a)&&(o.push({n_:"s",v:a}),r[a]=o.length-1);for(s=0;s<i.D.length;s++)c=i.D[s],e.push({n_:"x",v:r[t.VXt[c]]});return{discreteGroup:o,discretePrs:e}}function m(t,i,n,e){var t;(0,Z.ht)(e[i.Zc+n])&&(t=t.push({cacheName:i.Zc,index:i.lp,dataFieldIndex:i.l,subTotalType:n})-1,e[i.Zc+n]=t)}function s(t,i,n,e){var r,t,r=this;r.oQt=n?new Array(n.length):[],r.Zc=t,r.Rti=i,r.Pq={},r.Gti=0,r.EYt=e,r.Vti=0,r.lw=!0,i&&n&&(t=i.map(function(t){return r.Uti(t)}),r.uut(t,n)),r.SMt()}function J(t,i){var n,e,r,o,a,s,c,u,l;if(t){for(n=0,e=t;n<e.length;n++)r=e[n],o=K((0,Z.xmlDecode)(r.name)),(0,Z.ht)(o)||!i[o]||(0,Z.ht)(r.lp)||(i[o].lp=r.lp);for(s=[],c=0,u=a=Object.keys(i);c<u.length;c++)l=u[c],s.push(i[l]);s.sort(function(t,i){return t.lp-i.lp}),s.forEach(function(t,i){t.lp=i})}}function C(t,i){var n,e,r,o,a,s,n=t.Pq;for(e in i)if(i.hasOwnProperty(e)&&n[e]&&(r=n[e])&&(0,Z.ht)(r.P))for(r.k={},r.P={},r.D=[],o=t.oQt,a=r.lp,s=0;s<o.length;s++)o[s][a]=r.aQt(o[s][a],s,!1)}function u(t){switch(t){case"b":return T.PivotDataType.boolean;case"d":return T.PivotDataType.date;case"e":return T.PivotDataType.errorValue;case"m":return T.PivotDataType.noValue;case"n":return T.PivotDataType.number;case"s":return T.PivotDataType.string;default:return}}function L(t){var t=t.n_;return"s"===t?T.PivotDataType.string:"n"===t?T.PivotDataType.number:"d"===t?T.PivotDataType.date:"b"===t?T.PivotDataType.boolean:"e"===t?T.PivotDataType.errorValue:"m"===t?T.PivotDataType.noValue:void 0}function N(t){switch(t){case T.PivotDataType.boolean:return"b";case T.PivotDataType.date:return"d";case T.PivotDataType.errorValue:return"e";case T.PivotDataType.noValue:return"m";case T.PivotDataType.number:return"n";case T.PivotDataType.string:return"s";default:return"n"}}function I(t,i){var n=typeof t;return void 0===t?"m":"boolean"==n?"b":"number"==n?"n":"string"==n?"d"!==i||isNaN(Date.parse(t))?"s":"d":"e"}function E(n,t){var e,i,e={};for((0,Z.o)(Object.keys(n),function(t){for(var i=0;i<n[t].length;i++)e[n[t][i]]=1}),i=0;i<t.length;i++)(0,Z.ht)(e[t[i]])&&(n[t[i]]=[t[i]])}function l(t,i,n,e){var r=this;r.T=t,r.gd=i,r.groupItemsIndexMap={},r.groupItemsKeyIndexes={},"number"===e?((0,Z.ht)(t)||(0,Z.ht)(n)?r.Qti=i:r.Qti=t+Math.ceil((i-t)/n)*n,R(r,n,t,r.Qti)):B(r,n,t,i),r.Rs=n,r.type=e,r.name=this.getName(n)}function f(t,i){for(var n,e,r,o,n="",e=0,r=i;e<r.length;e++)n&&(n+="-&-"),n=(n=n+(o=r[e])+"&")+t[o];return n}function B(t,i,n,e){var r,o,a,s,c,u,l,f,h,r=x().dateResource,o=r.HOUR_GROUP_ITEMS.slice(),a=r.MINUTE_GROUP_ITEMS.slice(),s=r.SECOND_GROUP_ITEMS.slice();switch(i){case T.DateGroupType.seconds:t.groupItemsKeyList=s;break;case T.DateGroupType.minutes:t.groupItemsKeyList=a;break;case T.DateGroupType.hours:t.groupItemsKeyList=o;break;case T.DateGroupType.days:t.groupItemsKeyList=(0,Z.Wti)();break;case T.DateGroupType.months:t.groupItemsKeyList=(0,Z.zti)();break;case T.DateGroupType.quarters:t.groupItemsKeyList=(0,Z.Zti)();break;case T.DateGroupType.years:if(n&&e){for(c=[],u=n.getFullYear(),l=e.getFullYear(),f=u;f<=l;f++)c.push((0,z.Yti)(f));t.groupItemsKeyList=c}break;default:t.groupItemsKeyList=[]}for(n&&t.groupItemsKeyList.unshift(z.LESS+(0,Z.formatDateToString)(n)),e&&t.groupItemsKeyList.push(z.MORE+(0,Z.formatDateToString)(e)),f=0;f<t.groupItemsKeyList.length;f++)h=t.groupItemsKeyList[f],t.groupItemsIndexMap[h]=[],t.groupItemsKeyIndexes[h]=f}function R(t,i,n,e){var r,o,a;for(t.groupItemsKeyList=[],t.groupItemsKeyList.push(z.LESS+n),r=n;r<e;)t.groupItemsKeyList.push(r+"-"+(r+i-1)),r+=i;for(t.groupItemsKeyList.push(z.MORE+e),o=0;o<t.groupItemsKeyList.length;o++)a=t.groupItemsKeyList[o],t.groupItemsIndexMap[a]=[],t.groupItemsKeyIndexes[a]=o}function G(t,i,n,e){var r,o,a,s,c;if(!(n-i<=0||e<=0)){for(r=t.k,o=t.D,a=t.P,(0,Z.ht)(i)&&(i=t.T||V(t.D),t.rCi=!0),(0,Z.ht)(n)&&(n=t.gd||U(t.D),t.oCi=!0),t.T=i,t.gd=n,t.Rs=e,t.y1=t.Zc,s=new w(i,n,e,"number"),t.Qti=s.Qti,c=0;c<o.length;c++)s.insertIndexToIndexMap(o[c],r[(0,Z.isEmptyObject)(a)?""+o[c]:a[""+o[c]]]);t.cx=s.groupItemsKeyList,t.A=s.groupItemsIndexMap,t.AQt=s.groupItemsKeyIndexes,t.uQt()}}function V(t){for(var i,n,e,i=+t[0],n=1,e=t.length;n<e;n++)i=Math.min(i,+t[n]);return i}function U(t){for(var i,n,e,i=+t[0],n=1,e=t.length;n<e;n++)i=Math.max(i,+t[n]);return i}function Q(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e;n++)i=i<t[n]?i:t[n];return new Date(i)}function W(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e;n++)i=i>t[n]?i:t[n];return new Date(i)}function A(t,i,n){return(0,Z.ht)(n)?(n=1,t.zRt(i)?t.zRt(i+n)?void 0:i+n:i):A(t,i,n+1)}function X(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m;if(n){for(n.sort(function(t,i){return t.by-i.by}),e=[],a=0;a<n.length;a++){if(s=n[a].start,c=n[a].end,u=n[a].by,(0,Z.ht)(s)&&(s=(0,Z.ht)(r)?r=i.T||Q(i.D):r),(c=(0,Z.ht)(c)?(0,Z.ht)(o)?o=i.gd||W(i.D):o:c)<=s)return;e.push(new w(s,c,u,"date"))}for(l=i.k,f=i.D,h=i.P,v=0,d=i.D.length;v<d;v++)for(p=0;p<e.length;p++)e[p].insertIndexToIndexMap(i.D[v],l[h[f[v]]]);for(i.cx=e[0].groupItemsKeyList,i.A=e[0].groupItemsIndexMap,i.AQt=e[0].groupItemsKeyIndexes,i.T=e[0].T,i.gd=e[0].gd,n[0].start===H&&(i.rCi=!0),n[0].end===H&&(i.oCi=!0),i.Rs=e[0].Rs,i.y1=i.Zc,i.uQt(),i.nZt=[],p=1;p<e.length;p++)(m=new b({dataType:i.W5,name:A(t,e[p].name)})).cx=e[p].groupItemsKeyList,m.A=e[p].groupItemsIndexMap,m.AQt=e[p].groupItemsKeyIndexes,m.T=e[p].T,m.gd=e[p].gd,n[p].start===H&&(m.rCi=!0),n[p].end===H&&(m.oCi=!0),m.Rs=e[p].Rs,m.y1=i.Zc,m.qXt=!1,m.l=i.lp,m.uQt(),i.nZt.push(m.Zc),t.addField(m)}}function q(t){switch(t){case"seconds":return T.DateGroupType.seconds;case"minutes":return T.DateGroupType.minutes;case"hours":return T.DateGroupType.hours;case"days":return T.DateGroupType.days;case"months":return T.DateGroupType.months;case"quarters":return T.DateGroupType.quarters;case"years":return T.DateGroupType.years}}function D(t){switch(t){case T.DateGroupType.seconds:return"seconds";case T.DateGroupType.minutes:return"minutes";case T.DateGroupType.hours:return"hours";case T.DateGroupType.days:return"days";case T.DateGroupType.months:return"months";case T.DateGroupType.quarters:return"quarters";case T.DateGroupType.years:return"years"}}function K(t){var i,n,i=/_x00[0-1][0-9A-Fa-f]_/;return(0,Z.ht)(t)||t.match(i)===g?t:t.replace(n=/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(t,i,n){var e=0;return n&&(e=parseInt(n,16)),i?"_x00"+n+"_":String.fromCharCode(e)}).replace(/(\r)+\n/g,"\r\n")}function $(t){var i=g;switch(t){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15;break;case"#SPILL!":i=99}return i!==g?{_error:t,_code:i}:g}function v(t,i){if("s"===t||"string"===t)return K(i);var n;if("n"===t||"number"===t)return n=parseFloat(i),isNaN(n)?H:n;if("d"===t||"date"===t)return K(i);if("b"===t||"boolean"===t){if("1"===i||"t"===i)return!0;if("0"===i||"f"===i)return!1}return"e"===t||"errorValue"===t?$(i):"m"===t||"noValue"===t?null:"x"===t?parseInt(i,10):i}M=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),t.io=t.getPathStr=t.PivotCache=t.PivotCacheField=void 0,z=i("./pivot-entry.ts"),n=i("Common"),T=i("./src/pivot-interface.ts"),Z=i("./src/pivot-util.ts"),S=i("CalcEngine"),c=i("./src/pivot-sort.ts"),e=i("./src/pivot-calc-engine.ts"),Y=i("./src/overwrite-list.ts"),g=null,H=void 0,i=new n.Common.ResourceManager(z.SR),x=i.getResource.bind(i),r=n.Common.CultureManager,h=n.Common.kh,a.prototype.addCalcItem=function(t,i){var n,e,r,o,a,n=this,e=n.D,r=e.indexOf(t);r<0&&(r=e.push(t)-1),(o=n.k)[r]=[],(a=n.P)[t]=r,n.WXt[r]=i,n.uQt()},a.prototype.hasCalcItem=function(){return!!this.ty.length},a.prototype.cC=function(){return!!this.y1},a.prototype.up=function(){return this.ty.concat()},a.prototype.removeCalcItem=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,i=this,n=i.D,e=n.indexOf(t);if(!(e<0)){for(n.splice(e,1),delete(r=i.k)[e],a=0,s=o=Object.keys(r);a<s.length;a++)e<(u=+(c=s[a]))&&(r[u-1]=r[c]);for(delete(l=i.WXt)[e],v=0,d=f=Object.keys(l);v<d.length;v++)e<(h=+(p=d[v]))&&(l[h-1]=l[h],delete l[h]);for(delete(m=i.P)[t];e<n.length;e++)m[n[e]]--;i.uQt()}},a.prototype.y$t=function(t){var i,n,i,n;return this.P[t]},a.prototype.Hti=function(t){return this.W5!==T.PivotDataType.date||(0,Z.ht)(t)?t:(0,Z.kQt)(t)+""},a.prototype.Jti=function(t,i){var n=this;if(n.W5!==T.PivotDataType.number)return n.aQt(t,i);n.qti(t,i)},a.prototype.Kti=function(t){return(0,Z.ht)(t)||t===x().blank},a.prototype.Xti=function(t,i){var n,e,r,o,a,s,c,n,u,l,n=this,e=n.W5,r=n.D,o=n.P,a=o&&0<o.length,c=x().blank;if(r&&0<r.length){for(n=n.Kti(r[0]),u=0;u<r.length;u++)"number"==typeof(l=a?o[r[u]]:r[u])?(t.containsNumber=!0,isFinite(l)&&Math.floor(l)===l||(s=!1),(0,Z.ht)(t.minValue)?t.minValue=l:t.minValue=Math.min(l,t.minValue),(0,Z.ht)(t.maxValue)?t.maxValue=l:t.maxValue=Math.max(l,t.maxValue)):e===T.PivotDataType.date?"string"!=typeof l||isNaN(Date.parse(l))?(0,Z.ht)(l)||l===c||(t.containsNonDate=!0):(t.containsDate=!0,(0,Z.ht)(t.minDate)?t.minDate=l:t.minDate=Date.parse(l)<Date.parse(t.minDate)?l:t.minDate,(0,Z.ht)(t.maxDate)?t.maxDate=l:t.maxDate=Date.parse(l)>Date.parse(t.minDate)?l:t.maxDate):"string"==typeof l&&l!==c&&(t.containsString=!0),!(0,Z.ht)(l)&&l!==c||(t.containsBlank=!0);!0===t.containsNumber&&!1!==s&&(t.containsInteger=!0),(e!==T.PivotDataType.string||n)&&(0,Z.ht)(t.containsString)&&(t.containsString=!1),e===T.PivotDataType.date&&(0,Z.ht)(t.containsNonDate)&&(t.containsNonDate=!1)}},a.prototype.$ti=function(t,i){var n,e,r,o,a,s,i,c,n=this,e=i.containsString,r=i.containsNumber,o=i.containsDate,a=i.containsBlank,s=i.containsError,i=i.containsBool,c;1<[e,r,o,i].filter(Boolean).length&&(t.containsMixedTypes="1"),e&&t.containsMixedTypes||n.W5===T.PivotDataType.string||a||s||(t.containsSemiMixedTypes="0"),i&&(t.containsSemiMixedTypes="1")},a.prototype.tii=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,y,i,C,N,I,I,A,i=this,n=i.W5,e=i.D,r=i.P,o=r&&0<r.length,a=x().blank,s={};if(e&&0<e.length){for(y=w=g=b=m=p=d=v=h=f=l=u=c=void 0,i=i.Kti(e[0]),C=0,N=e;C<N.length;C++)I=N[C],"number"==(A=typeof(I=o?r[I]:I))?(d=!0,isFinite(I)&&Math.floor(I)===I||(p=!1),m=(0,Z.ht)(m)?I:Math.min(I,m),b=(0,Z.ht)(b)?I:Math.max(I,b)):n===T.PivotDataType.date?"string"!=A||isNaN(Date.parse(I))?(0,Z.ht)(I)||I===a||(l=!0):(f=!0,h=(0,Z.ht)(h)||Date.parse(I)<Date.parse(h)?I:h,v=(0,Z.ht)(v)||Date.parse(I)>Date.parse(v)?I:v):"string"==A&&I!==a?u=!0:I instanceof S.CalcError?g=!0:"boolean"==A&&(w=!0),!(0,Z.ht)(I)&&I!==a||(c=!0),"string"==A&&255<I.length&&(y=!0);!0===d&&!1!==p&&(p=!0),(n!==T.PivotDataType.string||i)&&(0,Z.ht)(u)&&(u=!1),n===T.PivotDataType.date&&(0,Z.ht)(l)&&(l=!1),t.count=e.length+"",f&&(t.containsDate="1"),!1===l&&(t.containsNonDate="0"),!1!==u||g||w||(t.containsString="0"),g&&(u=!0),c&&(t.containsBlank="1"),y&&(t.longText="1"),d&&!f&&(t.containsNumber="1"),p&&!f&&(t.containsInteger="1"),f?(t.minDate=(0,Z.kQt)(new Date(h)),t.maxDate=(0,Z.kQt)(new Date(v))):(d||p)&&(t.minValue=m,t.maxValue=b),s={containsString:u,containsNumber:d,containsDate:f,containsBlank:c,containsError:g,containsBool:w}}return s},a.prototype.iii=function(t){var i=this,n=t.containsString,e=t.containsNumber,r=t.containsDate,o=t.containsBlank,a=0;n&&a++,e&&a++,r&&a++,1<a&&(t.containsMixedTypes=!0),t.containsString&&t.containsMixedTypes?t.containsSemiMixedTypes=!0:i.W5===T.PivotDataType.string||o||(t.containsSemiMixedTypes=!1)},a.prototype.qti=function(t,i){var n=this,e=n.k,r=n.Hti(t),o=n.D;(0,Z.ht)(n.gd)&&(n.gd=t),(0,Z.ht)(n.T)&&(n.T=t),n.gd=n.gd<t?t:n.gd,n.T=n.T>t?t:n.T,e[r]||(e[r]=[],o.push(r)),e[r].push(i)},a.prototype.aQt=function(i,t,n){var e,r,o,a,s,n,c,e,e=this,r=e.k,o=e.P,a=e.D,s=e.Bti,n=i=n&&2===e.W5?(0,Z.nii)(i):i;if((0,Z.ht)(i))n=x().blank;else if(2===e.W5){if("object"==typeof n)try{e.gd=e.gd<i?i:e.gd,e.T=e.T>i?i:e.T,n=(0,Z.formatDateToString)(i)}catch(t){n=i}}else n=e.Hti(i);return e=o[n=(0,Z.ht)(n)?x().blank:n],(0,Z.ht)(e)&&(e=s[(n+"").toLowerCase()]),(0,Z.ht)(e)?(c=a.push(n)-1,o[n]=c,s[(n+"").toLowerCase()]=c):c=e,(0,Z.ht)(r[c])&&(r[c]=[]),r[c].push(t),c},a.prototype.eii=function(t,i){var n,e=this.k;e[t]||(e[t]=[]),e[t].push(i)},a.prototype.rii=function(){for(var t,i,n,e,r,o,a,t=this,i=t.D,n=0,e=i[n],r=i.length;n<r&&(!e||isNaN(Date.parse(e)));)e=i[++n];for(o=(0,z.parseStringToDate)(e),a=(0,z.parseStringToDate)(e);n<r;n++)o=(e=(0,z.parseStringToDate)(i[n]+""))<o?e:o,a=a<e?e:a;t.T=o,t.gd=a},a.prototype.oii=function(){for(var t,i,n,e,r,o,a,t=this,i=t.D,n=0,e=i[n],r=i.length-1;n<r&&((0,Z.ht)(e)||isNaN(+e));)e=i[++n];for(a=o=e;n<i.length;n++)o=(e=i[n])<o?e:o,a=a<e?e:a;t.T=o,t.gd=a},a.prototype.getFieldsItemList=function(){return this.DH().concat()},a.prototype.getIndexesList=function(t){for(var i,n,e,r,o,i=this.aii(),n=[],e=0,r=t;e<r.length;e++)o=r[e],(0,Z.ht)(i[o])||(n=n.concat(i[o]));return n},a.prototype.getFilterIndexesList=function(){for(var t,i,n,e,r,o,t=this.aii(),i=[],n,e=0,r=Object.keys(t);e<r.length;e++)o=r[e],(0,Z.ht)(t[o])||(i=i.concat(t[o]));return i},a.prototype.DH=function(){return[].concat(this.cx||this.D)},a.prototype.aii=function(){return this.A||this.k},a.prototype.M=function(){return this.AQt||this.P},a.prototype.S=function(t){var i=this,n=i.W5;return i.VXt?i.VXt[t]:n===T.PivotDataType.number?(0,Z.getNumberGroupItemKey)(i,t):n===T.PivotDataType.date?(0,Z.getDateGroupItemKey)(i,t):void 0},a.prototype.sii=function(t,i){var n,e,n=this;n.N=t,e=n.VXt={},(0,Z.o)(Object.keys(t),function(i){(0,Z.o)(t[i],function(t){e[t]=i})}),(0,Z.o)(i,function(t){(0,Z.ht)(e[t])&&(e[t]=t)})},a.prototype.uii=function(){var t=this;delete t.T,delete t.gd,delete t.Rs,delete t.y1,delete t.cx,delete t.A,delete t.AQt,delete t.qXt,delete t.l,delete t.nZt},a.prototype.uQt=function(){var t,i,n,e,r,o,a,s,t=this,i={},n=t.W5,e=t.DH(),r=t.M(),o=1e3<e.length&&!t.needSort?e.concat():(0,c.mXt)(e.concat(),{sortType:T.SortType.asc,isDate:n===T.PivotDataType.date,isNumberGroup:n===T.PivotDataType.number&&!(0,Z.ht)(t.cx),by:t.Rs});if(o&&0<o.length){for(a=0,s=o.length;a<s;a++)i[r[o[a]]]=a;t.sQt=i}else t.sQt=g},a.prototype.dispose=function(){var t=this;t.k=g,t.D=g,t.sQt=g,t.P=g,t.cx=g,t.A=g,t.AQt=g,t.VXt=g,t.Hti=g,t.cii=g,t.cft=g,t.Xnn=g,t.N=g,t.nZt=g,t.lii=g},a.prototype.fromJson=function(t,i){var n,e,r,o,a,n=this;if((0,Z.ht)(t.name)||(n.Zc=t.name),(0,Z.ht)(n.W5)&&!(0,Z.ht)(i)&&(n.W5=u(i.type)),(e=t.entities)&&0<e.length)for(n.P||(n.P={}),n.D=[],r=x().blank,o=void 0,a=0;a<e.length;a++)e[a].isUnusedItem||(o=e[a].value,(0,Z.ht)(o)&&(o=r),"object"!=typeof(o=2!==n.W5||isNaN(Date.parse(o))?o:(0,Z.formatDateToString)(new Date(o)))||(0,Z.ht)(o._error)&&(0,Z.ht)(o._calcError)||(o=z.ErrorsMap[o._code]||z.ErrorsMap[0]),n.D.push(o),n.P[o]=a)},a.prototype.yh=function(t,i){var n,i,e,r,o,a,n=this;if((0,Z.ht)(t.name)||(n.Zc=K((0,Z.xmlDecode)(t.name))),(0,Z.ht)(n.W5)&&!(0,Z.ht)(i)&&(n.W5=u(i.n_)),(e=(i=(0,Z.xr)(t,"sharedItems"))&&i.c_)&&0<e.length)for(n.P||(n.P={}),n.D=[],r=x().blank,o=void 0,a=0;a<e.length;a++)e[a].u||(o=v(e[a].n_,e[a].v),(0,Z.ht)(o)&&(o=r),"object"!=typeof(o=2!==n.W5||isNaN(Date.parse(o))?o:(0,Z.formatDateToString)(new Date(o)))||(0,Z.ht)(o._error)&&(0,Z.ht)(o._calcError)||(o=z.ErrorsMap[o._code]||z.ErrorsMap[0]),n.D.push(o),n.P[o]=a)},a.prototype.toJson=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,f,o,t,o,i=this,n=(0,Z.ht)(i.cft)?{}:i.cft,e=x().blank;if((0,Z.ht)(i.Zc)||(n.name=i.Zc),(0,Z.ht)(i.lp)||(n.lp=i.lp),(0,Z.ht)(i.D5)||(n.formula=i.D5,n.databaseField=!1),!1===i.qXt&&(n.databaseField=!1),i.hasCalcItem()&&i.W5===T.PivotDataType.date&&(n.containsMixedTypes=!0,n.containsString=!0),!1!==n.databaseField&&(i.Xti(n,t),i.iii(n)),(0,Z.isEmptyObject)(i.P))n.entities=[];else if(r=n.entities=[],(o=i.D)&&0<o.length){for(a=N(i.W5),c=!(s={}),u=0,l=o;u<l.length;u++)"e"===(v=I(h=f=l[u],a))?h=(null==h?void 0:h.toJSON)&&h.toJSON()||h._error:("s"===v&&255<f.length&&(n.longText=!0),c=!0),s[f=(h+"").toLowerCase()]||((0,Z.ht)(h)||h===e?r.push({type:"m"}):r.push({type:v,value:h,isCalculatedItem:!!i.sh[h]}),s[f]=!0);c||(n.entities=[])}return t=(o=t&&t.getField(i.y1))&&o.lp,i.cx&&((0,Z.ht)(i.T)?(0,Z.isEmptyObject)(i.N)||(n.fieldGroup={base:t},O(i,o,n)):"number"==typeof i.T?(n.fieldGroup={startNum:i.T,endNum:i.gd,autoStart:!0===i.rCi,autoEnd:!0===i.oCi,groupInterval:i.Rs,base:t,hasRangeGroup:!0},n.fieldGroup.groupItems=d(i.T,i.gd,i.Rs)):i.T instanceof Date&&(n.fieldGroup={startDate:i.T&&new Date(i.T).toUTCString(),endDate:i.gd&&new Date(i.gd).toUTCString(),autoStart:!0===i.rCi,autoEnd:!0===i.oCi,groupBy:D(i.Rs),base:t,hasRangeGroup:!0},i.cx)&&(o=i.cx.concat(),o=j(i.T,i.gd,o,n.fieldGroup),n.fieldGroup.groupItems=o)),n},a.prototype.wh=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,v,d,v,o,r,p,t,m,b,r,o,r,i=this,n=(0,Z.ht)(i.Xnn)?{n_:"cacheField",c_:[]}:i.Xnn,e=x().blank,r={n_:"sharedItems"};if((0,Z.ht)(i.lp)||(n.lp=i.lp),(0,Z.ht)(i.Zc)||(n.name=(0,Z.xmlEncode)(i.Zc.split("\n").join("_x000a_"))),(0,Z.ht)(i.D5)||(n.formula=(0,Z.xmlEncode)(i.D5),n.databaseField="0"),!1===i.qXt&&(n.databaseField="0"),i.hasCalcItem()&&i.W5===T.PivotDataType.date&&(r.containsMixedTypes=1,r.containsString=1),"0"!==n.databaseField&&(o=i.tii(r),i.$ti(r,o)),a=[],"0"!==n.databaseField&&!(0,Z.isEmptyObject)(i.P)&&(s=i.D)&&0<s.length){for(c=N(i.W5),l=!(u={}),f=0;f<s.length;f++)"e"===(v=I(h=s[f],c))?h=h&&h.toJSON&&h.toJSON()||h._error:l=!0,u[d=(h+"").toLowerCase()]||((0,Z.ht)(h)||h===e?a.push({n_:"m"}):(v={n_:v,v:y(v,h)},i.sh[h]&&(v.f=1),a.push(v)),u[d]=!0);l||(a=[])}return 0<a.length&&(r.c_=a,r.count=a.length,n.c_.push(r)),r=(o=t&&t.getField(i.y1))&&o.lp,i.cx&&(t={n_:"fieldGroup",base:r,c_:[]},(0,Z.ht)(i.T)?(0,Z.isEmptyObject)(i.N)||(o=(r=_(i,o)).discretePrs,r=r.discreteGroup,t.c_.push({n_:"groupItems",count:r.length,c_:r}),t.c_.push({n_:"discretePr",count:o.length,c_:o})):"number"==typeof i.T?(m={n_:"rangePr",groupInterval:i.Rs+"",startNum:i.T+"",endNum:i.gd+"",autoStart:!0===i.rCi?"1":"0",autoEnd:!0===i.oCi?"1":"0"},b={n_:"groupItems",c_:p=P(i.T,i.gd,i.Rs),count:p.length},t.c_.push(m),t.c_.push(b)):i.T instanceof Date&&(m={n_:"rangePr",groupBy:D(i.Rs),startDate:(0,Z.kQt)(i.T),endDate:(0,Z.kQt)(i.gd),autoStart:!0===i.rCi?"1":"0",autoEnd:!0===i.oCi?"1":"0"},p=i.cx.concat(),b={n_:"groupItems",c_:p=F(i.T,i.gd,p,m),count:p.length},t.c_.push(m),t.c_.push(b)),(0,z.Pr)(t,["rangePr","discretePr","groupItems"]),n.c_.push(t)),(0,z.Pr)(n,["sharedItems","fieldGroup"]),n},a.prototype.sf=function(){return this.sQt},b=a,t.PivotCacheField=b,s.prototype.hasCalcItem=function(t){for(var i,n,e,r,n,i=this,e=0,r=t;e<r.length;e++)if((n=r[e]).isDim&&0<(n=(n=i.getField(n.sourceName)).cC()?i.getField(n.y1):n).ty.length)return!0;return!1},s.prototype.aggregateCalcItem=function(t){var i=this;if((0,Z.ht)(t))return i.lw;i.lw=!!t},s.prototype.setUntreatedNodeInfo=function(t,i,n,e,r){var o=this,t=f(t,n);o.JXt||(o.JXt={}),o.JXt[t]={calcResultIndex:r,expression:e,pathInfo:i}},s.prototype.getPivotCalcService=function(){var t;return this.HXt},s.prototype.SMt=function(){var t=this;t.HXt=new e.PivotCalcService,t.POt=new e.PivotCalcSource(t.HXt),t.POt.setPivotCache(t),t.HXt.fii(t.POt)},s.prototype.getDataRefer=function(){return this.EYt},s.prototype.getHeaderList=function(){var t,i,n,e,r,o,i,n=this.Pq,t=[];for(o in n)h(n,o)&&(r={name:(e=n[o]).Zc,dataType:e.W5,index:e.lp},(0,Z.ht)(e.D5)||(r.fieldType=T.PivotSourceFieldType.isCalcField),(0,Z.ht)(e.y1)||(r.fieldType=T.PivotSourceFieldType.isGroupField),t[e.lp]=r);return M([],t,!0)},s.prototype.hii=function(){var t,i,n,e,r,i=this;if((0,Z.ht)(i.Rti)){for(r in e=void 0,t=[],n=i.Pq)h(n,r)&&(t[(e=n[r]).lp]={name:e.Zc,dataType:e.W5,index:e.lp});i.Rti=t}},s.prototype.dx=function(t,i){for(var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,m,b,g,w,y,C,N,I,A,T,n=this,e=[],r=[],s=n.getHeaderList(),c=n.oQt,u=[],f=n.Pq,h=[],v=[],p=x().blank,b=0,g=s;b<g.length;b++)(m=f[(w=g[b]).name]).cC()&&w.name!==m.y1||!(0,Z.ht)(m.D5)?r.push(w.index):u.push(w.name),h.push(m.D),(m=m.P)&&0<Object.keys(m).length?v.push(1):v.push(0);if(e.push(u),u=[],i)for(y=0,C=c;y<C.length;y++){for(l=(a=(w=C[y]).slice(0)).length,N=o=0;N<l;N++)-1<r.indexOf(N)||(v[N]?((d=h[N][a[N]])===p&&(d=null),u[o]=d):u[o]=a[N]===p?null:a[N],o++);e.push(u),u=[]}else for(I=0,A=t;I<A.length;I++){for(T=A[I],l=(a=M([],c[T],!0)).length,N=o=0;N<l;N++)-1<r.indexOf(N)||(v[N]?((d=h[N][a[N]])===p&&(d=null),u[o]=d):u[o]=a[N]===p?null:a[N],o++);e.push(u),u=[]}return e},s.prototype.ln=function(t,i){var n,e,r,o,a,s,c,u,c,l,f,h,v,d,p,m,b,n=this,e=n.ZVt,r=n.WVt(),o=n.getCalcItems();for(o.sort(function(t,i){return t.priority-i.priority}),a=[],s=0;s<r.length;s++)r[s]&&a.push({name:r[s].Zc,formula:r[s].D5});if(c=n.HXt,u=n.EYt,n.dispose(),n.HXt=c,n.EYt=u,n.oQt=[],n.Rti=t,n.Gti=0,n.Vti=0,n.Z$t&&n.Z$t.dispose(),n.Z$t=g,t&&i&&(c=t.map(function(t){return n.Uti(t)}),n.uut(c,i)),n.SMt(),(0,Z.ht)(e)||n.vii(e),0<a.length)for(s=0;s<a.length;s++)n.addCalcField(a[s].name,a[s].formula);for(f={},h=0,v=o;h<v.length;h++)d=v[h],(l=n.getField(d.sourceName)).W5===T.PivotDataType.number&&(f[d.sourceName]=!0);0<Object.keys(f).length&&C(n,f);try{for(p=0,m=o;p<m.length;p++)b=m[p],n.dii(b.sourceName,b.calcItemName,b.formula,n.pii())}catch(t){}},s.prototype.vii=function(t){var i,n,i=this;for(n in t)h(t,n)&&i.dy(t[n])},s.prototype.mii=function(t){return this.EYt===t},s.prototype.getName=function(){return this.Zc},s.prototype.getAllFieldsNames=function(){var t,i,n,t=[],i=this.Pq;for(n in i)i.hasOwnProperty(n)&&(t[i[n].lp]=i[n].Zc);return t},s.prototype.uut=function(t,r){var i,o,a,s,o,i=this,a=x().blank,s=r.length||0;(0,Z.o)(t,function(t,i){var n,e;if(t.W5===T.PivotDataType.number||t.W5===T.PivotDataType.date){for(n=t.W5===T.PivotDataType.number?function(t){return"number"==typeof t}:function(t){return t instanceof Date},e=0;(!r[e]||(0,Z.ht)(r[e][i])||!n(r[e][i]))&&e<s;)e++;t.T=r[e][i],t.gd=r[e][i]}}),(0,Z.o)(r,function(n,e){(0,Z.o)(t,function(t,i){o=n[i],!(0,Z.ht)(o)&&""!==o||(n[i]=a),o=t.Jti(o,e),(0,Z.ht)(o)||(n[i]=o)}),i.oQt[e]=n}),(0,Z.o)(t,function(t){t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date||t.uQt()}),this.bii()},s.prototype.gii=function(t,i){var n,i,s,c,n=this,i=i.pivotCacheRecords;i&&0<i.length&&(s=i[0],c=x().blank,(0,Z.o)(i,function(r,o){var a=[];(0,Z.o)(t,function(t,i){var n,e,n=r[i]&&r[i].value;(0,Z.ht)(n)&&(n=c),e=s[i]&&s[i].type||u(t.W5),"object"!=typeof n||(0,Z.ht)(n._error)||(n=z.ErrorsMap[n._code]||z.ErrorsMap[0]),"x"===e?t.eii(n,o):"m"===e||(0,Z.ht)(e)?((0,Z.ht)(n)||(t.W5=T.PivotDataType.string),n=t.aQt(n,o,!0)):"n"!==e?n=t.aQt(n,o,!0):t.qti(n,o),a[i]=n}),n.oQt.push(a)}),(0,Z.o)(t,function(t){t.W5===T.PivotDataType.date&&t.rii(),t.W5===T.PivotDataType.number&&(0,Z.ht)(t.T)&&t.oii(),t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date&&(t.W5!==T.PivotDataType.number||(0,Z.ht)(t.P))||t.uQt()}))},s.prototype.wii=function(t,i){var n,i,s,c,n=this,i=i&&i.c_;i&&0<i.length&&(s=i[0],c=x().blank,(0,Z.o)(i,function(r,o){var a=[];(0,Z.o)(t,function(t,i){var n,n,e,n=r.c_&&r.c_[i],n=v(n&&n.n_,n&&n.v);(0,Z.ht)(n)&&(n=c),e=s.c_[i]&&s.c_[i].n_||u(t.W5),"object"!=typeof n||(0,Z.ht)(n._error)||(n=z.ErrorsMap[n._code]||z.ErrorsMap[0]),"x"===e?t.eii(n,o):"m"===e||(0,Z.ht)(e)?((0,Z.ht)(n)||(t.W5=T.PivotDataType.string),n=t.aQt(n,o,!0)):"n"!==e?n=t.aQt(n,o,!0):t.qti(n,o),a[i]=n}),n.oQt.push(a)}),(0,Z.o)(t,function(t){t.W5===T.PivotDataType.date&&t.rii(),t.W5===T.PivotDataType.number&&(0,Z.ht)(t.T)&&t.oii(),t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date&&(t.W5!==T.PivotDataType.number||(0,Z.ht)(t.P))||t.uQt()}))},s.prototype.bii=function(){var t,i,n,e,r,o,a,s,c,u,l,f,h,v,f,d,p,t=this,i=t.oQt,n=t.Q$t={},e=x().blank;if(!(0,Z.ht)(i)){for(r=i.length,c=t.Pq,l=[],h=0,v=u=t.Rti;h<v.length;h++)f=v[h],(0,Z.ht)(f)||(0,Z.ht)(c[f.name])||((f=c[f.name]).P&&0<Object.keys(f.P).length?l[f.lp]=(0,Z.ht)(f.P[e])?-1:f.P[e]:l[f.lp]=e);for(d=0;d<r;d++)if(o=i[d]){for(a=o.length,s=!0,p=0;p<a;p++)if(o[p]!==l[p]){s=!1;break}s&&(n[d]=1)}}},s.prototype.getField=function(t){return this.Pq[t]},s.prototype.Uti=function(t){var i,t,n,i=this,t=new b(t);return(0,Z.ht)(t.lp)&&(t.lp=i.Gti),n=t.Zc,(0,Z.ht)(i.Pq[n])&&i.Gti++,i.Pq[n]=t},s.prototype.zRt=function(t){return this.Pq[t]},s.prototype.yii=function(){var t,i,n,t=[],i=this.Pq;for(n in i)i.hasOwnProperty(n)&&t.push(i[n]);return t},s.prototype.Cii=function(t,i){var n=this.Pq[t];return i.reduce(function(t,i){return t.concat(n.k[i]||[])},[])},s.prototype.Iii=function(t){var n,t,n=this,t=t.map(function(t){var i,t,i,i=t.sourceName,t=t.items,i=n.zRt(i);return i?i.getIndexesList(t):[]});return this.Aii((0,Z.amt)(t))},s.prototype.Aii=function(t){for(var i,n,e,r,i=[],n=0,e=t;n<e.length;n++)r=e[n],i.push(this.oQt[r]);return i},s.prototype.addField=function(t){var i,n,i=this;t&&!(0,Z.ht)(t.Zc)&&(n=t.Zc,(0,Z.ht)(i.Pq[n])?((0,Z.ht)(t.lp)&&(t.lp=i.Gti),(0,Z.ht)(i.Pq[n])&&i.Gti++):t.lp=i.Pq[n].lp,i.Pq[n]=t)},s.prototype.removeField=function(t){var i=this;!t||(0,Z.ht)(t.Zc)||(0,Z.ht)(i.Pq[t.Zc])||((0,Z.ht)(t.lp)||i.Nii(t.lp),delete i.Pq[t.Zc],i.Gti--)},s.prototype.removeCalcField=function(t){var i=this,t=i.getField(t);t&&!(0,Z.ht)(t.D5)&&i.removeField(t)},s.prototype.Nii=function(t){var i,n,e,r,i,n=this.Pq;for(e in n)n.hasOwnProperty(e)&&(r=n[e])&&!(0,Z.ht)(r.lp)&&r.lp>t&&r.lp--},s.prototype.dispose=function(){var t,i,t=this;for(i in t.oQt=g,t.HXt=g,t.POt=g,t.Pq)t.Pq.hasOwnProperty(i)&&(t.Pq[i].dispose(),delete t.Pq[i]);t.Rti=g,t.EYt=g,t.cft=g,t.Xnn=g,t.ZVt=g,t.Z$t=g},s.prototype.Tii=function(t){for(var i,n,e,r,i=this,n=[],e=0;e<t.length;e++)n.push(i.Pq[t[e].fieldName].k[t[e].item]);return r=(0,Z.amt)(n),i.Aii(r)},s.prototype.pVt=function(t){for(var i,n,e,r,o,a,s,c,i=this,n=[],e=0;e<t.length;e++)if(r=i.Pq[t[e].fieldName],(0,Z.ht)(r.cii))n.push(r.k[t[e].item]);else{for(o=r.cii[t[e].item],a=!1,s=r._baseFieldName,c=0;c<t.length;c++)s===t[c].fieldName&&(0,Z.Mii)(o,t[c].item)&&(a=!0);if(!a)return[]}return(0,Z.amt)(n)},s.prototype.bVt=function(t){for(var i,n,e,r,i=this,n=[],e=0;e<t.length;e++)(r=i.zRt(t[e].sourceName))&&n.push(r.getIndexesList(t[e].items));return(0,Z.amt)(n)},s.prototype.xii=function(t){var i;return!!this.Pq[t]},s.prototype.KXt=function(t){var i,n,i=this.Pq;for(n in i)if(i.hasOwnProperty(n)&&i[n].lp===t)return i[n]},s.prototype.Dii=function(t){this.Pq[t.Zc]=t},s.prototype.dy=function(t){var i,n,e,r,n,o,a,e,i=this;return(0,Z.ht)(i.ZVt)&&(i.ZVt={}),n=i.ZVt,e=(0,z.RF)(t),r=i.getField(t.originFieldName),!(0,Z.ht)(r)&&(n[t.originFieldName]=e,(n=t.textGroup)?(o=n.groupItems,a=new b({dataType:r.W5,name:n.fieldName,index:r.lp}),E(o,r.D),a.cx=[],a.A={},a.AQt={},(0,Z.o)(Object.keys(o),function(t,i){a.cx.push(t),a.AQt[t]=i,a.A[i]=[],(0,Z.o)(o[t],function(t){a.A[i]=(0,Z.F)(a.A[i],r.k[r.P[t]])})}),a.sii(o,r.D),a.N=o,a.y1=r.Zc,a.qXt=!1,a.l=r.lp,delete a.lp,a.uQt(),i.addField(a)):r.W5!==T.PivotDataType.number||(0,Z.ht)(t.numberGroup)?r.W5===T.PivotDataType.date&&X(i,r,t.dateGroups):(e=t.numberGroup,G(r,e.start,e.end,e.by)),!0)},s.prototype.zVt=function(t,i,n){var e,r,o,a,s,e=this;return!((0,Z.ht)(n)||(r=n.textGroup,o=n.numberGroup,a=n.dateGroups,!(r&&r.fieldName===t||o&&n.originFieldName===t||a&&(s=e.zRt(t)).y1===i)))},s.prototype.YVt=function(t){var i,n,e,r,o,a,s,c,u,l,f,i=this,n=i.ZVt;if(!(0,Z.ht)(n))for(e in n)if(h(n,e)&&(r=n[e],i.zVt(t,e,r))){delete n[e];break}if(o=i.getField(t),a=[],!(0,Z.ht)(o.A))if(o.N)a.push(o.Zc),i.removeField(o);else if("number"==typeof o.T)o.uii(),o.uQt();else if(o.T instanceof Date){for(s=o,l=(c=(s=!(u=0,Z.ht)(o.l)&&(0,Z.ht)(o.nZt)?i.KXt(o.l):s).nZt).length;u<l;u++)f=i.getField(c[u]),i.removeField(f);delete n[s.Zc],a=a.concat(c),s.uii(),s.uQt()}return a},s.prototype.xVt=function(t){var i,t,n,t,e,r,o,i=this,t=i.getField(t),n=[];if(!(0,Z.ht)(t)&&((0,Z.ht)((t=t).y1)||(t=i.getField(t.y1)),!(0,Z.ht)(t))&&!(0,Z.ht)(t.nZt)&&0<t.nZt.length)for(n.push(t),r=0,o=(e=t.nZt).length;r<o;r++)n.push(i.getField(e[r]));return n},s.prototype.WVt=function(){var t,i,n,t=this.Pq,i=[];for(n in t)t.hasOwnProperty(n)&&!(0,Z.ht)(t[n].D5)&&i.push(t[n]);return i},s.prototype.addCalcField=function(t,i){var n,t,e,r,n=this,t=new b({dataType:T.PivotDataType.number,name:t});t.D5=i,t.qXt=!1,e=n.HXt,r=n.POt,t.lii=e.parseFormulaToCalcRelatedFieldNames(i),t.iti=e.calcService.parse(r,i,0,0),n.addField(t)},s.prototype.checkFieldNameAndItems=function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,n=Object.keys(t),o={};if(!(0,Z.ht)(i)){for(a=0,s=i;a<s.length;a++)o[c=s[a]]=!0;for(u=0,l=n;u<l.length;u++)if(!o[f=l[u]])return!1}for(h=0,v=n;h<v.length;h++){if(f=v[h],r=this.getField(f),(0,Z.ht)(r))return!1;for(e=r.P,d=0,p=t[f];d<p.length;d++)if(m=p[d],(0,Z.ht)(e[m]))return!1}return!0},s.prototype.setSortInfo=function(t,i){var n,t=this.getField(t);(0,Z.ht)(t)||((0,Z.ht)(i)?t.needSort=null:(t.needSort=i,t.uQt()))},s.prototype.addCalcItem=function(t,i,n,e){var r,o,a,r=this,o,a=r.HXt.parseFormulaToCalcRelatedFieldItemMap(n);return!!r.checkFieldNameAndItems(a,e)&&this.dii(t,i,n,r.pii())},s.prototype.dii=function(t,i,n,e){var r,o,a,t,o,s,r=this,o=r.HXt,a=r.POt,t=r.getField(t),o=o.calcService.parse(a,n,0,0);if(t.sh[i]={calcItemFormula:n,calcExpression:o},(s=t.ty.indexOf(i))<0)return t.ty.push(i),t.addCalcItem(i,(0,Z.ht)(e)?r.pii():e),!0},s.prototype.getCalcItems=function(t){for(var i,n,i,e,r,o,a,s,c,u,l,f,h,i=this,n=[],i=(0,Z.ht)(t)?i.yii():[i.getField(t)],e=0,r=i;e<r.length;e++)for(a=(o=r[e]).ty,s=o.sh,c=o.WXt,u=o.M(),l=0,f=a;l<f.length;l++)h=f[l],n.push({sourceName:o.Zc,formula:s[h].calcItemFormula,calcItemName:h,priority:c[u[h]]});return n},s.prototype.updateCalcItem=function(t,i,n,e,r){var o,a,s,c,u,l,f,r,o=this,a=o.HXt,s=o.POt,c=o.getField(t);if((0,Z.ht)(c))return!1;if((u=c.ty.indexOf(i))<0)return!1;if(l=!1,n!==c.sh[i].calcItemFormula&&!(0,Z.ht)(n)){if(f=a.parseFormulaToCalcRelatedFieldItemMap(n),!o.checkFieldNameAndItems(f,r))return!1;r=a.calcService.parse(s,n,0,0),c.Eti[i]=f,c.sh[i]={calcItemFormula:n,calcExpression:r},l=!0}return l=(0,Z.ht)(e)?l:o.updateCalcItemPriority(t,i,e)||l},s.prototype.updateCalcItemPriority=function(t,i,n){var e,t,r,t,o,a,s,c,u,l,f,h,v,d,p,e=this,t=e.getField(t);if((0,Z.ht)(t)||t.ty.indexOf(i)<0)return!1;if(r=t.WXt[t.M()[i]],n<1?n=1:n>e.Vti&&(n=e.Vti),n===r)return!1;for(t=e.yii(),o=n<r?1:-1,a=Math.min(n,r),s=Math.max(n,r),c=0,u=t;c<u.length;c++)if((l=u[c]).hasCalcItem())for(f=l.WXt,v=0,d=h=Object.keys(f);v<d.length;v++)f[p=d[v]]===r?f[p]=n:f[p]>=a&&f[p]<=s&&(f[p]+=o);return!0},s.prototype.removeCalcItem=function(t,i){var n,e,r,t,o,a,s,c,c,s,n=this,e=[],r=n.getField(t),t=[i];if(r)for(a=t=(o=0,Z.ht)(i)?M([],r.ty,!0):t;o<a.length;o++)s=a[o],(c=r.D.indexOf(s))<0||(c=r.WXt[c],r.removeCalcItem(s),e.push({formula:r.sh[s].calcItemFormula,calcItemName:s}),delete r.Eti[s],delete r.sh[s],0<=(s=r.ty.indexOf(s))&&r.ty.splice(s,1),(0,Z.ht)(c))||n.Sii(c);return e},s.prototype.Sii=function(t){for(var i,n,e,r,o,a,s,c,u,l,i=this,n,e=0,r=i.yii();e<r.length;e++)if(a=(o=r[e]).WXt)for(c=0,u=s=Object.keys(a);c<u.length;c++)a[l=u[c]]>t&&a[l]--;i.Vti--},s.prototype.pii=function(){return this.Vti+=1,this.Vti},s.prototype.eti=function(t){for(var i,n,e,r,o,a,s,c,u,l,f,h,v,d,p,i=this,n=[],e={},r=[],o={},a=[],s=[],c={normalFieldsInfos:n,calcFieldsInfos:r},u=0,l=t.length;u<l;u++)f=i.getField(t[u].cacheName),(0,Z.ht)(f.D5)?m(n,f,t[u].subTotalType,e):i.kii(f.Zc,a,s);for(h=0,v=a.length;h<v;h++)m(n,d=i.getField(a[h]),T.SubtotalType.sum,e);for(h=0,v=s.length;h<v;h++)m(r,p=i.getField(s[h]),T.SubtotalType.sum,o);return c},s.prototype.jii=function(t){for(var i,n,e,r,o,i=this,n=[],e=0,r=t.length;e<r;e++)o=i.getField(t[e].cacheName),(0,Z.ht)(o.D5)||n.push(o);return n},s.prototype.kii=function(t,i,n){for(var e,t,r,o,a,s,c,e=this,t=e.getField(t),r=t.lii,o=0,a=r.length;o<a;o++)s=(0,z.Oii)(r[o]),c=e.getField(s),(0,Z.ht)(c.D5)?i.push(s):e.kii(s,i,n);n.push(t.Zc)},s.prototype.dot=function(t){var i,n,r,t,i=this,n=i.Pq,r=[];(0,Z.o)(t,function(t){var t=n[t];t&&((0,Z.ht)(t.P)||0===Object.keys(t.P).length)&&(t.k={},t.P={},t.D=[],t.cC()||r.push(t))}),t=i.oQt,(0,Z.o)(t,function(n,e){(0,Z.o)(r,function(t){var i=t.lp;n[i]=t.aQt(n[i],e,!1)})}),(0,Z.o)(r,function(t){t.uQt()})},s.prototype.Pii=function(t){var i,t,i=!1,t=L(t);return t!==T.PivotDataType.noValue&&t!==T.PivotDataType.errorValue?t:(i=t===T.PivotDataType.errorValue?!0:i)?T.PivotDataType.errorValue:T.PivotDataType.noValue},s.prototype.pJt=function(t){for(var i,n,e,i=!1,n=0;n<t.length;n++){if((e=u(t[n].type))!==T.PivotDataType.noValue&&e!==T.PivotDataType.errorValue)return e;e===T.PivotDataType.errorValue&&(i=!0)}return i?T.PivotDataType.errorValue:T.PivotDataType.noValue},s.prototype.fromJson=function(t,i,n){var e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,g,w,w,y,C,g,w,N,I,A,T,M,S,x,D,k,j,O,e=this;if(e.cft=i,(0,Z.ht)(i.name)?e.Zc=t:e.Zc=i.name,(0,Z.ht)(t)||(e.FVt=+t),(0,Z.ht)(i.pivotCacheId)||(e.yQt=+i.pivotCacheId),(0,Z.ht)(i.recordCount)||(e.recordCount=i.recordCount),i.refreshOnLoad&&(e.fCi=!!i.refreshOnLoad),(0,Z.ht)(i.sourceType)||(e.sourceType=i.sourceType,(e.EYt="",Z.ht)(i.sheet)||(e.EYt=i.sheet,e.sheet=i.sheet,(0,Z.ht)(i.ref))||(e.EYt=e.EYt+"!"+i.ref,e.ref=i.ref),(0,Z.ht)(i.sourceName))||(e.EYt=i.sourceName,e.sourceName=i.sourceName),o=[],a=[],s=[],(r=(0,z.RF)(i.fields))&&0<r.length)for(c=0;c<r.length;c++){if(l=(u=r[c]).fieldGroup,u.lp=c,l){if(!(0,Z.ht)(l.base)&&((0,Z.ht)(u.entities)||0===u.entities.length)&&!(0,Z.ht)(l.startDate)){(0,Z.ht)(r[l.base])||(0,Z.ht)(r[l.base].fieldGroup)||!(0,Z.ht)(r[l.base].fieldGroup.Fii)||(r[l.base].fieldGroup.Fii=[]),r[l.base].fieldGroup.Fii.push(u);continue}if(a.push(u),!(0,Z.ht)(l.discreteGroup))continue}if((0,Z.ht)(u.formula)){if(f=u.entities,(h={}).name=u.name,h.index=c,f&&0<f.length)h.dataType=e.pJt(f);else if(i.Rti)for(v=0,d=i.Rti;v<d.length;v++)(p=d[v]).name===h.name&&(h.dataType=p.dataType);(m=e.Uti(h)).fromJson(u,i.pivotCacheRecords&&i.pivotCacheRecords[0]&&i.pivotCacheRecords[0][c]),o.push(m)}else s.push(u)}for(e.gii(o,i),y=0,C=b=i.calculatedItems||[];y<C.length;y++)w=(g=C[y]).pivotArea,!(0,Z.ht)(w.outline)&&(g=g.formula,w=w.references[0],w=(m=i.fields[w.field]).entities[w.indexes[0]]&&m.entities[w.indexes[0]].value)&&e.addCalcItem(m.name,w,g);if(0<a.length)for(c=0;c<a.length;c++)if((l=(u=a[c]).fieldGroup)&&(N=(0,Z.ht)(l.base)?u:r[l.base]))if((I={}).originFieldName=N.name,(0,Z.ht)(l.groupInterval))if((0,Z.ht)(l.groupBy)){if((0,Z.ht)(l.parent)){if(x=l.discreteGroup,D=l.groupItems,x&&0<x.length&&D&&0<D.length)for(I.textGroup={fieldName:u.name,groupItems:{}},k=I.textGroup.groupItems,M=0;M<x.length;M++)j=!(0,Z.ht)(x[M])&&D[x[M]]&&D[x[M]].value,(0,Z.ht)(j)||((0,Z.ht)(k[j])&&(k[j]=[]),k[j].push(N.entities[M]&&N.entities[M].value));e.dy(I)}}else{if(A=[{start:!0===l.autoStart?H:new Date(l.startDate),end:!0===l.autoEnd?H:new Date(l.endDate),by:q(l.groupBy)}],(T=l.Fii)&&0<T.length)for(M=0;M<T.length;M++)S=T[M].fieldGroup,A.push({start:!0===l.autoStart?H:new Date(S.startDate),end:!0===l.autoEnd?H:new Date(S.endDate),by:q(S.groupBy)});I.dateGroups=A,e.dy(I)}else I.numberGroup={start:!0===l.autoStart?H:l.startNum,end:!0===l.autoEnd?H:l.endNum,by:l.groupInterval},e.dy(I);if(0<s.length)for(c=0;c<s.length;c++)e.addCalcField((O=s[c]).name,O.formula);(0,Z.ht)(i.overwriteList)||((0,Z.ht)(e.Z$t)&&(e.Z$t=new Y.OverwriteList),e.Z$t.fromJSON(i.overwriteList)),J(r,e.Pq),e.hii(),e.bii()},s.prototype.yh=function(t,i,n){var e,r,i,i,i,i,i,r,i,i,o,a,s,c,u,l,f,h,v,d,p,m,b,g,d,w,y,L,C,r,E,N,I,A,T,B,N,R,I,A,M,I,G,S,V,x,D,k,k,j,U,O,P,F,_,Q,W,e=this,r=(e.Xnn=t).lossless;if((0,Z.ht)(t.name)?(0,Z.ht)(r&&r.cacheName)?e.Zc=i:e.Zc=t.lossless.cacheName:e.Zc=t.name,(0,Z.ht)(i)||(e.FVt=+i),i=(i=(i=(i=(0,Z.xr)(t,"extLst"))&&(0,Z.xr)(i,"ext"))&&(0,Z.xr)(i,"pivotCacheDefinition"))&&i.pivotCacheId,(0,Z.ht)(i)||(e.yQt=+i),(0,Z.ht)(r&&r.overwriteList)||((0,Z.ht)(e.Z$t)&&(e.Z$t=new Y.OverwriteList),e.Z$t.fromJSON(r.overwriteList)),(0,Z.ht)(t.recordCount)||(e.recordCount=+t.recordCount),t.refreshOnLoad&&(e.fCi=!!t.refreshOnLoad),i=(0,Z.xr)(t,"cacheSource"),(0,Z.ht)(i)||(e.sourceType=i.type,i=(r=(e.EYt="",Z.xr)(i,"worksheetSource"))&&r.sheet,(0,Z.ht)(i)||(e.EYt=i,e.sheet=i,(0,Z.ht)(r.ref))||(e.EYt=e.EYt+"!"+r.ref,e.ref=r.ref),i=r&&r.name,(0,Z.ht)(i))||(e.EYt=i,e.sourceName=i),o=(0,Z.xr)(t,"cacheFields"),s=[],c=[],u=[],(a=(0,z.RF)(o.c_))&&0<a.length)for(l=0;l<a.length;l++){if(f=a[l],h=(0,Z.xr)(f,"fieldGroup"),f.lp=l,v=(0,Z.xr)(f,"sharedItems"),h){if(d=+h.base,p=(0,Z.xr)(h,"rangePr"),m=(0,Z.xr)(h,"discretePr"),!(0,Z.ht)(h.base)&&((0,Z.ht)(v)||v.c_&&0===v.c_.length)&&!(0,Z.ht)(p&&p.startDate)){b=(0,Z.xr)(a[d],"fieldGroup"),(0,Z.ht)(a[d])||!(0,Z.ht)(b)&&(0,Z.ht)(b.Fii)&&(b.Fii=[]),b.Fii.push(f);continue}if(c.push(f),!(0,Z.ht)(m))continue}if((0,Z.ht)(f.formula)){if((g={}).name=f.name,g.index=l,d=v&&v.c_&&0<v.c_.length,(0,Z.ht)(d)){if(t.lossless&&t.lossless.Rti)for(w=0,y=t.lossless.Rti;w<y.length;w++)(L=y[w]).name===g.name&&(g.dataType=L.dataType)}else g.dataType=e.Pii(v.c_[0]);g.name=K((0,Z.xmlDecode)(g.name)),(C=e.Uti(g)).yh(f,n&&n.c_&&n.c_[0]&&n.c_[0].c_[l]),s.push(C)}else u.push(f)}for(e.wii(s,n),B=E=(r=(T=0,Z.xr)(t,"calculatedItems"))&&r.c_||[];T<B.length;T++)N=B[T],I=(0,Z.xr)(N,"pivotArea"),!(0,Z.ht)(I.outline)&&(N=(0,Z.xmlDecode)(N.formula),I=(R=(0,Z.xr)(I,"references")).c_[0],A=(0,Z.xr)(I,"x"),C=o.c_[+I.field],A=(I=(M=(0,Z.xr)(C,"sharedItems").c_)[+A.v])&&I.v)&&e.addCalcItem(C.name,A,N);if(0<c.length)for(l=0;l<c.length;l++)if((h=(0,Z.xr)(f=c[l],"fieldGroup"))&&(G=(0,Z.ht)(h.base)?f:a[+h.base]))if((S={}).originFieldName=G.name,p=(0,Z.xr)(h,"rangePr"),(0,Z.ht)(p&&p.groupInterval))if((0,Z.ht)(p&&p.groupBy)){if((0,Z.ht)(h.par)&&(j=(m=(0,Z.xr)(h,"discretePr"))&&m.c_,O=(U=(0,Z.xr)(h,"groupItems"))&&U.c_,!(0,Z.ht)(j))){if(j&&0<j.length&&O&&0<O.length)for(S.textGroup={fieldName:f.name,groupItems:{}},P=S.textGroup.groupItems,D=0;D<j.length;D++)F=!(0,Z.ht)(j[D])&&O[+j[D].v]&&O[+j[D].v].v,(0,Z.ht)(F)||((0,Z.ht)(P[F])&&(P[F]=[]),M=(0,Z.xr)(G,"sharedItems"),P[F].push(M.c_[D]&&M.c_[D].v));e.dy(S)}}else{if(V=[{start:"1"===p.autoStart?H:new Date(Date.parse(p.startDate)),end:"1"===p.autoEnd?H:new Date(Date.parse(p.endDate)),by:q(p.groupBy)}],(x=h.Fii)&&0<x.length)for(D=0;D<x.length;D++)k=(0,Z.xr)(x[D],"fieldGroup"),k=(0,Z.xr)(k,"rangePr"),V.push({start:"1"===p.autoStart?H:new Date(Date.parse(k.startDate)),end:"1"===p.autoEnd?H:new Date(Date.parse(k.endDate)),by:q(k.groupBy)});S.dateGroups=V,e.dy(S)}else S.numberGroup={start:"1"===p.autoStart?H:parseFloat(p.startNum),end:"1"===p.autoEnd?H:parseFloat(p.endNum),by:parseFloat(p.groupInterval)},e.dy(S);if(0<u.length)for(_=0,Q=u;_<Q.length;_++)e.addCalcField(K((0,Z.xmlDecode)((W=Q[_]).name)),K((0,Z.xmlDecode)(W.formula)));J(a,e.Pq),e.hii(),e.bii()},s.prototype.toJson=function(t){var i,n,e,r,o,a,s,c,u,l,f,h,i=this,n=(0,Z.ht)(i.cft)?{}:i.cft;if((0,Z.ht)(i.FVt)||(n.cacheId=i.FVt),(0,Z.ht)(i.yQt)?n.pivotCacheId=i.FVt:n.pivotCacheId=i.yQt,(0,Z.ht)(i.Zc)||(n.name=i.Zc),i.fCi&&(n.refreshOnLoad=1),(0,Z.ht)(i.recordCount)||(n.recordCount=i.oQt&&i.oQt.length),(0,Z.ht)(i.EYt)||(n.EYt=i.EYt),(0,Z.ht)(i.sourceType)||(n.sourceType=i.sourceType,(0,Z.ht)(i.sheet)||(n.sheet=i.sheet),(0,Z.ht)(i.ref)||(n.ref=i.ref),(0,Z.ht)(i.sourceName))||(n.sourceName=i.sourceName),n.calcItemCount=i.Vti||0,0<i.Vti&&(n.calculatedItems=i._ii()),i.Pq&&!(0,Z.isEmptyObject)(i.Pq)){for(r in e=[],t)t.hasOwnProperty(r)&&e.push(r);for(s in i.dot(e),C(i,t),o=n.fields=[],a={},i.Pq)i.Pq.hasOwnProperty(s)&&o.push(i.Pq[s].toJson(i));for(o.sort(function(t,i){return t.lp-i.lp}),c=[],u=0;u<o.length;u++)o[u].entities&&0<o[u].entities.length?c.push("x"):(0,Z.ht)(o[u].type)?c.push("n"):c.push(o[u].type),(0,Z.ht)(o[u].formula)||(a[u]=!0);for(l=[],u=0;u<i.oQt.length;u++){for(f=[],h=0;h<i.oQt[u].length;h++)!0!==a[h]&&f.push({type:c[h],value:i.oQt[u][h]});l.push(f)}n.pivotCacheRecords=l,n.Rti=i.Rti}return i.Z$t&&!i.Z$t.isEmpty()&&(n.overwriteList=i.Z$t.toJSON()),n},s.prototype.Lii=function(t,i){return{n_:"pivotArea",outline:"0",c_:[{n_:"references",count:"1",c_:[{n_:"reference",field:t+"",count:"1",c_:[{n_:"x",v:i+""}]}]}]}},s.prototype.Eii=function(){for(var t,i,n,e,r,o,a,s,c,u,l,f,t=this,i=[],n,e=0,r=t.yii();e<r.length;e++)if((a=(o=r[e]).ty)&&0<a.length)for(s=0,c=a;s<c.length;s++)u=c[s],l=t.Lii(o.lp,o.P[u]),i[f=o.WXt[o.P[u]]-1]={n_:"calculatedItem",formula:(0,Z.xmlEncode)(o.sh[u].calcItemFormula),c_:[l]};return i},s.prototype.wh=function(t){var i,n,e,r,o,e,a,a,s,c,u,l,f,h,v,d,d,p,m,b,g,i=this,n=i.oQt,e=n&&n.length;if(!(e<=0)){if(r=(0,Z.ht)(i.Xnn)?{}:i.Xnn,(0,Z.ht)(r.pivotCacheDefinition)&&(r.pivotCacheDefinition={n_:"pivotCacheDefinition",r_:[13,14,8,16,15],"r:id":"rId1"}),o=r.pivotCacheDefinition,(0,Z.ht)(i.FVt)||(r.cacheId=i.FVt+""),(0,Z.ht)(i.recordCount)||(o.recordCount=e+""),(0,Z.ht)(o.createdVersion)&&(o.createdVersion="7"),(0,Z.ht)(o.refreshedVersion)&&(o.refreshedVersion="7"),i.fCi&&(o.refreshOnLoad="1"),o.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[53,1],c_:[{n_:"pivotCacheDefinition",pivotCacheId:i.yQt+""}]}]}],e={n_:"cacheSource",type:i.sourceType},"worksheet"===i.sourceType&&(a={n_:"worksheetSource"},(0,Z.ht)(i.sourceName)||(a.name=i.sourceName),(0,Z.ht)(i.ref)||(a.ref=i.ref),(0,Z.ht)(i.sheet)||(a.sheet=i.sheet),e.c_=[a]),o.c_.push(e),0<i.Vti&&(a=i.Eii(),o.c_.push({n_:"calculatedItems",count:a.length+"",c_:a})),i.Pq&&!(0,Z.isEmptyObject)(i.Pq)){for(c in s=[],t)t.hasOwnProperty(c)&&s.push(c);for(f in i.dot(s),u=[],l={},i.Pq)i.Pq.hasOwnProperty(f)&&u.push(i.Pq[f].wh(i));for(u.sort(function(t,i){return t.lp-i.lp}),u.forEach(function(t){delete t.lp}),o.c_.push({n_:"cacheFields",count:u.length+"",c_:u}),(0,z.Pr)(o,["cacheSource","cacheFields","calculatedItems","extLst"]),h=[],v=0;v<u.length;v++)(d=(d=(0,Z.xr)(u[v],"sharedItems"))&&d.c_)&&0<d.length?h.push("x"):(0,Z.ht)(u[v].type)?h.push("n"):h.push(u[v].type),(0,Z.ht)(u[v].formula)||(l[v]=!0);for(p=[],v=0;v<i.oQt.length;v++){for(m=[],b=0;b<i.oQt[v].length;b++)!0!==l[b]&&m.push({n_:h[b],v:i.oQt[v][b]});p.push(g={n_:"r",c_:m})}r.pivotCacheRecords={n_:"pivotCacheRecords",r_:[13,14,8,16,15],count:n.length,c_:p}}return o.lossless={cacheName:i.Zc},o.lossless.Rti=i.Rti,i.Z$t&&!i.Z$t.isEmpty()&&(o.lossless.overwriteList=i.Z$t.toJSON()),r}},s.prototype._ii=function(){for(var t,i,n,e,r,o,a,s,c,u,l,t=this,i=[],n,e=0,r=t.yii();e<r.length;e++)if((a=(o=r[e]).ty)&&0<a.length)for(s=0,c=a;s<c.length;s++)u=c[s],(l={formula:o.sh[u].calcItemFormula,pivotArea:null}).pivotArea=t.Bii(o.lp,o.P[u]),i[o.WXt[o.P[u]]-1]=l;return i},s.prototype.Bii=function(t,i){var n={};return n.references=[{field:t,indexes:[i]}],n.outline=!0,n},s.prototype.$Vt=function(t,i){var n=this;(0,Z.ht)(n.Z$t)&&(n.Z$t=new Y.OverwriteList),n.Z$t.setOverwriteNode(t,i)},s.prototype.tQt=function(t){return this.Z$t&&this.Z$t.getOverwriteValue(t)},s.prototype.nQt=function(t){this.Z$t&&this.Z$t.removeOverwriteNode(t)},s.prototype.eQt=function(){return this.Z$t&&this.Z$t.getOverwriteList()},s.prototype.rQt=function(){this.Z$t&&this.Z$t.reset()},t.PivotCache=s,l.prototype.getName=function(t){var i=x().dateResource;switch(t){case T.DateGroupType.seconds:return i.Seconds;case T.DateGroupType.minutes:return i.Minutes;case T.DateGroupType.hours:return i.Hours;case T.DateGroupType.days:return i.Days;case T.DateGroupType.months:return i.Months;case T.DateGroupType.quarters:return i.Quarters;case T.DateGroupType.years:return i.Years}},l.prototype.insertIndexToIndexMap=function(t,i){var n,e,r,o,n,n=this,e=n.groupItemsKeyList,r=n.groupItemsIndexMap,o=n.groupItemsKeyIndexes,n=("number"===n.type?(0,Z.getNumberGroupItemKey):(0,Z.getDateGroupItemKey))(n,t);(0,Z.ht)(r[n])&&(r[n]=[],e.push(n),o[n]=e.length-1),r[n]=(0,Z.F)(r[n],i)},w=l,t.getPathStr=f,t.io=K},"./src/pivot-calc-engine.ts":function(t,i,n){var e,v,m,b,r,o,a,s,c,u;function l(t){return c.call(this,t)||this}function d(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,n={},r=(i=i.trim()).length,a=o=e=0,s=/^('|")([\d\D]*)\1$/g;for(i=i.replace(c=/'{2,2}/g,"'");a<r;){if((o=i.indexOf("[",a))<0)return;if(u=i.slice(e,o),s.lastIndex=0,l=t[u=s.test(u)?u.slice(1,u.length-1):u],a=o+1,!(0,m.ht)(l)){for(;(0,m.ht)(n[u]);){if(f=i.indexOf("]",a),h=i.slice(o+1,f),v=l.W5,d=h,p=l.D,(0,m.ht)(h)||h.length<=0||f<0)return;s.lastIndex=0,s.test(h)&&(d=h.slice(1,h.length-1),v!==b.PivotDataType.number||isNaN(+d)||(0<=p.indexOf(d)?n[u]=d:0<=p.indexOf(+d)&&(n[u]=+d))),0<=p.indexOf(d)&&(n[u]=d),a=f+1}e=a}}return n}function f(t){var t=u.call(this,t)||this;return t.resolvers=[new v.DefaultTokenResolver(5e3)],t}function p(t,i){var n,e,r,o,a;if(14===t.type)i.push(t.value);else if(t.value instanceof v.Expression)p(t.value,i);else if(Array.isArray(t.value))for(n=0,e=t.value;n<e.length;n++)(r=e[n])instanceof v.Expression&&p(r,i);else if(Array.isArray(t.arguments))for(o=0,a=t.arguments;o<a.length;o++)(r=a[o])instanceof v.Expression&&p(r,i)}function h(t,i){var n,e,r,o,a,s,c,u,l,f,h;if(8===t.type)throw new Error;if(15===t.type)for(n={},e=t.value,o=0,a=r=Object.keys(e);o<a.length;o++)s=a[o],n.field=s,n.item=e[s],i.push(n);else if(t.value instanceof v.Expression)p(t.value,i);else if(Array.isArray(t.value))for(c=0,u=t.value;c<u.length;c++)(l=u[c])instanceof v.Expression&&p(l,i);else if(Array.isArray(t.arguments))for(f=0,h=t.arguments;f<h.length;f++)(l=h[f])instanceof v.Expression&&p(l,i)}function g(t){var i,n,e,r,o,r,i={};if(!(0,m.ht)(t))for(n=0,e=t;n<e.length;n++)o=(r=e[n]).field,r=r.item,(0,m.ht)(o)||(i[o]?i[o].push(r):i[o]=[r]);return i}function w(){this.calcService=new v.CalcService}e=this&&this.__extends||(s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotCalcService=i.PivotCalcSource=void 0,v=n("CalcEngine"),m=n("./src/pivot-util.ts"),b=n("./src/pivot-interface.ts"),c=v.TokenResolver,e(l,c),l.prototype.setPivotCache=function(t){this.pivotCache=t},l.prototype.resolveToken=function(t,i,n,e,r){for(var o,a,s,c,u,l,f,f,h,o,a,c=this.pivotCache.Pq,u="";e<n.length&&0===(s=n[e]).uit;e++)u+=s.Awt;return 0<u.length&&(f=d(c,u),!(0,m.ht)(f))&&0<Object.keys(f).length?((l=new v.Expression(15)).value=f,{expr:l,index:e}):c[u]?((l=new v.Expression(14)).value=u,{expr:l,index:e}):(h=(f=u).length-1,c[f="'"===f.charAt(0)&&"'"===f.charAt(h)?f.substring(1,h):f]?((l=new v.Expression(14)).value=f,{expr:l,index:e}):void 0)},r=l,u=v.CalcSource,e(f,u),f.prototype.setPivotCache=function(t){this.pivotCache=t;var i=new r(6e3);i.setPivotCache(t),this.resolvers.unshift(i)},f.prototype.getResolver=function(){return this.resolvers},f.prototype.getField=function(t){var i=this.measureNode;if(!(0,m.ht)(i))return i[t]&&i[t].calc&&i[t].calc.sum},f.prototype.setContext=function(t){this.DJ=t},f.prototype.getFieldItem=function(){var t,i,n,e,r,o,a,t=this,i,n=t.expression,e=t.calcType,r=t.cacheName,o=t.pathInfo,a=t.resultIndex;return t.subtotalManager.getFieldCalcItem(arguments[0],n,o,e,r,a)},f.prototype.setCalcInfo=function(t,i,n,e,r,o){var a=this;a.calcType=t,a.subtotalManager=i,a.pathInfo=n,a.cacheName=e,a.expression=r,a.resultIndex=o},f.prototype.setMeasureNode=function(t){this.measureNode=t},i.PivotCalcSource=f,w.prototype.fii=function(t){this.calcSource=t},w.prototype.parseFormulaToCalcRelatedFieldNames=function(t){var i,n,i,i,n,t,t,e,r,o,a,i=this,n=i.calcService,i=i.calcSource,i=n.getParserContext(i);for(i.useR1C1=n.useR1C1,i.row=0,i.column=0,n=n.j3t,t=t.split(""),t=n.parseToTokens(i,t,!0),r=[],a=(e=n.eDt(i,t,!(o=0))).length;o<a;o++)p(e[o],r);return r},w.prototype.parseFormulaToCalcRelatedFieldItemMap=function(t){var i,n,i,i,n,t,t,e,r,o,a,i=this,n=i.calcService,i=i.calcSource,i=n.getParserContext(i);for(i.useR1C1=n.useR1C1,i.row=0,i.column=0,n=n.j3t,t=t.split(""),t=n.parseToTokens(i,t,!0),r=[],a=(e=n.eDt(i,t,!(o=0))).length;o<a;o++)h(e[o],r);return g(r)},w.prototype.getResolvers=function(){return this.calcSource.getResolver()},w.prototype.getGlobalSourceModel=function(t){return this.calcService.getGlobalSourceModel(t)},i.PivotCalcService=w},"./src/pivot-condition.ts":function(t,i,n){var v,d,s,e,r,o,a;function c(t,i,n){switch(t){case v.PivotValueFilterOperator.equalsTo:return function(t){return i===+t};case v.PivotValueFilterOperator.notEqualsTo:return function(t){return i!==+t};case v.PivotValueFilterOperator.greaterThan:return function(t){return i<+t};case v.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(t){return i<=+t};case v.PivotValueFilterOperator.lessThan:return function(t){return+t<i};case v.PivotValueFilterOperator.lessThanOrEqualsTo:return function(t){return+t<=i};case v.PivotValueFilterOperator.between:return function(t){return i<=+t&&+t<=n};case v.PivotValueFilterOperator.notBetween:return function(t){return+t<i||n<+t}}}function u(t,i,n){var e,i,n;this.sn=v.PivotConditionType.value,(e=this).LVt=t,i=isNaN(+i)?NaN:+i,(0,d.ht)(n)?(e.iX=s,e.eX=i):(n=isNaN(+n)?NaN:+n,e.eX=Math.min(i,n),e.iX=Math.max(i,n)),e.evaluate=c(t,e.eX,e.iX)}function l(n){var t,e,r,i,o,a,s,c,u,l,f,h,t=this.LVt,e=this.uit,r=this.GVt;if(n){if(n.sort(function(t,i){return t.value-i.value}),i=n.length,o=void 0,a=0,s=t===v.PivotTop10FilterOperator.top,e===v.PivotTop10FilterType.count)a=r;else if(e===v.PivotTop10FilterType.sum||e===v.PivotTop10FilterType.percent){for(c=i-1,u=n[s?i-1:0].value,l=0,f=function(){var t,i;if(e===v.PivotTop10FilterType.sum)return function(){return u<r};for(t=0;t<=c;t++)l+=n[t].value;return i=r/100,function(){return u/l<i}}();f();)a++,u+=n[s?c-a:a].value;a++}return o=s?n.slice(-1*a):n.slice(0,a),h={},(0,d.o)(o,function(t){h[t.index]=!0}),h}}function f(t,i,n){this.sn=v.PivotConditionType.top10;var e=this;e.LVt=t,e.uit=i,e.GVt=n,e.evaluate=l}function h(t,i,n){switch(t){case v.PivotCaptionFilterOperator.equalsTo:return function(t){return(0,d.Rii)(i,t)};case v.PivotCaptionFilterOperator.notEqualsTo:return function(t){return!(0,d.Rii)(i,t)};case v.PivotCaptionFilterOperator.beginsWith:return function(t){return(0,d.Gii)(i,t)};case v.PivotCaptionFilterOperator.doesNotBeginWith:return function(t){return!(0,d.Gii)(i,t)};case v.PivotCaptionFilterOperator.endsWith:return function(t){return(0,d.Vii)(i,t)};case v.PivotCaptionFilterOperator.doesNotEndWith:return function(t){return!(0,d.Vii)(i,t)};case v.PivotCaptionFilterOperator.contains:return function(t){return(0,d.Uii)(i,t)};case v.PivotCaptionFilterOperator.doesNotContain:return function(t){return!(0,d.Uii)(i,t)};case v.PivotCaptionFilterOperator.greaterThan:return function(t){return 0<(t+"").localeCompare(i,"kn",{numeric:!0})};case v.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(t){return 0<=(t+"").localeCompare(i,"kn",{numeric:!0})};case v.PivotCaptionFilterOperator.lessThan:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0};case v.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<=0};case v.PivotCaptionFilterOperator.between:return function(t){return 0<=(t+"").localeCompare(i,"kn",{numeric:!0})&&(t+"").localeCompare(n,"kn",{numeric:!0})<=0};case v.PivotCaptionFilterOperator.notBetween:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0||0<(t+"").localeCompare(n,"kn",{numeric:!0})}}}function p(t,i,n){this.sn=v.PivotConditionType.caption;var e=this;this.LVt=t,e.eX=(0,d.ht)(i)?i:i+"",e.iX=(0,d.ht)(n)?n:n+"",e.evaluate=h(t,e.eX,e.iX)}function m(t,i){var n,n=(0,d.ht)(i)?new Date:new Date(i);return t?(0,d.DQt)(n).getTime():n.getTime?n.getTime():i}function b(t,i){var i,i=(0,d.ht)(i)?new Date:new Date(i);return t?(0,d.DQt)(i):i}function g(t,i,n,e){return m(e,t)>=m(e,i)&&m(e,t)<=m(e,n)}function w(t){if(t%100==0){if(t%400==0)return 1}else if(t%4==0)return 1}function y(t,i,n){for(var e,r,o,a,e=i.getFullYear(),r=n.getFullYear(),o=e;o<=r;o++)if(i<=(a=C(t,o))&&a<=n)return!0;return!1}function C(t,i){var t=new Date(t.valueOf()),n=t.getFullYear(),e=t.getMonth(),r=t.getDate();return w(n)&&1===e&&29===r&&!w(i)?t.setFullYear(i,1,28):!w(n)&&1===e&&28===r&&w(i)?t.setFullYear(i,1,29):t.setFullYear(i),t}function N(t,i,n){var t,e,r,o,a,s,e,t=new Date(t.valueOf()),e=t.getMonth(),r=t.getDate(),o=[0,2,4,6,7,9,11],a=[3,5,8,10],s=w(i)?29:28;return-1<o.indexOf(e)&&31===r?-1<a.indexOf(n)?t.setMonth(n,30):1===n?t.setMonth(n,s):t.setMonth(n):-1<a.indexOf(e)&&30===r?-1<o.indexOf(n)?t.setMonth(n,31):1===n?t.setMonth(n,s):t.setMonth(n):1===e&&r===s?-1<o.indexOf(n)?t.setMonth(n,31):-1<a.indexOf(n)?t.setMonth(n,30):t.setMonth(n):(e=new Date(i,n+1,0).getDate())<r?t.setMonth(n,e):t.setMonth(n),t}function I(t,i,n,e){var r,r;return r=N(r=new Date(t.valueOf()),i,3*n+e)}function A(t,i,n){for(var e,r,o,a,s,c,u,l,e=i.getFullYear(),r=Math.floor(i.getMonth()/3),o=n.getFullYear(),a=Math.floor(n.getMonth()/3),s=t.getMonth()%3,c=e;c<=o;c++)for(u=C(t,c),c!==o&&(a=3),l=r=c!==e?0:r;l<=a;l++)if(i<=(u=I(u,c,l,s))&&u<=n)return!0;return!1}function T(t,i,n){for(var e,r,o,a,s,c,u,e=i.getFullYear(),r=i.getMonth(),o=n.getFullYear(),a=n.getMonth(),s=e;s<=o;s++)for(c=C(t,s),s!==o&&(a=11),u=r=s!==e?0:r;u<=a;u++)if(i<=(c=N(c,s,u))&&c<=n)return!0;return!1}function M(i,n,e,r,t,o,a){var s,c;if(i<=v.PivotDateFilterOperator.notBetween)switch(i){case v.PivotDateFilterOperator.equalsTo:return function(t){return m(r,n)===m(r,t)};case v.PivotDateFilterOperator.notEqualsTo:return function(t){return m(r,n)!==m(r,t)};case v.PivotDateFilterOperator.before:return function(t){return m(r,n)>m(r,t)};case v.PivotDateFilterOperator.beforeEqualsTo:return function(t){return m(r,n)>=m(r,t)};case v.PivotDateFilterOperator.after:return function(t){return m(r,n)<m(r,t)};case v.PivotDateFilterOperator.afterEqualsTo:return function(t){return m(r,n)<=m(r,t)};case v.PivotDateFilterOperator.Between:return function(t){return g(t,n,e,r)};case v.PivotDateFilterOperator.notBetween:return function(t){return m(r,t)<m(r,n)||m(r,t)>m(r,e)}}if(8<=i&&i<=23)switch(i){case v.PivotDateFilterOperator.today:return function(t){return m(r)===m(r,t)};case v.PivotDateFilterOperator.yesterday:return function(t){return m(r)-d.PRE_DAY===m(r,t)};case v.PivotDateFilterOperator.tomorrow:return function(t){return m(r)+d.PRE_DAY===m(r,t)};case v.PivotDateFilterOperator.last7Days:return function(t){var i=m(r),t=m(r,t);return i-7*d.PRE_DAY<=t&&t<i};case v.PivotDateFilterOperator.thisMonth:return function(t){var i=new Date;return i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.lastMonth:return function(t){var i=new Date;return i.setMonth(i.getMonth()-1),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.nextMonth:return function(t){var i=new Date;return i.setMonth(i.getMonth()+1),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.thisWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()),n.setDate(n.getDate()-n.getDay()+6),i<=t&&t<=n};case v.PivotDateFilterOperator.lastWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()-7),n.setDate(n.getDate()-n.getDay()),i<=t&&t<=n};case v.PivotDateFilterOperator.nextWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()+7),n.setDate(n.getDate()-n.getDay()+14),i<=t&&t<=n};case v.PivotDateFilterOperator.nextQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e+3),(r=(0,d.DQt)(new Date)).setMonth(n-e+6),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<(0,d.DQt)(r)};case v.PivotDateFilterOperator.thisQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e),(r=(0,d.DQt)(new Date)).setMonth(n-e+3),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<=(0,d.DQt)(r)};case v.PivotDateFilterOperator.lastQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e-3),(r=(0,d.DQt)(new Date)).setMonth(n-e),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<(0,d.DQt)(r)};case v.PivotDateFilterOperator.nextYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()+1===t.getFullYear()};case v.PivotDateFilterOperator.thisYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()===t.getFullYear()};case v.PivotDateFilterOperator.lastYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()-1===t.getFullYear()}}return i>=v.PivotDateFilterOperator.Q1&&i<=v.PivotDateFilterOperator.Q4?function(t){return i-v.PivotDateFilterOperator.Q1===Math.floor(t.getMonth()/3)}:i>=v.PivotDateFilterOperator.M1&&i<=v.PivotDateFilterOperator.M12?function(t){return i-v.PivotDateFilterOperator.M1===t.getMonth()}:i===v.PivotDateFilterOperator.yearToDate?function(t){var i=new Date,n=new Date;return i.setMonth(0,1),i.setHours(0,0,0,0),n.setHours(23,59,59),i<=t&&t<=n}:i===v.PivotDateFilterOperator.dateToDate?(s=b(r,n),c=t?b(r):b(r,e),o?a===v.PivotAdvancedDateFilterBy.year?function(t){return y(b(r,t),s,c)}:a===v.PivotAdvancedDateFilterBy.quarter?function(t){return A(b(r,t),s,c)}:a===v.PivotAdvancedDateFilterBy.month?function(t){return T(b(r,t),s,c)}:void 0:function(t){return m(r,t)>=m(r,s)&&m(r,t)<=m(r,c)}):void 0}function S(t,i,n,e,r,o,a){this.sn=v.PivotConditionType.date;var s=this;s.LVt=t,s.eX=n,s.iX=e,s.xQt=i,s.BVt=r,s.Rs=a,s.EVt=o,s.evaluate=M(t,s.eX,s.iX,i,r,o,a)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFilterDateCondition=i.Qii=i.SQt=i.PivotFilterCaptionCondition=i.PivotFilterTop10Condition=i.PivotFilterValueCondition=void 0,v=n("./src/pivot-interface.ts"),d=n("./src/pivot-util.ts"),s=void 0,u.prototype.getConditionType=function(){return this.sn},u.prototype.toJSON=function(){var t=this,i=t.LVt,t,t=t.LVt===v.PivotValueFilterOperator.between||v.PivotValueFilterOperator.notBetween?[t.eX,t.iX]:[t.eX];return{conType:v.PivotConditionType.value,val:t,operator:i}},u.prototype.fromJSON=function(t){var i,t,n,i=t.val,t=t.operator,n=this;n.LVt=t,i instanceof Array?(n.eX=i[0],n.iX=i[1]):(n.eX=i,n.iX=s),n.evaluate=c(n.LVt,n.eX,n.iX)},i.PivotFilterValueCondition=u,f.prototype.getConditionType=function(){return this.sn},f.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.GVt,t=t.uit;return{conType:v.PivotConditionType.top10,val:n,type:t,operator:i}},f.prototype.fromJSON=function(t){var i,n,t,e,i=t.val,n=t.operator,t=t.type,e=this;e.LVt=n,e.uit=t,e.GVt=i},i.PivotFilterTop10Condition=f,p.prototype.getConditionType=function(){return this.sn},p.prototype.toJSON=function(){var t=this,i=t.LVt,t=(0,d.ht)(t.iX)?[t.eX]:[t.eX,t.iX];return{conType:v.PivotConditionType.caption,val:t,operator:i}},p.prototype.fromJSON=function(t){var i,t,n,i=t.val,t=t.operator,n=this;n.LVt=t,n.eX=i[0],n.iX=i[1],n.evaluate=h(n.LVt,n.eX,n.iX)},i.PivotFilterCaptionCondition=p,i.SQt=m,i.Qii=b,S.prototype.getConditionType=function(){return this.sn},S.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.xQt,e,e=(0,d.ht)(t.iX)?[t.eX]:[t.eX,t.iX];return{conType:v.PivotConditionType.date,val:e,operator:i,isWholeDay:n,isDynamicEndDate:t.BVt,isParallel:t.EVt,by:t.Rs}},S.prototype.fromJSON=function(t){var i,n,e,r,o,t,a,i=t.val,n=t.operator,e=t.isWholeDay,r=t.isDynamicEndDate,o=t.isParallel,t=t.by,a=this;a.LVt=n,a.xQt=e,a.BVt=r,a.Rs=t,a.EVt=o,i instanceof Array?(a.eX=i[0],a.iX=i[1]):(a.eX=i,a.iX=s),a.evaluate=M(a.LVt,a.eX,a.iX,e,a.BVt,a.EVt,a.Rs)},i.PivotFilterDateCondition=S},"./src/pivot-engine.ts":function(t,i,n){var o,e,c,r;function a(t,i){for(var n,e,n=i[0].length,e=0;e<i.length;e++)i[e][n]=t.getValue(e,0)}function s(){var t=this;t.cut={},t.resetDataAnalyzer(),t.Wii=1,t.zii=1e8}function u(t,i){for(var n,e,r,o,n={},e=0,r=i;e<r.length;e++)n[(o=r[e]).FVt]=1;for(;n[t];)t++;return t}function l(t,i){return"external"!==t||!(0,c.ht)(i)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotEngine=void 0,o=n("./src/pivot-cache.ts"),e=n("./src/data-analyzer.ts"),c=n("./src/pivot-util.ts"),s.prototype.hasPivotCache=function(t){return!!this.cut[t]},s.prototype.addPivotCache=function(t){var i=this,n;return i.cut[t.getName()]=t,n=(0,c.ht)(t.FVt)?u(i.Wii,i.cut):u(t.FVt,i.cut),i.Wii=n+1,t.FVt=n,(0,c.ht)(t.yQt)?(t.yQt=i.zii,i.zii++):t.yQt>i.zii&&(i.zii=t.yQt+1),t},s.prototype.getPivotCacheByName=function(t){return this.cut[t]},s.prototype.getPivotCacheByCacheId=function(t){var i,n,e,i,n=this.cut;for(e in n)if(n.hasOwnProperty(e)&&n[e].FVt===t)return n[e]},s.prototype.getPivotCacheByPivotCacheId=function(t){var i,n,e,i,n=this.cut;for(e in n)if(n.hasOwnProperty(e)&&n[e].yQt===t)return n[e]},s.prototype.gJt=function(t){var i,n,i=this;for(n in i.cut)if(i.cut.hasOwnProperty(n)&&i.cut[n].mii(t))return i.cut[n];return null},s.prototype.dispose=function(){var t,i,t=this;for(i in t.cut)t.cut.hasOwnProperty(i)&&t.cut[i].dispose();t.cut={},t.Zii=null},s.prototype.reset=function(){this.cut={}},s.prototype.update=function(){},s.prototype.queryItem=function(t,i,n){for(var e,r,o,a,s,s,e=this.getPivotCacheByName(t),r=!1,o=0,a=i;o<a.length;o++)if(s=a[o],(s=(s=e.getField(s.sourceName)).cC()?e.getField(s.y1):s).ty&&0<s.ty.length){r=!0;break}return this.Zii.nti(e,this.Zii.Lh(e,i,r),i,n)},s.prototype.TQt=function(t,i,n){var t=this.getPivotCacheByName(t);return this.Zii.TQt(t,this.Zii.Lh(t,i),n)},s.prototype.getCalcFields=function(t){var t=this.getPivotCacheByName(t);return t?t.WVt():[]},s.prototype.addGroup=function(t,i){var t=this.getPivotCacheByName(t);return!!t&&t.dy(i)},s.prototype.fromJson=function(t){var i,n,e,e,i=this;for(n in this.resetDataAnalyzer(),t)t.hasOwnProperty(n)&&l((e=t[n]).sourceType,e.pivotCacheRecords)&&((e=new o.PivotCache).fromJson(n,t[n],i),i.addPivotCache(e))},s.prototype.toJson=function(t,i){for(var n,e,r,o,a,s,n=this.cut,e={},r=0,o=i;r<o.length;r++)s=n[a=o[r]],(0,c.ht)(s)||(e[s.FVt]=s.toJson(t[a]));return e},s.prototype.yh=function(t,i,n){var e,r,r,e=this,r=(0,c.xr)(t,"cacheSource");l(null==r?void 0:r.type,n)&&(this.resetDataAnalyzer(),(r=new o.PivotCache).yh(t,i,n),e.addPivotCache(r))},s.prototype.wh=function(t,i){for(var n,e,r,o,a,s,n=this.cut,e={},r=0,o=i;r<o.length;r++)s=n[a=o[r]],(0,c.ht)(s)||(e[s.Zc]=s.wh(t[a]));return e},s.prototype.resetDataAnalyzer=function(){this.Zii=new e.DataAnalyzer},i.PivotEngine=s},"./src/pivot-interface.ts":function(t,i){var n,e,r,o,a,s,c,u,l,f,h,v,d,p,m,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b;Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=i.PivotShowDataAs=i.DateGroupType=i.DataPosition=i.PivotTop10FilterOperator=i.PivotTop10FilterType=i.PivotAdvancedDateFilterBy=i.PivotDateFilterOperator=i.PivotCaptionFilterOperator=i.PivotValueFilterOperator=i.PivotConditionType=i.PivotDataType=i.SubtotalType=i.PivotSourceFieldType=i.PivotShowDataAsBaseItemType=void 0,(b=n=i.PivotShowDataAsBaseItemType||(i.PivotShowDataAsBaseItemType={}))[b.item=0]="item",b[b.next=1]="next",b[b.previous=2]="previous",(b=e=i.PivotSourceFieldType||(i.PivotSourceFieldType={}))[b.isCalcField=0]="isCalcField",b[b.isGroupField=1]="isGroupField",(b=r=i.SubtotalType||(i.SubtotalType={}))[b.average=0]="average",b[b.count=1]="count",b[b.countNums=2]="countNums",b[b.max=3]="max",b[b.min=4]="min",b[b.product=5]="product",b[b.stdDev=6]="stdDev",b[b.stdDevp=7]="stdDevp",b[b.sum=8]="sum",b[b.varr=9]="varr",b[b.varp=10]="varp",(b=o=i.PivotDataType||(i.PivotDataType={}))[b.number=0]="number",b[b.string=1]="string",b[b.date=2]="date",b[b.boolean=3]="boolean",b[b.errorValue=4]="errorValue",b[b.noValue=5]="noValue",(b=a=i.PivotConditionType||(i.PivotConditionType={}))[b.caption=0]="caption",b[b.date=1]="date",b[b.value=2]="value",b[b.top10=3]="top10",(b=s=i.PivotValueFilterOperator||(i.PivotValueFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.greaterThan=2]="greaterThan",b[b.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",b[b.lessThan=4]="lessThan",b[b.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",b[b.between=6]="between",b[b.notBetween=7]="notBetween",(b=c=i.PivotCaptionFilterOperator||(i.PivotCaptionFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.beginsWith=2]="beginsWith",b[b.doesNotBeginWith=3]="doesNotBeginWith",b[b.endsWith=4]="endsWith",b[b.doesNotEndWith=5]="doesNotEndWith",b[b.contains=6]="contains",b[b.doesNotContain=7]="doesNotContain",b[b.greaterThan=8]="greaterThan",b[b.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",b[b.lessThan=10]="lessThan",b[b.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",b[b.between=12]="between",b[b.notBetween=13]="notBetween",(b=u=i.PivotDateFilterOperator||(i.PivotDateFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.before=2]="before",b[b.beforeEqualsTo=3]="beforeEqualsTo",b[b.after=4]="after",b[b.afterEqualsTo=5]="afterEqualsTo",b[b.Between=6]="Between",b[b.notBetween=7]="notBetween",b[b.today=8]="today",b[b.yesterday=9]="yesterday",b[b.tomorrow=10]="tomorrow",b[b.last7Days=11]="last7Days",b[b.thisMonth=12]="thisMonth",b[b.lastMonth=13]="lastMonth",b[b.nextMonth=14]="nextMonth",b[b.thisWeek=15]="thisWeek",b[b.lastWeek=16]="lastWeek",b[b.nextWeek=17]="nextWeek",b[b.nextQuarter=18]="nextQuarter",b[b.thisQuarter=19]="thisQuarter",b[b.lastQuarter=20]="lastQuarter",b[b.nextYear=21]="nextYear",b[b.thisYear=22]="thisYear",b[b.lastYear=23]="lastYear",b[b.Q1=24]="Q1",b[b.Q2=25]="Q2",b[b.Q3=26]="Q3",b[b.Q4=27]="Q4",b[b.M1=28]="M1",b[b.M2=29]="M2",b[b.M3=30]="M3",b[b.M4=31]="M4",b[b.M5=32]="M5",b[b.M6=33]="M6",b[b.M7=34]="M7",b[b.M8=35]="M8",b[b.M9=36]="M9",b[b.M10=37]="M10",b[b.M11=38]="M11",b[b.M12=39]="M12",b[b.yearToDate=40]="yearToDate",b[b.dateToDate=41]="dateToDate",(b=l=i.PivotAdvancedDateFilterBy||(i.PivotAdvancedDateFilterBy={}))[b.month=1]="month",b[b.quarter=2]="quarter",b[b.year=3]="year",(b=f=i.PivotTop10FilterType||(i.PivotTop10FilterType={}))[b.count=0]="count",b[b.percent=1]="percent",b[b.sum=2]="sum",(b=h=i.PivotTop10FilterOperator||(i.PivotTop10FilterOperator={}))[b.top=1]="top",b[b.bottom=-1]="bottom",(b=v=i.DataPosition||(i.DataPosition={}))[b.row=0]="row",b[b.col=1]="col",b[b.none=2]="none",(b=d=i.DateGroupType||(i.DateGroupType={}))[b.seconds=0]="seconds",b[b.minutes=1]="minutes",b[b.hours=2]="hours",b[b.days=3]="days",b[b.months=4]="months",b[b.quarters=5]="quarters",b[b.years=6]="years",(b=p=i.PivotShowDataAs||(i.PivotShowDataAs={}))[b.normal=0]="normal",b[b.percentOfTotal=1]="percentOfTotal",b[b.percentOfRow=2]="percentOfRow",b[b.percentOfCol=3]="percentOfCol",b[b.percent=4]="percent",b[b.percentOfParentRow=5]="percentOfParentRow",b[b.percentOfParentCol=6]="percentOfParentCol",b[b.percentOfParent=7]="percentOfParent",b[b.difference=8]="difference",b[b.percentDiff=9]="percentDiff",b[b.runTotal=10]="runTotal",b[b.percentOfRunningTotal=11]="percentOfRunningTotal",b[b.rankAscending=12]="rankAscending",b[b.rankDescending=13]="rankDescending",b[b.index=14]="index",(b=m=i.SortType||(i.SortType={}))[b.asc=0]="asc",b[b.desc=1]="desc",b[b.custom=2]="custom"},"./src/pivot-sort.ts":function(t,l,i){var n,f,h,c,i,v,e,r,o,a,s,u,d,p;function m(t){var i,n,e,r,o,a,s,i=[],n=v().dateResource,e=n.HOUR_GROUP_ITEMS.slice(),r=n.MINUTE_GROUP_ITEMS.slice(),o=n.SECOND_GROUP_ITEMS.slice();switch(t){case f.DateGroupType.quarters:for(a=0;a<h.quartersGroupItemsKey.length;a++)i.push(n[h.quartersGroupItemsKey[a]]);break;case f.DateGroupType.months:for(a=0;a<h.monthsGroupItemsKey.length;a++)i.push(n[h.monthsGroupItemsKey[a]]);break;case f.DateGroupType.days:for(a=0;a<h.monthsGroupItemsKey.length;a++)for(s=1;s<=h.dayCountPerMonth[a];s++)i.push((0,c.Yii)(n[h.monthsGroupItemsKey[a]],s));break;case f.DateGroupType.hours:for(a=0;a<e.length;a++)i.push(e[a]);break;case f.DateGroupType.minutes:for(a=0;a<r.length;a++)i.push(r[a]);break;case f.DateGroupType.seconds:for(a=0;a<o.length;a++)i.push(o[a])}return i}Object.defineProperty(l,"__esModule",{value:!0}),l.mXt=l.Hii=l.Jii=l.qii=l.Kii=l.Xii=l.$ii=l.tni=void 0,n=i("Common"),f=i("./src/pivot-interface.ts"),h=i("./src/pivot-util.ts"),c=i("./pivot-entry.ts"),i=new n.Common.ResourceManager(c.SR),v=i.getResource.bind(i),l.tni=e=function(t,i){var n,e;return t===i?0:(n=+t,(e=+i)&&n?e<n?1:-1:(""+t).localeCompare(i+""))},l.$ii=r=function(t,i){return i<=t?1:-1},l.Xii=o=function(t,i){return t.getMonth()>=i.getMonth()?1:-1},l.Kii=a=function(t,i){return Math.floor(t.getMonth()/3)>=Math.floor(i.getMonth()/3)?1:-1},l.qii=s=function(t,i){return i<=t?1:-1},l.Jii=u=function(t,i){for(var n,e,r,o,a,s,c,u,e=v().blank,n=i===f.DateGroupType.years?(t.sort(l.tni),t):(r=m(i)).concat([]),s=0,c=!1,u=0;u<t.length;u++)t[u]&&t[u]!==e?-1<t[u].indexOf(h.LESS)?(o=t[u],s++):-1<t[u].indexOf(h.MORE)&&(a=t[u],s++):c=!0;return i===f.DateGroupType.years&&(n=n.splice(s)),o&&n.unshift(o),a&&n.push(a),c&&n.unshift(e),n},l.Hii=d=function(t){for(var i,n,e,r,o,a,a,i=[],n={},e=[],r=0,o=t.length;r<o;r++)a=void 0,-1<t[r].indexOf(h.LESS)?a=h.LESS:-1<t[r].indexOf(h.MORE)?a=h.MORE:-1<t[r].indexOf(h.NUMBER_GROUP_SEPARATOR)&&(a=h.NUMBER_GROUP_SEPARATOR),a=a?t[r].split(a)[1]:t[r],i.push(a),n[a]=r;for(i.sort(l.tni),r=0,o=i.length;r<o;r++)e.push(t[n[i[r]]]);return e},l.mXt=p=function(t,i){var n,e,r,o;if(i.isDate)(0,h.ht)(i.by)?t.sort(function(t,i){return new Date(t)>new Date(i)?1:-1}):t=(0,l.Jii)(t,i.by);else if(i.isNumberGroup)t=(0,l.Hii)(t);else{for(n=[],e=[],r=[],o=0;o<t.length;o++)t[o]===v().blank?r.push(t[o]):"number"==typeof t[o]?n.push(t[o]):"string"==typeof t[o]?e.push(t[o]):"object"==typeof t[o]&&e.push(t[o]._error||t[o]+"");1<n.length&&n.sort(function(t,i){return t-i}),1<e.length&&e.sort(function(t,i){return(0,c.ini)(t,i)}),t=n.concat(e,r)}return t}},"./src/pivot-util.ts":function(L,a,t){var n,r,e,t,i,o,s,c,E,B,R,G,t,u,l,f,h,v,d,V,p,m;function b(){}function g(t,i,n,e,r){var i=d.jJ(i);return i?d.qT(i=n+i+e).test(t):r()}function U(t,i){return t&&i?(t.splice.apply(t,n([t.length,i.length],i,!1)),t.sort(function(t,i){return t-i}),t):t||i||[]}function Q(e){var t,i,r,n,o,a;if(!e||0===e.length)return[];for(t=e[0],i=e.length,r={},w(t,function(t){r[t]=1}),n=function(t){var i={},n=!0;if(w(e[t],function(t){r[t]&&(n=!(i[t]=1))}),r=i,n)return{value:[]}},o=1;o<i;o++)if("object"==typeof(a=n(o)))return a.value;return Object.keys(r)}function W(t,i){for(var n,e,r,n=[],e=0,r=0;r<t.length;r++)for(;e<i.length;){if(!(t[r]>i[e])){if(t[r]!==i[e])break;n.push(t[r]);break}e++}return n}function z(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e&&0!==(i=W(i,t[n])).length;n++);}function Z(t,i){for(var n,e,r,n=!1,e=0,r=t.length;e<r;e++)i===t[e]&&(n=!0);return n}function w(t,i){for(var n,e,r,e=t.length,n=0;n<e&&!(r=i(t[n],n));n++);}function Y(t){for(var i,n,i=[],n=0;n<t.length;n++)i=i.concat(t[n]);return i}function y(t){return null==t}function C(t){return"string"==typeof t}function H(t){return!y(t)&&(t=C(t)?parseFloat(t):t)==t&&isFinite(t)}function N(t){return t<10?"0"+t:t+""}function I(t){var i;try{i=t.getFullYear()+"-"+N(t.getMonth()+1)+"-"+N(t.getDate())+"T"+N(t.getHours())+":"+N(t.getMinutes())+":"+N(t.getSeconds())}catch(t){}return i}function J(t){return t.getUTCFullYear()+"/"+N(t.getUTCMonth()+1)+"/"+N(t.getUTCDate())}function A(t,i){return i.slice(0,t.length).toLowerCase()===t.toLowerCase()}function q(t,i){return g(t,i,"^","",function(){return A(t,i)})}function T(t,i){return i.slice(-t.length).toLowerCase()===t.toLowerCase()}function K(t,i){return g(t,i,"","$",function(){return T(t,i)})}function M(t,i){return""===i||0<=t.toLowerCase().indexOf(i.toLowerCase())}function X(t,i){return g(t,i,"","",function(){return M(i,y(t)?"":t)})}function S(t,i){return t.toLowerCase()===i.toLowerCase()}function $(t,i){return g(i,t,"","",function(){return S(i,y(t)?"":t)})}function tt(t){var i,n,e;return t&&t instanceof Date?(i=t.getFullYear(),n=t.getMonth(),e=t.getDate(),new Date(i,n,e)):t}function it(t){return"string"==typeof t}function x(t){var i;return(0,a.getSR)().dateResource[a.monthsGroupItemsKey[t.getMonth()]]}function nt(t){var i;return(0,a.getSR)().dateResource.HOUR_GROUP_ITEMS[t.getHours()]}function et(t){var i;return(0,a.getSR)().dateResource.MINUTE_GROUP_ITEMS[t.getMinutes()]}function rt(t){var i;return(0,a.getSR)().dateResource.SECOND_GROUP_ITEMS[t.getSeconds()]}function ot(t){var i;return(0,a.getSR)().dateResource[a.quartersGroupItemsKey[Math.floor(t.getMonth()/3)]]}function at(){for(var t,i,n,e,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.monthsGroupItemsKey.length;n<e;n++)t.push(i[a.monthsGroupItemsKey[n]]);return t}function D(t){var i,n,i,n=f.Fe(f.culture()).TimelineDateSuffix;return t+(n&&n.year||"")}function k(t,i){var n,e,n,e=f.Fe(f.culture()).TimelineDateSuffix;return e&&e.date?t+i+e.date:i+"-"+t}function st(){for(var t,i,n,e,r,o,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.monthsGroupItemsKey.length;n<e;n++)for(r=0,o=a.dayCountPerMonth[n];r<o;r++)t.push(k(i[a.monthsGroupItemsKey[n]],r+1));return t}function ct(){for(var t,i,n,e,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.quartersGroupItemsKey.length;n<e;n++)t.push(i[a.quartersGroupItemsKey[n]]);return t}function ut(t){return t=t&&t[0]===t[t.length-1]&&"'"===t[0]?t.substring(1,t.length-1):t}function lt(t){var i;return"number"==typeof t?t:(i=Date.parse(t),isNaN(i)?(i=new Date(t),isNaN(i)?t:i):new Date(t))}function ft(t,i){var n,e,t,e;return y(i)||i===(0,a.getSR)().blank?(0,a.getSR)().blank:(n=t.T,e=t.Qti,t=t.Rs,i<n?a.LESS+n:e<=i?a.MORE+e:(e=n+Math.floor((i-n)/t)*t)+"-"+(e+t-1))}function ht(t,i){switch(t){case e.DateGroupType.seconds:return rt(i);case e.DateGroupType.minutes:return et(i);case e.DateGroupType.hours:return nt(i);case e.DateGroupType.days:return k(x(i),i.getDate());case e.DateGroupType.months:return x(i);case e.DateGroupType.quarters:return ot(i);case e.DateGroupType.years:return D(i.getFullYear());default:return I(i)}}function j(t){var i=f.Fe(f.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),h.Pe(t,n)}function vt(t,i){if(y(i)||i===(0,a.getSR)().blank)return(0,a.getSR)().blank;var n=t.T,e=t.gd,t=t.Rs,r;if("string"==typeof i&&P(i))r=P(i);else{if(!Date.parse(i))return l;r=new Date(i)}return r<n?"<"+j(n):e<r?">"+j(e):ht(t,r)}function dt(t){if(t&&"object"==typeof t)for(var i in t)if(t.hasOwnProperty(i))return!1;return!0}function O(t){var i,n,e,r,i=Array.isArray(t),n="[object Object]"===Object.prototype.toString.call(t);if(i){for(e=[],r=0;r<t.length;r++)e[r]=O(t[r]);return e}if(n){for(r in e=void 0,t)y(t[r])||((e=e===l?{}:e)[r]=O(t[r]));return e}return t}function pt(i,n){var e,t;try{e=(t=r.Common.CultureManager.getCultureInfo()).localeCompare?t.localeCompare(i,n):i.localeCompare(n,"en")}catch(t){e=i.localeCompare(n)}return e}function P(t){var i,t;return!y(t)&&""!==t&&"string"==typeof t&&(t=(i=new u).parse(t))instanceof Date?t:void 0}function mt(t,i){return y(t)?t:(i=i||/(&)|(<)|(>)|(")|(')/g,typeof t===v?t.replace(i,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+t)}function F(n){return function(t,i){return String.fromCharCode(parseInt(i,n))}}function bt(t,i){var n,e;return y(t)?t:!(n=typeof t===v)||-1===t.indexOf("&")?""+t:(e=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,(t=-1!==t.indexOf("&#")?t.replace(p,F(10)).replace(m,F(16)):t).replace(e,function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))}function gt(t,i){for(var n,e,r,o,a,o,n=i.split("&"),e=0,r=n.length;e<r;e++){if(a=(o=n[e].split("."))[0],o=o[1],!t)return;t=_(t,a,o)}return t}function _(t,i,n){var e,r,o,a;if(!t||!t.c_)return l;for(n=n?+n:0,r=0,o=(e=t.c_).length;r<o;r++)if((a=e[r])&&a.n_===i){if(0===n)return a;n--}}function wt(t,i){var n,e,r,o,a;if(!t||!t.c_)return l;for(e=[],r=0,o=(n=t.c_).length;r<o;r++)(a=n[r])&&a.n_===i&&e.push(a);return e}function yt(t,i){var n,e,r,o,a;if(t&&t.c_){for(n=[],e=0,r=i.length;e<r;e++)(a=wt(t,o=i[e]))&&0<a.length&&(n=n.concat(a));t.c_=n}}n=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(a,"__esModule",{value:!0}),a.Pr=a.xr=a.o1=a.xmlDecode=a.xmlEncode=a.parseStringToDate=a.ini=a.RF=a.k$t=a.isEmptyObject=a.getDateGroupItemKey=a.formatDateToString=a.getNumberGroupItemKey=a.nii=a.Oii=a.Zti=a.Wti=a.Yii=a.Yti=a.zti=a.isString=a.DQt=a.PRE_DAY=a.Rii=a.nni=a.Uii=a.eni=a.Vii=a.rni=a.Gii=a.oni=a.ani=a.kQt=a.jh=a.OMt=a.ht=a.sni=a.o=a.Mii=a.amt=a.F=a.uni=a.XFileConstants=a.NUMBER_GROUP_SEPARATOR=a.MORE=a.LESS=a.quartersGroupItemsKey=a.dayCountPerMonth=a.monthsGroupItemsKey=a.getSR=void 0,r=t("Common"),e=t("./src/pivot-interface.ts"),t=t("./pivot-entry.ts"),i=Math.min,o=Math.max,s=Math.abs,c=Math.pow,E=Math.sqrt,B=Math.floor,R=Math.ceil,G=!0,t=new r.Common.ResourceManager(t.SR,"PivotEngine"),a.getSR=t.getResource.bind(t),u=r.Formatter&&r.Formatter.GeneralFormatter,l=void 0,a.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],a.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],f=r.Common.CultureManager,h=r.Common.ct,a.LESS="<",a.MORE=">",a.NUMBER_GROUP_SEPARATOR="-",v="string",a.XFileConstants={cni:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",ns:"xr",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"},b.qT=function(t){var i=b.kUt[t],i;return(i=i||(b.kUt[t]=new RegExp(t,"g"))).lastIndex=0,i},b.jJ=function(t,i,n){var e,r,o,a,s,c;if(b._Ut[t])return b.EUt[t];if(b.qT(e="[~?*]+").test(t)){for(r=[],o=t.split(""),s={".":!(a=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},c=0;c<o.length;c++)"~"===(a=o[c])&&c<o.length-1?("*"===(a=o[++c])||"?"===a?r.push("\\"):i&&r.push("~"),r.push(a)):"?"===a?r.push("."):"*"===a?(r.push("[\\s\\S]"),r.push(n?"+":"*")):(s[a]&&r.push("\\"),r.push(a));return r.join("")}return null},b.tbt=function(t,i,n){var t=b.jJ(t,i,n),t;return t=t&&"^"+t+"$"},b.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},b.kUt={},b._Ut={},b.EUt={},d=b,a.uni=d,a.F=U,a.amt=Q,a.Mii=Z,a.o=w,a.sni=Y,a.ht=y,a.OMt=C,a.jh=H,a.kQt=I,a.ani=J,a.oni=A,a.Gii=q,a.rni=T,a.Vii=K,a.eni=M,a.Uii=X,a.nni=S,a.Rii=$,a.PRE_DAY=864e5,a.DQt=tt,a.isString=it,a.zti=at,a.Yti=D,a.Yii=k,a.Wti=st,a.Zti=ct,a.Oii=ut,a.nii=lt,a.getNumberGroupItemKey=ft,a.formatDateToString=j,a.getDateGroupItemKey=vt,a.isEmptyObject=dt,a.k$t=V=function(t,n){var i,e,r,o,a;if(!t)return t;for(e in i=[],t)t.hasOwnProperty(e)&&i.push(+e);for(i.sort(function(t,i){return(t-i)*n}),r={},o=0,a=i.length;o<a;o++)r[i[o]]=o+1;return r},a.RF=O,a.ini=pt,a.parseStringToDate=P,a.xmlEncode=mt,p=/&#(\d+);/g,m=/&#x([0-9A-F]+);/gi,a.xmlDecode=bt,a.o1=gt,a.xr=_,a.Pr=yt},"./src/pivotEngine.res.en.ts":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.resource=void 0,i.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years",SECOND_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],MINUTE_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],HOUR_GROUP_ITEMS:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(t){t.exports=o("@grapecity/js-calc")},Common:function(t){t.exports=o("Common")}},e={},t=r("./pivot-entry.ts"),(a={}).Pivot=t}(),e=a||{},"object"==typeof t.exports?t.exports=e.Pivot:void 0!==(i=function(){return e.Pivot}.apply(i,n=[]))&&(t.exports=i)},Pivot:function(t){"use strict";t.exports=e.Pivot},Common:function(t){"use strict";t.exports=e.Spread},"@grapecity/js-calc":function(t){"use strict";t.exports=e.Spread.CalcEngine},Core:function(t){"use strict";t.exports=e.Spread.Sheets},SheetsCalc:function(t){"use strict";t.exports=e.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=e.Spread.Sheets.CellTypes},ConditionalFormatting:function(t){"use strict";t.exports=e.Spread.Sheets.ConditionalFormatting},FormulaTextBox:function(t){"use strict";t.exports=e.Spread.Sheets.FormulaTextBox},Shapes:function(t){"use strict";t.exports=e.Spread.Sheets.Shapes},Slicers:function(t){"use strict";t.exports=e.Spread.Sheets.Slicers},Tables:function(t){"use strict";t.exports=e.Spread.Sheets.Tables}},o={},t=n("./dist/plugins/pivot/pivot-all-entry.js"),((e=void 0===e?{}:e).Spread=e.Spread||{}).Pivot=t});